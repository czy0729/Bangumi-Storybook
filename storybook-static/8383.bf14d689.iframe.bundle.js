(self.webpackChunkweb=self.webpackChunkweb||[]).push([[8383],{"./src/screens/web-view/bilibili-sync/component/btn/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Btn")},"./src/screens/web-view/bilibili-sync/component/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/btn/ds.ts"),c=s("./src/screens/web-view/bilibili-sync/component/btn/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.ob)((function(e){var t=e.style,s=e.btnStyle,n=e.text,i=void 0===n?"同步":n,l=e.type,u=e.size,a=void 0===u?11:u,m=e.disabled,b=e.loading,f=e.onPress,p=(0,c.memoStyles)(),j="success"===l&&!m;return(0,d.jsx)(o.Touchable,{style:(0,r.stl)(p.touch,t),onPress:m||b?void 0:f,children:(0,d.jsx)(o.Flex,{style:(0,r.stl)(p.btn,j&&p.btnSuccess,s),justify:"center",children:b?(0,d.jsx)(o.Loading.Mini,{}):(0,d.jsx)(o.Text,{bold:!0,size:a,type:j?"__plain__":void 0,children:i})})})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{touch:{width:56,borderRadius:n._.r(28),overflow:"hidden"},btn:{height:n._.r(28),backgroundColor:n._.select(n._.colorBg,n._._colorDarkModeLevel1),borderRadius:n._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/web-view/bilibili-sync/component/column-bgm/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"ColumnBgm")},"./src/screens/web-view/bilibili-sync/component/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/column-bgm/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.ob)((function(e){var t=e.select,s=e.text,n=e.next;return(0,c.jsxs)(o.Text,{style:r._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,c.jsxs)(o.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",n]})]})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/column-select/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.COMPONENT=t.COLOR_SUCCESS=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"ColumnSelect"),t.COLOR_SUCCESS="rgb(1, 173, 145)",t.HIT_SLOP={top:4,right:32,bottom:4,left:16}},"./src/screens/web-view/bilibili-sync/component/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),i=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/column-select/ds.ts"),c=s("./src/screens/web-view/bilibili-sync/component/column-select/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.ob)((function(e){var t=e.select,s=e.disabled,n=e.onPress;return s?(0,d.jsx)(o.default,{style:c.styles.columnSelect}):(0,d.jsx)(r.Touchable,{style:c.styles.columnSelect,hitSlop:l.HIT_SLOP,onPress:function(){return n(!t)},children:(0,d.jsx)(r.Flex,{style:c.styles.radio,justify:"center",children:(0,d.jsx)(r.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?l.COLOR_SUCCESS:void 0,size:16})})})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/web-view/bilibili-sync/component/column/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Column")},"./src/screens/web-view/bilibili-sync/component/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),i=s("./src/screens/web-view/bilibili-sync/component/column/ds.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.style,s=e.type,n=e.text,r=e.right,i=e.onPress;return(0,l.jsxs)(o.Flex,{style:t,children:[(0,l.jsx)(o.Text,{size:11,type:n&&"/"!==n?s:"sub",onPress:i,children:n||"__"}),r]})}),i.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Component")},"./src/screens/web-view/bilibili-sync/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT=t.BILIBILI_STATUS=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/constants/index.ts"),r=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(r.COMPONENT,"Item"),t.BILIBILI_STATUS={1:"想看",2:"在看",3:"看过"},t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},review:{},collection:{},hideSame:!1,onRefreshCollection:o.FROZEN_FN,onBottom:o.FROZEN_FN,onSubmit:o.FROZEN_FN}},"./src/screens/web-view/bilibili-sync/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/utils/decorators/index.ts"),r=n(s("./src/screens/web-view/bilibili-sync/component/item/item.tsx")),i=s("./src/screens/web-view/bilibili-sync/component/item/ds.ts"),l=s("./src/screens/web-view/bilibili-sync/component/item/styles.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s=e.item,n=t.$,o=t.navigation,i=s.subjectId;if(n.state.hideNotMatched&&!i)return null;var d=n.collection(i);return n.state.hideWatched&&"collect"===(null==d?void 0:d.status)?null:(0,c.jsx)(r.default,{navigation:o,styles:(0,l.memoStyles)(),item:s,review:n.review(s.id),collection:d,hideSame:n.state.hideSame,onRefreshCollection:n.onRefreshCollection,onBottom:n.onBottom,onSubmit:n.onSubmit})}),i.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/item/item.tsx":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=O(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=o?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}return n.default=e,s&&s.set(e,n),n}(s("react")),c=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),d=s("./src/components/index.ts"),u=s("./src/components/cover/utils.ts"),a=s("./src/screens/_/index.ts"),m=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),f=s("./src/utils/decorators/index.ts"),p=s("./src/utils/fetch/index.ts"),j=s("./src/constants/index.ts"),v=s("./src/screens/web-view/bilibili-sync/utils.ts"),_=o(s("./src/screens/web-view/bilibili-sync/component/btn/index.tsx")),y=o(s("./src/screens/web-view/bilibili-sync/component/column/index.tsx")),h=o(s("./src/screens/web-view/bilibili-sync/component/column-bgm/index.tsx")),x=o(s("./src/screens/web-view/bilibili-sync/component/column-select/index.tsx")),w=s("./src/screens/web-view/bilibili-sync/component/item/ds.ts"),g=s("./node_modules/react/jsx-runtime.js");function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(O=function(e){return e?s:t})(e)}t.default=(0,f.memo)((function(e){var t,s=e.navigation,o=e.styles,f=e.item,O=e.review,T=e.collection,S=e.hideSame,P=e.onRefreshCollection,E=e.onBottom,C=e.onSubmit,M=f.subjectId,N=!!M,I=!(null==T||!T.loaded),R=(null==(t=f.progress.replace("看到","").replace("第","").split(" "))?void 0:t[0])||"",L=(0,l.useState)(!1),D=(0,i.default)(L,2),k=D[0],B=D[1],A=(0,v.useSelectStatus)(f.status,null==T?void 0:T.status),q=(0,i.default)(A,2),H=q[0],F=q[1],z=(0,v.useSelectEp)(R,null==T?void 0:T.ep_status),U=(0,i.default)(z,2),W=U[0],G=U[1],V=(0,v.useSelectScore)(null==O?void 0:O.score,null==T?void 0:T.rating),J=(0,i.default)(V,2),Y=J[0],Z=J[1],$=(0,v.useSelectComment)(null==O?void 0:O.content,null==T?void 0:T.comment),K=(0,i.default)($,2),X=K[0],Q=K[1],ee={status:w.BILIBILI_STATUS[f.status]||"",ep:R||"",score:(null==O?void 0:O.score)||"",comment:(null==O?void 0:O.content)||""},te={status:j.MODEL_COLLECTION_STATUS.getLabel(null==T?void 0:T.status)||"",ep:(null==T?void 0:T.ep_status)&&T.ep_status+"话",score:(null==T?void 0:T.rating)||"",comment:(null==T?void 0:T.comment)||""};if(S&&ee.status==te.status&&ee.ep==te.ep&&ee.score==te.score&&ee.comment==te.comment)return null;var se={status:w.BILIBILI_STATUS[f.status],ep:(0,v.getSelectEp)(R,null==T?void 0:T.ep_status).value,score:(0,v.getSelectScore)(null==O?void 0:O.score,null==T?void 0:T.rating).value,comment:(0,v.getSelectComment)(null==O?void 0:O.content,null==T?void 0:T.comment).value},ne=function(){N&&s.push("Subject",{subjectId:M,_cn:f.title.replace("（僅限港澳台地區）",""),_image:(0,u.getCoverSrc)(f.cover,j.IMG_WIDTH_SM)})};return(0,g.jsxs)(d.Flex,{style:o.item,align:"start",children:[(0,g.jsx)(a.Cover,{src:f.cover,width:j.IMG_WIDTH_SM,height:j.IMG_HEIGHT_SM,radius:!0,onPress:ne}),(0,g.jsx)(d.Flex.Item,{children:(0,g.jsxs)(d.Flex,{style:o.body,direction:"column",align:"start",children:[(0,g.jsx)(d.Text,{bold:!0,numberOfLines:2,onPress:ne,children:f.title}),(0,g.jsxs)(d.Flex,{style:m._.mt.md,align:"start",children:[(0,g.jsxs)(c.default,{children:[(0,g.jsx)(y.default,{text:" ",type:"sub"}),(0,g.jsx)(y.default,{style:m._.mt.md,text:"状态",type:"sub"}),(0,g.jsx)(y.default,{style:m._.mt.md,text:"进度",type:"sub"}),(0,g.jsx)(y.default,{style:m._.mt.md,text:"评分",type:"sub"}),(0,g.jsx)(y.default,{style:m._.mt.md,text:"点评",type:"sub"})]}),(0,g.jsxs)(d.Flex.Item,{style:m._.ml.md,children:[(0,g.jsx)(y.default,{text:"bilibili",type:"sub"}),(0,g.jsx)(y.default,{style:m._.mt.md,text:ee.status}),(0,g.jsx)(y.default,{style:m._.mt.md,text:ee.ep}),(0,g.jsx)(y.default,{style:m._.mt.md,text:ee.score}),(0,g.jsx)(y.default,{style:m._.mt.md,text:ee.comment,onPress:function(){null!=O&&O.content&&(0,b.copy)(null==O?void 0:O.content,"已复制")}})]}),(0,g.jsxs)(d.Flex.Item,{style:m._.ml.md,flex:1.5,children:[(0,g.jsx)(y.default,{text:"bgm",type:"sub",right:N&&(0,g.jsx)(d.Touchable,{style:m._.ml.xs,hitSlop:w.HIT_SLOP,onPress:function(){return P(M)},children:(0,g.jsx)(d.Iconfont,{name:"md-refresh",size:12})})}),N?I?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.default,{select:H,text:te.status,next:se.status}),(0,g.jsx)(h.default,{select:W,text:te.ep,next:se.ep+"话"}),(0,g.jsx)(h.default,{select:Y,text:te.score,next:se.score}),(0,g.jsx)(h.default,{select:X,text:te.comment,next:se.comment})]}):(0,g.jsx)(d.Flex,{style:o.loading,children:(0,g.jsx)(d.Loading.Mini,{})}):(0,g.jsx)(y.default,{style:m._.mt.md,text:"未找到条目"})]}),N&&(0,g.jsxs)(c.default,{style:o.selectors,children:[(0,g.jsx)(y.default,{text:" ",type:"sub"}),I&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(x.default,{select:H,disabled:!se.status,onPress:F}),(0,g.jsx)(x.default,{select:W,disabled:""===se.ep,onPress:G}),(0,g.jsx)(x.default,{select:Y,disabled:!se.score,onPress:Z}),(0,g.jsx)(x.default,{select:X,disabled:!se.comment,onPress:Q})]})]})]}),(0,g.jsx)(c.default,{style:o.toolbar,children:(0,g.jsxs)(d.Flex,{style:m._.mt.md,children:[(0,g.jsx)(d.Flex.Item,{children:(0,g.jsxs)(d.Flex,{children:[(0,g.jsx)(_.default,{text:"详情",onPress:function(){(0,p.t)("bili同步.详情"),(0,b.open)("https://www.bilibili.com/bangumi/media/md"+f.id)}}),(0,g.jsx)(_.default,{style:m._.ml.sm,text:"搜索",onPress:function(){(0,p.t)("bili同步.搜索"),s.push("Search",{type:"动画",value:f.title.replace("（僅限港澳台地區）","")})}}),(0,g.jsx)(_.default,{style:m._.ml.sm,text:"置底",onPress:function(){return E(f.id)}})]})}),N&&(0,g.jsx)(_.default,{style:m._.ml.md,type:"success",disabled:!I||!(H||W||Y||X),loading:k,onPress:(0,r.default)(n.mark((function e(){var t,s,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},s={},H?"想看"===se.status?(t.status=!0,s.status="wish"):"看过"===se.status?(t.status=!0,s.status="collect"):"在看"===se.status&&(t.status=!0,s.status="do"):te.status&&(t.status=!0,s.status=j.MODEL_COLLECTION_STATUS.getValue(te.status)),Y&&(t.score=!0,s.rating=se.score),X&&(t.comment=!0,s.comment=se.comment),o={},W&&(t.ep=!0,o.ep=se.ep),B(!0),e.next=10,C(M,s,o);case 10:B(!1),t.status&&F(!1),t.ep&&G(!1),t.score&&Z(!1),t.comment&&Q(!1);case 15:case"end":return e.stop()}}),e)})))})]})})]})})]})}),w.DEFAULT_PROPS)},"./src/screens/web-view/bilibili-sync/component/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{item:{paddingRight:n._.wind-n._._wind,paddingLeft:n._.wind,paddingVertical:n._.md,marginBottom:n._.sm},body:{paddingLeft:n._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:n._._wind,marginTop:n._.xs},loading:{marginTop:13}}}))},"./src/screens/web-view/bilibili-sync/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"List")},"./src/screens/web-view/bilibili-sync/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/screens/_/index.ts"),r=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),l=n(s("./src/screens/web-view/bilibili-sync/component/tool-bar/index.tsx")),c=s("./src/screens/web-view/bilibili-sync/component/list/utils.tsx"),d=s("./src/screens/web-view/bilibili-sync/component/list/ds.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=t.$;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(l.default,{}),(0,u.jsx)(o.PaginationList2,{contentContainerStyle:r._.container.bottom,data:s.data,limit:12,ListHeaderComponent:s.data.length?(0,u.jsxs)(o.Notice,{children:["共查找到 ",s.data.length," 项结果"]}):null,renderItem:c.renderItem,onPage:s.onPage})]})}),d.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=function(e){var t=e.item;return(0,r.jsx)(o.default,{item:t})};n(s("react"));var o=n(s("./src/screens/web-view/bilibili-sync/component/item/index.tsx")),r=s("./node_modules/react/jsx-runtime.js")},"./src/screens/web-view/bilibili-sync/component/login/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.URL_ZONE=t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Login"),t.URL_ZONE="https://m.bilibili.com/space?from=headline"},"./src/screens/web-view/bilibili-sync/component/login/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.string.fixed.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=x(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=o?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r]}return n.default=e,s&&s.set(e,n),n}(s("react")),l=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),c=s("./node_modules/react-native-webview/index.js"),d=s("./src/components/index.ts"),u=s("./src/stores/index.ts"),a=s("./src/utils/index.ts"),m=s("./src/utils/dev/index.ts"),b=s("./src/utils/fetch/index.ts"),f=s("./src/utils/hooks/index.ts"),p=n(s("./src/constants/i18n/index.ts")),j=n(s("./src/screens/web-view/bilibili-sync/component/btn/index.tsx")),v=s("./src/screens/web-view/bilibili-sync/component/login/utils.ts"),_=s("./src/screens/web-view/bilibili-sync/component/login/ds.ts"),y=s("./src/screens/web-view/bilibili-sync/component/login/styles.ts"),h=s("./node_modules/react/jsx-runtime.js");function x(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(x=function(e){return e?s:t})(e)}t.default=function(e){var t=e.hide,s=e.onToggleHide,n=e.setData,x=e.setReviews;(0,m.r)(_.COMPONENT);var w=(0,i.useState)(0),g=(0,r.default)(w,2),O=g[0],T=g[1],S=(0,i.useState)("检查状态中..."),P=(0,r.default)(S,2),E=P[0],C=P[1],M=(0,i.useCallback)((function(e){var t,s=JSON.parse(e.nativeEvent.data),r=s.type,i=s.data;switch(r){case v.TYPE_CHECK_LOGIN:C(null!=i&&null!=(t=i.data)&&t.isLogin?"已"+p.default.login():"检查"+p.default.login()+"状态失败，请先"+p.default.login());break;case v.TYPE_GET_LIST:C("已获取番剧列表"),n(i),o=i.length;break;case v.TYPE_GET_REVIEW:C("已获取 "+o+" 个番剧信息，请收起"+p.default.login()+"框进行操作"),x(i)}}),[n,x]),N=(0,i.useCallback)((function(){C("检查状态中..."),T(O+1),(0,b.t)("bili同步.获取数据")}),[O]);return(0,f.useObserver)((function(){var e=(0,y.memoStyles)();return(0,h.jsxs)(h.Fragment,{children:[!t&&(0,h.jsx)(l.default,{style:e.mask}),(0,h.jsxs)(l.default,{style:(0,a.stl)(e.fixed,t&&e.hide),children:[(0,h.jsx)(l.default,{style:e.container,children:(0,h.jsx)(c.WebView,{source:{uri:_.URL_ZONE},containerStyle:[e.webview,t&&e.webviewHide],androidHardwareAccelerationDisabled:!0,androidLayerType:"software",javaScriptEnabled:!0,injectedJavaScript:(0,v.injectedJavaScript)(),onMessage:M},O)}),(0,h.jsxs)(l.default,{style:e.body,children:[(0,h.jsx)(d.Text,{type:E.includes("个番剧信息")?"warning":void 0,bold:!0,size:15,children:E}),(0,h.jsx)(d.Text,{style:u._.mt.md,size:12,type:"sub",children:"若上方网页白屏请多刷新几次。"}),(0,h.jsx)(d.Text,{style:u._.mt.sm,size:12,type:"sub",children:"因 bilibili 对鉴权信息做了保护加密，目前同步番剧需要通过在 WebView 内部发起带鉴权的请求，获得数据后通知 APP。"}),(0,h.jsxs)(d.Text,{style:u._.mt.sm,size:12,type:"sub",children:["完成同步前需要一直保持 bilibil ",p.default.login(),"状态，完成后你可以手动登出账号。"]}),(0,h.jsxs)(d.Flex,{style:u._.mt.md,justify:"center",children:[(0,h.jsx)(j.default,{style:e.btn,btnStyle:e.btnStyle,text:"重新获取数据",size:13,onPress:N}),(0,h.jsx)(j.default,{style:[e.btn,u._.ml.lg],btnStyle:e.btnStyle,text:"收起"+p.default.login()+"框",size:13,onPress:s})]})]})]})]})}))}},"./src/screens/web-view/bilibili-sync/component/login/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:n._.wind,width:n._.window.contentWidth,backgroundColor:n._.select(n._.colorPlain,n._._colorDarkModeLevel2),borderRadius:n._.radiusMd,shadowColor:n._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:n._.select(16,0)},hide:{top:n._.sm,right:n._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},container:{minHeight:400,borderWidth:2,borderColor:n._.colorBorder,borderRadius:n._.radiusMd,overflow:"hidden"},webview:{borderRadius:n._.radiusMd,overflow:"hidden"},webviewHide:{opacity:.01},body:{paddingTop:20,paddingHorizontal:n._.md,paddingBottom:28},iconToggle:{position:"absolute",zIndex:2,top:1,right:0},btn:{width:128},btnStyle:{height:40}}}))},"./src/screens/web-view/bilibili-sync/component/login/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_GET_REVIEW=t.TYPE_GET_LIST=t.TYPE_CHECK_LOGIN=void 0,t.injectedJavaScript=function(){return"(function() {\n    setTimeout(() => {\n      /* webview的postMessage不是马上生效的 */\n      let __timeoutId = null;\n      let __isBridgeOk = false;\n\n      function waitForBridge() {\n        if (!__isBridgeOk && !window.ReactNativeWebView.postMessage) {\n          __timeoutId = setTimeout(waitForBridge, 400);\n        } else {\n          clearTimeout(__timeoutId);\n          __timeoutId = null;\n          __isBridgeOk = true;\n\n          setTimeout(() => {\n            function xhr({ method = 'get', url } = {}) {\n    return new Promise(resolve => {\n      const request = new XMLHttpRequest()\n      request.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status === 200 || this.status === 201) {\n            resolve(JSON.parse(this.responseText))\n          }\n\n          if (this.status === 404 || this.status === 500) {\n            resolve(null)\n          }\n        }\n      }\n      request.onerror = function () {\n        resolve(null)\n      }\n      request.ontimeout = function () {\n        resolve(null)\n      }\n      request.onabort = function () {\n        resolve(null)\n      }\n      request.open(method, url, true)\n      request.withCredentials = true\n      request.send(null)\n    })\n  }\n\n  function postMessage(type, data) {\n    window.ReactNativeWebView.postMessage(JSON.stringify({ type, data }))\n  }\n\n  function ts() {\n    return String(new Date()/1);\n  }\n\n  function queue(fetchs) {\n    return new Promise(resolve => {\n      function cb() {\n        if (!fetchs.length) {\n          resolve(true);\n          return;\n        }\n\n        const fetch = fetchs.shift();\n        fetch().then(() => cb(fetchs));\n      }\n      cb();\n    });\n  };\n            function checkLogin() {\n    xhr({\n      url: 'https://api.bilibili.com/x/web-interface/nav'\n    }).then(data => {\n      if (data) postMessage('"+n+"', data);\n      if (data && data.data && data.data.isLogin) {\n        getList(data.data.wallet.mid);\n      }\n    });\n  };\n            const list = [];\n    const limit = 15;\n    let page = 1;\n    function getList(mid) {\n      xhr({\n        url: 'https://api.bilibili.com/x/space/bangumi/follow/list?type=1&follow_status=0&pn='+page+'&ps='+limit+'&vmid='+String(mid)+'&ts='+ts()\n      }).then(data => {\n        if (data && data.data && data.data.list) {\n          data.data.list.forEach(item => {\n            list.push({\n              id: item.media_id,\n              title: item.title,\n              cover: item.cover,\n              status: item.follow_status,\n              progress: item.progress,\n              total: item.total_count\n            });\n          });\n\n          if (data.data.list.length >= limit) {\n            page += 1;\n            getList(mid);\n          } else {\n            postMessage('"+o+"', list);\n\n            const mediaIds = list.map(item => item.id);\n            getReviews(mediaIds);\n          }\n        }\n      });\n    };\n            function getReviews(mediaIds) {\n    const reviews = {};\n    const fetchs = [];\n    mediaIds.forEach(mediaId => {\n      fetchs.push(() => {\n        return new Promise(resolve => {\n          xhr({\n            url: 'https://api.bilibili.com/pgc/review/user?media_id='+String(mediaId)+'&ts='+ts()\n          }).then(data => {\n            if (data && data.result && data.result.review && data.result.review.short_review) {\n              const { short_review } = data.result.review;\n              reviews[mediaId] = {\n                score: short_review.score || 0,\n                content: short_review.content || ''\n              };\n            }\n            resolve(true);\n          });\n        });\n      });\n    });\n\n    queue(fetchs).then(() => {\n      postMessage('"+r+"', reviews);\n    });\n  };\n            checkLogin();\n          }, 4000);\n        }\n      }\n\n      waitForBridge();\n    }, 1000);\n  }());"};var n=t.TYPE_CHECK_LOGIN="CHECK_LOGIN",o=t.TYPE_GET_LIST="GET_LIST",r=t.TYPE_GET_REVIEW="GET_REVIEW"},"./src/screens/web-view/bilibili-sync/component/tool-bar/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"ToolBar")},"./src/screens/web-view/bilibili-sync/component/tool-bar/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/tool-bar/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=t.$;return(0,c.jsxs)(o.ToolBar,{children:[(0,c.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideNotMatched")},children:[(0,c.jsx)(o.Text,{size:11,bold:!0,children:"隐藏未匹配"}),s.state.hideNotMatched&&(0,c.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,c.jsx)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideWatched")},children:(0,c.jsxs)(o.Flex,{children:[(0,c.jsx)(o.Text,{size:11,bold:!0,children:"隐藏看过"}),s.state.hideWatched&&(0,c.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]})}),(0,c.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideSame")},children:[(0,c.jsx)(o.Text,{size:11,bold:!0,children:"隐藏相同"}),s.state.hideSame&&(0,c.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,c.jsx)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("privacy")},children:(0,c.jsx)(o.Text,{size:11,bold:!0,children:s.state.privacy?"私密":"公开"})})]})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.MEDIA_SUBJECT=t.LOADED=t.HOST_API=t.COMPONENT=void 0;t.COMPONENT="BilibiliSync",t.HOST_API="https://api.bgm.tv",t.LOADED={},t.MEDIA_SUBJECT={28220978:1424,28235244:330973,28235419:317042,28236365:326868,28236374:333158,28236378:323626,28236382:341077,28236394:344422,28236424:321825,28236579:348666,3846:35861}},"./src/screens/web-view/bilibili-sync/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),c=s("./src/utils/fetch/index.ts"),d=n(s("./src/constants/i18n/index.ts")),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$,n=t.navigation,l=s.state.hide;return(0,u.jsx)(o.Header,{title:"bilibili 同步",hm:["bilibili-sync","BilibiliSync"],headerRight:function(){return(0,u.jsxs)(o.Flex,{children:[(0,u.jsx)(r.IconTouchable,{style:i._.mr.xs,name:l?"md-refresh":"md-close",color:i._.colorDesc,onPress:s.onToggleHide}),(0,u.jsx)(r.IconTouchable,{name:"md-info-outline",color:i._.colorDesc,size:19,onPress:function(){(0,c.t)("bili同步.关于"),n.push("Information",{title:"bilibili 同步",message:["此功能涉及到第三方平台"+d.default.login()+"，作者保证不会窃取任何个人数据，若有异议请勿使用。","因自动对比的数据存在较大的出错可能，目前不打算做一键提交功能，请手动核实后自行提交。","部分(僅限港澳台地區)的番剧做了最低限度的模糊匹配，若连翻译名称都不一样的基本没可能匹配成功。","网页版不存在此功能，所以此为高级会员功能。此功能开发不易，目前暂时对所有用户开放，觉得有用可支持一下。"],advance:!0})}})]})}})}))},"./src/screens/web-view/bilibili-sync/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),l=s("./src/utils/hooks/index.ts"),c=n(s("./src/screens/web-view/bilibili-sync/component/list/index.tsx")),d=n(s("./src/screens/web-view/bilibili-sync/component/login/index.tsx")),u=n(s("./src/screens/web-view/bilibili-sync/header/index.tsx")),a=n(s("./src/screens/web-view/bilibili-sync/store/index.ts")),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.ic)(a.default,(function(e,t){var s=t.$;return(0,l.useMount)((function(){(0,r.runAfter)((function(){s.init()}))})),(0,l.useObserver)((function(){return(0,m.jsxs)(o.Component,{id:"screen-bilibili-sync",children:[(0,m.jsx)(u.default,{}),(0,m.jsxs)(o.Page,{loaded:s.state._loaded,children:[(0,m.jsx)(d.default,{hide:s.state.hide,onToggleHide:s.onToggleHide,setData:s.setData,setReviews:s.setReviews}),(0,m.jsx)(c.default,{})]})]})}))}))},"./src/screens/web-view/bilibili-sync/store/action.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/web.timers.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s("./src/utils/index.ts"),f=s("./src/utils/fetch/index.ts"),p=s("./src/utils/fetch.v0/index.ts"),j=s("./src/utils/protobuf/index.web.ts"),v=s("./src/utils/thirdParty/cn-char/index.ts"),_=s("./src/screens/web-view/bilibili-sync/ds.ts"),y=o(s("./src/screens/web-view/bilibili-sync/store/fetch.ts"));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,u.default)(this,s)}}t.default=function(e){(0,d.default)(s,e);var t=h(s);function s(){var e,o,i;(0,l.default)(this,s);for(var d=arguments.length,u=new Array(d),a=0;a<d;a++)u[a]=arguments[a];return e=t.call.apply(t,[this].concat(u)),(0,m.default)((0,c.default)(e),"onToggleHide",(function(){e.setState({hide:!e.state.hide})})),(0,m.default)((0,c.default)(e),"onPage",(function(t){var s=t.filter((function(e){return e.subjectId})).map((function(e){return e.subjectId}));e.fetchCollections(s)})),(0,m.default)((0,c.default)(e),"setData",(function(t){e.setState({data:{list:t.map((function(e){var t;return Object.assign({subjectId:_.MEDIA_SUBJECT[e.id]||(null==(t=((0,j.get)("bangumi-data")||[]).find((function(t){var s,n,o=(null==t||null==(s=t.s)?void 0:s.b)===e.id;return o||(o=(null==t||null==(n=t.s)?void 0:n.bhmt)===e.id),o||(o=e.title.includes("（僅限港澳台地區）")?(null==t?void 0:t.c)===(0,v.t2s)(e.title.replace("（僅限港澳台地區）","")):(null==t?void 0:t.c)===e.title),o})))?void 0:t.id)||""},e)})),_loaded:(0,b.getTimestamp)()}}),e.save(),(0,f.t)("bili同步.获取成功",{length:t.length,userId:e.userId})})),(0,m.default)((0,c.default)(e),"setReviews",(function(t){e.setState({reviews:t}),e.save()})),(0,m.default)((0,c.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,m.default)({current:s},t,s)}),e.save(),(0,f.t)("bili同步.置底")})),(0,m.default)((0,c.default)(e),"onSubmit",(o=(0,r.default)(n.mark((function t(s,o,r){var i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(o).length){t.next=6;break}return i=e.state.privacy,t.next=6,(0,p.request)(_.HOST_API+"/collection/"+s+"/update",Object.assign({},o,{privacy:i?1:0}));case 6:if(!Object.keys(r).length){t.next=9;break}return t.next=9,(0,p.request)(_.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:r.ep||0});case 9:return t.next=11,e.fetchCollection(s);case 11:(0,b.feedback)(),(0,f.t)("bili同步.同步");case 13:case"end":return t.stop()}}),t)}))),function(e,t,s){return o.apply(this,arguments)})),(0,m.default)((0,c.default)(e),"onToggle",(i=(0,r.default)(n.mark((function t(s){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState((0,m.default)({},s,!e.state[s])),e.save();case 2:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})),(0,m.default)((0,c.default)(e),"onRefreshCollection",(function(t){e.setState({collections:(0,m.default)({},t,Object.assign({},e.collection(t)||{},{loaded:0}))}),setTimeout((function(){e.fetchCollection(t)}),0)})),e}return(0,i.default)(s)}(y.default)},"./src/screens/web-view/bilibili-sync/store/computed.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),c=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=n(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),a=s("./node_modules/mobx/dist/mobx.esm.js"),m=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),f=n(s("./src/screens/web-view/bilibili-sync/store/state.ts"));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,c.default)(this,s)}}t.default=(o=function(e){(0,l.default)(s,e);var t=p(s);function s(){return(0,r.default)(this,s),t.apply(this,arguments)}return(0,i.default)(s,[{key:"userId",get:function(){return m.userStore.usersInfo(m.userStore.myUserId).username||m.userStore.myUserId}},{key:"data",get:function(){var e=this.state,t=e.data,s=e.bottom;return t.list.slice().sort((function(e,t){return(0,b.asc)(s[e.id]||0,s[t.id]||0)})).sort((function(e,t){return(0,b.desc)(e.subjectId?1:0,t.subjectId?1:0)}))}},{key:"review",value:function(e){var t=this;return(0,a.computed)((function(){return t.state.reviews[e]})).get()}},{key:"collection",value:function(e){var t=this;return(0,a.computed)((function(){return t.state.collections[e]})).get()}}]),s}(f.default),(0,u.default)(o.prototype,"userId",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"userId"),o.prototype),(0,u.default)(o.prototype,"data",[a.computed],Object.getOwnPropertyDescriptor(o.prototype,"data"),o.prototype),o)},"./src/screens/web-view/bilibili-sync/store/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=void 0;var n=s("./src/screens/web-view/bilibili-sync/ds.ts"),o=(t.NAMESPACE="Screen"+n.COMPONENT,t.EXCLUDE_STATE={loadedBangumiData:!1});t.STATE=Object.assign({data:{list:[],_loaded:0},reviews:{},collections:{},bottom:{current:0},hide:!1,hideWatched:!1,hideSame:!1,hideNotMatched:!1,privacy:!1},o,{_loaded:!1})},"./src/screens/web-view/bilibili-sync/store/fetch.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s("./src/utils/index.ts"),f=s("./src/utils/fetch/index.ts"),p=s("./src/utils/fetch.v0/index.ts"),j=s("./src/utils/protobuf/index.web.ts"),v=o(s("./src/constants/i18n/index.ts")),_=s("./src/screens/web-view/bilibili-sync/ds.ts"),y=o(s("./src/screens/web-view/bilibili-sync/store/computed.ts"));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,u.default)(this,s)}}t.default=function(e){(0,d.default)(s,e);var t=h(s);function s(){var e,o;(0,l.default)(this,s);for(var i=arguments.length,d=new Array(i),u=0;u<i;u++)d[u]=arguments[u];return e=t.call.apply(t,[this].concat(d)),(0,m.default)((0,c.default)(e),"fetchBangumiData",(0,r.default)(n.mark((function t(){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.loadedBangumiData){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,j.decode)("bangumi-data");case 4:e.setState({loadedBangumiData:!0});case 5:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"fetchCollection",(o=(0,r.default)(n.mark((function t(s){var o,r;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},t.next=3,(0,p.request)(_.HOST_API+"/collection/"+s);case 3:null!=(r=t.sent)&&r.status?o[s]={status:r.status.type,ep_status:r.ep_status,private:r.private,rating:r.rating,comment:r.comment,loaded:(0,b.getTimestamp)()}:o[s]={loaded:(0,b.getTimestamp)()},e.setState({collections:o}),e.save();case 7:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})),(0,m.default)((0,c.default)(e),"fetchCollections",(0,r.default)(n.mark((function t(){var s,o,i,l=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=l.length>0&&void 0!==l[0]?l[0]:[],e.userId){t.next=4;break}return(0,b.info)("此功能依赖收藏数据，请先"+v.default.login(),4),t.abrupt("return",!1);case 4:return o={},i=[],s.forEach((function(e){_.LOADED[e]||(_.LOADED[e]=!0,i.push((0,r.default)(n.mark((function t(){var s;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.request)(_.HOST_API+"/collection/"+e);case 2:return null!=(s=t.sent)&&s.status?o[e]={status:s.status.type,ep_status:s.ep_status,private:s.private,rating:s.rating,comment:s.comment,loaded:(0,b.getTimestamp)()}:o[e]={loaded:(0,b.getTimestamp)()},t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))))})),t.next=9,(0,f.queue)(i,2);case 9:e.setState({collections:o}),e.save();case 11:case"end":return t.stop()}}),t)})))),e}return(0,i.default)(s)}(y.default)},"./src/screens/web-view/bilibili-sync/store/index.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s("./src/utils/protobuf/index.web.ts"),f=o(s("./src/screens/web-view/bilibili-sync/store/action.ts")),p=s("./src/screens/web-view/bilibili-sync/store/ds.ts");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,a.default)(e);if(t){var o=(0,a.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,u.default)(this,s)}}t.default=function(e){(0,d.default)(s,e);var t=j(s);function s(){var e;(0,l.default)(this,s);for(var o=arguments.length,i=new Array(o),d=0;d<o;d++)i[d]=arguments[d];return e=t.call.apply(t,[this].concat(i)),(0,m.default)((0,c.default)(e),"init",(0,r.default)(n.mark((function t(){var s,o,r,i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(p.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return i=t.t0,e.setState(Object.assign({},i,{hide:!(null==i||null==(s=i.data)||null==(o=s.list)||!o.length),loadedBangumiData:!(null==(r=(0,b.get)("bangumi-data"))||!r.length),_loaded:!0})),t.abrupt("return",e.fetchBangumiData());case 8:case"end":return t.stop()}}),t)})))),e}return(0,i.default)(s)}(f.default)},"./src/screens/web-view/bilibili-sync/store/state.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),r=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),c=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=s("./node_modules/mobx/dist/mobx.esm.js"),m=n(s("./src/utils/store/index.ts")),b=s("./src/screens/web-view/bilibili-sync/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,c.default)(this,s)}}t.default=function(e){(0,l.default)(s,e);var t=f(s);function s(){var e;(0,r.default)(this,s);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e=t.call.apply(t,[this].concat(o)),(0,u.default)((0,i.default)(e),"state",(0,a.observable)(b.STATE)),(0,u.default)((0,i.default)(e),"save",(function(){return e.saveStorage(b.NAMESPACE,b.EXCLUDE_STATE)})),e}return(0,o.default)(s)}(m.default)},"./src/screens/web-view/bilibili-sync/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectComment=u,t.getSelectEp=c,t.getSelectScore=d,t.getSelectStatus=l,t.useSelectComment=function(e,t){var s=(0,r.useState)(u(e,t).select),n=(0,o.default)(s,2),i=n[0],l=n[1];return(0,r.useEffect)((function(){l(u(e,t).select)}),[e,t]),[i,l]},t.useSelectEp=function(e,t){var s=(0,r.useState)(c(e,t).select),n=(0,o.default)(s,2),i=n[0],l=n[1];return(0,r.useEffect)((function(){l(c(e,t).select)}),[e,t]),[i,l]},t.useSelectScore=function(e,t){var s=(0,r.useState)(d(e,t).select),n=(0,o.default)(s,2),i=n[0],l=n[1];return(0,r.useEffect)((function(){l(d(e,t).select)}),[e,t]),[i,l]},t.useSelectStatus=function(e,t){var s=(0,r.useState)(l(e,t).select),n=(0,o.default)(s,2),i=n[0],c=n[1];return(0,r.useEffect)((function(){c(l(e,t).select)}),[e,t]),[i,c]};var o=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),r=s("react"),i=s("./src/constants/index.ts");function l(e,t){var s=Number(e||0),n=Number(i.MODEL_COLLECTION_STATUS.getTitle(t)||0);return 3===n?n=2:2===n&&(n=3),{select:!(n>=3)&&s>n,value:s}}function c(e,t){var s,n=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:n>Number(t||0),value:n}}function d(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function u(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}}}]);