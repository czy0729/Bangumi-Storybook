(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6729],{"./src/screens/home/voices/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/voices/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Component")},"./src/screens/home/voices/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/voices/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Item"),t.EVENT={id:"角色.跳转"}},"./src/screens/home/voices/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/screens/_/index.ts"),n=s("./src/stores/index.ts"),d=s("./src/utils/decorators/index.ts"),c=s("./src/screens/home/voices/component/item/ds.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s=e.item,o=e.index,d=t.navigation;return(0,i.jsx)(r.ItemVoice,Object.assign({style:n._.container.item,navigation:d,event:c.EVENT,index:o},s))}),c.COMPONENT)},"./src/screens/home/voices/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/voices/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"List")},"./src/screens/home/voices/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),d=s("./src/stores/index.ts"),c=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),a=s("./src/screens/home/voices/component/list/utils.tsx"),u=s("./src/screens/home/voices/component/list/ds.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=t.$;return s.monoVoices._loaded?(0,l.jsx)(n.PaginationList2,{contentContainerStyle:d._.container.bottom,keyExtractor:c.keyExtractor,data:s.monoVoices.list,limit:5,scrollToTop:!0,renderItem:a.renderItem,scrollEventThrottle:16,onScroll:s.onScroll,onHeaderRefresh:s.onHeaderRefresh}):(0,l.jsx)(r.Loading,{})}),u.COMPONENT)},"./src/screens/home/voices/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=function(e){var t=e.item,s=e.index;return(0,n.jsx)(r.default,{item:t,index:s})};o(s("react"));var r=o(s("./src/screens/home/voices/component/item/index.tsx")),n=s("./node_modules/react/jsx-runtime.js")},"./src/screens/home/voices/component/tool-bar/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/voices/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"ToolBar")},"./src/screens/home/voices/component/tool-bar/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.find.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/voices/component/tool-bar/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.obc)((function(e,t){var s=t.$,o=s.state.position,n=s.monoVoices.filters,d=void 0===n?[]:n;return(0,c.jsxs)(r.ToolBar,{children:[d.map((function(e){var t=e.data.map((function(e){return e.title})),n=e.data.find((function(e){return e.value===o}))||{title:"全部"};return(0,c.jsx)(r.ToolBar.Popover,{data:t,text:"全部"===n.title?e.title:n.title||e.title,type:"全部"!==n.title?"desc":"sub",onSelect:function(t){return s.onFilterSelect(t,e.data)}},e.title)})),(0,c.jsx)(r.Heatmap,{id:"角色.职位选择"})]})}),d.COMPONENT)},"./src/screens/home/voices/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=t.COMPONENT=void 0;var o=s("./src/stores/index.ts"),r=t.COMPONENT="Voices",n=(t.NAMESPACE="Screen"+r,t.EXCLUDE_STATE={visibleBottom:o._.window.height,position:"",ota:{}});t.STATE=Object.assign({},n,{_loaded:!1})},"./src/screens/home/voices/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/voices/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Header")},"./src/screens/home/voices/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),c=s("./src/utils/fetch/index.ts"),i=s("./src/screens/home/voices/header/ds.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s,o=t.$;return(0,a.jsx)(r.Header,{title:null!=(s=o.params)&&s.name?o.params.name+"的角色":"角色",alias:"角色",hm:[o.url,"Voices"],headerRight:function(){return(0,a.jsx)(r.Header.Popover,{data:["浏览器查看"],onSelect:function(e){"浏览器查看"===e&&((0,c.t)("角色.右上角菜单",{key:e}),(0,n.open)(o.url))},children:(0,a.jsx)(r.Heatmap,{id:"角色.右上角菜单"})})}})}),i.COMPONENT)},"./src/screens/home/voices/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),d=s("./src/utils/hooks/index.ts"),c=o(s("./src/screens/home/voices/component/list/index.tsx")),i=o(s("./src/screens/home/voices/component/tool-bar/index.tsx")),a=o(s("./src/screens/home/voices/header/index.tsx")),u=o(s("./src/screens/home/voices/store.ts")),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.ic)(u.default,(function(e,t){var s=t.$;return(0,d.useRunAfter)((function(){s.init()})),(0,d.useObserver)((function(){return(0,l.jsxs)(r.Component,{id:"screen-voices",children:[(0,l.jsx)(a.default,{}),(0,l.jsxs)(r.Page,{children:[(0,l.jsx)(i.default,{}),(0,l.jsx)(c.default,{})]})]})}))}))},"./src/screens/home/voices/store.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.function.bind.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,d=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),a=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=r(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=s("./node_modules/mobx/dist/mobx.esm.js"),v=s("./src/stores/index.ts"),h=s("./src/utils/index.ts"),b=s("./src/utils/fetch/index.ts"),y=s("./src/utils/kv/index.ts"),_=r(s("./src/utils/store/index.ts")),x=s("./src/constants/index.ts"),O=s("./src/screens/home/voices/ds.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}var T=[];t.default=(n=function(e){(0,u.default)(s,e);var t=P(s);function s(){var e,r;(0,c.default)(this,s);for(var n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return e=t.call.apply(t,[this].concat(i)),(0,p.default)((0,a.default)(e),"params",void 0),(0,p.default)((0,a.default)(e),"state",(0,j.observable)(O.STATE)),(0,p.default)((0,a.default)(e),"init",(0,d.default)(o.mark((function t(){var s;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(O.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:return s=t.t0,e.setState(Object.assign({},s,O.EXCLUDE_STATE,{_loaded:!0})),t.abrupt("return",e.fetchMonoVoices());case 8:case"end":return t.stop()}}),t)})))),(0,p.default)((0,a.default)(e),"onHeaderRefresh",(function(){return e.fetchMonoVoices()})),(0,p.default)((0,a.default)(e),"save",(function(){return e.saveStorage(O.NAMESPACE,O.EXCLUDE_STATE)})),(0,p.default)((0,a.default)(e),"fetchMonoVoices",(0,d.default)(o.mark((function t(){var s,r,n,d;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.fetchThirdParty(),s=e.state.position,t.next=4,v.subjectStore.fetchMonoVoices({monoId:e.monoId,position:s});case 4:return(r=t.sent).list.length&&e.thirdPartyKey in e.state.ota&&(d=(null==(n=e.ota)?void 0:n.ts)||0,(0,h.getTimestamp)()-d>=604800&&e.updateThirdParty()),t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))),(0,p.default)((0,a.default)(e),"fetchThirdParty",(0,d.default)(o.mark((function t(){var s;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ota||e.monoVoices._loaded){t.next=8;break}return t.next=3,(0,y.get)(e.thirdPartyKey);case 3:if(s=t.sent){t.next=7;break}return e.setState({ota:(0,p.default)({},e.thirdPartyKey,{list:[],_loaded:0})}),t.abrupt("return");case 7:e.setState({ota:(0,p.default)({},e.thirdPartyKey,Object.assign({},s,{_loaded:(0,h.getTimestamp)()}))});case 8:case"end":return t.stop()}}),t)})))),(0,p.default)((0,a.default)(e),"updateThirdParty",(0,d.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!T.includes(e.thirdPartyKey)){t.next=2;break}return t.abrupt("return");case 2:setTimeout((function(){(0,y.update)(e.thirdPartyKey,{list:e.monoVoices.list.slice(0,24)}),T.push(e.thirdPartyKey)}),0);case 3:case"end":return t.stop()}}),t)})))),(0,p.default)((0,a.default)(e),"onFilterSelect",(r=(0,d.default)(o.mark((function t(s,r){var n,d,c;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(0,b.t)("角色.职位选择",{label:s.split(" ")[0]}),n=r.find((function(e){return e.title===s}))||{},d=n.value,c=void 0===d?"":d,e.setState({position:c}),e.fetchMonoVoices(),e.save();case 5:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})),(0,p.default)((0,a.default)(e),"onScroll",h.updateVisibleBottom.bind((0,a.default)(e))),e}return(0,i.default)(s,[{key:"monoId",get:function(){return this.params.monoId}},{key:"ota",get:function(){return this.state.ota[this.thirdPartyKey]}},{key:"thirdPartyKey",get:function(){var e=this.state.position;return("voices_"+[this.monoId,e].join("_")).replace("/","_")}},{key:"monoVoices",get:function(){var e=v.subjectStore.monoVoices(this.monoId);return e._loaded?e:this.ota?Object.assign({},this.ota,{pagination:{page:1,pageTotal:10}}):x.LIST_EMPTY}},{key:"url",get:function(){var e=this.state.position;return(0,x.HTML_MONO_VOICES)(this.monoId,e)}}]),s}(_.default),(0,f.default)(n.prototype,"monoId",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"monoId"),n.prototype),(0,f.default)(n.prototype,"ota",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"ota"),n.prototype),(0,f.default)(n.prototype,"thirdPartyKey",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"thirdPartyKey"),n.prototype),(0,f.default)(n.prototype,"monoVoices",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"monoVoices"),n.prototype),(0,f.default)(n.prototype,"url",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"url"),n.prototype),n)}}]);