(self.webpackChunkweb=self.webpackChunkweb||[]).push([[4580],{"./src/screens/home/subject/component/rating/chart/chart.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.reverse.js"),s("./node_modules/core-js/modules/es.number.to-fixed.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var r=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),o=s("./src/components/index.ts"),i=s("./src/stores/index.ts"),c=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/subject/component/rating/chart/utils.ts"),l=s("./src/screens/home/subject/component/rating/chart/ds.ts"),u=s("./node_modules/react/jsx-runtime.js"),m=(0,a.memo)((function(e){var t=e.navigation,s=e.styles,n=e.friend,a=e.rating,m=e.total,p=e.count,b=e.score,j=e.toRating,h=(0,d.getDeviation)(m,p,b),g=Object.keys(p).length?p:l.DEFAULT_RATES;return(0,u.jsxs)(u.Fragment,{children:[!!m&&(0,u.jsxs)(o.Text,{style:s.total,size:12,type:"sub",children:[m," votes"]}),(0,u.jsx)(o.Flex,{style:s.chart,children:Object.keys(g).reverse().map((function(e,t){var n=(0,d.getHeight)(m,g[e]),l=a==e;return(0,u.jsxs)(o.Flex.Item,{style:t>0&&i._.ml.xs,children:[(0,u.jsxs)(o.Flex,{style:s.item,justify:"center",align:"end",children:[(0,u.jsx)(r.default,{style:(0,c.stl)(s.itemFill,l&&s.itemFillActive,{height:n})}),(0,u.jsxs)(o.Text,{style:[s.count,{bottom:n}],size:10,type:l?"warning":"sub",align:"center",bold:!0,children:[g[e]," "]})]}),(0,u.jsx)(o.Text,{style:i._.mt.sm,size:12,type:l?"warning":"title",align:"center",children:e})]},e)}))}),(0,u.jsxs)(o.Flex,{style:i._.mt.md,children:[(0,u.jsx)(o.Flex.Item,{children:(0,u.jsxs)(o.Touchable,{style:s.friend,onPress:function(){return j(t,"评分分布")},children:[(0,u.jsxs)(o.Flex,{children:[n.score?(0,u.jsxs)(o.Text,{size:12,type:"sub",children:["好友",(0,u.jsxs)(o.Text,{size:12,type:"main",children:[" ",n.score," "]}),(0,u.jsxs)(o.Text,{size:12,lineHeight:12,type:"sub",children:["(",n.total,")"]})]}):(0,u.jsx)(o.Text,{size:12,lineHeight:12,type:"sub",children:"用户评分"}),(0,u.jsx)(o.Iconfont,{name:"md-navigate-next"})]}),(0,u.jsx)(o.Heatmap,{id:"条目.跳转",from:"评分分布"})]})}),(0,u.jsx)(o.Touchable,{style:s.deviation,onPress:function(){t.push("Information",{title:"标准差",message:["0-1 异口同声","1.15 基本一致","1.3 略有分歧","1.45 莫衷一是","1.6 各执一词","1.75 你死我活"]})},children:(0,u.jsxs)(o.Flex,{children:[(0,u.jsx)(o.Text,{size:12,type:"sub",children:"标准差"}),(0,u.jsxs)(o.Text,{size:12,type:"main",children:[" ",(0,c.toFixed)(h,2)," "]}),(0,u.jsxs)(o.Text,{size:12,lineHeight:12,type:"sub",children:[(0,d.getDispute)(h)," "]}),(0,u.jsx)(o.Iconfont,{style:i._.ml.xs,name:"md-info-outline",size:16})]})})]})]})}),l.DEFAULT_PROPS,l.COMPONENT_MAIN);t.default=m;try{chart.displayName="chart",chart.__docgenInfo={description:"",displayName:"chart",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:'{ total: { position: "absolute"; zIndex: number; top: number; right: number; }; chart: { minHeight: number; marginTop: number; marginHorizontal: number; }; item: { height: number; paddingBottom: number; marginTop: number; }; ... 4 more ...; deviation: { ...; }; }'}},friend:{defaultValue:null,description:"",name:"friend",required:!0,type:{name:"DeepPartial<{ score: string; total: string; }>"}},rating:{defaultValue:null,description:"",name:"rating",required:!0,type:{name:"number"}},total:{defaultValue:null,description:"",name:"total",required:!0,type:{name:"string | number"}},count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"{ 1: number; 2: number; 3: number; 4: number; 5: number; 6: number; 7: number; 8: number; 9: number; 10: number; } | DeepPartial<Record<2 | 1 | 6 | 4 | 10 | 8 | 3 | 5 | 7 | 9, number>>"}},score:{defaultValue:null,description:"",name:"score",required:!0,type:{name:"string | number"}},toRating:{defaultValue:null,description:"",name:"toRating",required:!0,type:{name:'(navigation: Navigation, from?: string, status?: "" | "dropped" | "on_hold" | "wishes" | "collections" | "doings") => void'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/subject/component/rating/chart/chart.tsx#chart"]={docgenInfo:chart.__docgenInfo,name:"chart",path:"src/screens/home/subject/component/rating/chart/chart.tsx#chart"})}catch(e){}},"./src/screens/home/subject/component/rating/chart/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_RATES=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/subject/component/rating/ds.ts"),o=t.COMPONENT=(0,n.rc)(r.COMPONENT,"Chart");t.COMPONENT_MAIN=(0,n.rc)(o),t.DEFAULT_PROPS={navigation:{},styles:{},friend:{},rating:0,total:0,count:{},score:0,toRating:function(){}},t.DEFAULT_RATES={1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0}},"./src/screens/home/subject/component/rating/chart/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var r=s("./src/utils/decorators/index.ts"),o=n(s("./src/screens/home/subject/component/rating/chart/chart.tsx")),i=s("./src/screens/home/subject/component/rating/chart/ds.ts"),c=s("./src/screens/home/subject/component/rating/chart/styles.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$,n=t.navigation,r=s.rating,i=r.total,d=r.count,l=r.score;return(0,a.jsx)(o.default,{navigation:n,styles:(0,c.memoStyles)(),friend:s.subjectFormHTML.friend,rating:s.collection.rating,total:i,count:d,score:l,toRating:s.toRating})}),i.COMPONENT);try{chart.displayName="chart",chart.__docgenInfo={description:"",displayName:"chart",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/subject/component/rating/chart/index.tsx#chart"]={docgenInfo:chart.__docgenInfo,name:"chart",path:"src/screens/home/subject/component/rating/chart/index.tsx#chart"})}catch(e){}},"./src/screens/home/subject/component/rating/chart/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{total:{position:"absolute",zIndex:1,top:10,right:0},chart:{minHeight:144,marginTop:n._.md,marginHorizontal:-4},item:{height:144,paddingBottom:n._.xs,marginTop:-n._.md},itemFill:{position:"absolute",left:"50%",width:n._.device(6,8),marginLeft:n._.device(-3,-4),backgroundColor:n._.select(n._.colorWait,n._._colorSub),borderRadius:n._.device(6,4)},itemFillActive:{backgroundColor:n._.colorWarning},count:{position:"absolute",zIndex:1,right:0,left:0,marginBottom:4},friend:{paddingLeft:n._.xs,marginLeft:-n._.xs,borderRadius:n._.radiusSm,overflow:"hidden"},deviation:{paddingLeft:n._.xs,marginRight:-n._.xs,borderRadius:n._.radiusSm,overflow:"hidden"}}}))},"./src/screens/home/subject/component/rating/chart/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.array.reverse.js"),s("./node_modules/core-js/modules/es.object.values.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviation=function(e,t,s){return 0==e?0:function(e,t,s){var n=0;return e.forEach((function(e,s){0!==e&&(n+=(10-s-Number(t))*(10-s-Number(t))*e)})),Math.sqrt(n/Number(s))}(Object.values(t).reverse(),s,e)},t.getDispute=function(e){return 0===e?"-":e<1?"异口同声":e<1.15?"基本一致":e<1.3?"略有分歧":e<1.45?"莫衷一是":e<1.6?"各执一词":e<1.75?"你死我活":"厨黑大战"},t.getHeight=function(e,t){if(!e||!t)return 0;var s=t/Number(e);s>0&&s<n&&(s=n);return 100*Math.min(1.44*s||n,.9)+"%"};var n=.04},"./src/screens/home/subject/component/rating/rating.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=h(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,s&&s.set(e,n),n}(s("react")),i=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),c=s("./src/components/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/subject/ds.ts"),l=n(s("./src/screens/home/subject/component/icon/hidden.tsx")),u=n(s("./src/screens/home/subject/component/rating/chart/index.tsx")),m=n(s("./src/screens/home/subject/component/rating/title/index.tsx")),p=n(s("./src/screens/home/subject/component/rating/vib/index.tsx")),b=s("./src/screens/home/subject/component/rating/ds.ts"),j=s("./node_modules/react/jsx-runtime.js");function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(h=function(e){return e?s:t})(e)}var g=(0,a.memo)((function(e){var t=e.styles,s=e.hideScore,n=e.showRating,a=(0,o.useState)(!s),b=(0,r.default)(a,2),h=b[0],g=b[1];return(0,j.jsxs)(i.default,{style:n?t.container:t.hide,children:[(0,j.jsxs)(c.Flex,{children:[(0,j.jsx)(c.Flex.Item,{children:(0,j.jsx)(m.default,{showScore:h})}),!n&&(0,j.jsx)(l.default,{name:d.TITLE_RATING,value:"showRating"})]}),n&&(0,j.jsx)(i.default,{style:t.rate,children:h?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(u.default,{}),(0,j.jsx)(p.default,{})]}):(0,j.jsx)(c.Touchable,{onPress:function(){return g(!0)},children:(0,j.jsx)(c.Flex,{style:t.hideScore,justify:"center",children:(0,j.jsx)(c.Text,{children:"评分已隐藏, 点击显示"})})})})]})}),b.DEFAULT_PROPS,b.COMPONENT_MAIN);t.default=g;try{rating.displayName="rating",rating.__docgenInfo={description:"",displayName:"rating",props:{styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:"{ container: { minHeight: number; paddingHorizontal: number; marginTop: number; }; rate: { marginTop: number; }; hide: { paddingHorizontal: number; marginTop: number; marginBottom: number; }; hideScore: { ...; }; }"}},hideScore:{defaultValue:null,description:"",name:"hideScore",required:!0,type:{name:"boolean"}},showRating:{defaultValue:null,description:"",name:"showRating",required:!0,type:{name:"LayoutValue"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/subject/component/rating/rating.tsx#rating"]={docgenInfo:rating.__docgenInfo,name:"rating",path:"src/screens/home/subject/component/rating/rating.tsx#rating"})}catch(e){}},"./src/screens/home/subject/component/rating/title/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/subject/component/rating/ds.ts");t.COMPONENT=(0,n.rc)(r.COMPONENT,"Title")},"./src/screens/home/subject/component/rating/title/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var r=s("./src/components/index.ts"),o=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),a=s("./src/screens/home/subject/ds.ts"),d=s("./src/screens/home/subject/component/rating/title/ds.ts"),l=s("./src/screens/home/subject/component/rating/title/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s,n,c=e.showScore,d=t.$,m=(t.navigation,i.systemStore.setting.showRating);return(0,u.jsxs)(o.SectionTitle,{left:m&&(0,u.jsx)(o.Rank,{style:l.styles.rank,value:d.subject.rank||(null==(s=d.subjectFromOSS)||null==(n=s.rating)?void 0:n.rank)||"-",size:13}),icon:!m&&"md-navigate-next",onPress:function(){return d.onSwitchBlock("showRating")},children:[a.TITLE_RATING," ",c&&(0,u.jsx)(r.Text,{type:"warning",size:18,lineHeight:18,bold:!0,children:d.rating.score})]})}),d.COMPONENT)},"./src/screens/home/subject/component/rating/title/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({netabare:{borderRadius:n._.radiusSm,overflow:"hidden"},rate:{paddingLeft:n._.sm,marginRight:-n._.xs,borderRadius:n._.radiusSm,overflow:"hidden"},rank:{minWidth:n._.r(44),marginLeft:n._.xs}})},"./src/screens/home/subject/component/rating/vib/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/subject/component/rating/ds.ts");t.COMPONENT=(0,n.rc)(r.COMPONENT,"VIB")},"./src/screens/home/subject/component/rating/vib/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.number.to-fixed.js"),s("./node_modules/core-js/modules/es.number.constructor.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var r=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),o=s("./src/components/index.ts"),i=s("./src/screens/_/index.ts"),c=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),l=s("./src/screens/home/subject/component/rating/vib/ds.ts"),u=s("./src/screens/home/subject/component/rating/vib/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var s=t.$,n=t.navigation,a=(0,u.memoStyles)(),l=["VIB"];return s.vib.anidb&&l.push("AniDB"),s.vib.mal&&l.push("MAL"),"动画"===s.type&&l.push("netaba.re"),(0,m.jsx)(r.default,{style:a.vib,children:(0,m.jsx)(i.Popover,{data:l,onSelect:function(e){return"VIB"===e?((0,d.t)("条目.跳转",{to:"Stats",from:"评分分布",subjectId:s.subjectId}),void n.push("WebBrowser",{title:(0,c.cnjp)(s.cn,s.jp)+"的透视",url:"https://bgm.tv/subject/"+s.subjectId+"/stats"})):"netaba.re"===e?((0,d.t)("条目.跳转",{to:"Netabare",from:"评分分布",subjectId:s.subjectId}),void n.push("WebBrowser",{title:(0,c.cnjp)(s.cn,s.jp)+"的趋势",url:"https://netaba.re/subject/"+s.subjectId})):void("AniDB"!==e?"MAL"!==e||(0,c.open)("https://myanimelist.net/anime.php?q="+(s.jp||s.cn)):(0,c.open)("https://anidb.net/anime/?adb.search="+(s.jp||s.cn).replace(/～|、|・/g," ")+"&do.search=1"))},children:(0,m.jsxs)(o.Flex,{style:a.container,direction:"column",align:"end",children:[s.vib.avg?(0,m.jsxs)(o.Text,{type:"sub",size:10,lineHeight:11,children:["VIB: ",Number(s.vib.avg).toFixed(1)," (",s.vib.total,")"]}):(0,m.jsx)(o.Text,{type:"sub",size:10,lineHeight:11,children:"VIB: N/A"}),!!s.vib.anidb&&(0,m.jsxs)(o.Text,{type:"sub",size:10,lineHeight:11,children:["AniDB: ",Number(s.vib.anidb).toFixed(1)," (",s.vib.anidbTotal,")"]}),!!s.vib.mal&&(0,m.jsxs)(o.Text,{type:"sub",size:10,lineHeight:11,children:["MAL: ",Number(s.vib.mal).toFixed(1)," (",s.vib.malTotal,")"]})]})})})}),l.COMPONENT);try{vib.displayName="vib",vib.__docgenInfo={description:"",displayName:"vib",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/subject/component/rating/vib/index.tsx#vib"]={docgenInfo:vib.__docgenInfo,name:"vib",path:"src/screens/home/subject/component/rating/vib/index.tsx#vib"})}catch(e){}},"./src/screens/home/subject/component/rating/vib/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{vib:{position:"absolute",zIndex:1,top:34,right:-4},container:{paddingTop:4,paddingHorizontal:8,paddingBottom:6,backgroundColor:n._.select(n._.colorBg,n._.colorDarkModeLevel1),borderRadius:n._.radiusXs,overflow:"hidden"}}}))}}]);