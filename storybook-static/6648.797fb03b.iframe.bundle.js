(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6648],{"./src/screens/user/backup/component/btn/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Btn")},"./src/screens/user/backup/component/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/btn/ds.ts"),c=s("./src/screens/user/backup/component/btn/styles.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.btnStyle,d=void 0===n?void 0:n,u=e.text,l=void 0===u?"同步":u,i=e.type,p=void 0===i?void 0:i,m=e.size,f=void 0===m?11:m,b=e.disabled,_=void 0===b?void 0:b,j=e.loading,y=void 0===j?void 0:j,x=e.onPress,S=void 0===x?void 0:x,v=(0,c.memoStyles)(),g="success"===p&&!_;return(0,a.jsx)(o.Touchable,{style:(0,r.stl)(v.touch,s),onPress:_||y?void 0:S,children:(0,a.jsx)(o.Flex,{style:(0,r.stl)(v.btn,g&&v.btnSuccess,d),justify:"center",children:y?(0,a.jsx)(o.Loading.Mini,{}):(0,a.jsx)(o.Text,{bold:!0,size:f,type:g?"__plain__":void 0,children:l})})})}),u.COMPONENT);try{btn.displayName="btn",btn.__docgenInfo={description:"",displayName:"btn",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},btnStyle:{defaultValue:null,description:"",name:"btnStyle",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"number"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"any"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/btn/index.tsx#btn"]={docgenInfo:btn.__docgenInfo,name:"btn",path:"src/screens/user/backup/component/btn/index.tsx#btn"})}catch(e){}},"./src/screens/user/backup/component/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{touch:{width:56,borderRadius:n._.r(28),overflow:"hidden"},btn:{height:n._.r(28),backgroundColor:n._.select(n._.colorBg,n._._colorDarkModeLevel1),borderRadius:n._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/user/backup/component/cloud/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=t.COLOR_SUCCESS=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Cloud"),t.COLOR_SUCCESS="rgb(1, 173, 145)"},"./src/screens/user/backup/component/cloud/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.keys.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),u=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),a=s("./src/screens/user/backup/component/cloud/ds.ts"),l=s("./src/screens/user/backup/component/cloud/styles.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$,n=s.state,c=n.includeUrl,p=n.includeImage,m=n.upload,f=Object.keys(m).length;return(0,i.jsxs)(o.default,{style:l.styles.cloud,children:[(0,i.jsxs)(d.ItemSettingBlock,{style:l.styles.container,size:20,children:[(0,i.jsx)(d.ItemSettingBlock.Item,{title:"导出 CSV",information:"已获取 "+s.data.length+" 个收藏",onPress:s.onExport}),(0,i.jsx)(d.ItemSettingBlock.Item,{style:u._.ml.md,title:"导入 CSV",information:f?"已导入 "+f+" 个收藏":"导入后进行同步操作",onPress:s.onToggleUpload})]}),(0,i.jsxs)(r.Flex,{style:u._.mt.sm,children:[(0,i.jsx)(r.Text,{size:12,bold:!0,children:"导出 CSV 列包含："}),(0,i.jsx)(r.Touchable,{style:u._.ml.sm,onPress:function(){return s.onSetting("includeUrl")},children:(0,i.jsxs)(r.Flex,{children:[(0,i.jsx)(r.Iconfont,{name:c?"md-check-circle":"md-radio-button-off",size:16,color:c?a.COLOR_SUCCESS:void 0}),(0,i.jsx)(r.Text,{style:u._.ml.xs,size:12,bold:!0,type:c?"desc":"sub",children:"条目地址"})]})}),(0,i.jsx)(r.Touchable,{style:u._.ml.md,onPress:function(){return s.onSetting("includeImage")},children:(0,i.jsxs)(r.Flex,{children:[(0,i.jsx)(r.Iconfont,{name:p?"md-check-circle":"md-radio-button-off",size:16,color:p?a.COLOR_SUCCESS:void 0}),(0,i.jsx)(r.Text,{style:u._.ml.xs,size:12,bold:!0,type:p?"desc":"sub",children:"封面地址"})]})})]})]})}),a.COMPONENT);try{cloud.displayName="cloud",cloud.__docgenInfo={description:"",displayName:"cloud",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/cloud/index.tsx#cloud"]={docgenInfo:cloud.__docgenInfo,name:"cloud",path:"src/screens/user/backup/component/cloud/index.tsx#cloud"})}catch(e){}},"./src/screens/user/backup/component/cloud/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({cloud:{paddingHorizontal:n._.wind,marginBottom:n._.md},container:{paddingHorizontal:0}})},"./src/screens/user/backup/component/column-bgm/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"ColumnBgm")},"./src/screens/user/backup/component/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),d=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/column-bgm/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.select,s=e.text,n=e.next;return(0,c.jsxs)(o.Text,{style:r._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,c.jsxs)(o.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",n]})]})}),u.COMPONENT);try{columnbgm.displayName="columnbgm",columnbgm.__docgenInfo={description:"",displayName:"columnbgm",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"any"}},next:{defaultValue:null,description:"",name:"next",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/column-bgm/index.tsx#columnbgm"]={docgenInfo:columnbgm.__docgenInfo,name:"columnbgm",path:"src/screens/user/backup/component/column-bgm/index.tsx#columnbgm"})}catch(e){}},"./src/screens/user/backup/component/column-select/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.COMPONENT=t.COLOR_SUCCESS=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"ColumnSelect"),t.COLOR_SUCCESS="rgb(1, 173, 145)",t.HIT_SLOP={top:4,right:32,bottom:4,left:16}},"./src/screens/user/backup/component/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),d=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/column-select/ds.ts"),c=s("./src/screens/user/backup/component/column-select/styles.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.select,s=e.disabled,n=e.onPress;return s?(0,a.jsx)(o.default,{style:c.styles.columnSelect}):(0,a.jsx)(r.Touchable,{style:c.styles.columnSelect,hitSlop:u.HIT_SLOP,onPress:function(){return n(!t)},children:(0,a.jsx)(r.Flex,{style:c.styles.radio,justify:"center",children:(0,a.jsx)(r.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?u.COLOR_SUCCESS:void 0,size:16})})})}),u.COMPONENT);try{columnselect.displayName="columnselect",columnselect.__docgenInfo={description:"",displayName:"columnselect",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/column-select/index.tsx#columnselect"]={docgenInfo:columnselect.__docgenInfo,name:"columnselect",path:"src/screens/user/backup/component/column-select/index.tsx#columnselect"})}catch(e){}},"./src/screens/user/backup/component/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/user/backup/component/column/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Column")},"./src/screens/user/backup/component/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),d=s("./src/screens/user/backup/component/column/ds.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.show,r=void 0===n||n,d=e.type,c=void 0===d?void 0:d,a=e.text,l=void 0===a?void 0:a,i=e.right,p=void 0===i?void 0:i,m=e.onPress,f=void 0===m?void 0:m;return r?(0,u.jsxs)(o.Flex,{style:s,children:[(0,u.jsx)(o.Text,{size:11,type:l&&"/"!==l?c:"sub",onPress:f,children:l||"__"}),p]}):null}),d.COMPONENT);try{column.displayName="column",column.__docgenInfo={description:"",displayName:"column",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"any"}},right:{defaultValue:null,description:"",name:"right",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/column/index.tsx#column"]={docgenInfo:column.__docgenInfo,name:"column",path:"src/screens/user/backup/component/column/index.tsx#column"})}catch(e){}},"./src/screens/user/backup/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Component")},"./src/screens/user/backup/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Item"),t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},upload:{},onBottom:function(){},onSubmit:function(){}}},"./src/screens/user/backup/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/utils/decorators/index.ts"),r=n(s("./src/screens/user/backup/component/item/item.tsx")),d=s("./src/screens/user/backup/component/item/ds.ts"),u=s("./src/screens/user/backup/component/item/styles.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s,n=e.item,o=t.$,d=t.navigation;return(0,c.jsx)(r.default,{navigation:d,styles:(0,u.memoStyles)(),item:n,upload:o.upload(null==(s=n.subject)?void 0:s.id),onBottom:o.onBottom,onSubmit:o.onSubmit})}),d.COMPONENT)},"./src/screens/user/backup/component/item/item.tsx":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=g(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var d=o?Object.getOwnPropertyDescriptor(e,r):null;d&&(d.get||d.set)?Object.defineProperty(n,r,d):n[r]=e[r]}return n.default=e,s&&s.set(e,n),n}(s("./node_modules/react/index.js")),c=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),a=s("./src/components/index.ts"),l=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),p=s("./src/utils/index.ts"),m=s("./src/utils/decorators/index.ts"),f=s("./src/constants/index.ts"),b=s("./src/screens/user/backup/utils.ts"),_=o(s("./src/screens/user/backup/component/btn/index.tsx")),j=o(s("./src/screens/user/backup/component/column/index.tsx")),y=o(s("./src/screens/user/backup/component/column-bgm/index.tsx")),x=o(s("./src/screens/user/backup/component/column-select/index.tsx")),S=s("./src/screens/user/backup/component/item/ds.ts"),v=s("./node_modules/react/jsx-runtime.js");function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(g=function(e){return e?s:t})(e)}t.default=(0,m.memo)((function(e){var t,s,o,m,S,g,h=e.navigation,O=e.styles,C=e.item,T=e.upload,E=e.onBottom,k=e.onSubmit,P=!!T,N=f.MODEL_SUBJECT_TYPE.getTitle(null==(t=C.subject)?void 0:t.type),M=["动画","书籍","三次元"].includes(N),I=(0,u.useState)(!1),A=(0,d.default)(I,2),w=A[0],R=A[1],L=(0,b.useSelectStatus)(C.type,null==T?void 0:T.type),D=(0,d.default)(L,2),V=D[0],B=D[1],H=(0,b.useSelectEp)("",null==T?void 0:T.ep_status),q=(0,d.default)(H,2),U=q[0],Y=q[1],K=(0,b.useSelectScore)(C.rate,null==T?void 0:T.rate),z=(0,d.default)(K,2),F=z[0],J=z[1],G=(0,b.useSelectTags)(C.tags.join(" "),null!=T&&T.tags?T.tags.join(" "):""),W=(0,d.default)(G,2),$=W[0],X=W[1],Z=(0,b.useSelectComment)(C.comment,null==T?void 0:T.comment),Q=(0,d.default)(Z,2),ee=Q[0],te=Q[1],se=C.type?(0,b.actionStatus)(C.type,N):"未收藏",ne={status:se,ep:(C.ep_status||0)+" / "+((null==(s=C.subject)?void 0:s.eps)||"??"),score:C.rate||"",tags:C.tags.join(" ")||"",comment:C.comment||""},oe=(0,b.actionStatus)(null==T?void 0:T.type,N),re={status:oe,ep:((null==T?void 0:T.ep_status)||0)+" / "+((null==T||null==(o=T.subject)?void 0:o.eps)||"??"),score:(null==T?void 0:T.rate)||"",tags:null!=T&&T.tags?T.tags.join(" "):"",comment:(null==T?void 0:T.comment)||""},de={status:(0,b.getSelectStatus)(se,oe).value,ep:(0,b.getSelectEp)(C.ep_status,null==T?void 0:T.ep_status).value,score:(0,b.getSelectScore)(C.rate,null==T?void 0:T.rate).value,tags:(0,b.getSelectTags)(C.tags.join(" "),null!=T&&T.tags?T.tags.join(" "):"").value,comment:(0,b.getSelectComment)(C.comment,null==T?void 0:T.comment).value},ue=function(){var e;h.push("Subject",{subjectId:null==(e=C.subject)?void 0:e.id})};return(0,v.jsxs)(a.Flex,{style:O.item,align:"start",children:[(0,v.jsx)(l.Cover,{src:null==(m=C.subject)?void 0:m.image,width:P?f.IMG_WIDTH_SM:f.IMG_WIDTH,height:P?f.IMG_HEIGHT_SM:f.IMG_HEIGHT,radius:!0,type:N,onPress:ue}),(0,v.jsx)(a.Flex.Item,{children:(0,v.jsxs)(a.Flex,{style:O.body,direction:"column",align:"start",children:[(0,v.jsx)(a.Text,{bold:!0,numberOfLines:2,onPress:ue,children:(0,p.cnjp)(null==(S=C.subject)?void 0:S.cn,null==(g=C.subject)?void 0:g.jp)}),(0,v.jsxs)(a.Flex,{style:i._.mt.md,align:"start",children:[(0,v.jsxs)(c.default,{children:[(0,v.jsx)(j.default,{text:" ",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,text:"状态",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,show:M&&(P||!P&&!!ne.ep),text:"进度",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.score,text:"评分",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.tags,text:"标签",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.comment,text:"点评",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,text:"更新",type:"sub"})]}),(0,v.jsxs)(a.Flex.Item,{style:i._.ml.md,children:[(0,v.jsx)(j.default,{text:"导出",type:"sub"}),(0,v.jsx)(j.default,{style:i._.mt.md,text:ne.status}),(0,v.jsx)(j.default,{style:i._.mt.md,show:M&&(P||!P&&!!ne.ep),text:ne.ep}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.score,text:ne.score}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.tags,text:ne.tags}),(0,v.jsx)(j.default,{style:i._.mt.md,show:P||!P&&!!ne.comment,text:ne.comment}),(0,v.jsx)(j.default,{style:i._.mt.md,text:C.updated_at.replace("T"," ").replace("Z","")})]}),P&&(0,v.jsxs)(a.Flex.Item,{style:i._.ml.md,children:[(0,v.jsx)(j.default,{text:"导入",type:"sub"}),(0,v.jsx)(y.default,{select:V,text:re.status,next:de.status}),(0,v.jsx)(y.default,{select:U,text:re.ep,next:de.ep+"话"}),(0,v.jsx)(y.default,{select:F,text:re.score,next:de.score}),(0,v.jsx)(y.default,{select:$,text:re.tags,next:de.tags}),(0,v.jsx)(y.default,{select:ee,text:re.comment,next:de.comment})]}),P&&(0,v.jsxs)(c.default,{style:O.selectors,children:[(0,v.jsx)(j.default,{text:" ",type:"sub"}),(0,v.jsx)(x.default,{select:V,disabled:!de.status,onPress:B}),(0,v.jsx)(x.default,{select:U,disabled:!de.ep,onPress:Y}),(0,v.jsx)(x.default,{select:F,disabled:!de.score,onPress:J}),(0,v.jsx)(x.default,{select:$,disabled:!de.tags,onPress:X}),(0,v.jsx)(x.default,{select:ee,disabled:!de.comment,onPress:te})]})]}),P&&(0,v.jsx)(c.default,{style:O.toolbar,children:(0,v.jsxs)(a.Flex,{style:i._.mt.md,justify:"end",children:[(0,v.jsx)(_.default,{text:"置底",onPress:function(){var e;E(null==(e=C.subject)?void 0:e.id)}}),(0,v.jsx)(_.default,{style:i._.ml.md,type:"success",disabled:!(V||U||F||ee),loading:w,onPress:(0,r.default)(n.mark((function e(){var t,s,o,r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={},o={},V?"想看"===de.status?(s.status=!0,o.status="wish"):"看过"===de.status?(s.status=!0,o.status="collect"):"在看"===de.status&&(s.status=!0,o.status="do"):re.status&&(s.status=!0,o.status=f.MODEL_COLLECTION_STATUS.getValue(re.status)),F&&(s.score=!0,o.rating=de.score),$&&(s.tags=!0,o.tags=de.tags),ee&&(s.comment=!0,o.comment=de.comment),o.private=C.private,r={},U&&(s.ep=!0,r.ep=de.ep),R(!0),e.next=12,k(null==(t=C.subject)?void 0:t.id,o,r);case 12:R(!1),s.status&&B(!1),s.ep&&Y(!1),s.score&&J(!1),s.comment&&te(!1);case 17:case"end":return e.stop()}}),e)})))})]})})]})})]})}),S.DEFAULT_PROPS);try{item.displayName="item",item.__docgenInfo={description:"",displayName:"item",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:"{ item: { paddingRight: number; paddingLeft: number; paddingVertical: number; marginBottom: number; }; body: { paddingLeft: number; }; selectors: { width: number; }; toolbar: { width: string; paddingRight: number; marginTop: number; }; loading: { ...; }; }"}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Item"}},upload:{defaultValue:null,description:"",name:"upload",required:!0,type:{name:"Item"}},onBottom:{defaultValue:null,description:"",name:"onBottom",required:!0,type:{name:"(subjectId: SubjectId) => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(subjectId: SubjectId, collectionData: any, epData: any) => Promise<boolean>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/item/item.tsx#item"]={docgenInfo:item.__docgenInfo,name:"item",path:"src/screens/user/backup/component/item/item.tsx#item"})}catch(e){}},"./src/screens/user/backup/component/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{item:{paddingRight:n._.wind,paddingLeft:n._.wind,paddingVertical:n._.md,marginBottom:n._.sm},body:{paddingLeft:n._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:n._._wind,marginTop:n._.xs},loading:{marginTop:13}}}))},"./src/screens/user/backup/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"List")},"./src/screens/user/backup/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/screens/_/index.ts"),r=s("./src/stores/index.ts"),d=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/list/utils.tsx"),c=s("./src/screens/user/backup/component/list/ds.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s=t.$;return(0,a.jsx)(o.PaginationList2,{contentContainerStyle:r._.container.bottom,data:s.data,limit:12,footerEmptyDataText:"没有获取到任何数据，请检查登录、授权状态，在进度页面下拉刷新重新授权或者重新登录再试试",renderItem:u.renderItem,onHeaderRefresh:s.fetchCollectionsAll})}),c.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/user/backup/component/list/index.tsx#list"})}catch(e){}},"./src/screens/user/backup/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=d;n(s("./node_modules/react/index.js"));var o=n(s("./src/screens/user/backup/component/item/index.tsx")),r=s("./node_modules/react/jsx-runtime.js");function d(e){var t=e.item;return(0,r.jsx)(o.default,{item:t})}try{d.displayName="renderItem",d.__docgenInfo={description:"",displayName:"renderItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/list/utils.tsx#renderItem"]={docgenInfo:d.__docgenInfo,name:"renderItem",path:"src/screens/user/backup/component/list/utils.tsx#renderItem"})}catch(e){}},"./src/screens/user/backup/component/tips/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Tips")},"./src/screens/user/backup/component/tips/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),d=s("./src/screens/user/backup/component/tips/ds.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$.state.progress,n=s.fetching,r=s.message,d=s.current,c=s.total;return(0,u.jsx)(o.Progress,{show:n,message:r,current:d,total:c})}),d.COMPONENT);try{tips.displayName="tips",tips.__docgenInfo={description:"",displayName:"tips",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/tips/index.tsx#tips"]={docgenInfo:tips.__docgenInfo,name:"tips",path:"src/screens/user/backup/component/tips/index.tsx#tips"})}catch(e){}},"./src/screens/user/backup/component/upload/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Upload")},"./src/screens/user/backup/component/upload/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.fixed.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./node_modules/react-native-webview/index.js"),d=s("./src/components/index.ts"),u=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),a=n(s("./src/screens/user/backup/component/btn/index.tsx")),l=s("./src/screens/user/backup/component/upload/utils.ts"),i=s("./src/screens/user/backup/component/upload/ds.ts"),p=s("./src/screens/user/backup/component/upload/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$;if(!s.state.modal)return null;var n=(0,p.memoStyles)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(o.default,{style:n.mask}),(0,m.jsxs)(o.default,{style:n.fixed,children:[(0,m.jsx)(o.default,{style:n.container,children:(0,m.jsx)(r.WebView,{containerStyle:n.webview,source:{html:(0,l.injectedHTML)()},androidHardwareAccelerationDisabled:!0,androidLayerType:"software",javaScriptEnabled:!0,onMessage:function(e){var t=JSON.parse(e.nativeEvent.data).data;s.onMessage(t)}})}),(0,m.jsxs)(o.default,{style:n.body,children:[(0,m.jsx)(d.Text,{bold:!0,size:15,children:"点击上方按钮导入 CSV 文件"}),(0,m.jsx)(d.Flex,{style:u._.mt.lg,justify:"center",children:(0,m.jsx)(a.default,{style:n.btn,btnStyle:n.btnStyle,text:"收起",size:13,onPress:s.onToggleUpload})})]})]})]})}),i.COMPONENT);try{upload.displayName="upload",upload.__docgenInfo={description:"",displayName:"upload",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/component/upload/index.tsx#upload"]={docgenInfo:upload.__docgenInfo,name:"upload",path:"src/screens/user/backup/component/upload/index.tsx#upload"})}catch(e){}},"./src/screens/user/backup/component/upload/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:n._.wind,width:n._.window.contentWidth,backgroundColor:n._.select(n._.colorPlain,n._._colorDarkModeLevel2),borderRadius:n._.radiusMd,shadowColor:n._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:n._.select(16,0)},hide:{top:n._.sm,right:n._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},container:{minHeight:128,borderRadius:n._.radiusMd,overflow:"hidden"},webview:{borderRadius:n._.radiusMd,overflow:"hidden"},webviewHide:{opacity:.01},body:{paddingTop:20,paddingHorizontal:n._.md,paddingBottom:28},iconToggle:{position:"absolute",zIndex:2,top:1,right:0},btn:{width:128},btnStyle:{height:40}}}))},"./src/screens/user/backup/component/upload/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_IMPORT=void 0,t.injectedHTML=function(){return'<!DOCTYPE html>\n  <html lang="en">\n    <head>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n      <meta name="viewport" content="width=device-width,initial-scale=1" />\n      <title>上传CSV</title>\n      <style>\n        * {\n          padding: 0;\n          margin: 0;\n        }\n        #upload_wrap {\n          height: 120px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n      </style>\n    </head>\n    <body>\n      <div id="upload_wrap">\n        <input id="upload_input" type="file" accept=".csv" onchange="readCSVFile(this)" />\n      </div>\n      <script>\n        function readCSVFile(obj) {\n          var reader = new FileReader()\n          reader.readAsText(obj.files[0])\n          reader.onload = function () {\n            postMessage(\''+n+"', this.result);\n          }\n        }\n\n        function postMessage(type, data) {\n          window.ReactNativeWebView.postMessage(JSON.stringify({ type, data }))\n        }\n      <\/script>\n    </body>\n  </html>"};var n=t.TYPE_IMPORT="CSV_IMPORT"},"./src/screens/user/backup/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.LIMIT=t.HOST_API=t.EXCLUDE_STATE=t.CSV_HEADS=t.COMPONENT=void 0;var n=t.COMPONENT="Backup",o=(t.NAMESPACE="Screen"+n,t.HOST_API="https://api.bgm.tv",t.LIMIT=100,t.EXCLUDE_STATE={progress:{fetching:!1,message:"",current:0,total:0},modal:!1,upload:{},bottom:{current:0}});t.STATE=Object.assign({anime:[],book:[],music:[],game:[],real:[],last:0,includeUrl:!1,includeImage:!1},o,{_loaded:!1}),t.CSV_HEADS=["ID","封面","网址","类型","中文","日文","放送","排名","评分","话数","看到","状态","标签","我的评价","我的简评","私密","更新时间"]},"./src/screens/user/backup/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var n=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/ds.ts");t.COMPONENT=(0,n.rc)(o.COMPONENT,"Header")},"./src/screens/user/backup/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/screens/_/index.ts"),d=s("./src/stores/index.ts"),u=s("./src/utils/decorators/index.ts"),c=s("./src/screens/user/backup/header/ds.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.obc)((function(e,t){var s=t.navigation;return(0,a.jsx)(o.Header,{title:"本地备份",hm:["backup","Backup"],headerRight:function(){return(0,a.jsx)(r.IconTouchable,{name:"md-info-outline",color:d._.colorDesc,onPress:function(){s.push("Information",{title:"本地备份",message:["条目地址和封面地址为可选导出项。","因为这些值长度较长，对于部分有大量收藏记录的用户来说，很可能导致内存溢出导出失败，请自行尝试。"]})}})}})}),c.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/user/backup/header/index.tsx#header"})}catch(e){}},"./src/screens/user/backup/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),d=s("./src/utils/hooks/index.ts"),u=n(s("./src/screens/user/backup/component/cloud/index.tsx")),c=n(s("./src/screens/user/backup/component/list/index.tsx")),a=n(s("./src/screens/user/backup/component/tips/index.tsx")),l=n(s("./src/screens/user/backup/component/upload/index.tsx")),i=n(s("./src/screens/user/backup/header/index.tsx")),p=n(s("./src/screens/user/backup/store.ts")),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ic)(p.default,(function(e,t){var s=t.$;return(0,d.useMount)((function(){s.init()})),(0,d.useObserver)((function(){return(0,m.jsxs)(o.Component,{id:"screen-backup",children:[(0,m.jsx)(i.default,{}),(0,m.jsxs)(o.Page,{children:[(0,m.jsx)(l.default,{}),(0,m.jsx)(u.default,{}),s.state.progress.fetching?(0,m.jsx)(o.Loading,{}):(0,m.jsx)(c.default,{})]}),(0,m.jsx)(a.default,{})]})}))}));try{backup.displayName="backup",backup.__docgenInfo={description:"",displayName:"backup",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/backup/index.tsx#backup"]={docgenInfo:backup.__docgenInfo,name:"backup",path:"src/screens/user/backup/index.tsx#backup"})}catch(e){}},"./src/screens/user/backup/store.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.is-array.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,d=o(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),u=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),a=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),i=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),p=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=o(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),_=s("./node_modules/mobx/dist/mobx.esm.js"),j=o(s("./node_modules/csvjson-csv2json/csv2json.js")),y=s("./node_modules/json2csv/dist/json2csv.umd.js"),x=s("./src/stores/index.ts"),S=s("./src/utils/index.ts"),v=s("./src/utils/fetch/index.ts"),g=s("./src/utils/fetch.v0/index.ts"),h=s("./src/utils/fetch.v0/ds.ts"),O=s("./src/utils/kv/index.ts"),C=o(s("./src/utils/store/index.ts")),T=s("./src/constants/index.ts"),E=s("./src/screens/user/backup/utils.ts"),k=s("./src/screens/user/backup/ds.ts");function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,m.default)(e);if(t){var o=(0,m.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,p.default)(this,s)}}t.default=(r=function(e){(0,i.default)(s,e);var t=P(s);function s(){var e,o,r,a;(0,c.default)(this,s);for(var i=arguments.length,p=new Array(i),m=0;m<i;m++)p[m]=arguments[m];return e=t.call.apply(t,[this].concat(p)),(0,f.default)((0,l.default)(e),"state",(0,_.observable)(k.STATE)),(0,f.default)((0,l.default)(e),"init",(0,u.default)(n.mark((function t(){var s;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(k.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:if(s=t.t0,e.setState(Object.assign({},s,k.EXCLUDE_STATE,{_loaded:!0})),e.state.last){t.next=10;break}return t.next=10,e.fetchCollectionsAll();case 10:return t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t)})))),(0,f.default)((0,l.default)(e),"fetchCollectionsAll",(0,u.default)(n.mark((function t(){var s,o,r,d;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.progress.fetching){t.next=2;break}return t.abrupt("return",!1);case 2:e.setState({anime:[],book:[],music:[],game:[],real:[],progress:{fetching:!0,total:T.SUBJECT_TYPE.length*T.COLLECTION_STATUS.length}}),t.prev=3,s=0,o=0;case 6:if(!(o<T.SUBJECT_TYPE.length)){t.next=21;break}r=0;case 8:if(!(r<T.COLLECTION_STATUS.length)){t.next=17;break}return d=T.MODEL_SUBJECT_TYPE.getTitle(T.SUBJECT_TYPE[o].value),s+=1,e.setState({progress:{current:s,message:d+" ("+(0,E.actionStatus)(T.COLLECTION_STATUS[r].title,d)+") "}}),t.next=14,e.fetchCollections(T.SUBJECT_TYPE[o].value,T.COLLECTION_STATUS[r].title);case 14:r+=1,t.next=8;break;case 17:e.setStorage(k.NAMESPACE);case 18:o+=1,t.next=6;break;case 21:e.setState({last:(0,S.getTimestamp)()}),e.setStorage(k.NAMESPACE),(0,v.t)("本地备份.获取",{userId:e.userId}),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(3),(0,v.t)("本地备份.报错",{userId:e.userId});case 29:return t.prev=29,e.setState({progress:k.EXCLUDE_STATE.progress}),t.finish(29);case 32:case"end":return t.stop()}}),t,null,[[3,26,29,32]])})))),(0,f.default)((0,l.default)(e),"fetchCollections",(o=(0,u.default)(n.mark((function t(s,o){var r,u,c,a,l=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.length>2&&void 0!==l[2]?l[2]:1,t.next=3,(0,g.request)((0,h.API_COLLECTIONS)(e.userId,s,r,k.LIMIT,o));case 3:if(u=t.sent,c=T.MODEL_SUBJECT_TYPE.getLabel(s),Array.isArray(null==u?void 0:u.data)&&(a=u.data.map((function(e){var t,s=(e||{}).subject;return{type:e.type,rate:e.rate,ep_status:e.ep_status,vol_status:e.vol_status,comment:e.comment,tags:e.tags,private:e.private,updated_at:e.updated_at,subject:{id:null==s?void 0:s.id,date:null==s?void 0:s.date,eps:null==s?void 0:s.eps,image:null==s||null==(t=s.images)?void 0:t.medium,jp:null==s?void 0:s.name,cn:null==s?void 0:s.name_cn,rank:null==s?void 0:s.rank,score:null==s?void 0:s.score,type:null==e?void 0:e.subject_type}}})),e.setState((0,f.default)({},c,[].concat((0,d.default)((0,_.toJS)(e.state[c])),(0,d.default)(a))))),!(u.total&&u.offset+k.LIMIT<u.total)){t.next=8;break}return t.abrupt("return",e.fetchCollections(s,o,r+1));case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})),(0,f.default)((0,l.default)(e),"fetchCollection",(r=(0,u.default)(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.info(t);case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})),(0,f.default)((0,l.default)(e),"onSetting",(function(t){e.setState((0,f.default)({},t,!e.state[t])),e.setStorage(k.NAMESPACE)})),(0,f.default)((0,l.default)(e),"onExport",(0,u.default)(n.mark((function t(){var s,o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.csv.length){t.next=3;break}return(0,S.info)("没有获取到收藏信息，请检查登录状态"),t.abrupt("return",!1);case 3:return t.next=5,(0,O.temp)(e.userId+"_"+(0,S.date)("Y-m-d_H-i-s",(0,S.getTimestamp)())+".csv","\ufeff"+e.csv);case 5:if(s=t.sent,null!=(o=s.data)&&o.downloadKey){t.next=10;break}return(0,S.info)("未知错误，下载失败，重试或联系作者"),t.abrupt("return",!1);case 10:(0,v.t)("本地备份.导出",{data:e.userId+"|"+e.csv.length}),(0,S.open)((0,O.download)(o.downloadKey));case 12:case"end":return t.stop()}}),t)})))),(0,f.default)((0,l.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,f.default)({current:s},t,s)}),e.setStorage(k.NAMESPACE),(0,v.t)("本地备份.置底")})),(0,f.default)((0,l.default)(e),"onSubmit",(a=(0,u.default)(n.mark((function t(s,o,r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(o).length){t.next=5;break}return t.next=5,(0,g.request)(k.HOST_API+"/collection/"+s+"/update",Object.assign({},o,{privacy:o.privacy?1:0}));case 5:if(!Object.keys(r).length){t.next=8;break}return t.next=8,(0,g.request)(k.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:r.ep||0});case 8:return t.next=10,e.fetchCollection(s);case 10:(0,S.feedback)(),(0,v.t)("本地备份.同步");case 12:case"end":return t.stop()}}),t)}))),function(e,t,s){return a.apply(this,arguments)})),(0,f.default)((0,l.default)(e),"onToggleUpload",(function(){e.setState({modal:!e.state.modal})})),(0,f.default)((0,l.default)(e),"onMessage",(function(t){try{var s=(0,j.default)(t);if(s.length){var n={};s.map((function(e){if(e.ID){var t=e["状态"];t.includes("在")?t="3":t.includes("想")?t="1":t.includes("过")?t="2":t.includes("搁置")?t="4":t.includes("抛弃")&&(t="5"),n[e.ID]={type:t,rate:e["我的评价"]||"",ep_status:e["看到"]||"",vol_status:"",comment:e["我的简评"]||"",tags:(e["标签"]||"").split(" "),private:"是"===e["私密"],updated_at:e["更新时间"]||"",subject:{id:e.ID,date:e["放送"]||"",eps:e["话数"]||"",image:e["封面"]||"",jp:e["日文"]||"",cn:e["中文"]||"",rank:e["排名"]||"",score:e["评分"]||"",type:T.MODEL_SUBJECT_TYPE.getValue(e["类型"])||"2"}}}})),e.setState({upload:n}),e.setStorage(k.NAMESPACE),e.onToggleUpload(),(0,v.t)("本地备份.导入",{data:e.userId+"|"+s.length})}}catch(e){(0,S.info)("解析CSV出错，请重新导入")}})),e}return(0,a.default)(s,[{key:"userId",get:function(){return x.userStore.usersInfo(x.userStore.myUserId).username||x.userStore.myUserId}},{key:"csv",get:function(){if(this.state.progress.fetching)return"";if(!this.data.length)return"";var e=this.state,t=e.includeUrl,s=e.includeImage,n=this.data.map((function(e){var n,o=e.subject,r=(0,f.default)({},k.CSV_HEADS[0],o.id);s&&(r[k.CSV_HEADS[1]]=o.image),t&&(r[k.CSV_HEADS[2]]="https://bgm.tv/subject/"+o.id);var d=(r=Object.assign({},r,(n={},(0,f.default)(n,k.CSV_HEADS[3],T.MODEL_SUBJECT_TYPE.getTitle(o.type)),(0,f.default)(n,k.CSV_HEADS[4],o.cn),(0,f.default)(n,k.CSV_HEADS[5],o.jp),(0,f.default)(n,k.CSV_HEADS[6],o.date),(0,f.default)(n,k.CSV_HEADS[7],o.rank||""),(0,f.default)(n,k.CSV_HEADS[8],o.score||""),(0,f.default)(n,k.CSV_HEADS[9],o.eps||""),(0,f.default)(n,k.CSV_HEADS[10],e.ep_status||""),(0,f.default)(n,k.CSV_HEADS[11],T.MODEL_COLLECTION_STATUS.getLabel(e.type)),(0,f.default)(n,k.CSV_HEADS[12],e.tags.join(" ")),(0,f.default)(n,k.CSV_HEADS[13],e.rate||""),(0,f.default)(n,k.CSV_HEADS[14],e.comment||""),(0,f.default)(n,k.CSV_HEADS[15],e.private?"是":""),(0,f.default)(n,k.CSV_HEADS[16],e.updated_at),n)))[k.CSV_HEADS[3]];return"书籍"===d?r[k.CSV_HEADS[11]]=r[k.CSV_HEADS[11]].replace("看","读"):"游戏"===d?r[k.CSV_HEADS[11]]=r[k.CSV_HEADS[11]].replace("看","玩"):"音乐"===d&&(r[k.CSV_HEADS[11]]=r[k.CSV_HEADS[11]].replace("看","听")),r}));return new y.Parser(k.CSV_HEADS).parse(n)}},{key:"upload",value:function(e){var t=this;return(0,_.computed)((function(){return t.state.upload[e]||null})).get()}},{key:"list",get:function(){var e=this.state,t=e.anime,s=e.book,n=e.music,o=e.game,r=e.real;return[].concat((0,d.default)(t),(0,d.default)(s),(0,d.default)(n),(0,d.default)(o),(0,d.default)(r))}},{key:"listMap",get:function(){var e={};return this.list.forEach((function(t){e[t.subject.id]=!0})),e}},{key:"data",get:function(){var e=this;if(this.state.progress.fetching)return[];var t=this.state.upload;if(Object.keys(t).length){var s=[];Object.keys(t).forEach((function(n){n in e.listMap||s.push(Object.assign({},t[n],{type:"",ep_status:"",rate:"",tags:[],comment:""}))})),s.push.apply(s,(0,d.default)(this.list));var n=this.state.bottom;return s.slice().sort((function(e,s){return(0,S.asc)(t[e.subject.id]?0:1,t[s.subject.id]?0:1)})).sort((function(e,t){return(0,S.asc)(n[e.subject.id]||0,n[t.subject.id]||0)}))}return this.list.slice().sort((function(e,t){return(0,S.asc)(e.updated_at,t.updated_at)}))}}]),s}(C.default),(0,b.default)(r.prototype,"userId",[_.computed],Object.getOwnPropertyDescriptor(r.prototype,"userId"),r.prototype),(0,b.default)(r.prototype,"csv",[_.computed],Object.getOwnPropertyDescriptor(r.prototype,"csv"),r.prototype),(0,b.default)(r.prototype,"list",[_.computed],Object.getOwnPropertyDescriptor(r.prototype,"list"),r.prototype),(0,b.default)(r.prototype,"listMap",[_.computed],Object.getOwnPropertyDescriptor(r.prototype,"listMap"),r.prototype),(0,b.default)(r.prototype,"data",[_.computed],Object.getOwnPropertyDescriptor(r.prototype,"data"),r.prototype),r)},"./src/screens/user/backup/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.actionStatus=function(e,t){var s=d.MODEL_COLLECTION_STATUS.getLabel(e)||"";"书籍"===t?s=s.replace("看","读"):"游戏"===t?s=s.replace("看","玩"):"音乐"===t&&(s=s.replace("看","听"));return s},t.getSelectComment=p,t.getSelectEp=a,t.getSelectScore=l,t.getSelectStatus=c,t.getSelectTags=i,t.useSelectComment=function(e,t){var s=(0,r.useState)(p(e,t).select),n=(0,o.default)(s,2),d=n[0],u=n[1];return(0,r.useEffect)((function(){u(p(e,t).select)}),[e,t]),[d,u]},t.useSelectEp=function(e,t){var s=(0,r.useState)(a(e,t).select),n=(0,o.default)(s,2),d=n[0],u=n[1];return(0,r.useEffect)((function(){u(a(e,t).select)}),[e,t]),[d,u]},t.useSelectScore=function(e,t){var s=(0,r.useState)(l(e,t).select),n=(0,o.default)(s,2),d=n[0],u=n[1];return(0,r.useEffect)((function(){u(l(e,t).select)}),[e,t]),[d,u]},t.useSelectStatus=function(e,t){var s=(0,r.useState)(c(e,t).select),n=(0,o.default)(s,2),d=n[0],u=n[1];return(0,r.useEffect)((function(){u(c(e,t).select)}),[e,t]),[d,u]},t.useSelectTags=function(e,t){var s=(0,r.useState)(i(e,t).select),n=(0,o.default)(s,2),d=n[0],u=n[1];return(0,r.useEffect)((function(){u(i(e,t).select)}),[e,t]),[d,u]};var o=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),r=s("./node_modules/react/index.js"),d=s("./src/constants/index.ts");function u(e){return String(e).replace(/读|玩|听/g,"看").trim()}function c(e,t){return{select:u(e)!==u(t),value:t}}function a(e,t){var s,n=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:n>Number(t||0),value:n}}function l(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function i(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}function p(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}}}]);