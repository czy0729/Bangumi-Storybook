(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6825],{"./src/screens/rakuen/topic/component/bottom/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.MARKS=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Bottom"),t.MARKS=["+1","mark","(bgm38)"]},"./src/screens/rakuen/topic/component/bottom/extra/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/bottom/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Extra")},"./src/screens/rakuen/topic/component/bottom/extra/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),i=s("./src/utils/dev/index.ts"),c=s("./src/utils/hooks/index.ts"),d=s("./src/screens/rakuen/topic/component/bottom/extra/ds.ts"),a=s("./src/screens/rakuen/topic/component/bottom/extra/styles.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=function(e){var t=e.onDirect;(0,i.r)(d.COMPONENT);var s=(0,a.memoStyles)(),o=n.rakuenStore.setting.switchSlider,u=n._.ios("height","bottom");return(0,c.useObserver)((function(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.SafeAreaBottom,{style:s.left,type:u,children:(0,l.jsx)(r.Touchable,{useRN:!0,onPress:function(){return t(!!o)},onLongPress:function(){return t(!!o,20)},children:(0,l.jsx)(r.Flex,{style:s.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{style:n._.mr.md,name:o?"md-navigate-next":"md-navigate-before",size:24})})})}),(0,l.jsx)(r.SafeAreaBottom,{style:s.center,type:u,pointerEvents:"none",children:(0,l.jsx)(r.Flex,{style:s.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{name:"md-edit",size:15})})}),(0,l.jsx)(r.SafeAreaBottom,{style:s.right,type:u,children:(0,l.jsx)(r.Touchable,{useRN:!0,onPress:function(){return t(!o)},onLongPress:function(){return t(!o,20)},children:(0,l.jsx)(r.Flex,{style:s.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{style:n._.ml.md,name:o?"md-navigate-before":"md-navigate-next",size:24})})})})]})}))}},"./src/screens/rakuen/topic/component/bottom/extra/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){var e=o._.ios(36,"auto");return{left:{position:"absolute",zIndex:1002,left:0,bottom:0,height:e,paddingRight:o._.md},center:{position:"absolute",zIndex:1001,left:o._.window.width/3,bottom:0,height:e},right:{position:"absolute",zIndex:1002,right:0,bottom:0,height:e},btn:{width:o._.window.width/3,height:48}}}))},"./src/screens/rakuen/topic/component/bottom/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),i=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),d=o(s("./src/screens/rakuen/topic/component/bottom/extra/index.tsx")),a=s("./src/screens/rakuen/topic/component/bottom/ds.ts"),l=s("./src/screens/rakuen/topic/component/bottom/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=e.fixedTextareaRef,o=e.onDirect,c=t.$,p=t.navigation;if(!n.userStore.isWebLogin||n.userStore.isLimit)return null;var m=(0,l.memoStyles)(),f=c.topic.tip;if((void 0===f?"":f).includes("半公开"))return(0,u.jsx)(r.SafeAreaBottom,{style:m.fixedBottom,type:n._.ios("height","bottom"),children:(0,u.jsxs)(r.Flex,{children:[(0,u.jsx)(r.Text,{children:"半公开小组只有成员才能发言, "}),(0,u.jsx)(r.Text,{type:"main",onPress:function(){return(0,i.appNavigate)(c.groupHref,p)},children:"点击加入"})]})});var j=c.topic.close;if(j)return(0,u.jsx)(r.SafeAreaBottom,{style:m.fixedBottom,type:n._.ios("height","bottom"),children:(0,u.jsxs)(r.Flex,{children:[(0,u.jsx)(r.Text,{children:"主题已被关闭"}),!!j&&(0,u.jsxs)(r.Text,{type:"sub",children:[": ",j]})]})});var h=c.state,b=h.placeholder,_=h.value;return(0,u.jsx)(r.FixedTextarea,{ref:s,placeholder:b||void 0,value:_,source:!0,marks:a.MARKS,extraComponent:(0,u.jsx)(d.default,{onDirect:o}),onChange:c.onChange,onClose:c.closeFixedTextarea,onSubmit:c.doSubmit})}),a.COMPONENT)},"./src/screens/rakuen/topic/component/bottom/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts"),r=s("./src/constants/index.ts");t.memoStyles=o._.memoStyles((function(){return{fixedBottom:Object.assign({position:"absolute",zIndex:1,right:0,bottom:0,left:0,height:o._.ios(32,"auto"),paddingVertical:16,paddingHorizontal:o._.wind,backgroundColor:o._.select(o._.colorPlain,o._._colorDarkModeLevel1)},r.IOS?{shadowColor:o._.colorShadow,shadowOffset:{width:1,height:-2},shadowOpacity:.06,shadowRadius:6}:{elevation:8})}}))},"./src/screens/rakuen/topic/component/content/content.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.string.trim.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),i=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),l=s("./src/screens/rakuen/topic/component/content/ds.ts"),u=s("./src/screens/rakuen/topic/component/content/styles.ts"),p=s("./node_modules/react/jsx-runtime.js"),m=(0,a.memo)((function(e){var t=e.topicId,s=e.html,o=e.isEp,a=e.id,l=e.formhash,m=e.likeType,f=e.translateResult,j=e.doTranslate,h=e.onLinkPress,b=t.includes("group/");return(0,p.jsxs)(r.default,{style:u.styles.html,children:[b&&!s&&(0,p.jsx)(n.Flex,{style:u.styles.loading,justify:"center",children:(0,p.jsx)(n.Loading,{})}),f.length?(0,p.jsx)(r.default,{children:f.map((function(e,t){return(0,p.jsxs)(r.default,{children:[(0,p.jsx)(n.Text,{style:c._.mt.md,size:13,lineHeight:14,type:"sub",children:e.src.trim()}),(0,p.jsx)(n.Text,{style:c._.mt.xs,size:15,lineHeight:17,children:e.dst.trim()})]},t)}))}):!!s&&(0,p.jsxs)(p.Fragment,{children:[o&&!(0,d.isChineseParagraph)((0,d.removeURLs)((0,d.removeHTMLTag)(s)))&&(0,p.jsxs)(r.default,{style:u.styles.iconTranslate,children:[(0,p.jsx)(i.IconTouchable,{name:"md-g-translate",size:18,onPress:j}),(0,p.jsx)(n.Heatmap,{id:"帖子.翻译内容"})]}),(0,p.jsxs)(r.default,{style:c._.mt.md,children:[(0,p.jsx)(n.RenderHtml,{html:s,matchLink:!0,onLinkPress:h}),(0,p.jsx)(n.Heatmap,{bottom:133,id:"帖子.跳转",to:"Blog",alias:"日志",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:100,id:"帖子.跳转",to:"CatalogDetail",alias:"目录",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:67,id:"帖子.跳转",to:"Topic",alias:"帖子",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:34,id:"帖子.跳转",to:"Mono",alias:"人物",transparent:!0}),(0,p.jsx)(n.Heatmap,{id:"帖子.跳转",to:"WebBrowser",alias:"浏览器",transparent:!0})]})]}),(0,p.jsx)(i.Likes,{show:!0,topicId:t,id:a,formhash:l,likeType:m,onLongPress:c.uiStore.showLikesUsers})]})}),l.DEFAULT_PROPS,l.COMPONENT_MAIN);t.default=m},"./src/screens/rakuen/topic/component/content/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/constants/index.ts"),n=s("./src/screens/rakuen/topic/component/ds.ts"),i=t.COMPONENT=(0,o.rc)(n.COMPONENT,"Content");t.COMPONENT_MAIN=(0,o.rc)(i),t.DEFAULT_PROPS={topicId:"",html:"",isEp:!1,id:"",formhash:"",likeType:"",translateResult:[],doTranslate:r.FROZEN_FN,onLinkPress:r.FROZEN_FN}},"./src/screens/rakuen/topic/component/content/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.array.slice.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=l(t);if(s&&s.has(e))return s.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(o,n,i):o[n]=e[n]}return o.default=e,s&&s.set(e,o),o}(s("react")),n=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),c=o(s("./src/screens/rakuen/topic/component/content/content.tsx")),d=s("./src/screens/rakuen/topic/component/content/ds.ts"),a=s("./node_modules/react/jsx-runtime.js");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(l=function(e){return e?s:t})(e)}t.default=(0,i.obc)((function(e,t){var s,o,i,d=t.$,l=t.navigation,u=(0,r.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,n.appNavigate)(e,l,t,{id:"帖子.跳转",data:{from:"#1",topicId:d.topicId}})}),[d.topicId,l]);return(0,a.jsx)(c.default,{topicId:d.topicId,html:d.html,isEp:d.isEp,id:null==(s=d.topic)?void 0:s.id,formhash:null==(o=d.topic)?void 0:o.formhash,likeType:null==(i=d.topic)?void 0:i.likeType,translateResult:d.state.translateResult.slice(),doTranslate:d.doTranslate,onLinkPress:u})}),d.COMPONENT)},"./src/screens/rakuen/topic/component/content/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({html:{minHeight:o._.r(120)},loading:{height:o._.r(120)},iconTranslate:{position:"absolute",zIndex:1,top:0,right:-4}})},"./src/screens/rakuen/topic/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Component")},"./src/screens/rakuen/topic/component/ep/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Ep")},"./src/screens/rakuen/topic/component/ep/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.find-index.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.function.name.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(o(s("react")),s("./src/components/index.ts")),i=s("./src/stores/index.ts"),c=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),a=s("./src/screens/rakuen/topic/component/ep/ds.ts"),l=s("./src/screens/rakuen/topic/component/ep/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s,o=t.$,d=t.navigation;if(null==(s=o.groupHref)||!s.includes("/subject/"))return null;var a=Number(o.groupHref.replace("/subject/","")),p=i.subjectStore.subject(a).eps;if(null==p||!p.length)return null;var m=[],f=(m=p.length>=1e3?[].concat((0,r.default)(p),(0,r.default)(i.subjectStore.epV2(a).list)).filter((function(e){return 0===e.type})):p.filter((function(e){return 0===e.type}))).findIndex((function(e){var t;return null==(t=e.url)?void 0:t.includes(o.topicId)}));if(-1===f)return null;var j,h,b=(0,l.memoStyles)();if(f-1>=0&&(j=m[f-1]),f+1<=m.length-1&&(h=m[f+1]),!j&&!h)return null;var _=function(e){var t;d.replace("Topic",{topicId:"ep/"+(null==(t=e.url)?void 0:t.split("/ep/")[1]),_title:(1===e.type?"sp":"ep")+e.sort+"."+(0,c.cnjp)(e.name_cn,e.name)})};return(0,u.jsxs)(n.Flex,{style:b.container,children:[(0,u.jsx)(n.Flex.Item,{children:j&&(0,u.jsxs)(n.Touchable,{style:b.item,animate:!0,onPress:function(){return _(j)},children:[(0,u.jsxs)(n.Flex,{children:[(0,u.jsx)(n.Iconfont,{style:b.left,name:"md-navigate-before",size:18,color:i._.colorDesc}),(0,u.jsxs)(n.Text,{size:16,bold:!0,children:[1===j.type?"sp":"ep",j.sort]})]}),(0,u.jsx)(n.Text,{style:i._.mt.xs,size:12,type:"sub",numberOfLines:1,children:(0,c.HTMLDecode)((0,c.cnjp)(j.name_cn,j.name))})]})}),(0,u.jsx)(n.Flex.Item,{style:i._.ml.md,children:h&&(0,u.jsxs)(n.Touchable,{style:b.item,animate:!0,onPress:function(){return _(h)},children:[(0,u.jsxs)(n.Flex,{justify:"end",children:[(0,u.jsxs)(n.Text,{size:16,bold:!0,align:"right",children:[1===h.type?"sp":"ep",h.sort]}),(0,u.jsx)(n.Iconfont,{style:b.right,name:"md-navigate-next",size:18,color:i._.colorDesc})]}),(0,u.jsx)(n.Text,{style:i._.mt.xs,size:12,type:"sub",align:"right",numberOfLines:1,children:(0,c.HTMLDecode)((0,c.cnjp)(h.name_cn,h.name))})]})})]})}),a.COMPONENT)},"./src/screens/rakuen/topic/component/ep/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{paddingVertical:o._.md,paddingHorizontal:o._.wind,marginRight:o._.xs},item:{paddingTop:o._.sm,paddingBottom:o._.sm+4,paddingHorizontal:o._.md,borderWidth:1,borderColor:o._.colorBorder,borderRadius:o._.radiusSm},left:{marginTop:2,marginLeft:-2},right:{marginTop:2,marginRight:-2}}}))},"./src/screens/rakuen/topic/component/header-title/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.IMG_WIDTH=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts"),n=t.COMPONENT=(0,o.rc)(r.COMPONENT,"HeaderTitle");t.COMPONENT_MAIN=(0,o.rc)(n),t.IMG_WIDTH=28,t.DEFAULT_PROPS={navigation:{},avatar:"",userId:"",userName:"",title:"",group:""}},"./src/screens/rakuen/topic/component/header-title/header-title.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.array.filter.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),d=s("./src/screens/rakuen/topic/component/header-title/ds.ts"),a=s("./src/screens/rakuen/topic/component/header-title/styles.ts"),l=s("./node_modules/react/jsx-runtime.js"),u=(0,c.memo)((function(e){var t=e.navigation,s=e.avatar,o=e.userId,c=e.userName,u=e.title,p=e.group,m=[c||p,p].filter((function(e){return!!e})).join(" · ");return(0,l.jsxs)(r.Flex,{style:a.styles.container,children:[!!s&&(0,l.jsx)(r.UserStatus,{userId:o,children:(0,l.jsx)(n.Avatar,{navigation:t,size:d.IMG_WIDTH,src:s,userId:o,name:c})}),(0,l.jsxs)(r.Flex.Item,{style:i._.ml.sm,children:[(0,l.jsx)(r.Text,{size:13,numberOfLines:1,children:u}),!!m&&(0,l.jsx)(n.VerticalAlign,{type:"sub",text:c||p,size:10,lineHeight:12,bold:!0,numberOfLines:1,children:m})]})]})}),d.DEFAULT_PROPS,d.COMPONENT_MAIN);t.default=u},"./src/screens/rakuen/topic/component/header-title/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/utils/decorators/index.ts"),n=s("./src/constants/index.ts"),i=o(s("./src/screens/rakuen/topic/component/header-title/header-title.tsx")),c=s("./src/screens/rakuen/topic/component/header-title/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.$,s=e.navigation;return(0,d.jsx)(i.default,{navigation:s,avatar:t.avatar===n.IMG_DEFAULT_AVATAR?t.groupThumb:t.avatar,userId:t.userId,userName:t.userName,title:t.title,group:t.group})}),c.COMPONENT)},"./src/screens/rakuen/topic/component/header-title/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({container:{marginTop:o._.platforms(4,-8,-10,-14,-8),marginRight:o._.web(80,o._.lg),marginLeft:-o._.sm}})},"./src/screens/rakuen/topic/component/heatmaps/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.ob)((function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Heatmap,{right:2,bottom:160,id:"帖子.楼层跳转",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:84,id:"帖子.删除回复",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:51,id:"帖子.回复",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:119,bottom:51,id:"帖子.回复失败",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:18,id:"帖子.显示评论框",transparent:!0}),(0,i.jsx)(r.Heatmap,{id:"帖子",screen:"Topic"})]})}))},"./src/screens/rakuen/topic/component/icon/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Icon")},"./src/screens/rakuen/topic/component/icon/favor.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),i=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),d=s("./src/utils/decorators/index.ts"),a=s("./src/screens/rakuen/topic/component/icon/ds.ts"),l=s("./src/screens/rakuen/topic/component/icon/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.$;return(0,u.jsxs)(r.default,{style:t.favorCount?l.styles.withCollect:c._.mr.xs,children:[(0,u.jsx)(i.IconHeader,{name:t.isFavor?"md-star":"md-star-outline",color:t.isFavor?c._.colorYellow:c._.colorDesc,onPress:t.setFavor,children:(0,u.jsx)(n.Heatmap,{right:33,bottom:7,id:"帖子.设置收藏"})}),!!t.favorCount&&(0,u.jsx)(n.Text,{style:l.styles.num,size:10,bold:!0,children:t.favorCount})]})}),a.COMPONENT)},"./src/screens/rakuen/topic/component/icon/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({withCollect:{paddingRight:o._.sm},num:{position:"absolute",right:7,bottom:5}})},"./src/screens/rakuen/topic/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.PRE_RENDER_INDEX=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Item"),t.PRE_RENDER_INDEX=8},"./src/screens/rakuen/topic/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/screens/_/index.ts"),n=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),c=s("./src/screens/rakuen/topic/component/item/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=e.item,o=e.index,i=e.onShowFixedTextarea,a=t.$;if(!a.postId&&!a.state.rendered&&o>c.PRE_RENDER_INDEX-1)return null;var l={id:"帖子.跳转",data:{topicId:a.topicId}};return(0,d.jsx)(r.ItemPost,Object.assign({inViewY:.8*n._.window.height,index:o,postId:a.postId,authorId:a.topic.userId},s,{matchLink:!0,event:l,showFixedTextare:i}))}),c.COMPONENT)},"./src/screens/rakuen/topic/component/list/ds.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.LISTVIEW_PROPS=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var r=s("./src/utils/index.ts"),n=s("./src/utils/dev/index.ts"),i=s("./src/constants/index.ts"),c=s("./src/screens/rakuen/topic/component/ds.ts"),d=o(s("./src/screens/rakuen/topic/component/top/index.tsx")),a=s("./node_modules/react/jsx-runtime.js"),l=t.COMPONENT=(0,n.rc)(c.COMPONENT,"List");t.COMPONENT_MAIN=(0,n.rc)(l),t.LISTVIEW_PROPS={keyExtractor:r.keyExtractor,scrollEventThrottle:16,initialNumToRender:120,maxToRenderPerBatch:120,updateCellsBatchingPeriod:120,scrollToTop:!0,keyboardDismissMode:"on-drag",ListHeaderComponent:(0,a.jsx)(d.default,{})},t.DEFAULT_PROPS={forwardRef:i.FROZEN_FN,data:i.LIST_EMPTY,postId:"",onScroll:i.FROZEN_FN,onScrollToIndexFailed:i.FROZEN_FN,onHeaderRefresh:i.FROZEN_FN,onShowFixedTextarea:i.FROZEN_FN}},"./src/screens/rakuen/topic/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/utils/decorators/index.ts"),n=o(s("./src/screens/rakuen/topic/component/list/list.tsx")),i=s("./src/screens/rakuen/topic/component/list/ds.tsx"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=e.forwardRef,o=e.onShowFixedTextarea,r=e.onScrollToIndexFailed,i=t.$;return(0,c.jsx)(n.default,{forwardRef:s,data:i.comments,postId:i.postId,onScroll:i.onScroll,onScrollToIndexFailed:r,onHeaderRefresh:i.fetchTopic,onShowFixedTextarea:o})}),i.COMPONENT)},"./src/screens/rakuen/topic/component/list/list.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=f(t);if(s&&s.has(e))return s.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(o,n,i):o[n]=e[n]}return o.default=e,s&&s.set(e,o),o}(s("react")),n=s("./src/components/index.ts"),i=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),l=s("./src/constants/index.ts"),u=o(s("./src/screens/rakuen/topic/component/item/index.tsx")),p=s("./src/screens/rakuen/topic/component/list/ds.tsx"),m=s("./node_modules/react/jsx-runtime.js");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(f=function(e){return e?s:t})(e)}var j=(0,a.memo)((function(e){var t=e.forwardRef,s=e.data,o=e.postId,a=e.onScroll,f=e.onScrollToIndexFailed,j=e.onHeaderRefresh,h=e.onShowFixedTextarea,b=(0,r.useCallback)((function(e){var t=e.item,s=e.index;return(0,m.jsx)(u.default,{item:t,index:s,onShowFixedTextarea:h})}),[h]),_=Object.assign({},p.LISTVIEW_PROPS,{keyExtractor:d.keyExtractor,style:c._.container.content,contentContainerStyle:c._.container.bottom,lazy:o?void 0:4,progressViewOffset:c._.ios(c._.statusBarHeight,0),removeClippedSubviews:!1,renderItem:b,onScroll:a,onScrollToIndexFailed:f,onHeaderRefresh:j}),y=s.list;return l.WEB||y.length<=80?(0,m.jsx)(n.ListView,Object.assign({},_,{ref:t,data:s})):(0,m.jsx)(i.PaginationList2,Object.assign({},_,{forwardRef:t,data:y,limit:24}))}),p.DEFAULT_PROPS,p.COMPONENT_MAIN);t.default=j},"./src/screens/rakuen/topic/component/milestone/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Milestone")},"./src/screens/rakuen/topic/component/milestone/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./node_modules/react-native-webview/index.js"),i=s("./src/utils/decorators/index.ts"),c=s("./src/screens/rakuen/topic/component/milestone/ds.ts"),d=s("./src/screens/rakuen/topic/component/milestone/styles.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=t.$;if("group/366561"!==s.topicId)return null;var o=(0,d.memoStyles)(),i='<!DOCTYPE html><html lang=en><head><meta charset="UTF-8"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Bangumi Open Source</title><style>*{padding:0;margin:0}::-webkit-scrollbar{display:none}body{overflow:hidden;background:#000}</style><body><div style=position:relative;width:'+o.body.width+"px;height:"+o.body.height+"px><canvas id=canvas_matrix style=display:block;background-color:transparent;position:absolute;left:0;top:0;width:"+o.body.width+"px;height:"+o.body.height+"px width=300 height=150></canvas><canvas id=canvas_matrix_2 style=display:block;background-color:transparent;position:absolute;left:0;top:0;width:"+o.body.width+"px;height:"+o.body.height+'px;border-radius:15px width=300 height=150></canvas><div style="font-family:Courier New,serif;position:absolute;width:100%;height:100%;text-align:center;top:45%;font-size:20px;color:#fff;text-shadow:0 0 15px #0f0,0 0 9px #56b000,0 0 15px #006400,0 0 5px #006400">Bangumi Open Source</div></div><script>function m(t,e){return Math.floor(Math.random()*(e-t)+t)}function v(t,e){return Math.random()*(e-t)+t}function d(t,e){this.x=t,this.y=e}var t=document.getElementById("canvas_matrix"),n=t.getContext("2d"),i=document.getElementById("canvas_matrix_2"),s=i.getContext("2d"),a=t.width,h=t.height,r=["b","a","n","g","u","m","i","o","p","e","n","s","o","u","r","c","e"],e=10,u=[],o=10,c=10,f=a/o;t.width=i.width=a,t.height=i.height=h,d.prototype.t=function(t){this.value=r[m(0,r.length-1)].toUpperCase(),this.speed=v(.5,1.5),s.fillStyle="rgba(255,255,255,0.3)",s.font=c+"px san-serif",s.fillText(this.value,this.x,this.y),t.fillStyle="#0F0",t.font=c+"px san-serif",t.fillText(this.value,this.x,this.y),this.y+=this.speed,this.y>h&&(this.y=v(-100,10),this.speed=v(.5,3))};for(var x=0;f>x;x++)u.push(new d(x*o,v(-500,0)));var b=function(){n.fillStyle="rgba(0, 0, 0, 0.05)",n.fillRect(0,0,a,h),s.clearRect(0,0,a,h);for(var t=u.length;t--;){u[t].t(n);{u[t]}}requestAnimationFrame(b)};b();<\/script>';return(0,a.jsx)(r.default,{style:o.container,children:!s.state.showHeaderTitle&&(0,a.jsx)(n.WebView,{style:o.body,source:{html:i},scrollEnabled:!1,androidHardwareAccelerationDisabled:!0,androidLayerType:"software"})})}),c.COMPONENT)},"./src/screens/rakuen/topic/component/milestone/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){var e=o._.window.contentWidth-(o._.wind-o._._wind);return{container:{height:160,marginTop:-o._.md,marginBottom:o._.md,borderRadius:o._.radiusMd,overflow:"hidden"},body:{width:e,height:160,backgroundColor:"#000",opacity:.99}}}))},"./src/screens/rakuen/topic/component/section-title/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"SectionTitle")},"./src/screens/rakuen/topic/component/section-title/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.array.reverse.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),d=o(s("./src/screens/rakuen/topic/component/segment/index.tsx")),a=s("./src/screens/rakuen/topic/component/section-title/ds.ts"),l=s("./src/screens/rakuen/topic/component/section-title/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$,o=(0,l.memoStyles)(),c=s.comments.list,a=0;return(void 0===c?[]:c).forEach((function(e){a+=1,e.sub&&(a+=e.sub.length)})),(0,u.jsxs)(n.SectionTitle,{style:o.title,right:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.default,{}),(0,u.jsx)(n.IconReverse,{style:s.state.reverse?o.reverse:void 0,iconStyle:o.reverseIcon,color:s.state.reverse?i._.colorMain:i._.colorIcon,size:18,onPress:s.toggleReverseComments,children:(0,u.jsx)(r.Heatmap,{right:10,bottom:29,id:"帖子.吐槽倒序"})})]}),children:["吐槽"," ",!!a&&(0,u.jsx)(r.Text,{size:12,type:"sub",lineHeight:24,children:a})]})}),a.COMPONENT)},"./src/screens/rakuen/topic/component/section-title/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{title:{paddingHorizontal:o._.wind,marginTop:o._.lg,marginBottom:o._.md},reverse:{transform:[{rotateX:"180deg"}]},reverseIcon:{marginRight:4,marginLeft:o._.md}}}))},"./src/screens/rakuen/topic/component/segment/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Segement")},"./src/screens/rakuen/topic/component/segment/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.find-index.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/web.timers.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),i=s("./src/stores/index.ts"),c=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),a=s("./src/screens/rakuen/topic/component/segment/ds.ts"),l=s("./src/screens/rakuen/topic/component/segment/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s=t.$,o=["全部"];if(s.state.filterPost)o.push("跳转");else{if(i.rakuenStore.setting.likes){var d,a=(null==(d=s.likesFloorIds)?void 0:d.length)||0;a&&o.push("贴贴 "+a)}var p=!!i.userStore.myId;p&&s.commentMeCount&&o.push("我 "+s.commentMeCount),p&&s.commentFriendsCount&&o.push("好友 "+s.commentFriendsCount)}if(o.length<=1)return null;var m=0;if(s.state.filterPost)m=o.length-1;else if(o.length>1){var f=s.state.filterType;"likes"===f?m=o.findIndex((function(e){return e.includes("贴贴")})):"me"===f?m=o.findIndex((function(e){return e.includes("我")})):"friends"===f&&(m=o.findIndex((function(e){return e.includes("好友")})))}return-1===m&&(m=0),(0,u.jsxs)(r.default,{children:[(0,u.jsx)(n.SegmentedControl,{style:[l.styles.segmentedControl,{width:o.length*i._.r(56)}],size:11,values:o,selectedIndex:m,onValueChange:function(e){if(s.state.filterPost)return(0,c.info)("取消仅显示跳转楼层"),(0,c.feedback)(),void setTimeout((function(){s.clearFilterPost()}),0);var t=s.state.filterType;e.includes("贴贴")&&"likes"!==t?s.onFilterLikes():e.includes("我")&&"me"!==t?s.onFilterMe():e.includes("好友")&&"friends"!==t?s.onFilterFriends():s.onFilterClear()}},m),(0,u.jsx)(n.Heatmap,{right:74,bottom:24,id:"帖子.好友相关"}),(0,u.jsx)(n.Heatmap,{right:24,bottom:24,id:"帖子.与我相关"})]})}),a.COMPONENT)},"./src/screens/rakuen/topic/component/segment/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({segmentedControl:{height:o._.r(28)}})},"./src/screens/rakuen/topic/component/top/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/rakuen/topic/component/ds.ts"),n=t.COMPONENT=(0,o.rc)(r.COMPONENT,"Top");t.COMPONENT_MAIN=(0,o.rc)(n),t.DEFAULT_PROPS={navigation:{},styles:{},topicId:"",title:"",subTitle:"",time:"",replies:"",group:"",groupHref:"",groupThumb:"",groupThumbFallback:"",avatar:"",userId:"",userName:"",userSign:"",filterPost:"",monoId:"",isMono:!1,delete:!1}},"./src/screens/rakuen/topic/component/top/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/stores/index.ts"),n=s("./src/utils/index.ts"),i=s("./src/utils/app/ds.ts"),c=s("./src/utils/decorators/index.ts"),d=s("./src/constants/index.ts"),a=o(s("./src/screens/rakuen/topic/component/top/top.tsx")),l=s("./src/screens/rakuen/topic/component/top/ds.ts"),u=s("./src/screens/rakuen/topic/component/top/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$,o=t.navigation,c=(0,n.getGroupThumbStatic)(s.groupThumb);"string"==typeof c&&r.systemStore.setting.cdn&&"magma"===r.systemStore.setting.cdnOrigin&&c.includes(i.HOST_IMAGE)&&(c=c.includes("pic/cover")?(0,d.CDN_OSS_MAGMA_POSTER)(c.replace("/s/","/l/"),"bgm_poster_100"):(0,d.CDN_OSS_MAGMA_PIC)(c));var l=(0,u.memoStyles)();return(0,p.jsx)(a.default,{navigation:o,styles:l,topicId:s.topicId,title:s.title,subTitle:s.subTitle,time:s.time,replies:s.params._replies,group:s.group,groupHref:s.groupHref,groupThumb:c,groupThumbFallback:s.groupThumb,avatar:s.avatar,userId:s.userId,userName:s.userName,userSign:s.userSign,filterPost:s.state.filterPost,monoId:s.monoId,isMono:s.isMono,delete:s.topic.delete})}),l.COMPONENT)},"./src/screens/rakuen/topic/component/top/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{paddingVertical:o._.sm,paddingHorizontal:o._.wind},groupWrap:{minHeight:o._.r(32),marginTop:o._.sm,marginBottom:o._.xs},groupLabel:{overflow:"hidden",maxWidth:"100%",padding:4,paddingRight:10,marginRight:o._.sm,backgroundColor:o._.select(o._.colorBg,o._._colorDarkModeLevel1),borderRadius:o._.radiusXs},group:{maxWidth:.6*o._.window.contentWidth,marginLeft:o._.sm},userWrap:{height:o._.r(42),marginTop:o._.sm},katakana:{marginTop:-12},loading:{height:o._.r(240)}}}))},"./src/screens/rakuen/topic/component/top/top.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.slice.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=y(t);if(s&&s.has(e))return s.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(o,n,i):o[n]=e[n]}return o.default=e,s&&s.set(e,o),o}(s("react")),i=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),c=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),a=s("./src/stores/index.ts"),l=s("./src/utils/index.ts"),u=s("./src/utils/decorators/index.ts"),p=s("./src/constants/index.ts"),m=o(s("./src/screens/rakuen/topic/component/content/index.tsx")),f=o(s("./src/screens/rakuen/topic/component/ep/index.tsx")),j=o(s("./src/screens/rakuen/topic/component/milestone/index.tsx")),h=o(s("./src/screens/rakuen/topic/component/section-title/index.tsx")),b=s("./src/screens/rakuen/topic/component/top/ds.ts"),_=s("./node_modules/react/jsx-runtime.js");function y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(y=function(e){return e?s:t})(e)}var x=(0,u.memo)((function(e){var t=e.navigation,s=e.styles,o=e.topicId,u=e.title,b=e.subTitle,y=e.time,x=e.replies,v=e.group,g=e.groupHref,O=e.groupThumb,T=e.groupThumbFallback,k=e.avatar,P=e.userId,S=e.userName,I=e.userSign,E=e.filterPost,N=e.monoId,M=e.isMono,C=e.delete,w=(0,n.useState)(1),R=(0,r.default)(w,2),F=R[0],A=R[1],D=(0,n.useCallback)((function(){return A(2)}),[]),H={id:"帖子.跳转",data:{from:"#1",topicId:o}},L=o.includes("group/"),B=o.includes("ep/");return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.HeaderPlaceholder,{}),(0,_.jsxs)(i.default,{style:s.container,children:[(0,_.jsx)(j.default,{}),(0,_.jsxs)(c.Text,{type:"title",size:20,bold:!0,selectable:!0,children:[u,!!x&&(0,_.jsx)(c.Text,{type:"main",size:12,lineHeight:26,bold:!0,children:"  "+(x.includes("+")?"":"+")+x.trim()})]}),!!b&&(0,_.jsx)(c.Text,{style:a._.mv.sm,type:"sub",size:14,bold:!0,selectable:!0,children:b}),(0,_.jsxs)(c.Flex,{style:s.groupWrap,children:[!!v&&(0,_.jsx)(c.Flex,{style:s.groupLabel,children:(0,_.jsx)(c.Touchable,{animate:!0,onPress:function(){M?(0,l.appNavigate)(p.HOST+"/"+N,t,{},H):(0,l.appNavigate)(g,t,{_jp:v},H)},children:(0,_.jsxs)(c.Flex,{children:[(0,_.jsx)(c.Cover,{size:B?40:20,src:O||a._.select(p.IMG_EMPTY,p.IMG_EMPTY_DARK),radius:a._.radiusXs,priority:"high",fallback:B,fallbackSrc:B?String(T).replace("/r/100x100",""):void 0}),(0,_.jsx)(c.Text,{style:s.group,size:13,numberOfLines:1,children:(0,l.HTMLDecode)((0,l.findSubjectCn)(v))})]})})}),!!y&&(0,_.jsx)(c.Flex.Item,{children:(0,_.jsx)(c.Text,{type:"sub",size:13,children:(0,l.simpleTime)(y)})}),(0,_.jsx)(c.Heatmap,{right:74,id:"帖子.跳转",to:"Group",alias:"小组"}),(0,_.jsx)(c.Heatmap,{id:"帖子.跳转",to:"Subject",alias:"条目",transparent:!0})]}),L&&(0,_.jsxs)(c.Flex,{style:s.userWrap,children:[!!k&&(0,_.jsx)(c.UserStatus,{userId:P,children:(0,_.jsx)(c.Avatar,{navigation:t,event:H,size:40,src:k,userId:P,name:S,priority:"high"})}),!!P&&(0,_.jsxs)(c.Flex.Item,{style:a._.ml.sm,children:[(0,_.jsx)(d.Name,{userId:P,numberOfLines:1,bold:!0,children:S}),(0,_.jsxs)(c.Text,{style:a._.mt.xs,type:"sub",size:12,numberOfLines:F,onPress:D,children:["@",P,!!I&&" ("+I.slice(1,I.length-1)+")"]})]}),(0,_.jsx)(c.Heatmap,{id:"帖子.跳转",to:"Zone",alias:"空间"})]}),E?(0,_.jsx)(c.Expand,{ratio:1.28,children:(0,_.jsx)(m.default,{})}):(0,_.jsx)(m.default,{}),!!C&&(0,_.jsxs)(c.Text,{style:a._.mb.md,size:15,lineHeight:18,bold:!0,align:"center",children:["数据库中没有查询到指定话题","\n","话题可能正在审核或已被删除"]})]}),(0,_.jsx)(c.Divider,{}),(0,_.jsx)(f.default,{}),(0,_.jsx)(h.default,{})]})}),b.DEFAULT_PROPS,b.COMPONENT_MAIN);t.default=x},"./src/screens/rakuen/topic/component/touch-scroll/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/constants/index.ts"),n=s("./src/screens/rakuen/topic/component/ds.ts"),i=t.COMPONENT=(0,o.rc)(n.COMPONENT,"TouchScroll");t.COMPONENT_MAIN=(0,o.rc)(i),t.DEFAULT_PROPS={styles:{},list:[],readedTime:0,scrollDirection:r.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("右侧"),directFloor:"",isWebLogin:!1,onPress:r.FROZEN_FN},t.HIT_SLOP={top:0,right:2,bottom:0,left:2}},"./src/screens/rakuen/topic/component/touch-scroll/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),c=s("./src/constants/index.ts"),d=s("./src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx"),a=s("./src/screens/rakuen/topic/component/touch-scroll/ds.ts"),l=s("./src/screens/rakuen/topic/component/touch-scroll/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=e.onPress,o=t.$,i=n.rakuenStore.setting.scrollDirection;return i!==c.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("隐藏")&&o.comments.list.length?(0,u.jsx)(r.Component,{id:"screen-topic-touch-scroll",children:(0,u.jsx)(d.TouchScroll,{styles:(0,l.memoStyles)(),list:o.comments.list,readedTime:o.readed._time,scrollDirection:i,directFloor:o.state.directFloor,isWebLogin:n.userStore.isWebLogin,onPress:s})}):null}),a.COMPONENT)},"./src/screens/rakuen/topic/component/touch-scroll/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{containerRight:{position:"absolute",top:o._.headerHeight,right:0,bottom:o._.ios(64,46),width:16,backgroundColor:o._.colorPlain},containerLeft:{position:"absolute",top:o._.headerHeight,left:0,bottom:o._.ios(64,46),width:16,backgroundColor:o._.colorPlain},containerBottom:{position:"absolute",left:0,right:0,bottom:40,width:"100%",height:24,backgroundColor:o._.select(o._.colorPlain,o._._colorDarkModeLevel1)},notLogin:{bottom:0,height:32,paddingBottom:8},itemVertical:{width:16,height:"100%"},itemHorizontal:{width:"100%",height:"100%"},itemNew:{borderRightWidth:6,borderColor:o._.select(o._.colorMainLightBorder,"rgb(59, 48, 51)")},itemText:{minHeight:16},dot:{width:4,height:4,backgroundColor:o._.colorIcon,borderRadius:4}}}))},"./src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.replace.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.TouchScroll=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/TouchableWithoutFeedback/index.js")),n=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),i=s("./src/components/index.ts"),c=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),l=s("./src/constants/index.ts"),u=s("./src/screens/rakuen/topic/component/touch-scroll/ds.ts"),p=s("./node_modules/react/jsx-runtime.js");t.TouchScroll=(0,a.memo)((function(e){var t,s=e.styles,o=e.list,a=e.readedTime,m=e.scrollDirection,f=e.directFloor,j=e.isWebLogin,h=e.onPress,b=f?Number((null==(t=f.match(/\d+/))?void 0:t[0])||0):0,_=[Math.floor(.33333*o.length)-1,Math.floor(.66666*o.length)-1,o.length-1],y=m===l.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("右侧")||m===l.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("左侧"),x={hitSlop:u.HIT_SLOP};return l.IOS?x.onPress=function(){return h(-1)}:x.onPressIn=function(){return h(-1)},(0,p.jsxs)(i.Flex,{style:(0,d.stl)(s["container"+(0,d.titleCase)(m)],!j&&!y&&s.notLogin),direction:y?"column":void 0,children:[(0,p.jsx)(i.Flex.Item,{style:s.itemText,flex:y?1:3,children:(0,p.jsx)(r.default,Object.assign({},x,{children:(0,p.jsx)(i.Flex,{style:y?s.itemVertical:s.itemHorizontal,children:(0,p.jsx)(i.Text,{style:c._.container.block,size:8,type:"icon",align:"center",children:"1"})})}))}),o.map((function(e,t){var m,f=b&&"#"+b===e.floor,j=!1;a&&((0,d.getTimestamp)(e.time)>a&&(j=!0),j||e.sub&&e.sub.forEach((function(e){(0,d.getTimestamp)(e.time)>a&&(j=!0)})));var x=_.includes(t),v={hitSlop:u.HIT_SLOP};return l.IOS?v.onPress=function(){return h(t)}:v.onPressIn=function(){return h(t)},(0,p.jsx)(i.Flex.Item,{style:x&&s.itemText,flex:y?1:x?3:1,children:(0,p.jsx)(r.default,Object.assign({},v,{children:(0,p.jsx)(i.Flex,{style:(0,d.stl)(y?s.itemVertical:s.itemHorizontal,j&&s.itemNew),justify:"center",children:x?(0,p.jsx)(i.Text,{style:c._.container.block,size:8,type:j?c._.select("plain","icon"):"icon",bold:f,align:"center",noWrap:!0,children:String((null==(m=o[t])?void 0:m.floor)||"").replace("#","")}):f?(0,p.jsx)(n.default,{style:s.dot}):null})}))},t)}))]})}),u.DEFAULT_PROPS,u.COMPONENT_MAIN,(function(e){return Object.assign({},e,{list:e.list.length})}))},"./src/screens/rakuen/topic/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.PRE_OFFSET=t.COMPONENT=void 0;var o=s("./src/stores/index.ts");t.COMPONENT="Topic",t.PRE_OFFSET=.2*o._.window.height},"./src/screens/rakuen/topic/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_SPA=t.TEXT_SHARE=t.TEXT_REPORT=t.TEXT_COPY=t.DATA=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/constants/index.ts"),n=s("./src/screens/rakuen/topic/ds.ts"),i=(t.COMPONENT=(0,o.rc)(n.COMPONENT,"Header"),t.TEXT_SPA="网页版查看"),c=t.TEXT_COPY="复制链接",d=t.TEXT_SHARE="复制分享",a=t.TEXT_REPORT="举报",l=t.DATA=[c,d,a];r.WEB||l.unshift(i)},"./src/screens/rakuen/topic/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.fixed.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(o(s("react")),s("./src/components/index.ts")),i=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),a=s("./src/constants/index.ts"),l=o(s("./src/screens/rakuen/topic/component/header-title/index.tsx")),u=o(s("./src/screens/rakuen/topic/component/icon/favor.tsx")),p=s("./src/screens/rakuen/topic/header/ds.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s,o=t.$,c=t.navigation,f=(null==(s=o.params)?void 0:s._url)||a.HOST+"/rakuen/topic/"+o.topicId;return(0,m.jsx)(n.Header,{mode:"transition",statusBarEventsType:"Topic",fixed:o.state.fixed,title:o.topic.title,alias:"帖子",hm:[f,"Topic"],headerTitle:(0,m.jsx)(l.default,{$:o,navigation:c}),headerRight:function(){return(0,m.jsxs)(n.Flex,{children:[(0,m.jsx)(u.default,{$:o}),(0,m.jsx)(n.Header.Popover,{data:["帖子 · "+o.topicId].concat((0,r.default)(p.DATA)),onSelect:function(e){switch((0,d.t)("帖子.右上角菜单",{key:e.includes("帖子")?"浏览器查看":e}),e){case p.TEXT_SPA:(0,i.open)(a.URL_SPA+"/"+(0,i.getSPAParams)("Topic",{topicId:o.topicId}));break;case p.TEXT_COPY:(0,i.copy)(f,"已复制链接");break;case p.TEXT_SHARE:(0,i.copy)("【链接】"+o.title+" | Bangumi番组计划\n"+f,"已复制分享文案");break;case p.TEXT_REPORT:(0,i.open)(a.HOST+"/group/forum");break;default:(0,i.open)(f)}},children:(0,m.jsx)(n.Heatmap,{id:"帖子.右上角菜单"})})]})}})}),p.COMPONENT)},"./src/screens/rakuen/topic/hooks.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.array.find-index.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.useTopicPage=function(e){var t=e.$,s=(0,p.useIsFocused)(),r=(0,p.useIsFocusedRef)(),j=(0,i.useRef)(null),h=(0,i.useRef)(null),b=(0,i.useRef)(0),_=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var s,o=t.comments.list[e];if((0,a.info)(null==o?void 0:o.floor,.8),m.WEB){var r;if(-1===e)return void(0,l.scrollToTop)();var n=null==(r=document.querySelector('item-post[data-key="'+o.id+'"]'))?void 0:r.offsetTop;return void(n&&(0,l.scrollToTop)(n-d._.headerHeight))}null==(s=j.current)||s.scrollToIndex({animated:!1,index:e,viewOffset:0})}catch(e){console.error("topic/index.js","scrollTo",e)}}),[t.comments]),y=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{(0,u.t)("帖子.楼层跳转",{topicId:t.topicId,index:e});var r=d.rakuenStore.setting.sliderAnimated;if(-1===e){var n;if(s&&(0,a.info)("#1",.8),m.WEB)(0,l.scrollToTop)();else null==(n=j.current)||n.scrollToOffset({animated:!!r||s,offset:0-d._.headerHeight});return(0,a.feedback)(!0),void t.updateDirection(-1,"")}var i=t.comments.list[e];if(s&&(0,a.info)(null==i?void 0:i.floor,.8),m.WEB){var c,p=null==(c=document.querySelector('item-post[data-key="'+i.id+'"]'))?void 0:c.offsetTop;p&&(0,l.scrollToTop)(p-d._.headerHeight)}else{var f;null==(f=j.current)||f.scrollToIndex({animated:!!r||s,index:e,viewOffset:0+d._.headerHeight+o})}(0,a.feedback)(!0)}catch(e){console.error("topic/index.js","onScrollTo",e);try{var h,b,_=null==(h=String(e).match(/but maximum is (\d+)/))?void 0:h[1];if(_)s&&(0,a.info)("#"+_,.5),null==(b=j.current)||b.scrollToIndex({animated:s,index:Number(_),viewOffset:0+d._.headerHeight})}catch(e){}}}),[t]),x=(0,i.useCallback)((function(e){var t=e.highestMeasuredFrameIndex,s=e.index;try{_(t),setTimeout((function(){b.current>=8||(b.current+=1,_(s))}),100)}catch(e){console.error("topic/index.js","onScrollToIndexFailed",e)}}),[_]),v=(0,i.useCallback)((function(e){console.info("onJumpTo",e);var s=e||t.postId;if(s){var o=t.comments,r=o.list;if(o._loaded)try{var n;r.forEach((function(e,t){n||(e.id===s?(n=t,console.info("scrollIndex",n)):e.sub&&e.sub.forEach((function(e){e.id===s&&(n=t,console.info("scrollIndex sub",n))})))})),void 0!==n&&_(n)}catch(e){console.error("topic/index.js","onJumpTo",e)}}}),[t.comments,t.postId,_]),g=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{y(e);var s=t.directItems.findIndex((function(t){return t.floor==="#"+(e+1)}));s&&-1!==s&&t.updateDirection(s)}catch(e){console.error("topic/index.js","onFloorPress",e)}}),[t,y]),O=(0,i.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{var o=t.directItems.length;if(!t.directItems.length)return;var r=t.state.directIndex,n=Math.min(o-1,Math.max(0,r+(e?1:-1)*s));if(0===r&&0===n||-1===r&&0===n&&!e)return void y(-1,!1);var i=t.directItems[n];if(!i)return;var l=i.index,u=i.floor,p=f.PRE_OFFSET;if(1===l.length)y(l[0],!1,p),s>1&&(0,a.info)(u,.8);else{var m=d.rakuenStore.setting.subExpand;l[1]>Number(m)-1&&t.onExpand(i.pid),setTimeout((function(){var e=i.pid,t=i.sibling;p+=f.PRE_OFFSET,p-=c.layoutHeightMap.get(e)||0,t.forEach((function(e){p-=c.layoutHeightMap.get(e)||0})),y(l[0],!1,p),s>1&&(0,a.info)(u,.8)}),40)}t.updateDirection(n,u)}catch(e){console.error("topic/index.js","onDirect",e)}}),[t,y]),T=(0,i.useCallback)((function(){try{var e;null==(e=h.current)||e.onFocus()}catch(e){console.error("topic/index.js","onShowFixedTextarea",e)}}),[]);return(0,p.useRunAfter)((0,n.default)(o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,a.androidKeyboardAdjust)("setAdjustResize"),setTimeout((function(){r.current&&t.setRendered(!0)}),400),e.next=4,t.init();case 4:t.postId&&v();case 5:case"end":return e.stop()}}),e)})))),(0,p.useKeyboardAdjustResize)(),(0,i.useEffect)((function(){s||(d.uiStore.closePopableSubject(),d.uiStore.closeLikesGrid())}),[s]),(0,p.useMount)((function(){return function(){setTimeout((function(){t.setState({fixed:!1})}),480)}})),{fixedTextareaRef:h,forwardRef:j,onDirect:O,onFloorPress:g,onJumpTo:v,onScrollToIndexFailed:x,onShowFixedTextarea:T}};var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=s("react"),c=s("./src/screens/_/item/post/utils.ts"),d=s("./src/stores/index.ts"),a=s("./src/utils/index.ts"),l=s("./src/utils/dom/index.ts"),u=s("./src/utils/fetch/index.ts"),p=s("./src/utils/hooks/index.ts"),m=s("./src/constants/index.ts"),f=s("./src/screens/rakuen/topic/ds.ts")},"./src/screens/rakuen/topic/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),i=s("./src/utils/decorators/index.ts"),c=s("./src/utils/hooks/index.ts"),d=o(s("./src/screens/rakuen/topic/component/bottom/index.tsx")),a=o(s("./src/screens/rakuen/topic/component/heatmaps/index.tsx")),l=o(s("./src/screens/rakuen/topic/component/list/index.tsx")),u=o(s("./src/screens/rakuen/topic/component/touch-scroll/index.tsx")),p=o(s("./src/screens/rakuen/topic/header/index.tsx")),m=s("./src/screens/rakuen/topic/hooks.ts"),f=o(s("./src/screens/rakuen/topic/store/index.ts"));s("./src/screens/rakuen/topic/styles.web.ts");var j=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.ic)(f.default,(function(e,t){var s=(0,m.useTopicPage)(t),o=s.forwardRef,i=s.fixedTextareaRef,f=s.onFloorPress,h=s.onShowFixedTextarea,b=s.onScrollToIndexFailed,_=s.onDirect;return(0,c.useObserver)((function(){return(0,j.jsxs)(r.Component,{id:"screen-topic",children:[(0,j.jsx)(n.TapListener,{children:(0,j.jsxs)(r.Page,{statusBarEvent:!1,children:[(0,j.jsx)(l.default,{forwardRef:o,onScrollToIndexFailed:b,onShowFixedTextarea:h}),(0,j.jsx)(u.default,{onPress:f})]})}),(0,j.jsx)(p.default,{}),(0,j.jsx)(d.default,{fixedTextareaRef:i,onDirect:_}),(0,j.jsx)(a.default,{})]})}))}))},"./src/screens/rakuen/topic/store/action.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.array.reverse.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.function.bind.js"),s("./node_modules/core-js/modules/es.string.fixed.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.array.is-array.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.array.map.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=r(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),c=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),a=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),p=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),j=s("./src/components/header/utils.tsx"),h=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),_=r(s("./src/utils/cache-manager/index.ts")),y=s("./src/utils/fetch/index.ts"),x=s("./src/utils/kv/index.ts"),v=r(s("./src/utils/thirdParty/html-entities-decoder.ts")),g=s("./src/constants/index.ts"),O=r(s("./src/screens/rakuen/topic/store/fetch.ts")),T=s("./src/screens/rakuen/topic/store/ds.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,p.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=k(s);function s(){var e,r,d;(0,a.default)(this,s);for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return e=t.call.apply(t,[this].concat(p)),(0,f.default)((0,l.default)(e),"cacheAvatars",(function(){e.comments.list.forEach((function(e){var t="avatar|"+e.userId;_.default.has(t)||_.default.set(t,e.avatar),e.sub.forEach((function(e){var t="avatar|"+e.userId;_.default.has(t)||_.default.set(e.userId,e.avatar)}))}))})),(0,f.default)((0,l.default)(e),"toggleReverseComments",(function(){var t=e.state.reverse;(0,y.t)("帖子.吐槽倒序",{topicId:e.topicId,reverse:!t}),e.setState({reverse:!t}),e.setStorage(T.NAMESPACE)})),(0,f.default)((0,l.default)(e),"onFilterClear",(function(){e.setState({filterType:"",filterPost:""}),e.save(),(0,b.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterLikes",(function(){(0,y.t)("帖子.贴贴相关",{topicId:e.topicId}),e.setState({filterType:"likes",filterPost:""}),e.save(),(0,b.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterMe",(function(){(0,y.t)("帖子.与我相关",{topicId:e.topicId}),e.setState({filterType:"me",filterPost:""}),e.save(),(0,b.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterFriends",(function(){(0,y.t)("帖子.好友相关",{topicId:e.topicId}),e.setState({filterType:"friends",filterPost:""}),e.save(),(0,b.feedback)()})),(0,f.default)((0,l.default)(e),"clearFilterPost",(function(){e.setState({filterPost:""})})),(0,f.default)((0,l.default)(e),"showFixedTextarea",(function(t,s,o,r){(0,y.t)("帖子.显示评论框",{topicId:e.topicId});var n="";if(t&&(n="回复 "+t+"："),r){var i=(0,b.HTMLDecode)((0,b.removeHTMLTag)(r,!1));i.length>=64&&(i=i.slice(0,64)+"..."),n+=i}e.setState({placeholder:n,replySub:s,message:o})})),(0,f.default)((0,l.default)(e),"closeFixedTextarea",(function(){e.setState({placeholder:"",replySub:"",message:"",editPostId:""})})),(0,f.default)((0,l.default)(e),"showFixedTextareaEdit",(r=(0,c.default)(o.mark((function t(s,r){var n,i;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.rakuenStore.fetchTopicEdit(s,null==(n=String(e.topicId).split("/"))?void 0:n[0]);case 2:if(!0!==(i=t.sent)){t.next=6;break}return(0,b.info)("此楼层不再允许修改，可能已被回复过"),t.abrupt("return");case 6:if(i){t.next=9;break}return(0,b.info)("未能获取到回复内容，可能授权过期了"),t.abrupt("return");case 9:e.setState({value:""}),setTimeout((function(){e.setState({editPostId:s,value:i}),r()}),0);case 11:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})),(0,f.default)((0,l.default)(e),"onChange",(function(t){e.setState({value:t})})),(0,f.default)((0,l.default)(e),"recoveryContent",(function(t){(0,y.t)("帖子.回复失败",{topicId:e.topicId}),(0,b.info)("回复失败，可能是cookie失效了"),e.setState({value:""}),setTimeout((function(){e.setState({value:t})}),160)})),(0,f.default)((0,l.default)(e),"setFavor",(0,c.default)(o.mark((function t(){var s,r,n,i,c,d;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=!e.isFavor,t.next=3,h.rakuenStore.setFavorV2(e.topicId,s);case 3:200===(null==(r=t.sent)?void 0:r.code)&&((0,y.t)("帖子.设置收藏",{topicId:e.topicId,isFavor:s}),s&&(i={avatar:e.avatar,userId:e.userId,userName:e.userName,title:e.title,group:e.group,time:e.time},null!=(n=i.avatar)&&n.includes("icon.jpg")&&(i.avatar=e.groupThumb),e.topicId.includes("ep/")&&(d=null==(c=String(e.epFormHTML).match(/\/ 首播:(.+?)<\/span>/))?void 0:c[1])&&(i.time="首播:"+d),(0,x.update)("favor_"+e.topicId.replace("/","_"),i)));case 5:case"end":return t.stop()}}),t)})))),(0,f.default)((0,l.default)(e),"updateShowHeaderTitle",(function(t){e.setState({showHeaderTitle:t})})),(0,f.default)((0,l.default)(e),"toggleExpand",(function(t){var s=e.state.expands;e.setState({expands:s.includes(t)?s.filter((function(e){return e!==t})):[].concat((0,i.default)(s),[t])}),e.save()})),(0,f.default)((0,l.default)(e),"onExpand",(function(t){e.state.expands.includes(String(t))||e.toggleExpand(String(t))})),(0,f.default)((0,l.default)(e),"updateDirection",(function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.setState({directIndex:t,directFloor:s}),e.save()})),(0,f.default)((0,l.default)(e),"updateVisibleBottom",b.updateVisibleBottom.bind((0,l.default)(e))),(0,f.default)((0,l.default)(e),"onScrollY",0),(0,f.default)((0,l.default)(e),"onScroll",(function(t){e.updateVisibleBottom(t),h.uiStore.closePopableSubject(),h.uiStore.closeLikesGrid();var s=t.nativeEvent.contentOffset.y;e.onScrollY=s;var o=e.state.fixed;o&&s>j.HEADER_TRANSITION_HEIGHT||!o&&s<=j.HEADER_TRANSITION_HEIGHT||e.setState({fixed:s>j.HEADER_TRANSITION_HEIGHT})})),(0,f.default)((0,l.default)(e),"setRendered",(function(t){e.setState({rendered:t})})),(0,f.default)((0,l.default)(e),"doSubmit",(function(t){var s;if(e.topicId.includes("group/"))s="group/topic";else if(e.topicId.includes("subject/"))s="subject/topic";else if(e.topicId.includes("ep/"))s="subject/ep";else if(e.topicId.includes("crt/"))s="character";else{if(!e.topicId.includes("prsn/"))return;s="person"}var o=e.state,r=o.replySub,n=o.editPostId;n?e.doEditReply(n,t):r?e.doReplySub(t,s):e.doReply(t,s)})),(0,f.default)((0,l.default)(e),"doEditReply",(function(t,s){var r;(0,y.t)("帖子.编辑回复",{topicId:e.topicId,postId:t});var n=e.topic.formhash;h.rakuenStore.doEditReply({postId:t,topicType:null==(r=String(e.topicId).split("/"))?void 0:r[0],content:s,formhash:n},(0,c.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({value:"",editPostId:""}),t.next=3,e.fetchTopic();case 3:(0,b.feedback)();case 4:case"end":return t.stop()}}),t)}))))})),(0,f.default)((0,l.default)(e),"doReply",(function(t,s){(0,y.t)("帖子.回复",{topicId:e.topicId,sub:!1});var o=e.topic.formhash;h.rakuenStore.doReply({type:s,topicId:e.topicId.match(/\d+/g)[0],content:t,formhash:o},(function(s){var o={};try{o=JSON.parse(s)}catch(e){}g.IOS&&"ok"!==o.status?e.recoveryContent(t):e.setState({value:""}),(0,b.feedback)(),e.fetchTopic()}))})),(0,f.default)((0,l.default)(e),"doReplySub",(function(t,s){(0,y.t)("帖子.回复",{topicId:e.topicId,sub:!0});var o=e.state,r=o.placeholder,i=o.replySub,c=o.message,d=e.topic.formhash,a=i.split(","),l=(0,n.default)(a,6),u=l[1],p=l[2],m=l[4],f=l[5],j=t;if(c){var _=(0,v.default)(c).replace(/<div class="quote"><q>.*<\/q><\/div>/,"");j="[quote][b]"+r+"[/b] 说: "+(0,b.removeHTMLTag)(_,!1)+"[/quote]\n"+t}h.rakuenStore.doReply({type:s,content:j,formhash:d,topicId:String(u||"").trim(),related:String(p||"").trim(),sub_reply_uid:String(m||"").trim(),post_uid:String(f||"").trim()},(function(s){var o={};try{o=JSON.parse(s)}catch(e){}g.IOS&&"ok"!==o.status?e.recoveryContent(t):e.setState({value:""}),(0,b.feedback)(),e.fetchTopic()}))})),(0,f.default)((0,l.default)(e),"doDeleteReply",(function(t){t&&((0,y.t)("帖子.删除回复",{topicId:e.topicId}),h.rakuenStore.doDeleteReply({url:g.HOST+"/"+t},(function(){(0,b.feedback)(),(0,b.info)("已删除"),e.fetchTopic()})))})),(0,f.default)((0,l.default)(e),"doTranslate",(0,c.default)(o.mark((function t(){var s,r,n,i;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.translateResult.length){t.next=2;break}return t.abrupt("return");case 2:return(0,y.t)("帖子.翻译内容",{topicId:e.topicId}),t.prev=3,s=(0,b.loading)(),t.next=7,(0,y.baiduTranslate)(String(e.title+"\n"+e.html).replace(/<br \/>/g,"\n").replace(/<\/?[^>]*>/g,""));case 7:if(r=t.sent,s(),n=JSON.parse(r),i=n.trans_result,!Array.isArray(i)){t.next=13;break}return e.setState({translateResult:i}),t.abrupt("return");case 13:(0,b.info)("翻译失败, 请重试"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(3),s&&s(),(0,b.info)("翻译失败, 请重试");case 20:case"end":return t.stop()}}),t,null,[[3,16]])})))),(0,f.default)((0,l.default)(e),"doTranslateFloor",(d=(0,c.default)(o.mark((function t(s,r){var n,i,c,d,a;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.state.translateResultFloor)[s]){t.next=3;break}return t.abrupt("return");case 3:return(0,y.t)("帖子.翻译内容",{floorId:s}),t.prev=4,i=(0,b.loading)(),t.next=8,(0,y.baiduTranslate)((0,b.removeHTMLTag)(r.replace(/<br>/g,"\n"),!1));case 8:if(c=t.sent,i(),d=JSON.parse(c),a=d.trans_result,!Array.isArray(a)){t.next=14;break}return e.setState({translateResultFloor:Object.assign({},n,(0,f.default)({},s,a.map((function(e){return e.dst})).join("\n")))}),t.abrupt("return");case 14:(0,b.info)("翻译失败, 请重试"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),i&&i(),(0,b.info)("翻译失败, 请重试");case 21:case"end":return t.stop()}}),t,null,[[4,17]])}))),function(e,t){return d.apply(this,arguments)})),e}return(0,d.default)(s)}(O.default)},"./src/screens/rakuen/topic/store/computed.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.array.reverse.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.array.find-index.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.index-of.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=o(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),c=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),a=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=o(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=s("./node_modules/mobx/dist/mobx.esm.js"),h=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),_=o(s("./src/utils/cache-manager/index.ts")),y=s("./src/constants/index.ts"),x=o(s("./src/screens/rakuen/topic/store/state.ts")),v=s("./src/screens/rakuen/topic/store/ds.ts");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,p.default)(e);if(t){var r=(0,p.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,u.default)(this,s)}}t.default=(r=function(e){(0,l.default)(s,e);var t=g(s);function s(){var e;(0,c.default)(this,s);for(var o=arguments.length,r=new Array(o),n=0;n<o;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),(0,m.default)((0,a.default)(e),"save",(function(){return e.saveStorage(e.namespace,v.EXCLUDE_STATE)})),e}return(0,d.default)(s,[{key:"topicId",get:function(){var e,t=this.params.topicId,s=void 0===t?"":t;return s?(null==(e=s.split("#"))?void 0:e[0])||"":"0"}},{key:"postId",get:function(){var e,t=this.params.topicId;return null==(e=(void 0===t?"":t).split("#post_"))?void 0:e[1]}},{key:"namespace",get:function(){return v.NAMESPACE+"|"+this.topicId}},{key:"topic",get:function(){return(0,b.freeze)(h.rakuenStore.topic(this.topicId))}},{key:"topicFromOSS",get:function(){return this.state.topic}},{key:"comments",get:function(){var e=this;return(0,b.freeze)((function(){if(e.state.filterPost){var t=h.rakuenStore.comments(e.topicId);return Object.assign({},t,{list:t.list.filter((function(t){if(t.id===e.state.filterPost)return!0;var s=!1;return t.sub.forEach((function(t){t.id===e.state.filterPost&&(s=!0)})),s})),pagination:{page:1,pageTotal:1}})}var s=e.state,o=s.reverse,r=s.filterType,n=h.rakuenStore.comments(e.topicId),c=n._loaded?n:e.state.comments,d=c.list;if(o&&(d=c.list.slice().reverse()),h.systemStore.setting.filterDefault&&(d=d.filter((function(e){var t;return!(null!=(t=e.avatar)&&t.includes(y.URL_DEFAULT_AVATAR))})).map((function(e){return Object.assign({},e,{sub:e.sub.filter((function(e){var t;return!(null!=(t=e.avatar)&&t.includes(y.URL_DEFAULT_AVATAR))}))})}))),"likes"===r){var a=(0,i.default)(e.likesFloorIds||[]);return a.length?Object.assign({},c,{list:d.filter((function(e){if(a.includes(e.id))return!0;var t=!1;return e.sub.forEach((function(e){a.includes(e.id)&&(t=!0)})),t})),pagination:{page:1,pageTotal:1}}):Object.assign({},c,{list:d})}return"me"===r?Object.assign({},c,{list:d.filter((function(e){return-1!==e.sub.findIndex((function(e){return e.userId===h.userStore.myId}))||e.userId===h.userStore.myId})),pagination:{page:1,pageTotal:1}}):"friends"===r?Object.assign({},c,{list:d.filter((function(t){return-1!==t.sub.findIndex((function(t){return e.myFriendsMap[t.userId]}))||e.myFriendsMap[t.userId]})),pagination:{page:1,pageTotal:1}}):Object.assign({},c,{list:d})}))}},{key:"commentMeCount",get:function(){return h.rakuenStore.comments(this.topicId).list.filter((function(e){return-1!==e.sub.findIndex((function(e){return e.userId===h.userStore.myId}))||e.userId===h.userStore.myId})).length}},{key:"commentFriendsCount",get:function(){var e=this;return h.rakuenStore.comments(this.topicId).list.filter((function(t){return-1!==t.sub.findIndex((function(t){return e.myFriendsMap[t.userId]}))||e.myFriendsMap[t.userId]})).length}},{key:"likesFloorIds",get:function(){return(0,b.freeze)(Object.keys(h.rakuenStore.likes(this.topicId)))}},{key:"directItems",get:function(){var e=this;return(0,b.freeze)((function(){var t="directItems|"+e.topicId+"|"+e.comments._loaded;if(_.default.get(t))return _.default.get(t);var s=[];return e.comments.list.forEach((function(e,t){s.push({id:Number(e.id),floor:e.floor,index:[t]});var o=[];e.sub.forEach((function(r,n){o.push(Number(r.id)),s.push({pid:Number(e.id),id:Number(r.id),floor:r.floor,index:[t,n],sibling:[].concat(o)})}))})),s.sort((function(e,t){return(0,b.asc)(e.id,t.id)})),_.default.set(t,s)}))}},{key:"isEp",get:function(){return 0===this.topicId.indexOf("ep/")}},{key:"isMono",get:function(){return 0===this.topicId.indexOf("crt/")||0===this.topicId.indexOf("prsn/")}},{key:"monoId",get:function(){return 0===this.topicId.indexOf("crt/")?this.topicId.replace("crt/","character/"):0===this.topicId.indexOf("prsn/")?this.topicId.replace("prsn/","person/"):this.topicId}},{key:"epFormHTML",get:function(){return h.subjectStore.epFormHTML(this.topicId.replace("ep/",""))}},{key:"readed",get:function(){return h.rakuenStore.readed(this.topicId)}},{key:"myFriendsMap",get:function(){return(0,b.freeze)(h.usersStore.myFriendsMap)}},{key:"isFavor",get:function(){return h.rakuenStore.favorV2(this.topicId)}},{key:"favorCount",get:function(){return h.rakuenStore.favorCount(this.topicId)}},{key:"postUsersMap",get:function(){var e={};return h.rakuenStore.comments(this.topicId).list.forEach((function(t){e[t.userName]||(e[t.userName]={userId:t.userId,userName:t.userName,avatar:t.avatar}),t.sub.forEach((function(t){e[t.userName]||(e[t.userName]={userId:t.userId,userName:t.userName,avatar:t.avatar})}))})),(0,b.freeze)(e)}},{key:"isBlockUser",value:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,j.computed)((function(){return-1!==h.rakuenStore.blockUserIds.findIndex((function(o){var r=o.split("@"),i=(0,n.default)(r,2),c=i[0],d=i[1];if("undefined"===d)return c===t;if(s){var a=s.split(",");if(7===a.length&&d==a[5])return!0}return d==e||c===t}))})).get()}},{key:"title",get:function(){return(0,b.HTMLDecode)(("undefined"===this.topic.title?"":this.topic.title)||this.params._title||this.topicFromOSS.title||"")}},{key:"subTitle",get:function(){if(!this.topicId.includes("ep/"))return"";var e=(0,b.HTMLDecode)(this.params._title||"");return e===this.title?"":e}},{key:"group",get:function(){return this.isMono?this.topic.title||this.params._title:this.topic.group||this.params._group||this.topicFromOSS.group||""}},{key:"groupThumb",get:function(){var e=this.params,t=e._group,s=e._groupThumb;return s||(t?h.rakuenStore.groupThumb(t):this.topic.groupThumb||this.topicFromOSS.groupThumb||"")}},{key:"groupHref",get:function(){return this.topic.groupHref||this.topicFromOSS.groupHref||""}},{key:"time",get:function(){return this.topic.time||this.topicFromOSS.time||""}},{key:"avatar",get:function(){return this.topic.avatar||this.params._avatar||this.topicFromOSS.avatar||""}},{key:"userId",get:function(){return this.topic.userId||this.params._userId||this.topicFromOSS.userId||""}},{key:"userName",get:function(){return(0,b.HTMLDecode)(this.topic.userName||this.params._userName||this.topicFromOSS.userName||"")}},{key:"userSign",get:function(){return this.topic.userSign||this.topicFromOSS.userSign||""}},{key:"html",get:function(){return this.isEp?this.epFormHTML||this.params._desc:(this.topic.message||this.topicFromOSS.message||"").replace(/(<br\s*\/?>){3,}/g,"<br><br>")}}]),s}(x.default),(0,f.default)(r.prototype,"topicId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicId"),r.prototype),(0,f.default)(r.prototype,"postId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"postId"),r.prototype),(0,f.default)(r.prototype,"namespace",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"namespace"),r.prototype),(0,f.default)(r.prototype,"topic",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topic"),r.prototype),(0,f.default)(r.prototype,"topicFromOSS",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicFromOSS"),r.prototype),(0,f.default)(r.prototype,"comments",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"comments"),r.prototype),(0,f.default)(r.prototype,"commentMeCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"commentMeCount"),r.prototype),(0,f.default)(r.prototype,"commentFriendsCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"commentFriendsCount"),r.prototype),(0,f.default)(r.prototype,"likesFloorIds",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"likesFloorIds"),r.prototype),(0,f.default)(r.prototype,"directItems",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"directItems"),r.prototype),(0,f.default)(r.prototype,"isEp",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isEp"),r.prototype),(0,f.default)(r.prototype,"isMono",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isMono"),r.prototype),(0,f.default)(r.prototype,"monoId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"monoId"),r.prototype),(0,f.default)(r.prototype,"epFormHTML",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"epFormHTML"),r.prototype),(0,f.default)(r.prototype,"readed",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"readed"),r.prototype),(0,f.default)(r.prototype,"myFriendsMap",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"myFriendsMap"),r.prototype),(0,f.default)(r.prototype,"isFavor",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isFavor"),r.prototype),(0,f.default)(r.prototype,"favorCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"favorCount"),r.prototype),(0,f.default)(r.prototype,"postUsersMap",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"postUsersMap"),r.prototype),(0,f.default)(r.prototype,"title",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"title"),r.prototype),(0,f.default)(r.prototype,"subTitle",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"subTitle"),r.prototype),(0,f.default)(r.prototype,"group",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"group"),r.prototype),(0,f.default)(r.prototype,"groupThumb",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"groupThumb"),r.prototype),(0,f.default)(r.prototype,"groupHref",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"groupHref"),r.prototype),(0,f.default)(r.prototype,"time",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"time"),r.prototype),(0,f.default)(r.prototype,"avatar",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"avatar"),r.prototype),(0,f.default)(r.prototype,"userId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userId"),r.prototype),(0,f.default)(r.prototype,"userName",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userName"),r.prototype),(0,f.default)(r.prototype,"userSign",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userSign"),r.prototype),(0,f.default)(r.prototype,"html",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"html"),r.prototype),r)},"./src/screens/rakuen/topic/store/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=void 0;var o=s("./src/stores/index.ts"),r=s("./src/constants/index.ts"),n=(t.NAMESPACE="ScreenTopic",t.EXCLUDE_STATE={fixed:!1,rendered:r.WEB,visibleBottom:o._.window.height,showHeaderTitle:!1,placeholder:"",value:"",replySub:"",editPostId:"",message:"",translateResult:[],translateResultFloor:{},topic:{_loaded:0},comments:{list:[],pagination:{page:0,pageTotal:0},_list:[],_loaded:0},filterPost:""});t.STATE=Object.assign({},n,{expands:[],filterType:"",reverse:!1,favor:{favored:!1,count:0,_loaded:0},directIndex:-1,directFloor:"",_loaded:!1})},"./src/screens/rakuen/topic/store/fetch.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.string.sub.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s("./src/stores/index.ts"),f=s("./src/utils/index.ts"),j=s("./src/utils/kv/index.ts"),h=r(s("./src/utils/thirdParty/html-entities-decoder.ts")),b=s("./src/constants/index.ts"),_=r(s("./src/screens/rakuen/topic/store/computed.ts"));function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}t.default=function(e){(0,a.default)(s,e);var t=y(s);function s(){var e;(0,c.default)(this,s);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),(0,p.default)((0,d.default)(e),"fetchTopic",(function(){return m.rakuenStore.fetchTopic({topicId:e.topicId})})),(0,p.default)((0,d.default)(e),"fetchEpFormHTML",(function(){var t=e.topicId.replace("ep/","");return m.subjectStore.fetchEpFormHTML(t)})),(0,p.default)((0,d.default)(e),"fetchTopicFromOSS",(0,n.default)(o.mark((function t(){var s,r,n,i,c,d,a,l;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.topic._loaded){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,(0,j.get)("topic_"+e.topicId.replace("/","_"));case 5:if(s=t.sent){t.next=9;break}return e.updateTopicThirdParty(),t.abrupt("return");case 9:r=s.ts,n=s.topic,i=s.comments,c=(0,f.getTimestamp)(),"object"==typeof n&&"object"==typeof i&&(l={topic:Object.assign({},n,{_loaded:c})},null!=i&&null!=(d=i.list)&&null!=(a=d[0])&&a.floor&&(i.list.length>=2&&1===i.list[0].floor.localeCompare(i.list[1].floor)||(l.comments=Object.assign({},i,{_loaded:c}))),e.setState(l)),c-r>=4*b.H&&e.updateTopicThirdParty(),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(2);case 17:case"end":return t.stop()}}),t,null,[[2,15]])})))),(0,p.default)((0,d.default)(e),"updateTopicThirdParty",(function(){setTimeout((function(){var t=e.topic,s=t._loaded,o=t.formhash;if(s&&o)try{(0,j.update)("topic_"+e.topicId.replace("/","_"),{topic:(0,f.omit)(e.topic,["formhash","lastview","close","_loaded"]),comments:Object.assign({},e.comments,{list:e.comments.list.filter((function(e,t){return t<16})).map((function(e){return Object.assign({},(0,f.omit)(e,["replySub","erase","message","sub"]),{message:(0,h.default)(e.message),sub:e.sub.filter((function(e,t){return t<8})).map((function(e){return Object.assign({},(0,f.omit)(e,["replySub","erase","message"]),{message:(0,h.default)(e.message)})}))})}))})})}catch(e){}}),1e4)})),e}return(0,i.default)(s)}(_.default)},"./src/screens/rakuen/topic/store/index.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.reverse.js"),s("./node_modules/core-js/modules/web.timers.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s("./src/stores/index.ts"),f=s("./src/utils/index.ts"),j=r(s("./src/screens/rakuen/topic/store/action.ts")),h=s("./src/screens/rakuen/topic/store/ds.ts");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}var _=!1,y=function(e){(0,a.default)(s,e);var t=b(s);function s(){var e;(0,c.default)(this,s);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),(0,p.default)((0,d.default)(e),"init",(0,n.default)(o.mark((function t(){var s,r,n,i,c;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.state._loaded,r=(0,f.getTimestamp)(),n=!s||r-Number(s)>60,t.next=5,e.getStorage(h.NAMESPACE);case 5:return i=t.sent,t.prev=6,t.t0=Object,t.t1={},t.next=11,e.getStorage(e.namespace);case 11:if(t.t2=t.sent,t.t3=h.EXCLUDE_STATE,t.t4={reverse:i.reverse,_loaded:n?r:s},c=t.t0.assign.call(t.t0,t.t1,t.t2,t.t3,t.t4),e.postId&&(c.filterType="",c.filterPost=e.postId),e.setState(c),e.fetchTopicFromOSS(),_||(m.rakuenStore.getFavor(),_=!0),!n){t.next=28;break}if(e.isEp?e.fetchEpFormHTML():m.rakuenStore.checkIsFavor(e.topicId),m.usersStore.updateFriendsMap(),e.params._noFetch){t.next=28;break}return t.next=26,e.fetchTopic();case 26:return setTimeout((function(){e.cacheAvatars()}),0),t.abrupt("return",!0);case 28:t.next=33;break;case 30:t.prev=30,t.t5=t.catch(6),e.setState(Object.assign({},h.EXCLUDE_STATE,{reverse:i.reverse,_loaded:n?r:s}));case 33:return t.abrupt("return",!0);case 34:case"end":return t.stop()}}),t,null,[[6,30]])})))),e}return(0,i.default)(s)}(j.default);t.default=y},"./src/screens/rakuen/topic/store/state.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),n=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),l=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),u=s("./node_modules/mobx/dist/mobx.esm.js"),p=o(s("./src/utils/store/index.ts")),m=s("./src/screens/rakuen/topic/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var r=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,d.default)(this,s)}}t.default=function(e){(0,c.default)(s,e);var t=f(s);function s(){var e;(0,n.default)(this,s);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),(0,l.default)((0,i.default)(e),"params",void 0),(0,l.default)((0,i.default)(e),"state",(0,u.observable)(m.STATE)),e}return(0,r.default)(s)}(p.default)},"./src/screens/rakuen/topic/styles.web.ts":(e,t,s)=>{s("./src/screens/rakuen/topic/index.scss")},"./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[7].use[3]!./src/screens/rakuen/topic/index.scss":(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var o=s("./node_modules/css-loader/dist/runtime/sourceMaps.js"),r=s.n(o),n=s("./node_modules/css-loader/dist/runtime/api.js"),i=s.n(n)()(r());i.push([e.id,"screen-topic-touch-scroll{position:static !important}screen-topic-touch-scroll>div>div{cursor:pointer}screen-topic-touch-scroll>div>div:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-color:rgba(255,255,255,0.16);border-radius:4px;opacity:0;transition:opacity 0.2s;pointer-events:none}screen-topic-touch-scroll>div>div:hover:after{opacity:1}\n","",{version:3,sources:["webpack://./src/screens/rakuen/topic/index.scss"],names:[],mappings:"AAOE,0BACE,0BAA2B,CAD5B,kCAIG,cAAe,CAJlB,wCAOK,UAAW,CACX,iBAAkB,CAClB,KAAM,CACN,OAAQ,CACR,QAAS,CACT,MAAO,CACP,uCAA2C,CAC3C,iBAAkB,CAClB,SAAU,CACV,uBAAwB,CACxB,mBAAoB,CAjBzB,8CAoBK,SAAU",sourcesContent:["/*\n * @Author: czy0729\n * @Date: 2024-09-03 13:25:03\n * @Last Modified by:   czy0729\n * @Last Modified time: 2024-09-03 13:25:03\n */\nscreen-topic {\n  &-touch-scroll {\n    position: static !important;\n\n    > div > div {\n      cursor: pointer;\n\n      &:after {\n        content: '';\n        position: absolute;\n        top: 0;\n        right: 0;\n        bottom: 0;\n        left: 0;\n        background-color: rgba(255, 255, 255, 0.16);\n        border-radius: 4px;\n        opacity: 0;\n        transition: opacity 0.2s;\n        pointer-events: none;\n      }\n      &:hover:after {\n        opacity: 1;\n      }\n    }\n  }\n}\n"],sourceRoot:""}]);const c=i},"./src/screens/rakuen/topic/index.scss":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var o=s("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),r=s.n(o),n=s("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),i=s.n(n),c=s("./node_modules/style-loader/dist/runtime/insertBySelector.js"),d=s.n(c),a=s("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),l=s.n(a),u=s("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),p=s.n(u),m=s("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),f=s.n(m),j=s("./node_modules/css-loader/dist/cjs.js!./node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[7].use[3]!./src/screens/rakuen/topic/index.scss"),h={};h.styleTagTransform=f(),h.setAttributes=l(),h.insert=d().bind(null,"head"),h.domAPI=i(),h.insertStyleElement=p();r()(j.Z,h);const b=j.Z&&j.Z.locals?j.Z.locals:void 0}}]);