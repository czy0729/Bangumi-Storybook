(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5285],{"./src/screens/user/friends/component/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/user/friends/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"Component")},"./src/screens/user/friends/component/filter/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"Filter")},"./src/screens/user/friends/component/filter/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.filter.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),d=r("./src/stores/index.ts"),i=r("./src/utils/decorators/index.ts"),u=r("./src/screens/user/friends/component/filter/ds.ts"),c=r("./src/screens/user/friends/component/filter/styles.ts"),l=r("./node_modules/react/jsx-runtime.js");s.default=(0,i.obc)((function(e,s){var r=s.$,t=(0,c.memoStyles)();return(0,l.jsxs)(n.default,{style:t.filter,children:[(0,l.jsx)(o.Input,{style:t.input,clearButtonMode:"never",defaultValue:r.state.filter,placeholder:r.friends.list.length+"个好友",onChangeText:r.onFilterChange}),r.state.fetching&&(0,l.jsx)(n.default,{style:t.loading,children:(0,l.jsx)(o.Loading.Medium,{color:d._.colorSub,size:16})})]})}),u.COMPONENT);try{filter.displayName="filter",filter.__docgenInfo={description:"",displayName:"filter",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/component/filter/index.tsx#filter"]={docgenInfo:filter.__docgenInfo,name:"filter",path:"src/screens/user/friends/component/filter/index.tsx#filter"})}catch(e){}},"./src/screens/user/friends/component/filter/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{filter:{height:56,paddingVertical:10,paddingHorizontal:t._.wind,backgroundColor:t._.colorBg},input:Object.assign({height:36,paddingVertical:0},t._.fontSize(16),{fontWeight:"800",textAlign:"center",backgroundColor:t._.select(t._.colorBorder,t._.colorPlain),borderRadius:40}),loading:{position:"absolute",zIndex:2,top:20,right:16,width:44,height:44}}}))},"./src/screens/user/friends/component/item-grid/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"ItemGrid")},"./src/screens/user/friends/component/item-grid/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),d=r("./src/screens/_/index.ts"),i=r("./src/stores/index.ts"),u=r("./src/utils/index.ts"),c=r("./src/utils/decorators/index.ts"),l=r("./src/utils/fetch/index.ts"),a=r("./src/screens/user/friends/component/item-grid/ds.ts"),f=r("./src/screens/user/friends/component/item-grid/styles.ts"),m=r("./node_modules/react/jsx-runtime.js");s.default=(0,c.obc)((function(e,s){var r=e.index,t=e.item,c=s.navigation,a=(0,f.memoStyles)(),p=t.userId,_=t.avatar,j=t.userName;return(0,m.jsx)(n.default,{style:(0,u.stl)(a.item,r%i._.portrait(5,8)==0&&a.left),children:(0,m.jsxs)(o.Touchable,{animate:!0,scale:.9,onPress:function(){(0,l.t)("好友.跳转",{to:"Zone",userId:p}),c.push("Zone",{userId:p,_name:j,_image:_})},children:[(0,m.jsx)(o.Avatar,{size:a.item.width,src:_,radius:!0}),(0,m.jsx)(d.Name,{style:i._.mt.sm,size:11,bold:!0,userId:p,children:(0,u.HTMLDecode)(j)}),(0,m.jsxs)(o.Text,{style:i._.mt.xs,type:"sub",size:9,numberOfLines:1,bold:!0,children:["@",p]})]})})}),a.COMPONENT)},"./src/screens/user/friends/component/item-grid/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){var e=t._.portrait(5,8),s=t._.grid(e);return{item:{width:s.width,marginTop:t._.md,marginLeft:s.marginLeft},left:{marginLeft:0}}}))},"./src/screens/user/friends/component/list/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"List")},"./src/screens/user/friends/component/list/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=r("./src/screens/_/index.ts"),o=r("./src/stores/index.ts"),d=r("./src/utils/decorators/index.ts"),i=r("./src/screens/user/friends/component/list/utils.tsx"),u=r("./src/screens/user/friends/component/list/ds.ts"),c=r("./src/screens/user/friends/component/list/styles.ts"),l=r("./node_modules/react/jsx-runtime.js");s.default=(0,d.obc)((function(e,s){var r=s.$,t=(0,c.memoStyles)(),d=o._.portrait(5,8);return(0,l.jsx)(n.PaginationList2,{keyExtractor:i.keyExtractor,contentContainerStyle:t.contentContainerStyle,data:r.list,numColumns:d,limit:6*d,renderItem:i.renderItem,onHeaderRefresh:r.fetchFriends})}),u.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/user/friends/component/list/index.tsx#list"})}catch(e){}},"./src/screens/user/friends/component/list/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{contentContainerStyle:{paddingTop:t._.sm,paddingHorizontal:t._.wind,paddingBottom:t._.bottom}}}))},"./src/screens/user/friends/component/list/utils.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.keyExtractor=i,s.renderItem=d;t(r("react"));var n=t(r("./src/screens/user/friends/component/item-grid/index.tsx")),o=r("./node_modules/react/jsx-runtime.js");function d(e){var s=e.item,r=e.index;return(0,o.jsx)(n.default,{index:r,item:s})}function i(e){return String(e.userId)}try{d.displayName="renderItem",d.__docgenInfo={description:"",displayName:"renderItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/component/list/utils.tsx#renderItem"]={docgenInfo:d.__docgenInfo,name:"renderItem",path:"src/screens/user/friends/component/list/utils.tsx#renderItem"})}catch(e){}try{i.displayName="keyExtractor",i.__docgenInfo={description:"",displayName:"keyExtractor",props:{userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/component/list/utils.tsx#keyExtractor"]={docgenInfo:i.__docgenInfo,name:"keyExtractor",path:"src/screens/user/friends/component/list/utils.tsx#keyExtractor"})}catch(e){}},"./src/screens/user/friends/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var t=s.COMPONENT="Friends",n=(s.NAMESPACE="Screen"+t,s.EXCLUDE_STATE={sort:"",filter:"",fetching:!1});s.STATE=Object.assign({},n,{_loaded:!1})},"./src/screens/user/friends/header/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/user/friends/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"Header")},"./src/screens/user/friends/header/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=r("./src/components/index.ts"),o=r("./src/utils/index.ts"),d=r("./src/utils/decorators/index.ts"),i=r("./src/utils/fetch/index.ts"),u=r("./src/screens/user/friends/header/ds.ts"),c=r("./node_modules/react/jsx-runtime.js");s.default=(0,d.obc)((function(e,s){var r=s.$;return(0,c.jsx)(n.Header,{title:"好友",headerTitleAlign:"left",hm:[r.url,"Friends"],headerRight:function(){return(0,c.jsx)(n.Header.Popover,{data:["浏览器查看"],onSelect:function(e){"浏览器查看"===e&&((0,i.t)("好友.右上角菜单",{key:e}),(0,o.open)(r.url))},children:(0,c.jsx)(n.Heatmap,{id:"好友.右上角菜单"})})}})}),u.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/user/friends/header/index.tsx#header"})}catch(e){}},"./src/screens/user/friends/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=r("./src/components/index.ts"),o=r("./src/stores/index.ts"),d=r("./src/utils/decorators/index.ts"),i=r("./src/utils/hooks/index.ts"),u=t(r("./src/screens/user/friends/component/filter/index.tsx")),c=t(r("./src/screens/user/friends/component/list/index.tsx")),l=t(r("./src/screens/user/friends/header/index.tsx")),a=t(r("./src/screens/user/friends/store.ts")),f=r("./node_modules/react/jsx-runtime.js");s.default=(0,d.ic)(a.default,(function(e,s){var r=s.$;return(0,i.useRunAfter)((function(){r.init()})),(0,i.useObserver)((function(){return(0,f.jsxs)(n.Component,{id:"screen-friends",children:[(0,f.jsx)(l.default,{}),(0,f.jsxs)(n.Page,{children:[(0,f.jsx)(u.default,{}),(0,f.jsx)(c.default,{})]}),(0,f.jsx)(n.Heatmap,{bottom:o._.bottom+o._.sm,id:"好友",screen:"Friends"})]})}))}));try{friends.displayName="friends",friends.__docgenInfo={description:"",displayName:"friends",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/friends/index.tsx#friends"]={docgenInfo:friends.__docgenInfo,name:"friends",path:"src/screens/user/friends/index.tsx#friends"})}catch(e){}},"./src/screens/user/friends/store.ts":(e,s,r)=>{var t=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.string.trim.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,d=n(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=n(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=n(r("./node_modules/@babel/runtime/helpers/createClass.js")),c=n(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=n(r("./node_modules/@babel/runtime/helpers/inherits.js")),a=n(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),f=n(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=n(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=n(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),_=r("./node_modules/mobx/dist/mobx.esm.js"),j=r("./src/stores/index.ts"),y=r("./src/utils/index.ts"),x=n(r("./src/utils/cache-manager/index.ts")),h=r("./src/utils/fetch/index.ts"),b=n(r("./src/utils/store/index.ts")),O=r("./src/constants/index.ts"),v=r("./src/screens/user/friends/utils.ts"),g=r("./src/screens/user/friends/ds.ts");function S(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=(0,f.default)(e);if(s){var n=(0,f.default)(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return(0,a.default)(this,r)}}s.default=(o=function(e){(0,l.default)(r,e);var s=S(r);function r(){var e;(0,i.default)(this,r);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return e=s.call.apply(s,[this].concat(o)),(0,m.default)((0,c.default)(e),"params",void 0),(0,m.default)((0,c.default)(e),"state",(0,_.observable)(g.STATE)),(0,m.default)((0,c.default)(e),"init",(0,d.default)(t.mark((function s(){return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=e,s.t1=Object,s.t2={},s.next=5,e.getStorage(g.NAMESPACE);case 5:return s.t3=s.sent,s.t4=g.EXCLUDE_STATE,s.t5={_loaded:!0},s.t6=s.t1.assign.call(s.t1,s.t2,s.t3,s.t4,s.t5),s.t0.setState.call(s.t0,s.t6),s.abrupt("return",e.fetchFriends());case 11:case"end":return s.stop()}}),s)})))),(0,m.default)((0,c.default)(e),"fetchFriends",(function(){return j.usersStore.fetchFriends({userId:e.userId})})),(0,m.default)((0,c.default)(e),"fetchUsersBatch",(0,d.default)(t.mark((function s(){var r;return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!e.state.fetching){s.next=2;break}return s.abrupt("return",!1);case 2:return e.setState({fetching:!0}),r=[],e.list.forEach((function(s,t){var n=e.users(s.userId)._loaded;(!n||(0,y.getTimestamp)()-Number(n)>=60*(15+t))&&r.push((function(){return j.usersStore.fetchUsers({userId:s.userId})}))})),s.next=7,(0,h.queue)(r);case 7:return e.setState({fetching:!1}),s.abrupt("return",!0);case 9:case"end":return s.stop()}}),s)})))),(0,m.default)((0,c.default)(e),"onSort",(function(s){(0,h.t)("好友.排序",{title:s});var r="";"同步率"===s&&(r="percent"),"最近"===s&&(r="recent"),e.setState({sort:r}),e.setStorage(g.NAMESPACE)})),(0,m.default)((0,c.default)(e),"onFilterChange",(0,y.debounce)((function(s){e.setState({filter:s.trim()})}))),e}return(0,u.default)(r,[{key:"userId",get:function(){return this.params.userId}},{key:"users",value:function(e){return(0,_.computed)((function(){return j.usersStore.users(e)})).get()}},{key:"friends",get:function(){return j.usersStore.friends(this.userId)}},{key:"list",get:function(){var e=this,s=g.NAMESPACE+"|list|"+this.userId;if(this.state.fetching&&x.default.get(s))return x.default.get(s);var r=this.state.filter.toUpperCase(),t=this.friends.list;r.length&&(t=t.filter((function(e){var s=e.userName;return!!s.includes(r)||(0,y.getPinYinFilterValue)(s,r)})));var n=this.state.sort;return"percent"===n&&(t=t.slice().sort((function(s,r){return(0,y.desc)(s,r,(function(s){var r;return null==(r=e.users(s.userId))?void 0:r.percent}))}))),"recent"===n&&(t=t.slice().sort((function(s,r){return(0,v.sortByRecent)(e.users(s.userId).recent,e.users(r.userId).recent)}))),x.default.set(s,t)}},{key:"url",get:function(){var e;return(0,O.HTML_FRIENDS)((null==(e=this.params)?void 0:e.userId)||j.userStore.myId)}}]),r}(b.default),(0,p.default)(o.prototype,"userId",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"userId"),o.prototype),(0,p.default)(o.prototype,"friends",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"friends"),o.prototype),(0,p.default)(o.prototype,"list",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"list"),o.prototype),(0,p.default)(o.prototype,"url",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"url"),o.prototype),o)},"./src/screens/user/friends/utils.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.sortByRecent=function(e,s){return e.includes("-")&&!s.includes("-")?1:!e.includes("-")&&s.includes("-")?-1:e.includes("-")&&s.includes("-")?(0,t.desc)((0,t.getTimestamp)(e)||0,(0,t.getTimestamp)(s)||0):(0,t.asc)((0,t.getRecentTimestamp)(e)||0,(0,t.getRecentTimestamp)(s)||0)};var t=r("./src/utils/index.ts")}}]);