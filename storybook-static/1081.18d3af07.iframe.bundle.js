(self.webpackChunkweb=self.webpackChunkweb||[]).push([[1081],{"./src/screens/tinygrail/valhall/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.sort.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=s(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=s(r("./node_modules/@babel/runtime/helpers/createClass.js")),o=s(r("./node_modules/@babel/runtime/helpers/inherits.js")),a=s(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=s(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),d=s(r("./node_modules/react/index.js")),u=r("./src/components/index.ts"),c=r("./src/stores/index.ts"),f=r("./src/utils/decorators/index.ts"),p=s(r("./src/screens/tinygrail/_/icon-go/index.tsx")),m=s(r("./src/screens/tinygrail/_/tool-bar/index.tsx")),h=r("./src/screens/tinygrail/overview/ds.ts"),y=s(r("./src/screens/tinygrail/valhall/list/index.tsx")),v=s(r("./src/screens/tinygrail/valhall/store.ts")),j=r("./node_modules/react/jsx-runtime.js");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,i.default)(e);if(t){var l=(0,i.default)(this).constructor;r=Reflect.construct(s,arguments,l)}else r=s.apply(this,arguments);return(0,a.default)(this,r)}}var b=function(e){(0,o.default)(r,e);var t=_(r);function r(){return(0,l.default)(this,r),t.apply(this,arguments)}return(0,n.default)(r,[{key:"componentDidMount",value:function(){this.context.$.init()}},{key:"renderContentHeaderComponent",value:function(){var e=this.context.$,t=e.state,r=t.level,s=t.sort,l=t.direction;return(0,j.jsx)(m.default,{style:c._.mt._sm,data:h.SORT_DS,level:r,levelMap:e.levelMap,sort:s,direction:l,onLevelSelect:e.onLevelSelect,onSortPress:e.onSortPress})}},{key:"render",value:function(){var e=this.context.$;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(u.Header,{title:"英灵殿",hm:["tinygrail/valhall","TinygrailValhall"],statusBarEvents:!1,statusBarEventsType:"Tinygrail",headerRight:function(){return(0,j.jsx)(p.default,{$:e})}}),(0,j.jsxs)(u.Page,{style:c._.container.tinygrail,children:[this.renderContentHeaderComponent(),(0,j.jsx)(y.default,{})]})]})}}]),r}(d.default.Component);t.default=(0,f.inject)(v.default)((0,f.obc)(b));try{valhall.displayName="valhall",valhall.__docgenInfo={description:"",displayName:"valhall",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/tinygrail/valhall/index.tsx#valhall"]={docgenInfo:valhall.__docgenInfo,name:"valhall",path:"src/screens/tinygrail/valhall/index.tsx#valhall"})}catch(e){}},"./src/screens/tinygrail/valhall/list/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("./node_modules/react/index.js"));var l=r("./src/components/index.ts"),n=r("./src/screens/_/index.ts"),o=r("./src/stores/index.ts"),a=r("./src/utils/index.ts"),i=r("./src/utils/decorators/index.ts"),d=s(r("./src/screens/tinygrail/_/item/index.tsx")),u=r("./src/screens/tinygrail/styles.ts"),c=r("./node_modules/react/jsx-runtime.js"),f={id:"英灵殿.跳转"};t.default=(0,i.obc)((function(e,t){var r=t.$;return r.computedList._loaded?(0,c.jsx)(n.PaginationList2,{style:o._.container.flex,contentContainerStyle:o._.container.bottom,keyExtractor:a.keyExtractor,refreshControlProps:u.refreshControlProps,footerTextType:"tinygrailText",data:r.computedList.list,windowSize:6,initialNumToRender:24,maxToRenderPerBatch:24,updateCellsBatchingPeriod:24,lazy:24,scrollToTop:!0,renderItem:p,onHeaderRefresh:r.fetchValhallList}):(0,c.jsx)(l.Loading,{style:o._.container.flex,color:o._.colorTinygrailText})}));function p(e){var t=e.item,r=e.index;return(0,c.jsx)(d.default,Object.assign({index:r,type:"valhall",event:f},t))}try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/tinygrail/valhall/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/tinygrail/valhall/list/index.tsx#list"})}catch(e){}},"./src/screens/tinygrail/valhall/store.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var l=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=l(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),a=l(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=l(r("./node_modules/@babel/runtime/helpers/createClass.js")),d=l(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=l(r("./node_modules/@babel/runtime/helpers/inherits.js")),c=l(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),f=l(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=l(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=l(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),h=r("./node_modules/mobx/dist/mobx.esm.js"),y=r("./src/stores/index.ts"),v=r("./src/utils/index.ts"),j=l(r("./src/utils/store/index.ts")),_=r("./src/utils/fetch/index.ts"),b=r("./src/screens/tinygrail/_/utils.ts");function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,f.default)(e);if(t){var l=(0,f.default)(this).constructor;r=Reflect.construct(s,arguments,l)}else r=s.apply(this,arguments);return(0,c.default)(this,r)}}var x="ScreenTinygrailValhall";t.default=(n=function(e){(0,u.default)(r,e);var t=g(r);function r(){var e;(0,a.default)(this,r);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),(0,p.default)((0,d.default)(e),"state",(0,h.observable)({level:"",sort:"",direction:"",go:"资产重组",_loaded:!1})),(0,p.default)((0,d.default)(e),"init",(0,o.default)(s.mark((function t(){var r,l,n,o;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state._loaded,l=(0,v.getTimestamp)(),n=!r||l-Number(r)>60,t.next=5,e.getStorage(x);case 5:return o=t.sent,e.setState(Object.assign({},o,{_loaded:n?l:r})),n&&e.fetchValhallList(),t.abrupt("return",o);case 9:case"end":return t.stop()}}),t)})))),(0,p.default)((0,d.default)(e),"fetchValhallList",(function(){return y.tinygrailStore.fetchValhallList()})),(0,p.default)((0,d.default)(e),"onSelectGo",(function(t){(0,_.t)("英灵殿.设置前往",{title:t}),e.setState({go:t}),e.setStorage(x)})),(0,p.default)((0,d.default)(e),"onLevelSelect",(function(t){(0,_.t)("英灵殿.筛选",{level:t}),e.setState({level:t}),e.setStorage(x)})),(0,p.default)((0,d.default)(e),"onSortPress",(function(t){var r=e.state,s=r.sort,l=r.direction;if(t===s){var n=t,o="down";"down"===l?o="up":"up"===l&&(n="",o=""),(0,_.t)("英灵殿.排序",{sort:n,direction:o}),e.setState({sort:n,direction:o})}else(0,_.t)("英灵殿.排序",{sort:t,direction:"down"}),e.setState({sort:t,direction:"down"});e.setStorage(x)})),e}return(0,i.default)(r,[{key:"valhallList",get:function(){return(0,b.relation)(y.tinygrailStore.valhallList)}},{key:"computedList",get:function(){var e=this.state,t=e.sort,r=e.level,s=e.direction,l=this.valhallList;if(!l._loaded)return l;var n=l;return r&&(n=Object.assign({},n,{list:(0,b.levelList)(r,n.list)})),t&&(n=Object.assign({},n,{list:(0,b.sortList)(t,s,n.list)})),n}},{key:"levelMap",get:function(){var e=this.valhallList.list,t={};return e.forEach((function(e){return t[e.level]?t[e.level]+=1:t[e.level]=1})),t}}]),r}(j.default),(0,m.default)(n.prototype,"valhallList",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"valhallList"),n.prototype),(0,m.default)(n.prototype,"computedList",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"computedList"),n.prototype),(0,m.default)(n.prototype,"levelMap",[h.computed],Object.getOwnPropertyDescriptor(n.prototype,"levelMap"),n.prototype),n)}}]);