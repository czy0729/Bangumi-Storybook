(self.webpackChunkweb=self.webpackChunkweb||[]).push([[7551],{"./src/screens/user/backup/component/btn/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Btn")},"./src/screens/user/backup/component/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/utils/index.ts"),u=s("./src/utils/decorators/index.ts"),c=s("./src/screens/user/backup/component/btn/ds.ts"),l=s("./src/screens/user/backup/component/btn/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,r=e.btnStyle,u=void 0===r?void 0:r,c=e.text,a=void 0===c?"同步":c,i=e.type,p=void 0===i?void 0:i,m=e.size,f=void 0===m?11:m,b=e.disabled,j=void 0===b?void 0:b,_=e.loading,v=void 0===_?void 0:_,y=e.onPress,x=void 0===y?void 0:y,h=(0,l.memoStyles)(),g="success"===p&&!j;return(0,d.jsx)(o.Touchable,{style:(0,n.stl)(h.touch,s),onPress:j||v?void 0:x,children:(0,d.jsx)(o.Flex,{style:(0,n.stl)(h.btn,g&&h.btnSuccess,u),justify:"center",children:v?(0,d.jsx)(o.Loading.Mini,{}):(0,d.jsx)(o.Text,{bold:!0,size:f,type:g?"__plain__":void 0,children:a})})})}),c.COMPONENT)},"./src/screens/user/backup/component/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts");t.memoStyles=r._.memoStyles((function(){return{touch:{width:56,borderRadius:r._.r(28),overflow:"hidden"},btn:{height:r._.r(28),backgroundColor:r._.select(r._.colorBg,r._._colorDarkModeLevel1),borderRadius:r._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/user/backup/component/cloud/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=t.COLOR_SUCCESS=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Cloud"),t.COLOR_SUCCESS="rgb(1, 173, 145)"},"./src/screens/user/backup/component/cloud/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.keys.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=r(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),u=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),d=s("./src/screens/user/backup/component/cloud/ds.ts"),a=s("./src/screens/user/backup/component/cloud/styles.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$,r=s.state,l=r.includeUrl,p=r.includeImage,m=r.upload,f=Object.keys(m).length;return(0,i.jsxs)(o.default,{style:a.styles.cloud,children:[(0,i.jsxs)(u.ItemSettingBlock,{style:a.styles.container,size:20,children:[(0,i.jsx)(u.ItemSettingBlock.Item,{title:"导出 CSV",information:"已获取 "+s.data.length+" 个收藏",onPress:s.onExport}),(0,i.jsx)(u.ItemSettingBlock.Item,{style:c._.ml.md,title:"导入 CSV",information:f?"已导入 "+f+" 个收藏":"导入后进行同步操作",onPress:s.onToggleUpload})]}),(0,i.jsxs)(n.Flex,{style:c._.mt.sm,children:[(0,i.jsx)(n.Text,{size:12,bold:!0,children:"导出 CSV 列包含："}),(0,i.jsx)(n.Touchable,{style:c._.ml.sm,onPress:function(){return s.onSetting("includeUrl")},children:(0,i.jsxs)(n.Flex,{children:[(0,i.jsx)(n.Iconfont,{name:l?"md-check-circle":"md-radio-button-off",size:16,color:l?d.COLOR_SUCCESS:void 0}),(0,i.jsx)(n.Text,{style:c._.ml.xs,size:12,bold:!0,type:l?"desc":"sub",children:"条目地址"})]})}),(0,i.jsx)(n.Touchable,{style:c._.ml.md,onPress:function(){return s.onSetting("includeImage")},children:(0,i.jsxs)(n.Flex,{children:[(0,i.jsx)(n.Iconfont,{name:p?"md-check-circle":"md-radio-button-off",size:16,color:p?d.COLOR_SUCCESS:void 0}),(0,i.jsx)(n.Text,{style:c._.ml.xs,size:12,bold:!0,type:p?"desc":"sub",children:"封面地址"})]})})]})]})}),d.COMPONENT)},"./src/screens/user/backup/component/cloud/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var r=s("./src/stores/index.ts");t.styles=r._.create({cloud:{paddingHorizontal:r._.wind,marginBottom:r._.md},container:{paddingHorizontal:0}})},"./src/screens/user/backup/component/column-bgm/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"ColumnBgm")},"./src/screens/user/backup/component/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),u=s("./src/utils/decorators/index.ts"),c=s("./src/screens/user/backup/component/column-bgm/ds.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.ob)((function(e){var t=e.select,s=e.text,r=e.next;return(0,l.jsxs)(o.Text,{style:n._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,l.jsxs)(o.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",r]})]})}),c.COMPONENT)},"./src/screens/user/backup/component/column-select/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.COMPONENT=t.COLOR_SUCCESS=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"ColumnSelect"),t.COLOR_SUCCESS="rgb(1, 173, 145)",t.HIT_SLOP={top:4,right:32,bottom:4,left:16}},"./src/screens/user/backup/component/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=r(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),u=s("./src/utils/decorators/index.ts"),c=s("./src/screens/user/backup/component/column-select/ds.ts"),l=s("./src/screens/user/backup/component/column-select/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.ob)((function(e){var t=e.select,s=e.disabled,r=e.onPress;return s?(0,d.jsx)(o.default,{style:l.styles.columnSelect}):(0,d.jsx)(n.Touchable,{style:l.styles.columnSelect,hitSlop:c.HIT_SLOP,onPress:function(){return r(!t)},children:(0,d.jsx)(n.Flex,{style:l.styles.radio,justify:"center",children:(0,d.jsx)(n.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?c.COLOR_SUCCESS:void 0,size:16})})})}),c.COMPONENT)},"./src/screens/user/backup/component/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var r=s("./src/stores/index.ts");t.styles=r._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/user/backup/component/column/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Column")},"./src/screens/user/backup/component/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/column/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,r=e.show,n=void 0===r||r,u=e.type,l=void 0===u?void 0:u,d=e.text,a=void 0===d?void 0:d,i=e.right,p=void 0===i?void 0:i,m=e.onPress,f=void 0===m?void 0:m;return n?(0,c.jsxs)(o.Flex,{style:s,children:[(0,c.jsx)(o.Text,{size:11,type:a&&"/"!==a?l:"sub",onPress:f,children:a||"__"}),p]}):null}),u.COMPONENT)},"./src/screens/user/backup/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Component")},"./src/screens/user/backup/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/constants/index.ts"),n=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Item"),t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},upload:{},onBottom:o.FROZEN_FN,onSubmit:o.FROZEN_FN}},"./src/screens/user/backup/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/utils/decorators/index.ts"),n=r(s("./src/screens/user/backup/component/item/item.tsx")),u=s("./src/screens/user/backup/component/item/ds.ts"),c=s("./src/screens/user/backup/component/item/styles.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s,r=e.item,o=t.$,u=t.navigation;return(0,l.jsx)(n.default,{navigation:u,styles:(0,c.memoStyles)(),item:r,upload:o.upload(null==(s=r.subject)?void 0:s.id),onBottom:o.onBottom,onSubmit:o.onSubmit})}),u.COMPONENT)},"./src/screens/user/backup/component/item/item.tsx":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=g(t);if(s&&s.has(e))return s.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var u=o?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(r,n,u):r[n]=e[n]}return r.default=e,s&&s.set(e,r),r}(s("react")),l=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),d=s("./src/components/index.ts"),a=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),p=s("./src/utils/index.ts"),m=s("./src/utils/decorators/index.ts"),f=s("./src/constants/index.ts"),b=s("./src/screens/user/backup/utils.ts"),j=o(s("./src/screens/user/backup/component/btn/index.tsx")),_=o(s("./src/screens/user/backup/component/column/index.tsx")),v=o(s("./src/screens/user/backup/component/column-bgm/index.tsx")),y=o(s("./src/screens/user/backup/component/column-select/index.tsx")),x=s("./src/screens/user/backup/component/item/ds.ts"),h=s("./node_modules/react/jsx-runtime.js");function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(g=function(e){return e?s:t})(e)}t.default=(0,m.memo)((function(e){var t,s,o,m,x,g,S=e.navigation,O=e.styles,C=e.item,T=e.upload,P=e.onBottom,k=e.onSubmit,E=!!T,M=f.MODEL_SUBJECT_TYPE.getTitle(null==(t=C.subject)?void 0:t.type),N=["动画","书籍","三次元"].includes(M),w=(0,c.useState)(!1),I=(0,u.default)(w,2),D=I[0],R=I[1],A=(0,b.useSelectStatus)(C.type,null==T?void 0:T.type),L=(0,u.default)(A,2),H=L[0],V=L[1],U=(0,b.useSelectEp)("",null==T?void 0:T.ep_status),B=(0,u.default)(U,2),F=B[0],z=B[1],q=(0,b.useSelectScore)(C.rate,null==T?void 0:T.rate),Y=(0,u.default)(q,2),J=Y[0],G=Y[1],W=(0,b.useSelectTags)(C.tags.join(" "),null!=T&&T.tags?T.tags.join(" "):""),X=(0,u.default)(W,2),$=X[0],Z=X[1],K=(0,b.useSelectComment)(C.comment,null==T?void 0:T.comment),Q=(0,u.default)(K,2),ee=Q[0],te=Q[1],se=C.type?(0,b.actionStatus)(C.type,M):"未收藏",re={status:se,ep:(C.ep_status||0)+" / "+((null==(s=C.subject)?void 0:s.eps)||"??"),score:C.rate||"",tags:C.tags.join(" ")||"",comment:C.comment||""},oe=(0,b.actionStatus)(null==T?void 0:T.type,M),ne={status:oe,ep:((null==T?void 0:T.ep_status)||0)+" / "+((null==T||null==(o=T.subject)?void 0:o.eps)||"??"),score:(null==T?void 0:T.rate)||"",tags:null!=T&&T.tags?T.tags.join(" "):"",comment:(null==T?void 0:T.comment)||""},ue={status:(0,b.getSelectStatus)(se,oe).value,ep:(0,b.getSelectEp)(C.ep_status,null==T?void 0:T.ep_status).value,score:(0,b.getSelectScore)(C.rate,null==T?void 0:T.rate).value,tags:(0,b.getSelectTags)(C.tags.join(" "),null!=T&&T.tags?T.tags.join(" "):"").value,comment:(0,b.getSelectComment)(C.comment,null==T?void 0:T.comment).value},ce=function(){var e;S.push("Subject",{subjectId:null==(e=C.subject)?void 0:e.id})};return(0,h.jsxs)(d.Flex,{style:O.item,align:"start",children:[(0,h.jsx)(a.Cover,{src:null==(m=C.subject)?void 0:m.image,width:E?f.IMG_WIDTH_SM:f.IMG_WIDTH,height:E?f.IMG_HEIGHT_SM:f.IMG_HEIGHT,radius:!0,type:M,onPress:ce}),(0,h.jsx)(d.Flex.Item,{children:(0,h.jsxs)(d.Flex,{style:O.body,direction:"column",align:"start",children:[(0,h.jsx)(d.Text,{bold:!0,numberOfLines:2,onPress:ce,children:(0,p.cnjp)(null==(x=C.subject)?void 0:x.cn,null==(g=C.subject)?void 0:g.jp)}),(0,h.jsxs)(d.Flex,{style:i._.mt.md,align:"start",children:[(0,h.jsxs)(l.default,{children:[(0,h.jsx)(_.default,{text:" ",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,text:"状态",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,show:N&&(E||!E&&!!re.ep),text:"进度",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.score,text:"评分",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.tags,text:"标签",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.comment,text:"点评",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,text:"更新",type:"sub"})]}),(0,h.jsxs)(d.Flex.Item,{style:i._.ml.md,children:[(0,h.jsx)(_.default,{text:"导出",type:"sub"}),(0,h.jsx)(_.default,{style:i._.mt.md,text:re.status}),(0,h.jsx)(_.default,{style:i._.mt.md,show:N&&(E||!E&&!!re.ep),text:re.ep}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.score,text:re.score}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.tags,text:re.tags}),(0,h.jsx)(_.default,{style:i._.mt.md,show:E||!E&&!!re.comment,text:re.comment}),(0,h.jsx)(_.default,{style:i._.mt.md,text:C.updated_at.replace("T"," ").replace("Z","")})]}),E&&(0,h.jsxs)(d.Flex.Item,{style:i._.ml.md,children:[(0,h.jsx)(_.default,{text:"导入",type:"sub"}),(0,h.jsx)(v.default,{select:H,text:ne.status,next:ue.status}),(0,h.jsx)(v.default,{select:F,text:ne.ep,next:ue.ep+"话"}),(0,h.jsx)(v.default,{select:J,text:ne.score,next:ue.score}),(0,h.jsx)(v.default,{select:$,text:ne.tags,next:ue.tags}),(0,h.jsx)(v.default,{select:ee,text:ne.comment,next:ue.comment})]}),E&&(0,h.jsxs)(l.default,{style:O.selectors,children:[(0,h.jsx)(_.default,{text:" ",type:"sub"}),(0,h.jsx)(y.default,{select:H,disabled:!ue.status,onPress:V}),(0,h.jsx)(y.default,{select:F,disabled:!ue.ep,onPress:z}),(0,h.jsx)(y.default,{select:J,disabled:!ue.score,onPress:G}),(0,h.jsx)(y.default,{select:$,disabled:!ue.tags,onPress:Z}),(0,h.jsx)(y.default,{select:ee,disabled:!ue.comment,onPress:te})]})]}),E&&(0,h.jsx)(l.default,{style:O.toolbar,children:(0,h.jsxs)(d.Flex,{style:i._.mt.md,justify:"end",children:[(0,h.jsx)(j.default,{text:"置底",onPress:function(){var e;P(null==(e=C.subject)?void 0:e.id)}}),(0,h.jsx)(j.default,{style:i._.ml.md,type:"success",disabled:!(H||F||J||ee),loading:D,onPress:(0,n.default)(r.mark((function e(){var t,s,o,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={},o={},H?"想看"===ue.status?(s.status=!0,o.status="wish"):"看过"===ue.status?(s.status=!0,o.status="collect"):"在看"===ue.status&&(s.status=!0,o.status="do"):ne.status&&(s.status=!0,o.status=f.MODEL_COLLECTION_STATUS.getValue(ne.status)),J&&(s.score=!0,o.rating=ue.score),$&&(s.tags=!0,o.tags=ue.tags),ee&&(s.comment=!0,o.comment=ue.comment),o.private=C.private,n={},F&&(s.ep=!0,n.ep=ue.ep),R(!0),e.next=12,k(null==(t=C.subject)?void 0:t.id,o,n);case 12:R(!1),s.status&&V(!1),s.ep&&z(!1),s.score&&G(!1),s.comment&&te(!1);case 17:case"end":return e.stop()}}),e)})))})]})})]})})]})}),x.DEFAULT_PROPS)},"./src/screens/user/backup/component/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts");t.memoStyles=r._.memoStyles((function(){return{item:{paddingRight:r._.wind,paddingLeft:r._.wind,paddingVertical:r._.md,marginBottom:r._.sm},body:{paddingLeft:r._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:r._._wind,marginTop:r._.xs},loading:{marginTop:13}}}))},"./src/screens/user/backup/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"List")},"./src/screens/user/backup/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/screens/_/index.ts"),n=s("./src/stores/index.ts"),u=s("./src/utils/decorators/index.ts"),c=s("./src/screens/user/backup/component/list/utils.tsx"),l=s("./src/screens/user/backup/component/list/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.obc)((function(e,t){var s=t.$;return(0,d.jsx)(o.PaginationList2,{contentContainerStyle:n._.container.bottom,data:s.data,limit:12,footerEmptyDataText:"没有获取到任何数据，请检查登录、授权状态，在进度页面下拉刷新重新授权或者重新登录再试试",renderItem:c.renderItem,onHeaderRefresh:s.fetchCollectionsAll})}),l.COMPONENT)},"./src/screens/user/backup/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=function(e){var t=e.item;return(0,n.jsx)(o.default,{item:t})};r(s("react"));var o=r(s("./src/screens/user/backup/component/item/index.tsx")),n=s("./node_modules/react/jsx-runtime.js")},"./src/screens/user/backup/component/tips/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Tips")},"./src/screens/user/backup/component/tips/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),u=s("./src/screens/user/backup/component/tips/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.obc)((function(e,t){var s=t.$.state.progress,r=s.fetching,n=s.message,u=s.current,l=s.total;return(0,c.jsx)(o.Progress,{show:r,message:n,current:u,total:l})}),u.COMPONENT)},"./src/screens/user/backup/component/upload/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/component/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Upload")},"./src/screens/user/backup/component/upload/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.fixed.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=r(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./node_modules/react-native-webview/index.js"),u=s("./src/components/index.ts"),c=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),d=r(s("./src/screens/user/backup/component/btn/index.tsx")),a=s("./src/screens/user/backup/component/upload/utils.ts"),i=s("./src/screens/user/backup/component/upload/ds.ts"),p=s("./src/screens/user/backup/component/upload/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$;if(!s.state.modal)return null;var r=(0,p.memoStyles)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(o.default,{style:r.mask}),(0,m.jsxs)(o.default,{style:r.fixed,children:[(0,m.jsx)(o.default,{style:r.container,children:(0,m.jsx)(n.WebView,{containerStyle:r.webview,source:{html:(0,a.injectedHTML)()},androidHardwareAccelerationDisabled:!0,androidLayerType:"software",javaScriptEnabled:!0,onMessage:function(e){var t=JSON.parse(e.nativeEvent.data).data;s.onMessage(t)}})}),(0,m.jsxs)(o.default,{style:r.body,children:[(0,m.jsx)(u.Text,{bold:!0,size:15,children:"点击上方按钮导入 CSV 文件"}),(0,m.jsx)(u.Flex,{style:c._.mt.lg,justify:"center",children:(0,m.jsx)(d.default,{style:r.btn,btnStyle:r.btnStyle,text:"收起",size:13,onPress:s.onToggleUpload})})]})]})]})}),i.COMPONENT)},"./src/screens/user/backup/component/upload/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts");t.memoStyles=r._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:r._.wind,width:r._.window.contentWidth,backgroundColor:r._.select(r._.colorPlain,r._._colorDarkModeLevel2),borderRadius:r._.radiusMd,shadowColor:r._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:r._.select(16,0)},hide:{top:r._.sm,right:r._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},container:{minHeight:128,borderRadius:r._.radiusMd,overflow:"hidden"},webview:{borderRadius:r._.radiusMd,overflow:"hidden"},webviewHide:{opacity:.01},body:{paddingTop:20,paddingHorizontal:r._.md,paddingBottom:28},iconToggle:{position:"absolute",zIndex:2,top:1,right:0},btn:{width:128},btnStyle:{height:40}}}))},"./src/screens/user/backup/component/upload/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_IMPORT=void 0,t.injectedHTML=function(){return'<!DOCTYPE html>\n  <html lang="en">\n    <head>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=edge" />\n      <meta name="viewport" content="width=device-width,initial-scale=1" />\n      <title>上传CSV</title>\n      <style>\n        * {\n          padding: 0;\n          margin: 0;\n        }\n        #upload_wrap {\n          height: 120px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n      </style>\n    </head>\n    <body>\n      <div id="upload_wrap">\n        <input id="upload_input" type="file" accept=".csv" onchange="readCSVFile(this)" />\n      </div>\n      <script>\n        function readCSVFile(obj) {\n          var reader = new FileReader()\n          reader.readAsText(obj.files[0])\n          reader.onload = function () {\n            postMessage(\''+r+"', this.result);\n          }\n        }\n\n        function postMessage(type, data) {\n          window.ReactNativeWebView.postMessage(JSON.stringify({ type, data }))\n        }\n      <\/script>\n    </body>\n  </html>"};var r=t.TYPE_IMPORT="CSV_IMPORT"},"./src/screens/user/backup/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.LIMIT=t.HOST_API=t.CSV_HEADS=t.COMPONENT=void 0;t.COMPONENT="Backup",t.HOST_API="https://api.bgm.tv",t.LIMIT=100,t.CSV_HEADS=["ID","封面","网址","类型","中文","日文","放送","排名","评分","话数","看到","状态","标签","我的评价","我的简评","私密","更新时间"]},"./src/screens/user/backup/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),o=s("./src/screens/user/backup/ds.ts");t.COMPONENT=(0,r.rc)(o.COMPONENT,"Header")},"./src/screens/user/backup/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),u=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/user/backup/header/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.navigation;return(0,d.jsx)(o.Header,{title:"本地备份",hm:["backup","Backup"],headerRight:function(){return(0,d.jsx)(n.IconTouchable,{name:"md-info-outline",color:u._.colorDesc,onPress:function(){s.push("Information",{title:"本地备份",message:["条目地址和封面地址为可选导出项。","因为这些值长度较长，对于部分有大量收藏记录的用户来说，很可能导致内存溢出导出失败，请自行尝试。"]})}})}})}),l.COMPONENT)},"./src/screens/user/backup/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var o=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),u=s("./src/utils/hooks/index.ts"),c=r(s("./src/screens/user/backup/component/cloud/index.tsx")),l=r(s("./src/screens/user/backup/component/list/index.tsx")),d=r(s("./src/screens/user/backup/component/tips/index.tsx")),a=r(s("./src/screens/user/backup/component/upload/index.tsx")),i=r(s("./src/screens/user/backup/header/index.tsx")),p=r(s("./src/screens/user/backup/store/index.ts")),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.ic)(p.default,(function(e,t){var s=t.$;return(0,u.useMount)((function(){s.init()})),(0,u.useObserver)((function(){return(0,m.jsxs)(o.Component,{id:"screen-backup",children:[(0,m.jsx)(i.default,{}),(0,m.jsxs)(o.Page,{children:[(0,m.jsx)(a.default,{}),(0,m.jsx)(c.default,{}),s.state.progress.fetching?(0,m.jsx)(o.Loading,{}):(0,m.jsx)(l.default,{})]}),(0,m.jsx)(d.default,{})]})}))}))},"./src/screens/user/backup/store/action.ts":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),a=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=o(s("./node_modules/csvjson-csv2json/csv2json.js")),f=s("./src/utils/index.ts"),b=s("./src/utils/fetch/index.ts"),j=s("./src/utils/fetch.v0/index.ts"),_=s("./src/utils/kv/index.ts"),v=s("./src/constants/index.ts"),y=s("./src/screens/user/backup/ds.ts"),x=o(s("./src/screens/user/backup/store/fetch.ts"));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return(0,a.default)(this,s)}}t.default=function(e){(0,d.default)(s,e);var t=h(s);function s(){var e,o;(0,c.default)(this,s);for(var u=arguments.length,d=new Array(u),a=0;a<u;a++)d[a]=arguments[a];return e=t.call.apply(t,[this].concat(d)),(0,p.default)((0,l.default)(e),"onSetting",(function(t){e.setState((0,p.default)({},t,!e.state[t])),e.save()})),(0,p.default)((0,l.default)(e),"onExport",(0,n.default)(r.mark((function t(){var s,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.csv.length){t.next=3;break}return(0,f.info)("没有获取到收藏信息，请检查登录状态"),t.abrupt("return",!1);case 3:return t.next=5,(0,_.temp)(e.userId+"_"+(0,f.date)("Y-m-d_H-i-s",(0,f.getTimestamp)())+".csv","\ufeff"+e.csv);case 5:if(s=t.sent,null!=(o=s.data)&&o.downloadKey){t.next=10;break}return(0,f.info)("未知错误，下载失败，重试或联系作者"),t.abrupt("return",!1);case 10:(0,b.t)("本地备份.导出",{data:e.userId+"|"+e.csv.length}),(0,f.open)((0,_.download)(o.downloadKey));case 12:case"end":return t.stop()}}),t)})))),(0,p.default)((0,l.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,p.default)({current:s},t,s)}),e.save(),(0,b.t)("本地备份.置底")})),(0,p.default)((0,l.default)(e),"onSubmit",(o=(0,n.default)(r.mark((function t(s,o,n){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(o).length){t.next=5;break}return t.next=5,(0,j.request)(y.HOST_API+"/collection/"+s+"/update",Object.assign({},o,{privacy:o.privacy?1:0}));case 5:if(!Object.keys(n).length){t.next=8;break}return t.next=8,(0,j.request)(y.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:n.ep||0});case 8:return t.next=10,e.fetchCollection(s);case 10:(0,f.feedback)(),(0,b.t)("本地备份.同步");case 12:case"end":return t.stop()}}),t)}))),function(e,t,s){return o.apply(this,arguments)})),(0,p.default)((0,l.default)(e),"onToggleUpload",(function(){e.setState({modal:!e.state.modal})})),(0,p.default)((0,l.default)(e),"onMessage",(function(t){try{var s=(0,m.default)(t);if(s.length){var r={};s.map((function(e){if(e.ID){var t=e["状态"];t.includes("在")?t="3":t.includes("想")?t="1":t.includes("过")?t="2":t.includes("搁置")?t="4":t.includes("抛弃")&&(t="5"),r[e.ID]={type:t,rate:e["我的评价"]||"",ep_status:e["看到"]||"",vol_status:"",comment:e["我的简评"]||"",tags:(e["标签"]||"").split(" "),private:"是"===e["私密"],updated_at:e["更新时间"]||"",subject:{id:e.ID,date:e["放送"]||"",eps:e["话数"]||"",image:e["封面"]||"",jp:e["日文"]||"",cn:e["中文"]||"",rank:e["排名"]||"",score:e["评分"]||"",type:v.MODEL_SUBJECT_TYPE.getValue(e["类型"])||"2"}}}})),e.setState({upload:r}),e.save(),e.onToggleUpload(),(0,b.t)("本地备份.导入",{data:e.userId+"|"+s.length})}}catch(e){(0,f.info)("解析CSV出错，请重新导入")}})),e}return(0,u.default)(s)}(x.default)},"./src/screens/user/backup/store/computed.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,n=r(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),u=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),d=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),a=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),m=s("./node_modules/mobx/dist/mobx.esm.js"),f=s("./node_modules/json2csv/dist/json2csv.umd.js"),b=s("./src/stores/index.ts"),j=s("./src/utils/index.ts"),_=s("./src/constants/index.ts"),v=s("./src/screens/user/backup/ds.ts"),y=r(s("./src/screens/user/backup/store/state.ts"));function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return(0,a.default)(this,s)}}t.default=(o=function(e){(0,d.default)(s,e);var t=x(s);function s(){return(0,c.default)(this,s),t.apply(this,arguments)}return(0,l.default)(s,[{key:"userId",get:function(){return b.userStore.usersInfo(b.userStore.myUserId).username||b.userStore.myUserId}},{key:"csv",get:function(){if(this.state.progress.fetching||!this.data.length)return"";var e=this.state,t=e.includeUrl,s=e.includeImage,r=this.data.map((function(e){var r,o=e.subject,n=(0,u.default)({},v.CSV_HEADS[0],o.id);s&&(n[v.CSV_HEADS[1]]=o.image),t&&(n[v.CSV_HEADS[2]]="https://bgm.tv/subject/"+o.id);var c=(n=Object.assign({},n,(r={},(0,u.default)(r,v.CSV_HEADS[3],_.MODEL_SUBJECT_TYPE.getTitle(o.type)),(0,u.default)(r,v.CSV_HEADS[4],o.cn),(0,u.default)(r,v.CSV_HEADS[5],o.jp),(0,u.default)(r,v.CSV_HEADS[6],o.date),(0,u.default)(r,v.CSV_HEADS[7],o.rank||""),(0,u.default)(r,v.CSV_HEADS[8],o.score||""),(0,u.default)(r,v.CSV_HEADS[9],o.eps||""),(0,u.default)(r,v.CSV_HEADS[10],e.ep_status||""),(0,u.default)(r,v.CSV_HEADS[11],_.MODEL_COLLECTION_STATUS.getLabel(e.type)),(0,u.default)(r,v.CSV_HEADS[12],e.tags.join(" ")),(0,u.default)(r,v.CSV_HEADS[13],e.rate||""),(0,u.default)(r,v.CSV_HEADS[14],e.comment||""),(0,u.default)(r,v.CSV_HEADS[15],e.private?"是":""),(0,u.default)(r,v.CSV_HEADS[16],e.updated_at),r)))[v.CSV_HEADS[3]];return"书籍"===c?n[v.CSV_HEADS[11]]=n[v.CSV_HEADS[11]].replace("看","读"):"游戏"===c?n[v.CSV_HEADS[11]]=n[v.CSV_HEADS[11]].replace("看","玩"):"音乐"===c&&(n[v.CSV_HEADS[11]]=n[v.CSV_HEADS[11]].replace("看","听")),n}));return new f.Parser(v.CSV_HEADS).parse(r)}},{key:"upload",value:function(e){var t=this;return(0,m.computed)((function(){return t.state.upload[e]||null})).get()}},{key:"list",get:function(){var e=this.state,t=e.anime,s=e.book,r=e.music,o=e.game,u=e.real;return[].concat((0,n.default)(t),(0,n.default)(s),(0,n.default)(r),(0,n.default)(o),(0,n.default)(u))}},{key:"listMap",get:function(){var e={};return this.list.forEach((function(t){e[t.subject.id]=!0})),e}},{key:"data",get:function(){var e=this;if(this.state.progress.fetching)return[];var t=this.state.upload;if(Object.keys(t).length){var s=[];Object.keys(t).forEach((function(r){r in e.listMap||s.push(Object.assign({},t[r],{type:"",ep_status:"",rate:"",tags:[],comment:""}))})),s.push.apply(s,(0,n.default)(this.list));var r=this.state.bottom;return s.slice().sort((function(e,s){return(0,j.asc)(t[e.subject.id]?0:1,t[s.subject.id]?0:1)})).sort((function(e,t){return(0,j.asc)(r[e.subject.id]||0,r[t.subject.id]||0)}))}return this.list.slice().sort((function(e,t){return(0,j.asc)(e.updated_at,t.updated_at)}))}}]),s}(y.default),(0,p.default)(o.prototype,"userId",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"userId"),o.prototype),(0,p.default)(o.prototype,"csv",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"csv"),o.prototype),(0,p.default)(o.prototype,"list",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"list"),o.prototype),(0,p.default)(o.prototype,"listMap",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"listMap"),o.prototype),(0,p.default)(o.prototype,"data",[m.computed],Object.getOwnPropertyDescriptor(o.prototype,"data"),o.prototype),o)},"./src/screens/user/backup/store/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=void 0;var r=s("./src/screens/user/backup/ds.ts"),o=(t.NAMESPACE="Screen"+r.COMPONENT,t.EXCLUDE_STATE={progress:{fetching:!1,message:"",current:0,total:0},modal:!1,upload:{},bottom:{current:0}});t.STATE=Object.assign({anime:[],book:[],music:[],game:[],real:[],last:0,includeUrl:!1,includeImage:!1},o,{_loaded:!1})},"./src/screens/user/backup/store/fetch.ts":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.is-array.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.function.name.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),u=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=s("./node_modules/mobx/dist/mobx.esm.js"),b=s("./src/utils/index.ts"),j=s("./src/utils/fetch/index.ts"),_=s("./src/utils/fetch.v0/index.ts"),v=s("./src/utils/fetch.v0/ds.ts"),y=s("./src/constants/index.ts"),x=s("./src/screens/user/backup/ds.ts"),h=s("./src/screens/user/backup/utils.ts"),g=o(s("./src/screens/user/backup/store/computed.ts")),S=s("./src/screens/user/backup/store/ds.ts");function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,p.default)(e);if(t){var o=(0,p.default)(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return(0,i.default)(this,s)}}t.default=function(e){(0,a.default)(s,e);var t=O(s);function s(){var e,o,c;(0,l.default)(this,s);for(var a=arguments.length,i=new Array(a),p=0;p<a;p++)i[p]=arguments[p];return e=t.call.apply(t,[this].concat(i)),(0,m.default)((0,d.default)(e),"fetchCollectionsAll",(0,u.default)(r.mark((function t(){var s,o,n,u;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.progress.fetching){t.next=2;break}return t.abrupt("return",!1);case 2:e.setState({anime:[],book:[],music:[],game:[],real:[],progress:{fetching:!0,total:y.SUBJECT_TYPE.length*y.COLLECTION_STATUS.length}}),t.prev=3,s=0,o=0;case 6:if(!(o<y.SUBJECT_TYPE.length)){t.next=21;break}n=0;case 8:if(!(n<y.COLLECTION_STATUS.length)){t.next=17;break}return u=y.MODEL_SUBJECT_TYPE.getTitle(y.SUBJECT_TYPE[o].value),s+=1,e.setState({progress:{current:s,message:u+" ("+(0,h.actionStatus)(y.COLLECTION_STATUS[n].title,u)+") "}}),t.next=14,e.fetchCollections(y.SUBJECT_TYPE[o].value,y.COLLECTION_STATUS[n].title);case 14:n+=1,t.next=8;break;case 17:e.save();case 18:o+=1,t.next=6;break;case 21:e.setState({last:(0,b.getTimestamp)()}),e.save(),(0,j.t)("本地备份.获取",{userId:e.userId}),t.next=29;break;case 26:t.prev=26,t.t0=t.catch(3),(0,j.t)("本地备份.报错",{userId:e.userId});case 29:return t.prev=29,e.setState({progress:S.EXCLUDE_STATE.progress}),t.finish(29);case 32:case"end":return t.stop()}}),t,null,[[3,26,29,32]])})))),(0,m.default)((0,d.default)(e),"fetchCollections",(o=(0,u.default)(r.mark((function t(s,o){var u,c,l,d,a=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=a.length>2&&void 0!==a[2]?a[2]:1,t.next=3,(0,_.request)((0,v.API_COLLECTIONS)(e.userId,s,u,x.LIMIT,o));case 3:if(c=t.sent,l=y.MODEL_SUBJECT_TYPE.getLabel(s),Array.isArray(null==c?void 0:c.data)&&(d=c.data.map((function(e){var t,s=(e||{}).subject;return{type:e.type,rate:e.rate,ep_status:e.ep_status,vol_status:e.vol_status,comment:e.comment,tags:e.tags,private:e.private,updated_at:e.updated_at,subject:{id:null==s?void 0:s.id,date:null==s?void 0:s.date,eps:null==s?void 0:s.eps,image:null==s||null==(t=s.images)?void 0:t.medium,jp:null==s?void 0:s.name,cn:null==s?void 0:s.name_cn,rank:null==s?void 0:s.rank,score:null==s?void 0:s.score,type:null==e?void 0:e.subject_type}}})),e.setState((0,m.default)({},l,[].concat((0,n.default)((0,f.toJS)(e.state[l])),(0,n.default)(d))))),!(c.total&&c.offset+x.LIMIT<c.total)){t.next=8;break}return t.abrupt("return",e.fetchCollections(s,o,u+1));case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)}))),function(e,t){return o.apply(this,arguments)})),(0,m.default)((0,d.default)(e),"fetchCollection",(c=(0,u.default)(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.info(t);case 1:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})),e}return(0,c.default)(s)}(g.default)},"./src/screens/user/backup/store/index.ts":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),a=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=o(s("./src/screens/user/backup/store/action.ts")),f=s("./src/screens/user/backup/store/ds.ts");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return(0,a.default)(this,s)}}t.default=function(e){(0,d.default)(s,e);var t=b(s);function s(){var e;(0,c.default)(this,s);for(var o=arguments.length,u=new Array(o),d=0;d<o;d++)u[d]=arguments[d];return e=t.call.apply(t,[this].concat(u)),(0,p.default)((0,l.default)(e),"init",(0,n.default)(r.mark((function t(){return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.t1=Object,t.t2={},t.next=5,e.getStorage(f.NAMESPACE);case 5:if(t.t3=t.sent,t.t3){t.next=8;break}t.t3={};case 8:if(t.t4=t.t3,t.t5=f.EXCLUDE_STATE,t.t6={_loaded:!0},t.t7=t.t1.assign.call(t.t1,t.t2,t.t4,t.t5,t.t6),t.t0.setState.call(t.t0,t.t7),e.state.last){t.next=16;break}return t.next=16,e.fetchCollectionsAll();case 16:return t.abrupt("return",!0);case 17:case"end":return t.stop()}}),t)})))),e}return(0,u.default)(s)}(m.default)},"./src/screens/user/backup/store/state.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),n=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),a=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=s("./node_modules/mobx/dist/mobx.esm.js"),p=r(s("./src/utils/store/index.ts")),m=s("./src/screens/user/backup/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return(0,l.default)(this,s)}}t.default=function(e){(0,c.default)(s,e);var t=f(s);function s(){var e;(0,n.default)(this,s);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return e=t.call.apply(t,[this].concat(o)),(0,a.default)((0,u.default)(e),"state",(0,i.observable)(m.STATE)),(0,a.default)((0,u.default)(e),"save",(function(){return e.saveStorage(m.NAMESPACE,m.EXCLUDE_STATE)})),e}return(0,o.default)(s)}(p.default)},"./src/screens/user/backup/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.actionStatus=function(e,t){var s=u.MODEL_COLLECTION_STATUS.getLabel(e)||"";"书籍"===t?s=s.replace("看","读"):"游戏"===t?s=s.replace("看","玩"):"音乐"===t&&(s=s.replace("看","听"));return s},t.getSelectComment=p,t.getSelectEp=d,t.getSelectScore=a,t.getSelectStatus=l,t.getSelectTags=i,t.useSelectComment=function(e,t){var s=(0,n.useState)(p(e,t).select),r=(0,o.default)(s,2),u=r[0],c=r[1];return(0,n.useEffect)((function(){c(p(e,t).select)}),[e,t]),[u,c]},t.useSelectEp=function(e,t){var s=(0,n.useState)(d(e,t).select),r=(0,o.default)(s,2),u=r[0],c=r[1];return(0,n.useEffect)((function(){c(d(e,t).select)}),[e,t]),[u,c]},t.useSelectScore=function(e,t){var s=(0,n.useState)(a(e,t).select),r=(0,o.default)(s,2),u=r[0],c=r[1];return(0,n.useEffect)((function(){c(a(e,t).select)}),[e,t]),[u,c]},t.useSelectStatus=function(e,t){var s=(0,n.useState)(l(e,t).select),r=(0,o.default)(s,2),u=r[0],c=r[1];return(0,n.useEffect)((function(){c(l(e,t).select)}),[e,t]),[u,c]},t.useSelectTags=function(e,t){var s=(0,n.useState)(i(e,t).select),r=(0,o.default)(s,2),u=r[0],c=r[1];return(0,n.useEffect)((function(){c(i(e,t).select)}),[e,t]),[u,c]};var o=r(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),n=s("react"),u=s("./src/constants/index.ts");function c(e){return String(e).replace(/读|玩|听/g,"看").trim()}function l(e,t){return{select:c(e)!==c(t),value:t}}function d(e,t){var s,r=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:r>Number(t||0),value:r}}function a(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function i(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}function p(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}}}]);