(self.webpackChunkweb=self.webpackChunkweb||[]).push([[2694],{"./src/screens/rakuen/board/component/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/rakuen/board/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"Component")},"./src/screens/rakuen/board/component/item/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/rakuen/board/component/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"Item")},"./src/screens/rakuen/board/component/item/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.string.replace.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.number.constructor.js"),r("./node_modules/core-js/modules/web.timers.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("./node_modules/react/index.js"));var o=s(r("./node_modules/react-native-web/dist/exports/View/index.js")),n=r("./src/components/index.ts"),d=r("./src/screens/_/index.ts"),a=r("./src/stores/index.ts"),u=r("./src/utils/index.ts"),c=r("./src/utils/decorators/index.ts"),i=r("./src/utils/fetch/index.ts"),l=r("./src/constants/index.ts"),p=r("./src/screens/rakuen/board/component/item/ds.ts"),m=r("./src/screens/rakuen/board/component/item/styles.ts"),f=r("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var r=e.title,s=e.href,c=e.replies,p=e.time,b=e.userId,j=e.userName,y=t.$,_=t.navigation;if((0,u.getIsBlockedUser)(a.rakuenStore.blockUserIds,j,b,"Board|"+s))return null;var h=(0,m.memoStyles)(),x=s.replace("/subject/topic/","subject/"),v=!!y.readed(x).time,O="+"+c.replace(" replies","");return(0,f.jsx)(n.Touchable,{style:(0,u.stl)(h.item,v&&h.readed),animate:!0,onPress:function(){if(Number(c)>l.LIMIT_TOPIC_PUSH){var e=""+l.HOST+s;(0,i.t)("讨论版.跳转",{to:"WebBrowser",url:e}),(0,u.info)("该帖评论多, 自动使用浏览器打开"),setTimeout((function(){(0,u.open)(e)}),1600)}else y.onItemPress(x,c),(0,u.appNavigate)(s,_,{_title:r,_replies:O,_time:p},{id:"讨论版.跳转"})},children:(0,f.jsxs)(n.Flex,{style:h.wrap,align:"start",children:[(0,f.jsx)(o.default,{style:a._.mr.sm,children:(0,f.jsx)(d.Avatar,{navigation:_,userId:b,name:j,src:(0,l.API_AVATAR)(b)})}),(0,f.jsxs)(n.Flex.Item,{children:[(0,f.jsxs)(n.Text,{size:15,children:[(0,u.HTMLDecode)(r),"+0"!==O&&(0,f.jsxs)(n.Text,{type:v?"sub":"main",size:12,lineHeight:15,bold:!0,children:[" ",O]})]}),(0,f.jsxs)(n.Text,{style:a._.mt.xs,type:"sub",size:12,children:[(0,u.correctAgo)(p)," /"," ",(0,f.jsx)(d.Name,{userId:b,showFriend:!0,size:12,bold:!0,children:j})]})]})]})},s)}),p.COMPONENT)},"./src/screens/rakuen/board/component/item/styles.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=r("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{item:{paddingLeft:s._.wind-s._._wind+s._.md},wrap:{paddingVertical:s._.md,paddingRight:s._.wind-s._._wind+s._.md},readed:{backgroundColor:s._.colorBg}}}))},"./src/screens/rakuen/board/component/list/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/rakuen/board/component/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"List")},"./src/screens/rakuen/board/component/list/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.object.assign.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("./node_modules/react/index.js"));var o=r("./src/components/index.ts"),n=r("./src/stores/index.ts"),d=r("./src/utils/decorators/index.ts"),a=s(r("./src/screens/rakuen/board/component/item/index.tsx")),u=r("./src/screens/rakuen/board/component/list/ds.ts"),c=r("./src/screens/rakuen/board/component/list/styles.ts"),i=r("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var r=t.$,s=(t.navigation,r.board),d=s.list;return s._loaded&&!d.length?(0,i.jsxs)(o.Flex,{style:c.styles.empty,direction:"column",justify:"center",children:[(0,i.jsx)(o.Mesume,{}),(0,i.jsx)(o.Text,{style:n._.mt.sm,type:"sub",children:"好像什么都没有"})]}):(0,i.jsx)(o.ScrollView,{contentContainerStyle:n._.container.bottom,scrollToTop:!0,children:d.map((function(e){return(0,i.jsx)(a.default,Object.assign({},e),e.href)}))})}),u.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/board/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/rakuen/board/component/list/index.tsx#list"})}catch(e){}},"./src/screens/rakuen/board/component/list/styles.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=r("./src/stores/index.ts");t.styles=s._.create({empty:{minHeight:240}})},"./src/screens/rakuen/board/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.COMPONENT=void 0;var s=t.COMPONENT="Board";t.NAMESPACE="Screen"+s,t.STATE={history:[],ota:{},_loaded:!1}},"./src/screens/rakuen/board/header/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/rakuen/board/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"Header")},"./src/screens/rakuen/board/header/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.function.name.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("./node_modules/react/index.js"));var o=r("./src/components/index.ts"),n=r("./src/utils/index.ts"),d=r("./src/utils/decorators/index.ts"),a=r("./src/utils/fetch/index.ts"),u=r("./src/screens/rakuen/board/header/ds.ts"),c=r("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var r,s=t.$;return(0,c.jsx)(o.Header,{title:null!=(r=s.params)&&r.name?s.params.name+"的讨论版":"讨论版",alias:"讨论版",hm:[s.url,"Board"],headerRight:function(){return(0,c.jsx)(o.Header.Popover,{data:["浏览器查看"],onSelect:function(e){"浏览器查看"===e&&((0,a.t)("讨论版.右上角菜单",{key:e}),(0,n.open)(s.url))},children:(0,c.jsx)(o.Heatmap,{id:"讨论版.右上角菜单"})})}})}),u.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/board/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/rakuen/board/header/index.tsx#header"})}catch(e){}},"./src/screens/rakuen/board/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("./node_modules/react/index.js"));var o=r("./src/components/index.ts"),n=r("./src/utils/decorators/index.ts"),d=r("./src/utils/hooks/index.ts"),a=s(r("./src/screens/rakuen/board/component/list/index.tsx")),u=s(r("./src/screens/rakuen/board/header/index.tsx")),c=s(r("./src/screens/rakuen/board/store.ts")),i=r("./node_modules/react/jsx-runtime.js");t.default=(0,n.ic)(c.default,(function(e,t){var r=t.$;return(0,d.useRunAfter)((function(){r.init()})),(0,d.useObserver)((function(){return(0,i.jsxs)(o.Component,{id:"screen-board",children:[(0,i.jsx)(u.default,{}),(0,i.jsx)(o.Page,{loaded:r.board._loaded,children:(0,i.jsx)(a.default,{})})]})}))}));try{board.displayName="board",board.__docgenInfo={description:"",displayName:"board",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/board/index.tsx#board"]={docgenInfo:board.__docgenInfo,name:"board",path:"src/screens/rakuen/board/index.tsx#board"})}catch(e){}},"./src/screens/rakuen/board/store.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/web.timers.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,d=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),a=o(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=o(r("./node_modules/@babel/runtime/helpers/createClass.js")),c=o(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),i=o(r("./node_modules/@babel/runtime/helpers/inherits.js")),l=o(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=o(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=o(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),b=r("./node_modules/mobx/dist/mobx.esm.js"),j=r("./src/stores/index.ts"),y=r("./src/utils/index.ts"),_=r("./src/utils/kv/index.ts"),h=o(r("./src/utils/store/index.ts")),x=r("./src/constants/index.ts"),v=r("./src/screens/rakuen/board/ds.ts");function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,p.default)(e);if(t){var o=(0,p.default)(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return(0,l.default)(this,r)}}var k=[];t.default=(n=function(e){(0,i.default)(r,e);var t=O(r);function r(){var e;(0,a.default)(this,r);for(var o=arguments.length,n=new Array(o),u=0;u<o;u++)n[u]=arguments[u];return e=t.call.apply(t,[this].concat(n)),(0,m.default)((0,c.default)(e),"params",void 0),(0,m.default)((0,c.default)(e),"state",(0,b.observable)(v.STATE)),(0,m.default)((0,c.default)(e),"init",(0,d.default)(s.mark((function t(){var r;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(e.key);case 2:return r=t.sent,e.setState(Object.assign({},r,{ota:{},_loaded:!0})),t.abrupt("return",e.fetchBoard());case 5:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"fetchBoard",(0,d.default)(s.mark((function t(){var r,o,n;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.fetchThirdParty(),t.next=3,j.rakuenStore.fetchBoard({subjectId:e.subjectId});case 3:return(r=t.sent).list.length&&e.thirdPartyKey in e.state.ota&&(n=(null==(o=e.ota)?void 0:o.ts)||0,(0,y.getTimestamp)()-n>=604800&&e.updateThirdParty()),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"fetchThirdParty",(0,d.default)(s.mark((function t(){var r;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ota||e.board._loaded){t.next=8;break}return t.next=3,(0,_.get)(e.thirdPartyKey);case 3:if(r=t.sent){t.next=7;break}return e.setState({ota:(0,m.default)({},e.thirdPartyKey,{list:[],_loaded:0})}),t.abrupt("return");case 7:e.setState({ota:(0,m.default)({},e.thirdPartyKey,Object.assign({},r,{_loaded:(0,y.getTimestamp)()}))});case 8:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"updateThirdParty",(0,d.default)(s.mark((function t(){return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!k.includes(e.thirdPartyKey)){t.next=2;break}return t.abrupt("return");case 2:setTimeout((function(){(0,_.update)(e.thirdPartyKey,{list:e.board.list}),k.push(e.thirdPartyKey)}),0);case 3:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"onItemPress",(function(e,t){return j.rakuenStore.updateTopicReaded(e,t)})),e}return(0,u.default)(r,[{key:"subjectId",get:function(){var e=this.params.subjectId;return void 0===e?"":e}},{key:"key",get:function(){return v.NAMESPACE+"|"+this.subjectId}},{key:"board",get:function(){var e=j.rakuenStore.board(this.subjectId);return e._loaded?e:this.ota?Object.assign({},this.ota,{pagination:{page:1,pageTotal:10}}):x.LIST_EMPTY}},{key:"url",get:function(){return(0,x.HTML_BOARD)(this.subjectId)}},{key:"readed",value:function(e){return(0,b.computed)((function(){return j.rakuenStore.readed(e)})).get()}},{key:"ota",get:function(){return this.state.ota[this.thirdPartyKey]}},{key:"thirdPartyKey",get:function(){return"board_"+this.subjectId}}]),r}(h.default),(0,f.default)(n.prototype,"subjectId",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"subjectId"),n.prototype),(0,f.default)(n.prototype,"key",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"key"),n.prototype),(0,f.default)(n.prototype,"board",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"board"),n.prototype),(0,f.default)(n.prototype,"url",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"url"),n.prototype),(0,f.default)(n.prototype,"ota",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"ota"),n.prototype),(0,f.default)(n.prototype,"thirdPartyKey",[b.computed],Object.getOwnPropertyDescriptor(n.prototype,"thirdPartyKey"),n.prototype),n)}}]);