(self.webpackChunkweb=self.webpackChunkweb||[]).push([[6574],{"./src/screens/user/friends/component/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/user/friends/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"Component")},"./src/screens/user/friends/component/filter/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"Filter")},"./src/screens/user/friends/component/filter/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.array.filter.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),o=t("./src/components/index.ts"),d=t("./src/stores/index.ts"),i=t("./src/utils/decorators/index.ts"),u=t("./src/screens/user/friends/component/filter/ds.ts"),c=t("./src/screens/user/friends/component/filter/styles.ts"),l=t("./node_modules/react/jsx-runtime.js");s.default=(0,i.obc)((function(e,s){var t=s.$,r=(0,c.memoStyles)();return(0,l.jsxs)(n.default,{style:r.filter,children:[(0,l.jsx)(o.Input,{style:r.input,clearButtonMode:"never",defaultValue:t.state.filter,placeholder:t.friends.list.length+"个好友",onChangeText:t.onFilterChange}),t.state.fetching&&(0,l.jsx)(n.default,{style:r.loading,children:(0,l.jsx)(o.Loading.Medium,{color:d._.colorSub,size:16})})]})}),u.COMPONENT)},"./src/screens/user/friends/component/filter/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{filter:{height:56,paddingVertical:10,paddingHorizontal:r._.wind,backgroundColor:r._.colorBg},input:Object.assign({height:36,paddingVertical:0},r._.fontSize(16),{fontWeight:"800",textAlign:"center",backgroundColor:r._.select(r._.colorBorder,r._.colorPlain),borderRadius:40}),loading:{position:"absolute",zIndex:2,top:20,right:16,width:44,height:44}}}))},"./src/screens/user/friends/component/item-grid/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"ItemGrid")},"./src/screens/user/friends/component/item-grid/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),o=t("./src/components/index.ts"),d=t("./src/screens/_/index.ts"),i=t("./src/stores/index.ts"),u=t("./src/utils/index.ts"),c=t("./src/utils/decorators/index.ts"),l=t("./src/utils/fetch/index.ts"),a=t("./src/screens/user/friends/component/item-grid/ds.ts"),m=t("./src/screens/user/friends/component/item-grid/styles.ts"),f=t("./node_modules/react/jsx-runtime.js");s.default=(0,c.obc)((function(e,s){var t=e.index,r=e.item,c=s.navigation,a=(0,m.memoStyles)(),p=r.userId,j=r.avatar,_=r.userName;return(0,f.jsx)(n.default,{style:(0,u.stl)(a.item,t%i._.portrait(5,8)==0&&a.left),children:(0,f.jsxs)(o.Touchable,{animate:!0,scale:.9,onPress:function(){(0,l.t)("好友.跳转",{to:"Zone",userId:p}),c.push("Zone",{userId:p,_name:_,_image:j})},children:[(0,f.jsx)(o.Avatar,{size:a.item.width,src:j,radius:!0}),(0,f.jsx)(d.Name,{style:i._.mt.sm,size:11,bold:!0,userId:p,children:(0,u.HTMLDecode)(_)}),(0,f.jsxs)(o.Text,{style:i._.mt.xs,type:"sub",size:9,numberOfLines:1,bold:!0,children:["@",p]})]})})}),a.COMPONENT)},"./src/screens/user/friends/component/item-grid/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){var e=r._.portrait(5,8),s=r._.grid(e);return{item:{width:s.width,marginTop:r._.md,marginLeft:s.marginLeft},left:{marginLeft:0}}}))},"./src/screens/user/friends/component/list/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/user/friends/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"List")},"./src/screens/user/friends/component/list/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=t("./src/screens/_/index.ts"),o=t("./src/stores/index.ts"),d=t("./src/utils/decorators/index.ts"),i=t("./src/screens/user/friends/component/list/utils.tsx"),u=t("./src/screens/user/friends/component/list/ds.ts"),c=t("./src/screens/user/friends/component/list/styles.ts"),l=t("./node_modules/react/jsx-runtime.js");s.default=(0,d.obc)((function(e,s){var t=s.$,r=(0,c.memoStyles)(),d=o._.portrait(5,8);return(0,l.jsx)(n.PaginationList2,{keyExtractor:i.keyExtractor,contentContainerStyle:r.contentContainerStyle,data:t.list,numColumns:d,limit:6*d,renderItem:i.renderItem,onHeaderRefresh:t.fetchFriends})}),u.COMPONENT)},"./src/screens/user/friends/component/list/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{contentContainerStyle:{paddingTop:r._.sm,paddingHorizontal:r._.wind,paddingBottom:r._.bottom}}}))},"./src/screens/user/friends/component/list/utils.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.keyExtractor=function(e){return String(e.userId)},s.renderItem=function(e){var s=e.item,t=e.index;return(0,o.jsx)(n.default,{index:t,item:s})};r(t("react"));var n=r(t("./src/screens/user/friends/component/item-grid/index.tsx")),o=t("./node_modules/react/jsx-runtime.js")},"./src/screens/user/friends/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var r=s.COMPONENT="Friends",n=(s.NAMESPACE="Screen"+r,s.EXCLUDE_STATE={sort:"",filter:"",fetching:!1});s.STATE=Object.assign({},n,{_loaded:!1})},"./src/screens/user/friends/header/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/user/friends/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"Header")},"./src/screens/user/friends/header/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=t("./src/components/index.ts"),o=t("./src/utils/index.ts"),d=t("./src/utils/decorators/index.ts"),i=t("./src/utils/fetch/index.ts"),u=t("./src/screens/user/friends/header/ds.ts"),c=t("./node_modules/react/jsx-runtime.js");s.default=(0,d.obc)((function(e,s){var t=s.$;return(0,c.jsx)(n.Header,{title:"好友",headerTitleAlign:"left",hm:[t.url,"Friends"],headerRight:function(){return(0,c.jsx)(n.Header.Popover,{data:["浏览器查看"],onSelect:function(e){"浏览器查看"===e&&((0,i.t)("好友.右上角菜单",{key:e}),(0,o.open)(t.url))},children:(0,c.jsx)(n.Heatmap,{id:"好友.右上角菜单"})})}})}),u.COMPONENT)},"./src/screens/user/friends/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=t("./src/components/index.ts"),o=t("./src/stores/index.ts"),d=t("./src/utils/decorators/index.ts"),i=t("./src/utils/hooks/index.ts"),u=r(t("./src/screens/user/friends/component/filter/index.tsx")),c=r(t("./src/screens/user/friends/component/list/index.tsx")),l=r(t("./src/screens/user/friends/header/index.tsx")),a=r(t("./src/screens/user/friends/store.ts")),m=t("./node_modules/react/jsx-runtime.js");s.default=(0,d.ic)(a.default,(function(e,s){var t=s.$;return(0,i.useRunAfter)((function(){t.init()})),(0,i.useObserver)((function(){return(0,m.jsxs)(n.Component,{id:"screen-friends",children:[(0,m.jsx)(l.default,{}),(0,m.jsxs)(n.Page,{children:[(0,m.jsx)(u.default,{}),(0,m.jsx)(c.default,{})]}),(0,m.jsx)(n.Heatmap,{bottom:o._.bottom+o._.sm,id:"好友",screen:"Friends"})]})}))}))},"./src/screens/user/friends/store.ts":(e,s,t)=>{var r=t("./node_modules/@babel/runtime/regenerator/index.js");t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.object.assign.js"),t("./node_modules/core-js/modules/es.array.for-each.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),t("./node_modules/core-js/modules/es.number.constructor.js"),t("./node_modules/core-js/modules/es.string.trim.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),t("./node_modules/core-js/modules/es.array.sort.js"),t("./node_modules/core-js/modules/es.array.slice.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,d=n(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=n(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=n(t("./node_modules/@babel/runtime/helpers/createClass.js")),c=n(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=n(t("./node_modules/@babel/runtime/helpers/inherits.js")),a=n(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=n(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=n(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=n(t("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=t("./node_modules/mobx/dist/mobx.esm.js"),_=t("./src/stores/index.ts"),b=t("./src/utils/index.ts"),y=n(t("./src/utils/cache-manager/index.ts")),x=t("./src/utils/fetch/index.ts"),h=n(t("./src/utils/store/index.ts")),v=t("./src/constants/index.ts"),g=t("./src/screens/user/friends/utils.ts"),O=t("./src/screens/user/friends/ds.ts");function P(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,m.default)(e);if(s){var n=(0,m.default)(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return(0,a.default)(this,t)}}s.default=(o=function(e){(0,l.default)(t,e);var s=P(t);function t(){var e;(0,i.default)(this,t);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return e=s.call.apply(s,[this].concat(o)),(0,f.default)((0,c.default)(e),"params",void 0),(0,f.default)((0,c.default)(e),"state",(0,j.observable)(O.STATE)),(0,f.default)((0,c.default)(e),"init",(0,d.default)(r.mark((function s(){return r.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=e,s.t1=Object,s.t2={},s.next=5,e.getStorage(O.NAMESPACE);case 5:return s.t3=s.sent,s.t4=O.EXCLUDE_STATE,s.t5={_loaded:!0},s.t6=s.t1.assign.call(s.t1,s.t2,s.t3,s.t4,s.t5),s.t0.setState.call(s.t0,s.t6),s.abrupt("return",e.fetchFriends());case 11:case"end":return s.stop()}}),s)})))),(0,f.default)((0,c.default)(e),"fetchFriends",(function(){return _.usersStore.fetchFriends({userId:e.userId})})),(0,f.default)((0,c.default)(e),"fetchUsersBatch",(0,d.default)(r.mark((function s(){var t;return r.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!e.state.fetching){s.next=2;break}return s.abrupt("return",!1);case 2:return e.setState({fetching:!0}),t=[],e.list.forEach((function(s,r){var n=e.users(s.userId)._loaded;(!n||(0,b.getTimestamp)()-Number(n)>=60*(15+r))&&t.push((function(){return _.usersStore.fetchUsers({userId:s.userId})}))})),s.next=7,(0,x.queue)(t);case 7:return e.setState({fetching:!1}),s.abrupt("return",!0);case 9:case"end":return s.stop()}}),s)})))),(0,f.default)((0,c.default)(e),"onSort",(function(s){(0,x.t)("好友.排序",{title:s});var t="";"同步率"===s&&(t="percent"),"最近"===s&&(t="recent"),e.setState({sort:t}),e.setStorage(O.NAMESPACE)})),(0,f.default)((0,c.default)(e),"onFilterChange",(0,b.debounce)((function(s){e.setState({filter:s.trim()})}))),e}return(0,u.default)(t,[{key:"userId",get:function(){return this.params.userId}},{key:"users",value:function(e){return(0,j.computed)((function(){return _.usersStore.users(e)})).get()}},{key:"friends",get:function(){return _.usersStore.friends(this.userId)}},{key:"list",get:function(){var e=this,s=O.NAMESPACE+"|list|"+this.userId;if(this.state.fetching&&y.default.get(s))return y.default.get(s);var t=this.state.filter.toUpperCase(),r=this.friends.list;t.length&&(r=r.filter((function(e){var s=e.userName;return!!s.includes(t)||(0,b.getPinYinFilterValue)(s,t)})));var n=this.state.sort;return"percent"===n&&(r=r.slice().sort((function(s,t){return(0,b.desc)(s,t,(function(s){var t;return null==(t=e.users(s.userId))?void 0:t.percent}))}))),"recent"===n&&(r=r.slice().sort((function(s,t){return(0,g.sortByRecent)(e.users(s.userId).recent,e.users(t.userId).recent)}))),y.default.set(s,r)}},{key:"url",get:function(){var e;return(0,v.HTML_FRIENDS)((null==(e=this.params)?void 0:e.userId)||_.userStore.myId)}}]),t}(h.default),(0,p.default)(o.prototype,"userId",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"userId"),o.prototype),(0,p.default)(o.prototype,"friends",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"friends"),o.prototype),(0,p.default)(o.prototype,"list",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"list"),o.prototype),(0,p.default)(o.prototype,"url",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"url"),o.prototype),o)},"./src/screens/user/friends/utils.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.sortByRecent=function(e,s){return e.includes("-")&&!s.includes("-")?1:!e.includes("-")&&s.includes("-")?-1:e.includes("-")&&s.includes("-")?(0,r.desc)((0,r.getTimestamp)(e)||0,(0,r.getTimestamp)(s)||0):(0,r.asc)((0,r.getRecentTimestamp)(e)||0,(0,r.getRecentTimestamp)(s)||0)};var r=t("./src/utils/index.ts")}}]);