(self.webpackChunkweb=self.webpackChunkweb||[]).push([[1990],{"./src/screens/home/subject/component/rating/chart/chart.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.keys.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.array.reverse.js"),t("./node_modules/core-js/modules/es.number.constructor.js"),t("./node_modules/core-js/modules/es.number.to-fixed.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var o=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),n=t("./src/components/index.ts"),i=t("./src/stores/index.ts"),c=t("./src/utils/index.ts"),d=t("./src/utils/decorators/index.ts"),l=t("./src/screens/home/subject/component/rating/chart/utils.ts"),a=t("./src/screens/home/subject/component/rating/chart/ds.ts"),u=t("./node_modules/react/jsx-runtime.js"),m=(0,d.memo)((function(e){var s=e.navigation,t=e.styles,r=e.friend,d=e.rating,m=e.total,j=e.count,b=e.score,p=e.toRating,h=(0,l.getDeviation)(m,j,b),x=Object.keys(j).length?j:a.DEFAULT_RATES;return(0,u.jsxs)(u.Fragment,{children:[!!m&&(0,u.jsxs)(n.Text,{style:t.total,size:12,type:"sub",children:[m," votes"]}),(0,u.jsx)(n.Flex,{style:t.chart,children:Object.keys(x).reverse().map((function(e,s){var r=(0,l.getHeight)(m,x[e]),a=d==e;return(0,u.jsxs)(n.Flex.Item,{style:s>0&&i._.ml.xs,children:[(0,u.jsxs)(n.Flex,{style:t.item,justify:"center",align:"end",children:[(0,u.jsx)(o.default,{style:(0,c.stl)(t.itemFill,a&&t.itemFillActive,{height:r})}),(0,u.jsxs)(n.Text,{style:[t.count,{bottom:r}],size:10,type:a?"warning":"sub",align:"center",bold:!0,children:[x[e]," "]})]}),(0,u.jsx)(n.Text,{style:i._.mt.sm,size:12,type:a?"warning":"title",align:"center",children:e})]},e)}))}),(0,u.jsxs)(n.Flex,{style:i._.mt.md,children:[(0,u.jsx)(n.Flex.Item,{children:(0,u.jsxs)(n.Touchable,{style:t.friend,onPress:function(){return p(s,"评分分布")},children:[(0,u.jsxs)(n.Flex,{children:[Number(r.score)?(0,u.jsxs)(n.Text,{size:12,type:"sub",children:["好友",(0,u.jsxs)(n.Text,{size:12,type:"main",children:[" ",r.score," "]}),(0,u.jsxs)(n.Text,{size:12,lineHeight:12,type:"sub",children:["(",r.total,")"]})]}):(0,u.jsx)(n.Text,{size:12,lineHeight:12,type:"sub",children:"用户评分"}),(0,u.jsx)(n.Iconfont,{name:"md-navigate-next"})]}),(0,u.jsx)(n.Heatmap,{id:"条目.跳转",from:"评分分布"})]})}),(0,u.jsx)(n.Touchable,{style:t.deviation,onPress:function(){s.push("Information",{title:"标准差",message:["0-1 异口同声","1.15 基本一致","1.3 略有分歧","1.45 莫衷一是","1.6 各执一词","1.75 你死我活"]})},children:(0,u.jsxs)(n.Flex,{children:[(0,u.jsx)(n.Text,{size:12,type:"sub",children:"标准差"}),(0,u.jsxs)(n.Text,{size:12,type:"main",children:[" ",(0,c.toFixed)(h,2)," "]}),(0,u.jsxs)(n.Text,{size:12,lineHeight:12,type:"sub",children:[(0,l.getDispute)(h)," "]}),(0,u.jsx)(n.Iconfont,{style:i._.ml.xs,name:"md-info-outline",size:16})]})})]})]})}),a.DEFAULT_PROPS,a.COMPONENT_MAIN);s.default=m},"./src/screens/home/subject/component/rating/chart/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.DEFAULT_RATES=s.DEFAULT_PROPS=s.COMPONENT_MAIN=s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),o=t("./src/constants/index.ts"),n=t("./src/screens/home/subject/component/rating/ds.ts"),i=s.COMPONENT=(0,r.rc)(n.COMPONENT,"Chart");s.COMPONENT_MAIN=(0,r.rc)(i),s.DEFAULT_PROPS={navigation:{},styles:{},friend:{},rating:0,total:0,count:{},score:0,toRating:o.FROZEN_FN},s.DEFAULT_RATES={1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:0}},"./src/screens/home/subject/component/rating/chart/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var o=t("./src/utils/decorators/index.ts"),n=r(t("./src/screens/home/subject/component/rating/chart/chart.tsx")),i=t("./src/screens/home/subject/component/rating/chart/ds.ts"),c=t("./src/screens/home/subject/component/rating/chart/styles.ts"),d=t("./node_modules/react/jsx-runtime.js");s.default=(0,o.obc)((function(e,s){var t=s.$,r=s.navigation,o=t.rating,i=o.total,l=o.count,a=o.score;return(0,d.jsx)(n.default,{navigation:r,styles:(0,c.memoStyles)(),friend:t.subjectFormHTML.friend,rating:t.collection.rating,total:i,count:l,score:a,toRating:t.toRating})}),i.COMPONENT)},"./src/screens/home/subject/component/rating/chart/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{total:{position:"absolute",zIndex:1,top:10,right:0},chart:{minHeight:144,marginTop:r._.md,marginHorizontal:-4},item:{height:144,paddingBottom:r._.xs,marginTop:-r._.md},itemFill:{position:"absolute",left:"50%",width:r._.device(6,8),marginLeft:r._.device(-3,-4),backgroundColor:r._.select(r._.colorWait,r._._colorSub),borderRadius:r._.device(6,4)},itemFillActive:{backgroundColor:r._.colorWarning},count:{position:"absolute",zIndex:1,right:0,left:0,marginBottom:4},friend:{paddingLeft:r._.xs,marginLeft:-r._.xs,borderRadius:r._.radiusSm,overflow:"hidden"},deviation:{paddingLeft:r._.xs,marginRight:-r._.xs,borderRadius:r._.radiusSm,overflow:"hidden"}}}))},"./src/screens/home/subject/component/rating/chart/utils.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.number.constructor.js"),t("./node_modules/core-js/modules/es.array.reverse.js"),t("./node_modules/core-js/modules/es.object.values.js"),t("./node_modules/core-js/modules/es.array.for-each.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.getDeviation=function(e,s,t){return 0==e?0:function(e,s,t){var r=0;return e.forEach((function(e,t){0!==e&&(r+=(10-t-Number(s))*(10-t-Number(s))*e)})),Math.sqrt(r/Number(t))}(Object.values(s).reverse(),t,e)},s.getDispute=function(e){return 0===e?"-":e<1?"异口同声":e<1.15?"基本一致":e<1.3?"略有分歧":e<1.45?"莫衷一是":e<1.6?"各执一词":e<1.75?"你死我活":"厨黑大战"},s.getHeight=function(e,s){if(!e||!s)return 0;var t=s/Number(e);t>0&&t<r&&(t=r);return 100*Math.min(1.44*t||r,.9)+"%"};var r=.04},"./src/screens/home/subject/component/rating/rating.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.weak-map.js"),t("./node_modules/core-js/modules/es.object.to-string.js"),t("./node_modules/core-js/modules/es.string.iterator.js"),t("./node_modules/core-js/modules/es.array.iterator.js"),t("./node_modules/core-js/modules/web.dom-collections.iterator.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=r(t("./node_modules/@babel/runtime/helpers/slicedToArray.js")),n=function(e,s){if(!s&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h(s);if(t&&t.has(e))return t.get(e);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=o?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}(t("react")),i=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),c=t("./src/components/index.ts"),d=t("./src/utils/decorators/index.ts"),l=t("./src/screens/home/subject/ds.ts"),a=r(t("./src/screens/home/subject/component/icon/hidden.tsx")),u=r(t("./src/screens/home/subject/component/rating/chart/index.tsx")),m=r(t("./src/screens/home/subject/component/rating/title/index.tsx")),j=r(t("./src/screens/home/subject/component/rating/vib/index.tsx")),b=t("./src/screens/home/subject/component/rating/ds.ts"),p=t("./node_modules/react/jsx-runtime.js");function h(e){if("function"!=typeof WeakMap)return null;var s=new WeakMap,t=new WeakMap;return(h=function(e){return e?t:s})(e)}var x=(0,d.memo)((function(e){var s=e.styles,t=e.hideScore,r=e.showRating,d=(0,n.useState)(!t),b=(0,o.default)(d,2),h=b[0],x=b[1];return(0,p.jsxs)(i.default,{style:r?s.container:s.hide,children:[(0,p.jsxs)(c.Flex,{children:[(0,p.jsx)(c.Flex.Item,{children:(0,p.jsx)(m.default,{showScore:h})}),!r&&(0,p.jsx)(a.default,{name:l.TITLE_RATING,value:"showRating"})]}),r&&(0,p.jsx)(i.default,{style:s.rate,children:h?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(u.default,{}),(0,p.jsx)(j.default,{})]}):(0,p.jsx)(c.Touchable,{onPress:function(){return x(!0)},children:(0,p.jsx)(c.Flex,{style:s.hideScore,justify:"center",children:(0,p.jsx)(c.Text,{children:"评分已隐藏, 点击显示"})})})})]})}),b.DEFAULT_PROPS,b.COMPONENT_MAIN);s.default=x},"./src/screens/home/subject/component/rating/title/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),o=t("./src/screens/home/subject/component/rating/ds.ts");s.COMPONENT=(0,r.rc)(o.COMPONENT,"Title")},"./src/screens/home/subject/component/rating/title/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var o=t("./src/components/index.ts"),n=t("./src/screens/_/index.ts"),i=t("./src/stores/index.ts"),c=t("./src/utils/decorators/index.ts"),d=t("./src/screens/home/subject/ds.ts"),l=t("./src/screens/home/subject/component/rating/title/ds.ts"),a=t("./src/screens/home/subject/component/rating/title/styles.ts"),u=t("./node_modules/react/jsx-runtime.js");s.default=(0,c.obc)((function(e,s){var t,r,c=e.showScore,l=s.$,m=(s.navigation,i.systemStore.setting.showRating);return(0,u.jsxs)(n.SectionTitle,{left:m&&(0,u.jsx)(n.Rank,{style:a.styles.rank,value:l.subject.rank||(null==(t=l.subjectFromOSS)||null==(r=t.rating)?void 0:r.rank)||"-",size:13}),icon:!m&&"md-navigate-next",onPress:function(){return l.onSwitchBlock("showRating")},children:[d.TITLE_RATING," ",c&&(0,u.jsx)(o.Text,{type:"warning",size:18,lineHeight:18,bold:!0,children:l.rating.score})]})}),l.COMPONENT)},"./src/screens/home/subject/component/rating/title/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.styles=void 0;var r=t("./src/stores/index.ts");s.styles=r._.create({netabare:{borderRadius:r._.radiusSm,overflow:"hidden"},rate:{paddingLeft:r._.sm,marginRight:-r._.xs,borderRadius:r._.radiusSm,overflow:"hidden"},rank:{minWidth:r._.r(44),marginLeft:r._.xs}})},"./src/screens/home/subject/component/rating/vib/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),o=t("./src/screens/home/subject/component/rating/ds.ts");s.COMPONENT=(0,r.rc)(o.COMPONENT,"VIB")},"./src/screens/home/subject/component/rating/vib/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.string.replace.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.number.to-fixed.js"),t("./node_modules/core-js/modules/es.number.constructor.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var o=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),n=t("./src/components/index.ts"),i=t("./src/screens/_/index.ts"),c=t("./src/utils/index.ts"),d=t("./src/utils/decorators/index.ts"),l=t("./src/utils/fetch/index.ts"),a=t("./src/screens/home/subject/component/rating/vib/ds.ts"),u=t("./src/screens/home/subject/component/rating/vib/styles.ts"),m=t("./node_modules/react/jsx-runtime.js");s.default=(0,d.obc)((function(e,s){var t=s.$,r=s.navigation,d=(0,u.memoStyles)(),a=["VIB"];return t.vib.anidb&&a.push("AniDB"),t.vib.mal&&a.push("MAL"),"动画"===t.type&&a.push("netaba.re"),(0,m.jsx)(o.default,{style:d.vib,children:(0,m.jsx)(i.Popover,{data:a,onSelect:function(e){return"VIB"===e?((0,l.t)("条目.跳转",{to:"Stats",from:"评分分布",subjectId:t.subjectId}),void r.push("WebBrowser",{title:(0,c.cnjp)(t.cn,t.jp)+"的透视",url:"https://bgm.tv/subject/"+t.subjectId+"/stats"})):"netaba.re"===e?((0,l.t)("条目.跳转",{to:"Netabare",from:"评分分布",subjectId:t.subjectId}),void r.push("WebBrowser",{title:(0,c.cnjp)(t.cn,t.jp)+"的趋势",url:"https://netaba.re/subject/"+t.subjectId})):void("AniDB"!==e?"MAL"!==e||(0,c.open)("https://myanimelist.net/anime.php?q="+(t.jp||t.cn)):(0,c.open)("https://anidb.net/anime/?adb.search="+(t.jp||t.cn).replace(/～|、|・/g," ")+"&do.search=1"))},children:(0,m.jsxs)(n.Flex,{style:d.container,direction:"column",align:"end",children:[t.vib.avg?(0,m.jsxs)(n.Text,{type:"sub",size:10,lineHeight:11,children:["VIB: ",Number(t.vib.avg).toFixed(1)," (",t.vib.total,")"]}):(0,m.jsx)(n.Text,{type:"sub",size:10,lineHeight:11,children:"VIB: N/A"}),!!t.vib.anidb&&(0,m.jsxs)(n.Text,{type:"sub",size:10,lineHeight:11,children:["AniDB: ",Number(t.vib.anidb).toFixed(1)," (",t.vib.anidbTotal,")"]}),!!t.vib.mal&&(0,m.jsxs)(n.Text,{type:"sub",size:10,lineHeight:11,children:["MAL: ",Number(t.vib.mal).toFixed(1)," (",t.vib.malTotal,")"]})]})})})}),a.COMPONENT)},"./src/screens/home/subject/component/rating/vib/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{vib:{position:"absolute",zIndex:1,top:34,right:-4},container:{paddingTop:4,paddingHorizontal:8,paddingBottom:6,backgroundColor:r._.select(r._.colorBg,r._.colorDarkModeLevel1),borderRadius:r._.radiusXs,overflow:"hidden"}}}))}}]);