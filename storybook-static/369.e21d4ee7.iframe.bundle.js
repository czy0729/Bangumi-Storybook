(self.webpackChunkweb=self.webpackChunkweb||[]).push([[369],{"./src/screens/user/server-status/index.tsx":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.map.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),o=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),a=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),d=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),c=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),g=n(s("./node_modules/react/index.js")),p=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),h=s("./src/components/index.ts"),f=s("./src/stores/index.ts"),b=s("./src/utils/decorators/index.ts"),y=s("./src/utils/fetch/index.ts"),j=s("./src/screens/user/server-status/utils.ts"),_=s("./src/screens/user/server-status/styles.ts"),x=s("./node_modules/react/jsx-runtime.js");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,c.default)(e);if(t){var n=(0,c.default)(this).constructor;s=Reflect.construct(r,arguments,n)}else s=r.apply(this,arguments);return(0,d.default)(this,s)}}var S=function(e){(0,u.default)(s,e);var t=v(s);function s(){var e;(0,o.default)(this,s);for(var n=arguments.length,l=new Array(n),u=0;u<n;u++)l[u]=arguments[u];return e=t.call.apply(t,[this].concat(l)),(0,m.default)((0,a.default)(e),"state",{list:(0,j.getSitesList)(),pinging:!1}),(0,m.default)((0,a.default)(e),"onPingOne",(function(t){var s=e.state,n=s.list;s.pinging||((0,y.t)("网络探针.检测",{index:t}),n[t].msg=[],n[t].loading=!0,e.setState({list:n,pinging:!0},(0,i.default)(r.mark((function s(){var n,i,o;return r.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=e.state.list,i=0;case 2:if(!(i<4)){s.next=11;break}return s.next=5,(0,y.ping)(n[t].url,n[t].headers);case 5:o=s.sent,n[t].msg.push(o),e.setState({list:n});case 8:i+=1,s.next=2;break;case 11:n[t].loading=!1,e.setState({list:n,pinging:!1});case 13:case"end":return s.stop()}}),s)})))))})),(0,m.default)((0,a.default)(e),"onPing",(function(){e.state.pinging||((0,y.t)("网络探针.全部检测"),e.setState({list:(0,j.getSitesList)(),pinging:!0},(0,i.default)(r.mark((function t(){var s,n,i,o;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e.state.list,n=0;case 2:if(!(n<s.length)){t.next=20;break}s[n].loading=!0,e.setState({list:s}),i=0;case 6:if(!(i<4)){t.next=15;break}return t.next=9,(0,y.ping)(s[n].url,s[n].headers);case 9:o=t.sent,s[n].msg.push(o),e.setState({list:s});case 12:i+=1,t.next=6;break;case 15:s[n].loading=!1,e.setState({list:s});case 17:n+=1,t.next=2;break;case 20:e.setState({pinging:!1});case 21:case"end":return t.stop()}}),t)})))))})),(0,m.default)((0,a.default)(e),"computedStatus",(function(e){var t=0;e.filter((function(e,t){return!!t})).forEach((function(e){return t+=e||5e3}));var s=t/e.length;return s<=150?"Success":s<=1e3?"Warning":"Danger"})),e}return(0,l.default)(s,[{key:"render",value:function(){var e=this,t=this.state.list;return(0,x.jsxs)(h.Component,{id:"screen-server-status",children:[(0,x.jsx)(h.Header,{title:"网络探针",hm:["server-status","ServerStatus"]}),(0,x.jsxs)(h.ScrollView,{style:f._.container.plain,contentContainerStyle:this.styles.contentContainerStyle,scrollToTop:!0,children:[(0,x.jsx)(h.Text,{style:f._.mt.md,size:12,lineHeight:14,type:"sub",children:"绿色 < 150ms，黄色 < 1000ms，红色 (或超时) > 1000ms (5000ms)，若必要服务为红色则严重影响 App 的正常使用"}),t.map((function(t,s){return(0,x.jsxs)(h.Flex,{style:f._.mt.lg,align:"start",children:[(0,x.jsxs)(p.default,{style:e.styles.desc,children:[(0,x.jsxs)(h.Text,{bold:!0,children:[s+1,". ",t.desc]}),(0,x.jsx)(h.Text,{style:f._.mt.xs,size:12,type:"sub",selectable:!0,children:t.title})]}),(0,x.jsx)(h.Flex.Item,{style:f._.ml.md,children:t.msg.filter((function(e,t){return!!t})).map((function(e,t){return(0,x.jsx)(h.Text,{style:f._.mb.xs,size:10,children:e?e+"ms":">5000ms 超时"},t)}))}),(0,x.jsxs)(h.Flex,{justify:"end",children:[t.msg.length>=4&&(0,x.jsx)(p.default,{style:[e.styles.status,e.styles["status"+e.computedStatus(t.msg)]]}),(0,x.jsx)(h.Flex,{style:e.styles.loading,justify:"end",children:t.loading?(0,x.jsx)(h.Flex,{style:e.styles.activity,justify:"center",children:(0,x.jsx)(h.Activity,{})}):(0,x.jsx)(h.Button,{style:e.styles.btnCheck,type:"plain",size:"sm",onPress:function(){return e.onPingOne(s)},children:"检测"})})]})]},t.title)}))]}),(0,x.jsxs)(p.default,{style:this.styles.btn,children:[(0,x.jsx)(h.Button,{type:"bid",onPress:this.onPing,children:"全部检测"}),(0,x.jsx)(h.Heatmap,{right:80,id:"网络探针.全部检测"})]})]})}},{key:"styles",get:function(){return(0,_.memoStyles)()}}]),s}(g.default.Component);t.default=(0,b.ob)(S);try{serverstatus.displayName="serverstatus",serverstatus.__docgenInfo={description:"",displayName:"serverstatus",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/user/server-status/index.tsx#serverstatus"]={docgenInfo:serverstatus.__docgenInfo,name:"serverstatus",path:"src/screens/user/server-status/index.tsx#serverstatus"})}catch(e){}},"./src/screens/user/server-status/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts");t.memoStyles=r._.memoStyles((function(){return{contentContainerStyle:{paddingHorizontal:r._.wind,paddingBottom:r._.bottom+r._.lg},desc:{width:"52%"},btn:{position:"absolute",zIndex:1,right:r._.wind,bottom:24,left:r._.wind,borderRadius:40,overflow:"hidden"},status:{width:8,height:8,marginRight:r._.md,borderRadius:4},statusSuccess:{backgroundColor:r._.colorSuccess},statusWarning:{backgroundColor:r._.colorWarning},statusDanger:{backgroundColor:r._.colorDanger},loading:{width:80},activity:{width:56},btnCheck:{width:"100%",borderRadius:16,overflow:"hidden"}}}))},"./src/screens/user/server-status/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.array.concat.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.getSitesList=function(){var e=[];try{var t=(0,i.getOriginConfig)(r.subjectStore.origin);Object.keys(t).forEach((function(s){t[s].forEach((function(t){1===t.active&&e.push({title:t.url,desc:t.name+" (源头)",url:t.url,msg:[],loading:!1})}))}))}catch(e){}return[{title:"https://bgm.tv",desc:"主站 (必要)",url:"https://bgm.tv/about/copyright",msg:[],loading:!1},{title:"https://bangumi.tv",desc:"登录验证码 (登录必要)",url:"https://bangumi.tv/about/copyright",msg:[],loading:!1},{title:n.URL_OAUTH,desc:"授权登录服务 (登录必要)",url:n.URL_OAUTH,msg:[],loading:!1},{title:"https://api.bgm.tv",desc:"主站 Api (必要)",url:(0,n.API_CALENDAR)(),msg:[],loading:!1},{title:"https://gitee.com",desc:"CDN 版本检测",url:"https://gitee.com/a402731062/bangumi/raw/master/data.json",msg:[],loading:!1},{title:"https://cdn.jsdelivr.net",desc:"CDN 资源域",url:(0,n.CDN_DISCOVERY_HOME)(),msg:[],loading:!1},{title:"https://tinygrail.com",desc:"小圣杯 Api",url:"https://tinygrail.com",msg:[],loading:!1},{title:n.GITHUB_RELEASE_REPOS,desc:"App 版本检测",url:n.GITHUB_RELEASE_REPOS,msg:[],loading:!1},{title:"https://bangumi-mosaic-tile.aho.im",desc:"进度瓷砖 Api",url:"https://bangumi-mosaic-tile.aho.im",msg:[],loading:!1},{title:"/gh/ekibun/bangumi_onair",desc:"每日放送",url:(0,n.CDN_ONAIR)(),msg:[],loading:!1},{title:(0,n.SITE_AGEFANS)()+"/update",desc:"Agefans",url:(0,n.SITE_AGEFANS)()+"/update",msg:[],loading:!1},{title:"https://api.bilibili.com/pgc/web/season/section?season_id=1",desc:"bilibili 番剧预览图",url:"https://api.bilibili.com/pgc/web/season/section?season_id=1",headers:{Referer:"https://www.bilibili.com/"},msg:[],loading:!1},{title:"https://list.youku.com/show/module?id=1&tab=point&callback=jQuery",desc:"youku 番剧预览图",url:"https://list.youku.com/show/module?id=1&tab=point&callback=jQuery",headers:{Referer:"https://list.youku.com/"},msg:[],loading:!1},{title:"https://netaba.re",desc:"netaba.re",url:"https://netaba.re",msg:[],loading:!1},{title:n.HOST_IMAGE_UPLOAD,desc:"免费图床",url:n.HOST_IMAGE_UPLOAD,msg:[],loading:!1}].concat(e)};var r=s("./src/stores/index.ts"),n=s("./src/constants/index.ts"),i=s("./src/screens/user/origin-setting/utils.ts")}}]);