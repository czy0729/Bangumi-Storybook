(self.webpackChunkweb=self.webpackChunkweb||[]).push([[479],{"./src/screens/rakuen/topic/component/bottom/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.MARKS=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Bottom"),t.MARKS=["+1","mark","(bgm38)"]},"./src/screens/rakuen/topic/component/bottom/extra/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/bottom/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Extra")},"./src/screens/rakuen/topic/component/bottom/extra/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/stores/index.ts"),i=o("./src/utils/dev/index.ts"),a=o("./src/utils/hooks/index.ts"),d=o("./src/screens/rakuen/topic/component/bottom/extra/ds.ts"),c=o("./src/screens/rakuen/topic/component/bottom/extra/styles.ts"),l=o("./node_modules/react/jsx-runtime.js");function u(e){var t=e.onDirect;(0,i.r)(d.COMPONENT);var o=(0,c.memoStyles)(),s=n.rakuenStore.setting.switchSlider,u=n._.ios("height","bottom");return(0,a.useObserver)((function(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.SafeAreaBottom,{style:o.left,type:u,children:(0,l.jsx)(r.Touchable,{useRN:!0,onPress:function(){return t(!!s)},onLongPress:function(){return t(!!s,20)},children:(0,l.jsx)(r.Flex,{style:o.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{style:n._.mr.md,name:s?"md-navigate-next":"md-navigate-before",size:24})})})}),(0,l.jsx)(r.SafeAreaBottom,{style:o.center,type:u,pointerEvents:"none",children:(0,l.jsx)(r.Flex,{style:o.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{name:"md-edit",size:15})})}),(0,l.jsx)(r.SafeAreaBottom,{style:o.right,type:u,children:(0,l.jsx)(r.Touchable,{useRN:!0,onPress:function(){return t(!s)},onLongPress:function(){return t(!s,20)},children:(0,l.jsx)(r.Flex,{style:o.btn,justify:"center",children:(0,l.jsx)(r.Iconfont,{style:n._.ml.md,name:s?"md-navigate-before":"md-navigate-next",size:24})})})})]})}))}t.default=u;try{u.displayName="Extra",u.__docgenInfo={description:"",displayName:"Extra",props:{onDirect:{defaultValue:null,description:"",name:"onDirect",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/bottom/extra/index.tsx#Extra"]={docgenInfo:u.__docgenInfo,name:"Extra",path:"src/screens/rakuen/topic/component/bottom/extra/index.tsx#Extra"})}catch(e){}},"./src/screens/rakuen/topic/component/bottom/extra/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){var e=s._.ios(36,"auto");return{left:{position:"absolute",zIndex:1002,left:0,bottom:0,height:e,paddingRight:s._.md},center:{position:"absolute",zIndex:1001,left:s._.window.width/3,bottom:0,height:e},right:{position:"absolute",zIndex:1002,right:0,bottom:0,height:e},btn:{width:s._.window.width/3,height:48}}}))},"./src/screens/rakuen/topic/component/bottom/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/stores/index.ts"),i=o("./src/utils/index.ts"),a=o("./src/utils/decorators/index.ts"),d=s(o("./src/screens/rakuen/topic/component/bottom/extra/index.tsx")),c=o("./src/screens/rakuen/topic/component/bottom/ds.ts"),l=o("./src/screens/rakuen/topic/component/bottom/styles.ts"),u=o("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var o=e.fixedTextareaRef,s=e.onDirect,a=t.$,p=t.navigation;if(!a.isWebLogin||a.isLimit)return null;var m=(0,l.memoStyles)(),f=a.topic.tip;if((void 0===f?"":f).includes("半公开"))return(0,u.jsx)(r.SafeAreaBottom,{style:m.fixedBottom,type:n._.ios("height","bottom"),children:(0,u.jsxs)(r.Flex,{children:[(0,u.jsx)(r.Text,{children:"半公开小组只有成员才能发言, "}),(0,u.jsx)(r.Text,{type:"main",onPress:function(){return(0,i.appNavigate)(a.groupHref,p)},children:"点击加入"})]})});var j=a.topic.close;if(j)return(0,u.jsx)(r.SafeAreaBottom,{style:m.fixedBottom,type:n._.ios("height","bottom"),children:(0,u.jsxs)(r.Flex,{children:[(0,u.jsx)(r.Text,{children:"主题已被关闭"}),!!j&&(0,u.jsxs)(r.Text,{type:"sub",children:[": ",j]})]})});var h=a.state,y=h.placeholder,_=h.value;return(0,u.jsx)(r.FixedTextarea,{ref:o,placeholder:y||void 0,value:_,source:!0,marks:c.MARKS,extraComponent:(0,u.jsx)(d.default,{onDirect:s}),onChange:a.onChange,onClose:a.closeFixedTextarea,onSubmit:a.doSubmit})}),c.COMPONENT)},"./src/screens/rakuen/topic/component/bottom/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts"),r=o("./src/constants/index.ts");t.memoStyles=s._.memoStyles((function(){return{fixedBottom:Object.assign({position:"absolute",zIndex:1,right:0,bottom:0,left:0,height:s._.ios(32,"auto"),paddingVertical:16,paddingHorizontal:s._.wind,backgroundColor:s._.select(s._.colorPlain,s._._colorDarkModeLevel1)},r.IOS?{shadowColor:s._.colorShadow,shadowOffset:{width:1,height:-2},shadowOpacity:.06,shadowRadius:6}:{elevation:8})}}))},"./src/screens/rakuen/topic/component/content/content.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.string.trim.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./src/components/index.ts"),i=o("./src/screens/_/index.ts"),a=o("./src/stores/index.ts"),d=o("./src/utils/index.ts"),c=o("./src/utils/decorators/index.ts"),l=o("./src/screens/rakuen/topic/component/content/ds.ts"),u=o("./src/screens/rakuen/topic/component/content/styles.ts"),p=o("./node_modules/react/jsx-runtime.js"),m=(0,c.memo)((function(e){var t=e.topicId,o=e.html,s=e.isEp,c=e.id,l=e.formhash,m=e.likeType,f=e.translateResult,j=e.doTranslate,h=e.onLinkPress,y=t.includes("group/");return(0,p.jsxs)(r.default,{style:u.styles.html,children:[y&&!o&&(0,p.jsx)(n.Flex,{style:u.styles.loading,justify:"center",children:(0,p.jsx)(n.Loading,{})}),f.length?(0,p.jsx)(r.default,{children:f.map((function(e,t){return(0,p.jsxs)(r.default,{children:[(0,p.jsx)(n.Text,{style:a._.mt.md,size:13,lineHeight:14,type:"sub",children:e.src.trim()}),(0,p.jsx)(n.Text,{style:a._.mt.xs,size:15,lineHeight:17,children:e.dst.trim()})]},t)}))}):!!o&&(0,p.jsxs)(p.Fragment,{children:[s&&!(0,d.isChineseParagraph)((0,d.removeURLs)((0,d.removeHTMLTag)(o)))&&(0,p.jsxs)(r.default,{style:u.styles.iconTranslate,children:[(0,p.jsx)(i.IconTouchable,{name:"md-g-translate",size:18,onPress:j}),(0,p.jsx)(n.Heatmap,{id:"帖子.翻译内容"})]}),(0,p.jsxs)(r.default,{style:a._.mt.md,children:[(0,p.jsx)(n.RenderHtml,{html:o,matchLink:!0,onLinkPress:h}),(0,p.jsx)(n.Heatmap,{bottom:133,id:"帖子.跳转",to:"Blog",alias:"日志",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:100,id:"帖子.跳转",to:"CatalogDetail",alias:"目录",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:67,id:"帖子.跳转",to:"Topic",alias:"帖子",transparent:!0}),(0,p.jsx)(n.Heatmap,{bottom:34,id:"帖子.跳转",to:"Mono",alias:"人物",transparent:!0}),(0,p.jsx)(n.Heatmap,{id:"帖子.跳转",to:"WebBrowser",alias:"浏览器",transparent:!0})]})]}),(0,p.jsx)(i.Likes,{show:!0,topicId:t,id:c,formhash:l,likeType:m,onLongPress:a.uiStore.showLikesUsers})]})}),l.DEFAULT_PROPS,l.COMPONENT_MAIN);t.default=m;try{content.displayName="content",content.__docgenInfo={description:"",displayName:"content",props:{topicId:{defaultValue:null,description:"",name:"topicId",required:!0,type:{name:"`subject/${string}` | `subject/${number}` | `group/${string}` | `group/${number}` | `ep/${string}` | `ep/${number}` | `prsn/${string}` | `prsn/${number}` | `crt/${string}` | `crt/${number}`"}},html:{defaultValue:null,description:"",name:"html",required:!0,type:{name:"string"}},isEp:{defaultValue:null,description:"",name:"isEp",required:!0,type:{name:"boolean"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"Id"}},formhash:{defaultValue:null,description:"",name:"formhash",required:!0,type:{name:"string"}},likeType:{defaultValue:null,description:"",name:"likeType",required:!0,type:{name:"string"}},translateResult:{defaultValue:null,description:"",name:"translateResult",required:!0,type:{name:"any[]"}},doTranslate:{defaultValue:null,description:"",name:"doTranslate",required:!0,type:{name:"() => Promise<void>"}},onLinkPress:{defaultValue:null,description:"",name:"onLinkPress",required:!0,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/content/content.tsx#content"]={docgenInfo:content.__docgenInfo,name:"content",path:"src/screens/rakuen/topic/component/content/content.tsx#content"})}catch(e){}},"./src/screens/rakuen/topic/component/content/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/constants/index.ts"),n=o("./src/screens/rakuen/topic/component/ds.ts"),i=t.COMPONENT=(0,s.rc)(n.COMPONENT,"Content");t.COMPONENT_MAIN=(0,s.rc)(i),t.DEFAULT_PROPS={topicId:"",html:"",isEp:!1,id:"",formhash:"",likeType:"",translateResult:[],doTranslate:r.FN,onLinkPress:r.FN}},"./src/screens/rakuen/topic/component/content/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.weak-map.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/es.array.slice.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=l(t);if(o&&o.has(e))return o.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=e[n]}return s.default=e,o&&o.set(e,s),s}(o("react")),n=o("./src/utils/index.ts"),i=o("./src/utils/decorators/index.ts"),a=s(o("./src/screens/rakuen/topic/component/content/content.tsx")),d=o("./src/screens/rakuen/topic/component/content/ds.ts"),c=o("./node_modules/react/jsx-runtime.js");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(l=function(e){return e?o:t})(e)}t.default=(0,i.obc)((function(e,t){var o,s,i,d=t.$,l=t.navigation,u=(0,r.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,n.appNavigate)(e,l,t,{id:"帖子.跳转",data:{from:"#1",topicId:d.topicId}})}),[d.topicId,l]);return(0,c.jsx)(a.default,{topicId:d.topicId,html:d.html,isEp:d.isEp,id:null==(o=d.topic)?void 0:o.id,formhash:null==(s=d.topic)?void 0:s.formhash,likeType:null==(i=d.topic)?void 0:i.likeType,translateResult:d.state.translateResult.slice(),doTranslate:d.doTranslate,onLinkPress:u})}),d.COMPONENT);try{content.displayName="content",content.__docgenInfo={description:"",displayName:"content",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/content/index.tsx#content"]={docgenInfo:content.__docgenInfo,name:"content",path:"src/screens/rakuen/topic/component/content/index.tsx#content"})}catch(e){}},"./src/screens/rakuen/topic/component/content/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=o("./src/stores/index.ts");t.styles=s._.create({html:{minHeight:s._.r(120)},loading:{height:s._.r(120)},iconTranslate:{position:"absolute",zIndex:1,top:0,right:-4}})},"./src/screens/rakuen/topic/component/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Component")},"./src/screens/rakuen/topic/component/ep/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Ep")},"./src/screens/rakuen/topic/component/ep/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/es.string.replace.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.array.find-index.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.array.sort.js"),o("./node_modules/core-js/modules/es.function.name.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(s(o("react")),o("./src/components/index.ts")),i=o("./src/stores/index.ts"),a=o("./src/utils/index.ts"),d=o("./src/utils/decorators/index.ts"),c=o("./src/screens/rakuen/topic/component/ep/ds.ts"),l=o("./src/screens/rakuen/topic/component/ep/styles.ts"),u=o("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var o,s=t.$,d=t.navigation;if(null==(o=s.groupHref)||!o.includes("/subject/"))return null;var c=Number(s.groupHref.replace("/subject/","")),p=i.subjectStore.subject(c).eps;if(null==p||!p.length)return null;var m=[],f=(m=p.length>=1e3?[].concat((0,r.default)(p),(0,r.default)(i.subjectStore.epV2(c).list)).filter((function(e){return 0===e.type})):p.filter((function(e){return 0===e.type}))).findIndex((function(e){var t;return null==(t=e.url)?void 0:t.includes(s.topicId)}));if(-1===f)return null;var j,h,y=(0,l.memoStyles)();if(f-1>=0&&(j=m[f-1]),f+1<=m.length-1&&(h=m[f+1]),!j&&!h)return null;var _=function(e){var t;d.replace("Topic",{topicId:"ep/"+(null==(t=e.url)?void 0:t.split("/ep/")[1]),_title:(1===e.type?"sp":"ep")+e.sort+"."+(0,a.cnjp)(e.name_cn,e.name)})};return(0,u.jsxs)(n.Flex,{style:y.container,children:[(0,u.jsx)(n.Flex.Item,{children:j&&(0,u.jsxs)(n.Touchable,{style:y.item,animate:!0,onPress:function(){return _(j)},children:[(0,u.jsxs)(n.Flex,{children:[(0,u.jsx)(n.Iconfont,{style:y.left,name:"md-navigate-before",size:18,color:i._.colorDesc}),(0,u.jsxs)(n.Text,{size:16,bold:!0,children:[1===j.type?"sp":"ep",j.sort]})]}),(0,u.jsx)(n.Text,{style:i._.mt.xs,size:12,type:"sub",numberOfLines:1,children:(0,a.HTMLDecode)((0,a.cnjp)(j.name_cn,j.name))})]})}),(0,u.jsx)(n.Flex.Item,{style:i._.ml.md,children:h&&(0,u.jsxs)(n.Touchable,{style:y.item,animate:!0,onPress:function(){return _(h)},children:[(0,u.jsxs)(n.Flex,{justify:"end",children:[(0,u.jsxs)(n.Text,{size:16,bold:!0,align:"right",children:[1===h.type?"sp":"ep",h.sort]}),(0,u.jsx)(n.Iconfont,{style:y.right,name:"md-navigate-next",size:18,color:i._.colorDesc})]}),(0,u.jsx)(n.Text,{style:i._.mt.xs,size:12,type:"sub",align:"right",numberOfLines:1,children:(0,a.HTMLDecode)((0,a.cnjp)(h.name_cn,h.name))})]})})]})}),c.COMPONENT);try{ep.displayName="ep",ep.__docgenInfo={description:"",displayName:"ep",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/ep/index.tsx#ep"]={docgenInfo:ep.__docgenInfo,name:"ep",path:"src/screens/rakuen/topic/component/ep/index.tsx#ep"})}catch(e){}},"./src/screens/rakuen/topic/component/ep/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{container:{paddingVertical:s._.md,paddingHorizontal:s._.wind,marginRight:s._.xs},item:{paddingTop:s._.sm,paddingBottom:s._.sm+4,paddingHorizontal:s._.md,borderWidth:1,borderColor:s._.colorBorder,borderRadius:s._.radiusSm},left:{marginTop:2,marginLeft:-2},right:{marginTop:2,marginRight:-2}}}))},"./src/screens/rakuen/topic/component/header-title/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.IMG_WIDTH=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts"),n=t.COMPONENT=(0,s.rc)(r.COMPONENT,"HeaderTitle");t.COMPONENT_MAIN=(0,s.rc)(n),t.IMG_WIDTH=28,t.DEFAULT_PROPS={navigation:{},avatar:"",userId:"",userName:"",title:"",group:""}},"./src/screens/rakuen/topic/component/header-title/header-title.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.join.js"),o("./node_modules/core-js/modules/es.array.filter.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/screens/_/index.ts"),i=o("./src/stores/index.ts"),a=o("./src/utils/decorators/index.ts"),d=o("./src/screens/rakuen/topic/component/header-title/ds.ts"),c=o("./src/screens/rakuen/topic/component/header-title/styles.ts"),l=o("./node_modules/react/jsx-runtime.js"),u=(0,a.memo)((function(e){var t=e.navigation,o=e.avatar,s=e.userId,a=e.userName,u=e.title,p=e.group,m=[a||p,p].filter((function(e){return!!e})).join(" · ");return(0,l.jsxs)(r.Flex,{style:c.styles.container,children:[!!o&&(0,l.jsx)(r.UserStatus,{userId:s,children:(0,l.jsx)(n.Avatar,{navigation:t,size:d.IMG_WIDTH,src:o,userId:s,name:a})}),(0,l.jsxs)(r.Flex.Item,{style:i._.ml.sm,children:[(0,l.jsx)(r.Text,{size:13,numberOfLines:1,children:u}),!!m&&(0,l.jsx)(n.VerticalAlign,{type:"sub",text:a||p,size:10,lineHeight:12,bold:!0,numberOfLines:1,children:m})]})]})}),d.DEFAULT_PROPS,d.COMPONENT_MAIN);t.default=u;try{headertitle.displayName="headertitle",headertitle.__docgenInfo={description:"",displayName:"headertitle",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},avatar:{defaultValue:null,description:"",name:"avatar",required:!0,type:{name:"string"}},userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"UserId"}},userName:{defaultValue:null,description:"",name:"userName",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/header-title/header-title.tsx#headertitle"]={docgenInfo:headertitle.__docgenInfo,name:"headertitle",path:"src/screens/rakuen/topic/component/header-title/header-title.tsx#headertitle"})}catch(e){}},"./src/screens/rakuen/topic/component/header-title/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/utils/decorators/index.ts"),n=o("./src/constants/index.ts"),i=s(o("./src/screens/rakuen/topic/component/header-title/header-title.tsx")),a=o("./src/screens/rakuen/topic/component/header-title/ds.ts"),d=o("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.$,o=e.navigation;return(0,d.jsx)(i.default,{navigation:o,avatar:t.avatar===n.IMG_DEFAULT_AVATAR?t.groupThumb:t.avatar,userId:t.userId,userName:t.userName,title:t.title,group:t.group})}),a.COMPONENT);try{headertitle.displayName="headertitle",headertitle.__docgenInfo={description:"",displayName:"headertitle",props:{$:{defaultValue:null,description:"",name:"$",required:!0,type:{name:"ScreenTopic"}},navigation:{defaultValue:null,description:"",name:"navigation",required:!1,type:{name:"Navigation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/header-title/index.tsx#headertitle"]={docgenInfo:headertitle.__docgenInfo,name:"headertitle",path:"src/screens/rakuen/topic/component/header-title/index.tsx#headertitle"})}catch(e){}},"./src/screens/rakuen/topic/component/header-title/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=o("./src/stores/index.ts");t.styles=s._.create({container:{marginTop:s._.platforms(4,-8,-10,-14,-8),marginLeft:-s._.sm,marginRight:s._.lg}})},"./src/screens/rakuen/topic/component/heatmaps/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/utils/decorators/index.ts"),i=o("./node_modules/react/jsx-runtime.js");t.default=(0,n.ob)((function(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Heatmap,{right:2,bottom:160,id:"帖子.楼层跳转",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:84,id:"帖子.删除回复",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:51,id:"帖子.回复",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:119,bottom:51,id:"帖子.回复失败",transparent:!0}),(0,i.jsx)(r.Heatmap,{right:76,bottom:18,id:"帖子.显示评论框",transparent:!0}),(0,i.jsx)(r.Heatmap,{id:"帖子",screen:"Topic"})]})}))},"./src/screens/rakuen/topic/component/icon/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Icon")},"./src/screens/rakuen/topic/component/icon/favor.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./src/components/index.ts"),i=o("./src/screens/_/index.ts"),a=o("./src/stores/index.ts"),d=o("./src/utils/decorators/index.ts"),c=o("./src/screens/rakuen/topic/component/icon/ds.ts"),l=o("./src/screens/rakuen/topic/component/icon/styles.ts"),u=o("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.$;return(0,u.jsxs)(r.default,{style:t.favorCount?l.styles.withCollect:a._.mr.xs,children:[(0,u.jsx)(i.IconHeader,{name:t.isFavor?"md-star":"md-star-outline",color:t.isFavor?a._.colorYellow:a._.colorDesc,onPress:t.setFavor,children:(0,u.jsx)(n.Heatmap,{right:33,bottom:7,id:"帖子.设置收藏"})}),!!t.favorCount&&(0,u.jsx)(n.Text,{style:l.styles.num,size:10,bold:!0,children:t.favorCount})]})}),c.COMPONENT);try{favor.displayName="favor",favor.__docgenInfo={description:"",displayName:"favor",props:{$:{defaultValue:null,description:"",name:"$",required:!0,type:{name:"ScreenTopic"}},navigation:{defaultValue:null,description:"",name:"navigation",required:!1,type:{name:"Navigation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/icon/favor.tsx#favor"]={docgenInfo:favor.__docgenInfo,name:"favor",path:"src/screens/rakuen/topic/component/icon/favor.tsx#favor"})}catch(e){}},"./src/screens/rakuen/topic/component/icon/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=o("./src/stores/index.ts");t.styles=s._.create({withCollect:{paddingRight:s._.sm},num:{position:"absolute",right:7,bottom:5}})},"./src/screens/rakuen/topic/component/item/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.PRE_RENDER_INDEX=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Item"),t.PRE_RENDER_INDEX=8},"./src/screens/rakuen/topic/component/item/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/screens/_/index.ts"),n=o("./src/stores/index.ts"),i=o("./src/utils/decorators/index.ts"),a=o("./src/screens/rakuen/topic/component/item/ds.ts"),d=o("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var o=e.item,s=e.index,i=e.onShowFixedTextarea,c=t.$;if(!c.postId&&!c.state.rendered&&s>a.PRE_RENDER_INDEX-1)return null;var l={id:"帖子.跳转",data:{topicId:c.topicId}};return(0,d.jsx)(r.ItemPost,Object.assign({inViewY:.8*n._.window.height,index:s,postId:c.postId,authorId:c.topic.userId},o,{matchLink:!0,event:l,showFixedTextare:i}))}),a.COMPONENT)},"./src/screens/rakuen/topic/component/list/ds.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.LISTVIEW_PROPS=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var r=o("./src/utils/index.ts"),n=o("./src/utils/dev/index.ts"),i=o("./src/constants/index.ts"),a=o("./src/screens/rakuen/topic/component/ds.ts"),d=s(o("./src/screens/rakuen/topic/component/top/index.tsx")),c=o("./node_modules/react/jsx-runtime.js"),l=t.COMPONENT=(0,n.rc)(a.COMPONENT,"List");t.COMPONENT_MAIN=(0,n.rc)(l),t.LISTVIEW_PROPS={keyExtractor:r.keyExtractor,scrollEventThrottle:16,initialNumToRender:120,maxToRenderPerBatch:120,updateCellsBatchingPeriod:120,scrollToTop:!0,keyboardDismissMode:"on-drag",ListHeaderComponent:(0,c.jsx)(d.default,{})},t.DEFAULT_PROPS={forwardRef:i.FN,data:i.LIST_EMPTY,postId:"",onScroll:i.FN,onScrollToIndexFailed:i.FN,onHeaderRefresh:i.FN,onShowFixedTextarea:i.FN}},"./src/screens/rakuen/topic/component/list/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/utils/decorators/index.ts"),n=s(o("./src/screens/rakuen/topic/component/list/list.tsx")),i=o("./src/screens/rakuen/topic/component/list/ds.tsx"),a=o("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var o=e.forwardRef,s=e.onShowFixedTextarea,r=e.onScrollToIndexFailed,i=t.$;return(0,a.jsx)(n.default,{forwardRef:o,data:i.comments,postId:i.postId,onScroll:i.onScroll,onScrollToIndexFailed:r,onHeaderRefresh:i.fetchTopic,onShowFixedTextarea:s})}),i.COMPONENT)},"./src/screens/rakuen/topic/component/list/list.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.weak-map.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/es.object.assign.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=f(t);if(o&&o.has(e))return o.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=e[n]}return s.default=e,o&&o.set(e,s),s}(o("react")),n=o("./src/components/index.ts"),i=o("./src/screens/_/index.ts"),a=o("./src/stores/index.ts"),d=o("./src/utils/index.ts"),c=o("./src/utils/decorators/index.ts"),l=o("./src/constants/index.ts"),u=s(o("./src/screens/rakuen/topic/component/item/index.tsx")),p=o("./src/screens/rakuen/topic/component/list/ds.tsx"),m=o("./node_modules/react/jsx-runtime.js");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(f=function(e){return e?o:t})(e)}var j=(0,c.memo)((function(e){var t=e.forwardRef,o=e.data,s=e.postId,c=e.onScroll,f=e.onScrollToIndexFailed,j=e.onHeaderRefresh,h=e.onShowFixedTextarea,y=(0,r.useCallback)((function(e){var t=e.item,o=e.index;return(0,m.jsx)(u.default,{item:t,index:o,onShowFixedTextarea:h})}),[h]),_=Object.assign({},p.LISTVIEW_PROPS,{keyExtractor:d.keyExtractor,style:a._.container.content,contentContainerStyle:a._.container.bottom,lazy:s?void 0:4,progressViewOffset:a._.ios(a._.statusBarHeight,0),removeClippedSubviews:!1,renderItem:y,onScroll:c,onScrollToIndexFailed:f,onHeaderRefresh:j}),b=o.list;return l.STORYBOOK||b.length<=80?(0,m.jsx)(n.ListView,Object.assign({},_,{ref:t,data:o})):(0,m.jsx)(i.PaginationList2,Object.assign({},_,{forwardRef:t,data:b,limit:24}))}),p.DEFAULT_PROPS,p.COMPONENT_MAIN);t.default=j;try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{forwardRef:{defaultValue:null,description:"",name:"forwardRef",required:!0,type:{name:"Fn"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:'{ list: any[]; pagination: { page: number; pageTotal: number; }; _list: any[]; _loaded: number | boolean; } | { list: any[] | { avatar: Avatar<"s">; floor: string; message: string; userId: UserId; ... 6 more ...; sub: CommentsItem[]; }[]; pagination?: { ...; }; _list?: { ...; }[]; _loaded?: Loaded; }'}},postId:{defaultValue:null,description:"",name:"postId",required:!0,type:{name:"string"}},onScroll:{defaultValue:null,description:"",name:"onScroll",required:!0,type:{name:"Fn"}},onScrollToIndexFailed:{defaultValue:null,description:"",name:"onScrollToIndexFailed",required:!0,type:{name:"Fn"}},onHeaderRefresh:{defaultValue:null,description:"",name:"onHeaderRefresh",required:!0,type:{name:"Fn"}},onShowFixedTextarea:{defaultValue:null,description:"",name:"onShowFixedTextarea",required:!0,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/list/list.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/rakuen/topic/component/list/list.tsx#list"})}catch(e){}},"./src/screens/rakuen/topic/component/milestone/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Milestone")},"./src/screens/rakuen/topic/component/milestone/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./node_modules/react-native-webview/index.js"),i=o("./src/utils/decorators/index.ts"),a=o("./src/screens/rakuen/topic/component/milestone/ds.ts"),d=o("./src/screens/rakuen/topic/component/milestone/styles.ts"),c=o("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var o=t.$;if("group/366561"!==o.topicId)return null;var s=(0,d.memoStyles)(),i='<!DOCTYPE html><html lang=en><head><meta charset="UTF-8"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Bangumi Open Source</title><style>*{padding:0;margin:0}::-webkit-scrollbar{display:none}body{overflow:hidden;background:#000}</style><body><div style=position:relative;width:'+s.body.width+"px;height:"+s.body.height+"px><canvas id=canvas_matrix style=display:block;background-color:transparent;position:absolute;left:0;top:0;width:"+s.body.width+"px;height:"+s.body.height+"px width=300 height=150></canvas><canvas id=canvas_matrix_2 style=display:block;background-color:transparent;position:absolute;left:0;top:0;width:"+s.body.width+"px;height:"+s.body.height+'px;border-radius:15px width=300 height=150></canvas><div style="font-family:Courier New,serif;position:absolute;width:100%;height:100%;text-align:center;top:45%;font-size:20px;color:#fff;text-shadow:0 0 15px #0f0,0 0 9px #56b000,0 0 15px #006400,0 0 5px #006400">Bangumi Open Source</div></div><script>function m(t,e){return Math.floor(Math.random()*(e-t)+t)}function v(t,e){return Math.random()*(e-t)+t}function d(t,e){this.x=t,this.y=e}var t=document.getElementById("canvas_matrix"),n=t.getContext("2d"),i=document.getElementById("canvas_matrix_2"),s=i.getContext("2d"),a=t.width,h=t.height,r=["b","a","n","g","u","m","i","o","p","e","n","s","o","u","r","c","e"],e=10,u=[],o=10,c=10,f=a/o;t.width=i.width=a,t.height=i.height=h,d.prototype.t=function(t){this.value=r[m(0,r.length-1)].toUpperCase(),this.speed=v(.5,1.5),s.fillStyle="rgba(255,255,255,0.3)",s.font=c+"px san-serif",s.fillText(this.value,this.x,this.y),t.fillStyle="#0F0",t.font=c+"px san-serif",t.fillText(this.value,this.x,this.y),this.y+=this.speed,this.y>h&&(this.y=v(-100,10),this.speed=v(.5,3))};for(var x=0;f>x;x++)u.push(new d(x*o,v(-500,0)));var b=function(){n.fillStyle="rgba(0, 0, 0, 0.05)",n.fillRect(0,0,a,h),s.clearRect(0,0,a,h);for(var t=u.length;t--;){u[t].t(n);{u[t]}}requestAnimationFrame(b)};b();<\/script>';return(0,c.jsx)(r.default,{style:s.container,children:!o.state.showHeaderTitle&&(0,c.jsx)(n.WebView,{style:s.body,source:{html:i},scrollEnabled:!1,androidHardwareAccelerationDisabled:!0,androidLayerType:"software"})})}),a.COMPONENT);try{milestone.displayName="milestone",milestone.__docgenInfo={description:"",displayName:"milestone",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/milestone/index.tsx#milestone"]={docgenInfo:milestone.__docgenInfo,name:"milestone",path:"src/screens/rakuen/topic/component/milestone/index.tsx#milestone"})}catch(e){}},"./src/screens/rakuen/topic/component/milestone/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){var e=s._.window.contentWidth-(s._.wind-s._._wind);return{container:{height:160,marginTop:-s._.md,marginBottom:s._.md,borderRadius:s._.radiusMd,overflow:"hidden"},body:{width:e,height:160,backgroundColor:"#000",opacity:.99}}}))},"./src/screens/rakuen/topic/component/section-title/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"SectionTitle")},"./src/screens/rakuen/topic/component/section-title/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.for-each.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.string.sub.js"),o("./node_modules/core-js/modules/es.array.reverse.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/screens/_/index.ts"),i=o("./src/stores/index.ts"),a=o("./src/utils/decorators/index.ts"),d=s(o("./src/screens/rakuen/topic/component/segment/index.tsx")),c=o("./src/screens/rakuen/topic/component/section-title/ds.ts"),l=o("./src/screens/rakuen/topic/component/section-title/styles.ts"),u=o("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var o=t.$,s=(0,l.memoStyles)(),a=o.comments.list,c=0;return(void 0===a?[]:a).forEach((function(e){c+=1,e.sub&&(c+=e.sub.length)})),(0,u.jsxs)(n.SectionTitle,{style:s.title,right:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(d.default,{}),(0,u.jsx)(n.IconReverse,{style:o.state.reverse?s.reverse:void 0,iconStyle:s.reverseIcon,color:o.state.reverse?i._.colorMain:i._.colorIcon,size:18,onPress:o.toggleReverseComments,children:(0,u.jsx)(r.Heatmap,{right:10,bottom:29,id:"帖子.吐槽倒序"})})]}),children:["吐槽"," ",!!c&&(0,u.jsx)(r.Text,{size:12,type:"sub",lineHeight:24,children:c})]})}),c.COMPONENT);try{sectiontitle.displayName="sectiontitle",sectiontitle.__docgenInfo={description:"",displayName:"sectiontitle",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/section-title/index.tsx#sectiontitle"]={docgenInfo:sectiontitle.__docgenInfo,name:"sectiontitle",path:"src/screens/rakuen/topic/component/section-title/index.tsx#sectiontitle"})}catch(e){}},"./src/screens/rakuen/topic/component/section-title/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{title:{paddingHorizontal:s._.wind,marginTop:s._.lg,marginBottom:s._.md},reverse:{transform:[{rotateX:"180deg"}]},reverseIcon:{marginRight:4,marginLeft:s._.md}}}))},"./src/screens/rakuen/topic/component/segment/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts");t.COMPONENT=(0,s.rc)(r.COMPONENT,"Segement")},"./src/screens/rakuen/topic/component/segment/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.find-index.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/web.timers.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./src/components/index.ts"),i=o("./src/stores/index.ts"),a=o("./src/utils/index.ts"),d=o("./src/utils/decorators/index.ts"),c=o("./src/screens/rakuen/topic/component/segment/ds.ts"),l=o("./src/screens/rakuen/topic/component/segment/styles.ts"),u=o("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var o=t.$,s=["全部"];if(o.state.filterPost)s.push("跳转");else{if(i.rakuenStore.setting.likes){var d,c=(null==(d=o.likesFloorIds)?void 0:d.length)||0;c&&s.push("贴贴 "+c)}var p=!!o.myId;p&&o.commentMeCount&&s.push("我 "+o.commentMeCount),p&&o.commentFriendsCount&&s.push("好友 "+o.commentFriendsCount)}if(s.length<=1)return null;var m=0;if(o.state.filterPost)m=s.length-1;else if(s.length>1){var f=o.state.filterType;"likes"===f?m=s.findIndex((function(e){return e.includes("贴贴")})):"me"===f?m=s.findIndex((function(e){return e.includes("我")})):"friends"===f&&(m=s.findIndex((function(e){return e.includes("好友")})))}return-1===m&&(m=0),(0,u.jsxs)(r.default,{children:[(0,u.jsx)(n.SegmentedControl,{style:[l.styles.segmentedControl,{width:s.length*i._.r(56)}],size:11,values:s,selectedIndex:m,onValueChange:function(e){if(o.state.filterPost)return(0,a.info)("取消仅显示跳转楼层"),(0,a.feedback)(),void setTimeout((function(){o.clearFilterPost()}),0);var t=o.state.filterType;e.includes("贴贴")&&"likes"!==t?o.onFilterLikes():e.includes("我")&&"me"!==t?o.onFilterMe():e.includes("好友")&&"friends"!==t?o.onFilterFriends():o.onFilterClear()}},m),(0,u.jsx)(n.Heatmap,{right:74,bottom:24,id:"帖子.好友相关"}),(0,u.jsx)(n.Heatmap,{right:24,bottom:24,id:"帖子.与我相关"})]})}),c.COMPONENT);try{segment.displayName="segment",segment.__docgenInfo={description:"",displayName:"segment",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/segment/index.tsx#segment"]={docgenInfo:segment.__docgenInfo,name:"segment",path:"src/screens/rakuen/topic/component/segment/index.tsx#segment"})}catch(e){}},"./src/screens/rakuen/topic/component/segment/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=o("./src/stores/index.ts");t.styles=s._.create({segmentedControl:{height:s._.r(28)}})},"./src/screens/rakuen/topic/component/top/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/screens/rakuen/topic/component/ds.ts"),n=t.COMPONENT=(0,s.rc)(r.COMPONENT,"Top");t.COMPONENT_MAIN=(0,s.rc)(n),t.DEFAULT_PROPS={navigation:{},styles:{},topicId:"",title:"",subTitle:"",time:"",replies:"",group:"",groupHref:"",groupThumb:"",groupThumbFallback:"",avatar:"",userId:"",userName:"",userSign:"",filterPost:"",monoId:"",isMono:!1,delete:!1}},"./src/screens/rakuen/topic/component/top/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/stores/index.ts"),n=o("./src/utils/index.ts"),i=o("./src/utils/app/ds.ts"),a=o("./src/utils/decorators/index.ts"),d=o("./src/constants/index.ts"),c=s(o("./src/screens/rakuen/topic/component/top/top.tsx")),l=o("./src/screens/rakuen/topic/component/top/ds.ts"),u=o("./src/screens/rakuen/topic/component/top/styles.ts"),p=o("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var o=t.$,s=t.navigation,a=(0,n.getGroupThumbStatic)(o.groupThumb);r.systemStore.setting.cdn&&"magma"===r.systemStore.setting.cdnOrigin&&"string"==typeof a&&a.includes(i.HOST_IMAGE)&&(a=(0,d.CDN_OSS_MAGMA_PIC)(a));var l=(0,u.memoStyles)();return(0,p.jsx)(c.default,{navigation:s,styles:l,topicId:o.topicId,title:o.title,subTitle:o.subTitle,time:o.time,replies:o.params._replies,group:o.group,groupHref:o.groupHref,groupThumb:a,groupThumbFallback:o.groupThumb,avatar:o.avatar,userId:o.userId,userName:o.userName,userSign:o.userSign,filterPost:o.state.filterPost,monoId:o.monoId,isMono:o.isMono,delete:o.topic.delete})}),l.COMPONENT);try{top.displayName="top",top.__docgenInfo={description:"",displayName:"top",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/top/index.tsx#top"]={docgenInfo:top.__docgenInfo,name:"top",path:"src/screens/rakuen/topic/component/top/index.tsx#top"})}catch(e){}},"./src/screens/rakuen/topic/component/top/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{container:{paddingVertical:s._.sm,paddingHorizontal:s._.wind},groupWrap:{minHeight:s._.r(32),marginTop:s._.sm,marginBottom:s._.xs},groupLabel:{overflow:"hidden",maxWidth:"100%",padding:4,paddingRight:10,marginRight:s._.sm,backgroundColor:s._.select(s._.colorBg,s._._colorDarkModeLevel1),borderRadius:s._.radiusXs},group:{maxWidth:.6*s._.window.contentWidth,marginLeft:s._.sm},userWrap:{height:s._.r(42),marginTop:s._.sm},katakana:{marginTop:-12},loading:{height:s._.r(240)}}}))},"./src/screens/rakuen/topic/component/top/top.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.weak-map.js"),o("./node_modules/core-js/modules/es.object.to-string.js"),o("./node_modules/core-js/modules/es.string.iterator.js"),o("./node_modules/core-js/modules/es.array.iterator.js"),o("./node_modules/core-js/modules/web.dom-collections.iterator.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.string.trim.js"),o("./node_modules/core-js/modules/es.string.replace.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.array.slice.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(o("./node_modules/@babel/runtime/helpers/slicedToArray.js")),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=b(t);if(o&&o.has(e))return o.get(e);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var i=r?Object.getOwnPropertyDescriptor(e,n):null;i&&(i.get||i.set)?Object.defineProperty(s,n,i):s[n]=e[n]}return s.default=e,o&&o.set(e,s),s}(o("react")),i=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),a=o("./src/components/index.ts"),d=o("./src/screens/_/index.ts"),c=o("./src/stores/index.ts"),l=o("./src/utils/index.ts"),u=o("./src/utils/decorators/index.ts"),p=o("./src/constants/index.ts"),m=s(o("./src/screens/rakuen/topic/component/content/index.tsx")),f=s(o("./src/screens/rakuen/topic/component/ep/index.tsx")),j=s(o("./src/screens/rakuen/topic/component/milestone/index.tsx")),h=s(o("./src/screens/rakuen/topic/component/section-title/index.tsx")),y=o("./src/screens/rakuen/topic/component/top/ds.ts"),_=o("./node_modules/react/jsx-runtime.js");function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(b=function(e){return e?o:t})(e)}var g=(0,u.memo)((function(e){var t=e.navigation,o=e.styles,s=e.topicId,u=e.title,y=e.subTitle,b=e.time,g=e.replies,x=e.group,v=e.groupHref,O=e.groupThumb,T=e.groupThumbFallback,S=e.avatar,I=e.userId,k=e.userName,P=e.userSign,E=e.filterPost,N=e.monoId,C=e.isMono,R=e.delete,M=(0,n.useState)(1),w=(0,r.default)(M,2),F=w[0],A=w[1],D=(0,n.useCallback)((function(){return A(2)}),[]),L={id:"帖子.跳转",data:{from:"#1",topicId:s}},H=s.includes("group/"),q=s.includes("ep/");return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.HeaderPlaceholder,{}),(0,_.jsxs)(i.default,{style:o.container,children:[(0,_.jsx)(j.default,{}),(0,_.jsxs)(a.Text,{type:"title",size:20,bold:!0,selectable:!0,children:[u,!!g&&(0,_.jsx)(a.Text,{type:"main",size:12,lineHeight:26,bold:!0,children:"  "+(g.includes("+")?"":"+")+g.trim()})]}),!!y&&(0,_.jsx)(a.Text,{style:c._.mv.sm,type:"sub",size:14,bold:!0,selectable:!0,children:y}),(0,_.jsxs)(a.Flex,{style:o.groupWrap,children:[!!x&&(0,_.jsx)(a.Flex,{style:o.groupLabel,children:(0,_.jsx)(a.Touchable,{animate:!0,onPress:function(){C?(0,l.appNavigate)(p.HOST+"/"+N,t,{},L):(0,l.appNavigate)(v,t,{_jp:x},L)},children:(0,_.jsxs)(a.Flex,{children:[(0,_.jsx)(a.Cover,{size:q?40:20,src:O||c._.select(p.IMG_EMPTY,p.IMG_EMPTY_DARK),radius:c._.radiusXs,priority:"high",fallback:q,fallbackSrc:q?String(T).replace("/r/100x100",""):void 0}),(0,_.jsx)(a.Text,{style:o.group,size:13,numberOfLines:1,children:(0,l.HTMLDecode)((0,l.findSubjectCn)(x))})]})})}),!!b&&(0,_.jsx)(a.Flex.Item,{children:(0,_.jsx)(a.Text,{type:"sub",size:13,children:(0,l.simpleTime)(b)})}),(0,_.jsx)(a.Heatmap,{right:74,id:"帖子.跳转",to:"Group",alias:"小组"}),(0,_.jsx)(a.Heatmap,{id:"帖子.跳转",to:"Subject",alias:"条目",transparent:!0})]}),H&&(0,_.jsxs)(a.Flex,{style:o.userWrap,children:[!!S&&(0,_.jsx)(a.UserStatus,{userId:I,children:(0,_.jsx)(a.Avatar,{navigation:t,event:L,size:40,src:S,userId:I,name:k,priority:"high"})}),!!I&&(0,_.jsxs)(a.Flex.Item,{style:c._.ml.sm,children:[(0,_.jsx)(d.Name,{userId:I,numberOfLines:1,bold:!0,children:k}),(0,_.jsxs)(a.Text,{style:c._.mt.xs,type:"sub",size:12,numberOfLines:F,onPress:D,children:["@",I,!!P&&" ("+P.slice(1,P.length-1)+")"]})]}),(0,_.jsx)(a.Heatmap,{id:"帖子.跳转",to:"Zone",alias:"空间"})]}),E?(0,_.jsx)(a.Expand,{ratio:1.28,children:(0,_.jsx)(m.default,{})}):(0,_.jsx)(m.default,{}),!!R&&(0,_.jsxs)(a.Text,{style:c._.mb.md,size:15,lineHeight:18,bold:!0,align:"center",children:["数据库中没有查询到指定话题","\n","话题可能正在审核或已被删除"]})]}),(0,_.jsx)(a.Divider,{}),(0,_.jsx)(f.default,{}),(0,_.jsx)(h.default,{})]})}),y.DEFAULT_PROPS,y.COMPONENT_MAIN);t.default=g;try{top.displayName="top",top.__docgenInfo={description:"",displayName:"top",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:'{ container: { paddingVertical: number; paddingHorizontal: number; }; groupWrap: { minHeight: number; marginTop: number; marginBottom: number; }; groupLabel: { overflow: "hidden"; maxWidth: string; ... 4 more ...; borderRadius: number; }; group: { ...; }; userWrap: { ...; }; katakana: { ...; }; loading: { ...; }; }'}},topicId:{defaultValue:null,description:"",name:"topicId",required:!0,type:{name:"`subject/${string}` | `subject/${number}` | `group/${string}` | `group/${number}` | `ep/${string}` | `ep/${number}` | `prsn/${string}` | `prsn/${number}` | `crt/${string}` | `crt/${number}`"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subTitle:{defaultValue:null,description:"",name:"subTitle",required:!0,type:{name:"string"}},time:{defaultValue:null,description:"",name:"time",required:!0,type:{name:"string"}},replies:{defaultValue:null,description:"",name:"replies",required:!0,type:{name:"string"}},group:{defaultValue:null,description:"",name:"group",required:!0,type:{name:"string"}},groupHref:{defaultValue:null,description:"",name:"groupHref",required:!0,type:{name:"string"}},groupThumb:{defaultValue:null,description:"",name:"groupThumb",required:!0,type:{name:"string"}},groupThumbFallback:{defaultValue:null,description:"",name:"groupThumbFallback",required:!0,type:{name:"string"}},avatar:{defaultValue:null,description:"",name:"avatar",required:!0,type:{name:"string"}},userId:{defaultValue:null,description:"",name:"userId",required:!0,type:{name:"UserId"}},userName:{defaultValue:null,description:"",name:"userName",required:!0,type:{name:"string"}},userSign:{defaultValue:null,description:"",name:"userSign",required:!0,type:{name:"string"}},filterPost:{defaultValue:null,description:"",name:"filterPost",required:!0,type:{name:"string"}},monoId:{defaultValue:null,description:"",name:"monoId",required:!0,type:{name:"string"}},isMono:{defaultValue:null,description:"",name:"isMono",required:!0,type:{name:"boolean"}},delete:{defaultValue:null,description:"",name:"delete",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/top/top.tsx#top"]={docgenInfo:top.__docgenInfo,name:"top",path:"src/screens/rakuen/topic/component/top/top.tsx#top"})}catch(e){}},"./src/screens/rakuen/topic/component/touch-scroll/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT_MAIN=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/constants/index.ts"),n=o("./src/screens/rakuen/topic/component/ds.ts"),i=t.COMPONENT=(0,s.rc)(n.COMPONENT,"TouchScroll");t.COMPONENT_MAIN=(0,s.rc)(i),t.DEFAULT_PROPS={styles:{},list:[],readedTime:0,scrollDirection:r.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("右侧"),directFloor:"",isWebLogin:!1,onPress:function(){}},t.HIT_SLOP={top:0,right:2,bottom:0,left:2}},"./src/screens/rakuen/topic/component/touch-scroll/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/utils/decorators/index.ts"),n=o("./src/constants/index.ts"),i=o("./src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx"),a=o("./src/screens/rakuen/topic/component/touch-scroll/ds.ts"),d=o("./src/screens/rakuen/topic/component/touch-scroll/styles.ts"),c=o("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var o=e.onPress,s=t.$,r=s.setting.scrollDirection;return r!==n.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("隐藏")&&s.comments.list.length?(0,c.jsx)(i.TouchScroll,{styles:(0,d.memoStyles)(),list:s.comments.list,readedTime:s.readed._time,scrollDirection:r,directFloor:s.state.directFloor,isWebLogin:s.isWebLogin,onPress:o}):null}),a.COMPONENT)},"./src/screens/rakuen/topic/component/touch-scroll/styles.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=o("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{containerRight:{position:"absolute",top:s._.headerHeight,right:0,bottom:s._.ios(64,46),width:16,backgroundColor:s._.colorPlain},containerLeft:{position:"absolute",top:s._.headerHeight,left:0,bottom:s._.ios(64,46),width:16,backgroundColor:s._.colorPlain},containerBottom:{position:"absolute",left:0,right:0,bottom:40,width:"100%",height:24,backgroundColor:s._.select(s._.colorPlain,s._._colorDarkModeLevel1)},notLogin:{bottom:0,height:32,paddingBottom:8},itemVertical:{width:16,height:"100%"},itemHorizontal:{width:"100%",height:"100%"},itemNew:{borderRightWidth:6,borderColor:s._.select(s._.colorMainLightBorder,"rgb(59, 48, 51)")},itemText:{minHeight:16},dot:{width:4,height:4,backgroundColor:s._.colorIcon,borderRadius:4}}}))},"./src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/es.string.match.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.string.sub.js"),o("./node_modules/core-js/modules/es.array.for-each.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.string.replace.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.TouchScroll=void 0;s(o("react"));var r=s(o("./node_modules/react-native-web/dist/exports/TouchableWithoutFeedback/index.js")),n=s(o("./node_modules/react-native-web/dist/exports/View/index.js")),i=o("./src/components/index.ts"),a=o("./src/stores/index.ts"),d=o("./src/utils/index.ts"),c=o("./src/utils/decorators/index.ts"),l=o("./src/constants/index.ts"),u=o("./src/screens/rakuen/topic/component/touch-scroll/ds.ts"),p=o("./node_modules/react/jsx-runtime.js"),m=t.TouchScroll=(0,c.memo)((function(e){var t,o=e.styles,s=e.list,c=e.readedTime,m=e.scrollDirection,f=e.directFloor,j=e.isWebLogin,h=e.onPress,y=f?Number((null==(t=f.match(/\d+/))?void 0:t[0])||0):0,_=[Math.floor(.33333*s.length)-1,Math.floor(.66666*s.length)-1,s.length-1],b=m===l.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("右侧")||m===l.MODEL_RAKUEN_SCROLL_DIRECTION.getValue("左侧"),g={hitSlop:u.HIT_SLOP};return l.IOS?g.onPress=function(){return h(-1)}:g.onPressIn=function(){return h(-1)},(0,p.jsxs)(i.Flex,{style:(0,d.stl)(o["container"+(0,d.titleCase)(m)],!j&&!b&&o.notLogin),direction:b?"column":void 0,children:[(0,p.jsx)(i.Flex.Item,{style:o.itemText,flex:b?1:3,children:(0,p.jsx)(r.default,Object.assign({},g,{children:(0,p.jsx)(i.Flex,{style:b?o.itemVertical:o.itemHorizontal,children:(0,p.jsx)(i.Text,{style:a._.container.block,size:8,type:"icon",align:"center",children:"1"})})}))}),s.map((function(e,t){var m,f=y&&"#"+y===e.floor,j=!1;c&&((0,d.getTimestamp)(e.time)>c&&(j=!0),j||e.sub&&e.sub.forEach((function(e){(0,d.getTimestamp)(e.time)>c&&(j=!0)})));var g=_.includes(t),x={hitSlop:u.HIT_SLOP};return l.IOS?x.onPress=function(){return h(t)}:x.onPressIn=function(){return h(t)},(0,p.jsx)(i.Flex.Item,{style:g&&o.itemText,flex:b?1:g?3:1,children:(0,p.jsx)(r.default,Object.assign({},x,{children:(0,p.jsx)(i.Flex,{style:(0,d.stl)(b?o.itemVertical:o.itemHorizontal,j&&o.itemNew),justify:"center",children:g?(0,p.jsx)(i.Text,{style:a._.container.block,size:8,type:j?a._.select("plain","icon"):"icon",bold:f,align:"center",noWrap:!0,children:String((null==(m=s[t])?void 0:m.floor)||"").replace("#","")}):f?(0,p.jsx)(n.default,{style:o.dot}):null})}))},t)}))]})}),u.DEFAULT_PROPS,u.COMPONENT_MAIN,(function(e){return Object.assign({},e,{list:e.list.length})}));try{m.displayName="TouchScroll",m.__docgenInfo={description:"",displayName:"TouchScroll",props:{styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:'{ containerRight: { position: "absolute"; top: number; right: number; bottom: number; width: number; backgroundColor: "rgb(255, 255, 255)" | "rgb(36, 36, 36)"; }; containerLeft: { position: "absolute"; ... 4 more ...; backgroundColor: "rgb(255, 255, 255)" | "rgb(36, 36, 36)"; }; ... 6 more ...; dot: { ...; }; }'}},list:{defaultValue:null,description:"",name:"list",required:!0,type:{name:'any[] | { avatar: Avatar<"s">; floor: string; message: string; userId: UserId; id: Id; time: string; userName: string; replySub: string; userSign: string; erase: string; sub: CommentsItem[]; }[]'}},readedTime:{defaultValue:null,description:"",name:"readedTime",required:!0,type:{name:"number"}},scrollDirection:{defaultValue:null,description:"",name:"scrollDirection",required:!0,type:{name:"enum",value:[{value:'"none"'},{value:'"left"'},{value:'"right"'},{value:'"bottom"'}]}},directFloor:{defaultValue:null,description:"",name:"directFloor",required:!0,type:{name:"string"}},isWebLogin:{defaultValue:null,description:"",name:"isWebLogin",required:!0,type:{name:"boolean"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx#TouchScroll"]={docgenInfo:m.__docgenInfo,name:"TouchScroll",path:"src/screens/rakuen/topic/component/touch-scroll/touch-scroll.tsx#TouchScroll"})}catch(e){}},"./src/screens/rakuen/topic/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.PRE_OFFSET=t.COMPONENT=void 0;var s=o("./src/stores/index.ts");t.COMPONENT="Topic",t.PRE_OFFSET=.2*s._.window.height},"./src/screens/rakuen/topic/header/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_SPA=t.TEXT_SHARE=t.TEXT_REPORT=t.TEXT_COPY=t.DATA=t.COMPONENT=void 0;var s=o("./src/utils/dev/index.ts"),r=o("./src/constants/index.ts"),n=o("./src/screens/rakuen/topic/ds.ts"),i=(t.COMPONENT=(0,s.rc)(n.COMPONENT,"Header"),t.TEXT_SPA="网页版查看"),a=t.TEXT_COPY="复制链接",d=t.TEXT_SHARE="复制分享",c=t.TEXT_REPORT="举报",l=t.DATA=[a,d,c];r.STORYBOOK||l.unshift(i)},"./src/screens/rakuen/topic/header/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.string.fixed.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(s(o("react")),o("./src/components/index.ts")),i=o("./src/utils/index.ts"),a=o("./src/utils/decorators/index.ts"),d=o("./src/utils/fetch/index.ts"),c=o("./src/constants/index.ts"),l=s(o("./src/screens/rakuen/topic/component/header-title/index.tsx")),u=s(o("./src/screens/rakuen/topic/component/icon/favor.tsx")),p=o("./src/screens/rakuen/topic/header/ds.ts"),m=o("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var o,s=t.$,a=t.navigation,f=(null==(o=s.params)?void 0:o._url)||c.HOST+"/rakuen/topic/"+s.topicId;return(0,m.jsx)(n.Header,{mode:"transition",statusBarEventsType:"Topic",fixed:s.state.fixed,title:s.topic.title,alias:"帖子",hm:[f,"Topic"],headerTitle:(0,m.jsx)(l.default,{$:s,navigation:a}),headerRight:function(){return(0,m.jsxs)(n.Flex,{children:[(0,m.jsx)(u.default,{$:s}),(0,m.jsx)(n.Header.Popover,{data:["帖子 · "+s.topicId].concat((0,r.default)(p.DATA)),onSelect:function(e){switch((0,d.t)("帖子.右上角菜单",{key:e.includes("帖子")?"浏览器查看":e}),e){case p.TEXT_SPA:(0,i.open)(c.URL_SPA+"/"+(0,i.getSPAParams)("Topic",{topicId:s.topicId}));break;case p.TEXT_COPY:(0,i.copy)(f,"已复制链接");break;case p.TEXT_SHARE:(0,i.copy)("【链接】"+s.title+" | Bangumi番组计划\n"+f,"已复制分享文案");break;case p.TEXT_REPORT:(0,i.open)(c.HOST+"/group/forum");break;default:(0,i.open)(f)}},children:(0,m.jsx)(n.Heatmap,{id:"帖子.右上角菜单"})})]})}})}),p.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/rakuen/topic/header/index.tsx#header"})}catch(e){}},"./src/screens/rakuen/topic/hooks.ts":(e,t,o)=>{var s=o("./node_modules/@babel/runtime/regenerator/index.js");o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.string.match.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/web.timers.js"),o("./node_modules/core-js/modules/es.array.for-each.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.string.sub.js"),o("./node_modules/core-js/modules/es.array.find-index.js");var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.useTopicPage=function(e){var t=e.$,o=(0,p.useIsFocused)(),r=(0,p.useIsFocusedRef)(),j=(0,i.useRef)(null),h=(0,i.useRef)(null),y=(0,i.useRef)(0),_=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{var o,s=t.comments.list[e];if((0,c.info)(null==s?void 0:s.floor,.8),m.STORYBOOK){var r;if(-1===e)return void(0,l.scrollToTop)();var n=null==(r=document.querySelector('item-post[data-key="'+s.id+'"]'))?void 0:r.offsetTop;return void(n&&(0,l.scrollToTop)(n-d._.headerHeight))}null==(o=j.current)||o.scrollToIndex({animated:!1,index:e,viewOffset:0})}catch(e){console.error("topic/index.js","scrollTo",e)}}),[t.comments]),b=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{(0,u.t)("帖子.楼层跳转",{topicId:t.topicId,index:e});var r=d.rakuenStore.setting.sliderAnimated;if(-1===e){var n;if(o&&(0,c.info)("#1",.8),m.STORYBOOK)(0,l.scrollToTop)();else null==(n=j.current)||n.scrollToOffset({animated:!!r||o,offset:0-d._.headerHeight});return(0,c.feedback)(!0),void t.updateDirection(-1,"")}var i=t.comments.list[e];if(o&&(0,c.info)(null==i?void 0:i.floor,.8),m.STORYBOOK){var a,p=null==(a=document.querySelector('item-post[data-key="'+i.id+'"]'))?void 0:a.offsetTop;p&&(0,l.scrollToTop)(p-d._.headerHeight)}else{var f;null==(f=j.current)||f.scrollToIndex({animated:!!r||o,index:e,viewOffset:0+d._.headerHeight+s})}(0,c.feedback)(!0)}catch(e){console.error("topic/index.js","onScrollTo",e);try{var h,y,_=null==(h=String(e).match(/but maximum is (\d+)/))?void 0:h[1];if(_)o&&(0,c.info)("#"+_,.5),null==(y=j.current)||y.scrollToIndex({animated:o,index:Number(_),viewOffset:0+d._.headerHeight})}catch(e){}}}),[t]),g=(0,i.useCallback)((function(e){var t=e.highestMeasuredFrameIndex,o=e.index;try{_(t),setTimeout((function(){y.current>=8||(y.current+=1,_(o))}),100)}catch(e){console.error("topic/index.js","onScrollToIndexFailed",e)}}),[_]),x=(0,i.useCallback)((function(e){console.info("onJumpTo",e);var o=e||t.postId;if(o){var s=t.comments,r=s.list;if(s._loaded)try{var n;r.forEach((function(e,t){n||(e.id===o?(n=t,console.info("scrollIndex",n)):e.sub&&e.sub.forEach((function(e){e.id===o&&(n=t,console.info("scrollIndex sub",n))})))})),void 0!==n&&_(n)}catch(e){console.error("topic/index.js","onJumpTo",e)}}}),[t.comments,t.postId,_]),v=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{b(e);var o=t.directItems.findIndex((function(t){return t.floor==="#"+(e+1)}));o&&-1!==o&&t.updateDirection(o)}catch(e){console.error("topic/index.js","onFloorPress",e)}}),[t,b]),O=(0,i.useCallback)((function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;try{var s=t.directItems.length;if(!t.directItems.length)return;var r=t.state.directIndex,n=Math.min(s-1,Math.max(0,r+(e?1:-1)*o));if(0===r&&0===n||-1===r&&0===n&&!e)return void b(-1,!1);var i=t.directItems[n];if(!i)return;var l=i.index,u=i.floor,p=f.PRE_OFFSET;if(1===l.length)b(l[0],!1,p),o>1&&(0,c.info)(u,.8);else{var m=d.rakuenStore.setting.subExpand;l[1]>Number(m)-1&&t.onExpand(i.pid),setTimeout((function(){var e=i.pid,t=i.sibling;p+=f.PRE_OFFSET,p-=a.layoutHeightMap.get(e)||0,t.forEach((function(e){p-=a.layoutHeightMap.get(e)||0})),b(l[0],!1,p),o>1&&(0,c.info)(u,.8)}),40)}t.updateDirection(n,u)}catch(e){console.error("topic/index.js","onDirect",e)}}),[t,b]),T=(0,i.useCallback)((function(){try{var e;null==(e=h.current)||e.onFocus()}catch(e){console.error("topic/index.js","onShowFixedTextarea",e)}}),[]);return(0,p.useRunAfter)((0,n.default)(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,c.androidKeyboardAdjust)("setAdjustResize"),setTimeout((function(){r.current&&t.setRendered(!0)}),400),e.next=4,t.init();case 4:t.postId&&x();case 5:case"end":return e.stop()}}),e)})))),(0,p.useKeyboardAdjustResize)(),(0,i.useEffect)((function(){o||(d.uiStore.closePopableSubject(),d.uiStore.closeLikesGrid())}),[o]),(0,p.useMount)((function(){return function(){setTimeout((function(){t.setState({fixed:!1})}),480)}})),{fixedTextareaRef:h,forwardRef:j,onDirect:O,onFloorPress:v,onJumpTo:x,onScrollToIndexFailed:g,onShowFixedTextarea:T}};var n=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o("react"),a=o("./src/screens/_/item/post/utils.ts"),d=o("./src/stores/index.ts"),c=o("./src/utils/index.ts"),l=o("./src/utils/dom/index.ts"),u=o("./src/utils/fetch/index.ts"),p=o("./src/utils/hooks/index.ts"),m=o("./src/constants/index.ts"),f=o("./src/screens/rakuen/topic/ds.ts")},"./src/screens/rakuen/topic/index.tsx":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(o("react"));var r=o("./src/components/index.ts"),n=o("./src/screens/_/index.ts"),i=o("./src/utils/decorators/index.ts"),a=o("./src/utils/hooks/index.ts"),d=s(o("./src/screens/rakuen/topic/component/bottom/index.tsx")),c=s(o("./src/screens/rakuen/topic/component/heatmaps/index.tsx")),l=s(o("./src/screens/rakuen/topic/component/list/index.tsx")),u=s(o("./src/screens/rakuen/topic/component/touch-scroll/index.tsx")),p=s(o("./src/screens/rakuen/topic/header/index.tsx")),m=o("./src/screens/rakuen/topic/hooks.ts"),f=s(o("./src/screens/rakuen/topic/store/index.ts")),j=o("./node_modules/react/jsx-runtime.js");t.default=(0,i.ic)(f.default,(function(e,t){var o=(0,m.useTopicPage)(t),s=o.forwardRef,i=o.fixedTextareaRef,f=o.onFloorPress,h=o.onShowFixedTextarea,y=o.onScrollToIndexFailed,_=o.onDirect;return(0,a.useObserver)((function(){return(0,j.jsxs)(r.Component,{id:"screen-topic",children:[(0,j.jsx)(n.TapListener,{children:(0,j.jsxs)(r.Page,{statusBarEvent:!1,children:[(0,j.jsx)(l.default,{forwardRef:s,onScrollToIndexFailed:y,onShowFixedTextarea:h}),(0,j.jsx)(u.default,{onPress:f})]})}),(0,j.jsx)(p.default,{}),(0,j.jsx)(d.default,{fixedTextareaRef:i,onDirect:_}),(0,j.jsx)(c.default,{})]})}))}));try{topic.displayName="topic",topic.__docgenInfo={description:"",displayName:"topic",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/topic/index.tsx#topic"]={docgenInfo:topic.__docgenInfo,name:"topic",path:"src/screens/rakuen/topic/index.tsx#topic"})}catch(e){}},"./src/screens/rakuen/topic/store/action.ts":(e,t,o)=>{var s=o("./node_modules/@babel/runtime/regenerator/index.js");o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.array.for-each.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.string.sub.js"),o("./node_modules/core-js/modules/es.array.reverse.js"),o("./node_modules/core-js/modules/es.array.slice.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/web.timers.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.string.match.js"),o("./node_modules/core-js/modules/es.string.replace.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.function.bind.js"),o("./node_modules/core-js/modules/es.string.fixed.js"),o("./node_modules/core-js/modules/es.string.trim.js"),o("./node_modules/core-js/modules/es.array.is-array.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/es.array.join.js"),o("./node_modules/core-js/modules/es.array.map.js");var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(o("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=r(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),a=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),p=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=r(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),j=o("./src/components/header/utils.tsx"),h=o("./src/stores/index.ts"),y=o("./src/utils/index.ts"),_=r(o("./src/utils/cache-manager/index.ts")),b=o("./src/utils/fetch/index.ts"),g=o("./src/utils/kv/index.ts"),x=r(o("./src/utils/thirdParty/html-entities-decoder.ts")),v=o("./src/constants/index.ts"),O=r(o("./src/screens/rakuen/topic/store/fetch.ts")),T=o("./src/screens/rakuen/topic/store/ds.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return(0,p.default)(this,o)}}t.default=function(e){(0,u.default)(o,e);var t=S(o);function o(){var e,r,d;(0,c.default)(this,o);for(var u=arguments.length,p=new Array(u),m=0;m<u;m++)p[m]=arguments[m];return e=t.call.apply(t,[this].concat(p)),(0,f.default)((0,l.default)(e),"cacheAvatars",(function(){e.comments.list.forEach((function(e){var t="avatar|"+e.userId;_.default.has(t)||_.default.set(t,e.avatar),e.sub.forEach((function(e){var t="avatar|"+e.userId;_.default.has(t)||_.default.set(e.userId,e.avatar)}))}))})),(0,f.default)((0,l.default)(e),"toggleReverseComments",(function(){var t=e.state.reverse;(0,b.t)("帖子.吐槽倒序",{topicId:e.topicId,reverse:!t}),e.setState({reverse:!t}),e.setStorage(T.NAMESPACE)})),(0,f.default)((0,l.default)(e),"onFilterClear",(function(){e.setState({filterType:"",filterPost:""}),e.save(),(0,y.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterLikes",(function(){(0,b.t)("帖子.贴贴相关",{topicId:e.topicId}),e.setState({filterType:"likes",filterPost:""}),e.save(),(0,y.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterMe",(function(){(0,b.t)("帖子.与我相关",{topicId:e.topicId}),e.setState({filterType:"me",filterPost:""}),e.save(),(0,y.feedback)()})),(0,f.default)((0,l.default)(e),"onFilterFriends",(function(){(0,b.t)("帖子.好友相关",{topicId:e.topicId}),e.setState({filterType:"friends",filterPost:""}),e.save(),(0,y.feedback)()})),(0,f.default)((0,l.default)(e),"clearFilterPost",(function(){e.setState({filterPost:""})})),(0,f.default)((0,l.default)(e),"showFixedTextarea",(function(t,o,s,r){(0,b.t)("帖子.显示评论框",{topicId:e.topicId});var n="";if(t&&(n="回复 "+t+"："),r){var i=(0,y.HTMLDecode)((0,y.removeHTMLTag)(r,!1));i.length>=64&&(i=i.slice(0,64)+"..."),n+=i}e.setState({placeholder:n,replySub:o,message:s})})),(0,f.default)((0,l.default)(e),"closeFixedTextarea",(function(){e.setState({placeholder:"",replySub:"",message:"",editPostId:""})})),(0,f.default)((0,l.default)(e),"showFixedTextareaEdit",(r=(0,a.default)(s.mark((function t(o,r){var n,i;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.rakuenStore.fetchTopicEdit(o,null==(n=String(e.topicId).split("/"))?void 0:n[0]);case 2:if(!0!==(i=t.sent)){t.next=6;break}return(0,y.info)("此楼层不再允许修改，可能已被回复过"),t.abrupt("return");case 6:if(i){t.next=9;break}return(0,y.info)("未能获取到回复内容，可能授权过期了"),t.abrupt("return");case 9:e.setState({value:""}),setTimeout((function(){e.setState({editPostId:o,value:i}),r()}),0);case 11:case"end":return t.stop()}}),t)}))),function(e,t){return r.apply(this,arguments)})),(0,f.default)((0,l.default)(e),"onChange",(function(t){e.setState({value:t})})),(0,f.default)((0,l.default)(e),"recoveryContent",(function(t){(0,b.t)("帖子.回复失败",{topicId:e.topicId}),(0,y.info)("回复失败，可能是cookie失效了"),e.setState({value:""}),setTimeout((function(){e.setState({value:t})}),160)})),(0,f.default)((0,l.default)(e),"setFavor",(0,a.default)(s.mark((function t(){var o,r,n,i,a,d;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=!e.isFavor,t.next=3,h.rakuenStore.setFavorV2(e.topicId,o);case 3:200===(null==(r=t.sent)?void 0:r.code)&&((0,b.t)("帖子.设置收藏",{topicId:e.topicId,isFavor:o}),o&&(i={avatar:e.avatar,userId:e.userId,userName:e.userName,title:e.title,group:e.group,time:e.time},null!=(n=i.avatar)&&n.includes("icon.jpg")&&(i.avatar=e.groupThumb),e.topicId.includes("ep/")&&(d=null==(a=String(e.epFormHTML).match(/\/ 首播:(.+?)<\/span>/))?void 0:a[1])&&(i.time="首播:"+d),(0,g.update)("favor_"+e.topicId.replace("/","_"),i)));case 5:case"end":return t.stop()}}),t)})))),(0,f.default)((0,l.default)(e),"updateShowHeaderTitle",(function(t){e.setState({showHeaderTitle:t})})),(0,f.default)((0,l.default)(e),"toggleExpand",(function(t){var o=e.state.expands;e.setState({expands:o.includes(t)?o.filter((function(e){return e!==t})):[].concat((0,i.default)(o),[t])}),e.save()})),(0,f.default)((0,l.default)(e),"onExpand",(function(t){e.state.expands.includes(String(t))||e.toggleExpand(String(t))})),(0,f.default)((0,l.default)(e),"updateDirection",(function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e.setState({directIndex:t,directFloor:o}),e.save()})),(0,f.default)((0,l.default)(e),"updateVisibleBottom",y.updateVisibleBottom.bind((0,l.default)(e))),(0,f.default)((0,l.default)(e),"onScrollY",0),(0,f.default)((0,l.default)(e),"onScroll",(function(t){e.updateVisibleBottom(t),h.uiStore.closePopableSubject(),h.uiStore.closeLikesGrid();var o=t.nativeEvent.contentOffset.y;e.onScrollY=o;var s=e.state.fixed;s&&o>j.HEADER_TRANSITION_HEIGHT||!s&&o<=j.HEADER_TRANSITION_HEIGHT||e.setState({fixed:o>j.HEADER_TRANSITION_HEIGHT})})),(0,f.default)((0,l.default)(e),"setRendered",(function(t){e.setState({rendered:t})})),(0,f.default)((0,l.default)(e),"doSubmit",(function(t){var o;if(e.topicId.includes("group/"))o="group/topic";else if(e.topicId.includes("subject/"))o="subject/topic";else if(e.topicId.includes("ep/"))o="subject/ep";else if(e.topicId.includes("crt/"))o="character";else{if(!e.topicId.includes("prsn/"))return;o="person"}var s=e.state,r=s.replySub,n=s.editPostId;n?e.doEditReply(n,t):r?e.doReplySub(t,o):e.doReply(t,o)})),(0,f.default)((0,l.default)(e),"doEditReply",(function(t,o){var r;(0,b.t)("帖子.编辑回复",{topicId:e.topicId,postId:t});var n=e.topic.formhash;h.rakuenStore.doEditReply({postId:t,topicType:null==(r=String(e.topicId).split("/"))?void 0:r[0],content:o,formhash:n},(0,a.default)(s.mark((function t(){return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({value:"",editPostId:""}),t.next=3,e.fetchTopic();case 3:(0,y.feedback)();case 4:case"end":return t.stop()}}),t)}))))})),(0,f.default)((0,l.default)(e),"doReply",(function(t,o){(0,b.t)("帖子.回复",{topicId:e.topicId,sub:!1});var s=e.topic.formhash;h.rakuenStore.doReply({type:o,topicId:e.topicId.match(/\d+/g)[0],content:t,formhash:s},(function(o){var s={};try{s=JSON.parse(o)}catch(e){}v.IOS&&"ok"!==s.status?e.recoveryContent(t):e.setState({value:""}),(0,y.feedback)(),e.fetchTopic()}))})),(0,f.default)((0,l.default)(e),"doReplySub",(function(t,o){(0,b.t)("帖子.回复",{topicId:e.topicId,sub:!0});var s=e.state,r=s.placeholder,i=s.replySub,a=s.message,d=e.topic.formhash,c=i.split(","),l=(0,n.default)(c,6),u=l[1],p=l[2],m=l[4],f=l[5],j=t;if(a){var _=(0,x.default)(a).replace(/<div class="quote"><q>.*<\/q><\/div>/,"");j="[quote][b]"+r+"[/b] 说: "+(0,y.removeHTMLTag)(_,!1)+"[/quote]\n"+t}h.rakuenStore.doReply({type:o,content:j,formhash:d,topicId:String(u||"").trim(),related:String(p||"").trim(),sub_reply_uid:String(m||"").trim(),post_uid:String(f||"").trim()},(function(o){var s={};try{s=JSON.parse(o)}catch(e){}v.IOS&&"ok"!==s.status?e.recoveryContent(t):e.setState({value:""}),(0,y.feedback)(),e.fetchTopic()}))})),(0,f.default)((0,l.default)(e),"doDeleteReply",(function(t){t&&((0,b.t)("帖子.删除回复",{topicId:e.topicId}),h.rakuenStore.doDeleteReply({url:v.HOST+"/"+t},(function(){(0,y.feedback)(),(0,y.info)("已删除"),e.fetchTopic()})))})),(0,f.default)((0,l.default)(e),"doTranslate",(0,a.default)(s.mark((function t(){var o,r,n,i;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.translateResult.length){t.next=2;break}return t.abrupt("return");case 2:return(0,b.t)("帖子.翻译内容",{topicId:e.topicId}),t.prev=3,o=(0,y.loading)(),t.next=7,(0,b.baiduTranslate)(String(e.title+"\n"+e.html).replace(/<br \/>/g,"\n").replace(/<\/?[^>]*>/g,""));case 7:if(r=t.sent,o(),n=JSON.parse(r),i=n.trans_result,!Array.isArray(i)){t.next=13;break}return e.setState({translateResult:i}),t.abrupt("return");case 13:(0,y.info)("翻译失败, 请重试"),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(3),o&&o(),(0,y.info)("翻译失败, 请重试");case 20:case"end":return t.stop()}}),t,null,[[3,16]])})))),(0,f.default)((0,l.default)(e),"doTranslateFloor",(d=(0,a.default)(s.mark((function t(o,r){var n,i,a,d,c;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=e.state.translateResultFloor)[o]){t.next=3;break}return t.abrupt("return");case 3:return(0,b.t)("帖子.翻译内容",{floorId:o}),t.prev=4,i=(0,y.loading)(),t.next=8,(0,b.baiduTranslate)((0,y.removeHTMLTag)(r.replace(/<br>/g,"\n"),!1));case 8:if(a=t.sent,i(),d=JSON.parse(a),c=d.trans_result,!Array.isArray(c)){t.next=14;break}return e.setState({translateResultFloor:Object.assign({},n,(0,f.default)({},o,c.map((function(e){return e.dst})).join("\n")))}),t.abrupt("return");case 14:(0,y.info)("翻译失败, 请重试"),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(4),i&&i(),(0,y.info)("翻译失败, 请重试");case 21:case"end":return t.stop()}}),t,null,[[4,17]])}))),function(e,t){return d.apply(this,arguments)})),e}return(0,d.default)(o)}(O.default)},"./src/screens/rakuen/topic/store/computed.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.string.split.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.string.replace.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.array.for-each.js"),o("./node_modules/core-js/modules/web.dom-collections.for-each.js"),o("./node_modules/core-js/modules/es.string.sub.js"),o("./node_modules/core-js/modules/es.array.reverse.js"),o("./node_modules/core-js/modules/es.array.slice.js"),o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.array.find-index.js"),o("./node_modules/core-js/modules/es.object.keys.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/es.array.sort.js"),o("./node_modules/core-js/modules/es.array.index-of.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=s(o("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=s(o("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),a=s(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=s(o("./node_modules/@babel/runtime/helpers/createClass.js")),c=s(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=s(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=s(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=s(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=s(o("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=o("./node_modules/mobx/dist/mobx.esm.js"),h=o("./src/stores/index.ts"),y=o("./src/utils/index.ts"),_=s(o("./src/utils/cache-manager/index.ts")),b=o("./src/constants/index.ts"),g=s(o("./src/screens/rakuen/topic/store/state.ts")),x=o("./src/screens/rakuen/topic/store/ds.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=(0,p.default)(e);if(t){var r=(0,p.default)(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return(0,u.default)(this,o)}}t.default=(r=function(e){(0,l.default)(o,e);var t=v(o);function o(){var e;(0,a.default)(this,o);for(var s=arguments.length,r=new Array(s),n=0;n<s;n++)r[n]=arguments[n];return e=t.call.apply(t,[this].concat(r)),(0,m.default)((0,c.default)(e),"save",(function(){return e.saveStorage(e.namespace,x.EXCLUDE_STATE)})),e}return(0,d.default)(o,[{key:"topicId",get:function(){var e,t=this.params.topicId,o=void 0===t?"":t;return o?(null==(e=o.split("#"))?void 0:e[0])||"":"0"}},{key:"postId",get:function(){var e,t=this.params.topicId;return null==(e=(void 0===t?"":t).split("#post_"))?void 0:e[1]}},{key:"namespace",get:function(){return x.NAMESPACE+"|"+this.topicId}},{key:"topic",get:function(){return h.rakuenStore.topic(this.topicId)}},{key:"topicFormCDN",get:function(){var e=this.state.topic;return e._loaded?e:h.rakuenStore.topicFormCDN(this.topicId.replace("group/",""))}},{key:"comments",get:function(){var e=this;if(this.state.filterPost){var t=h.rakuenStore.comments(this.topicId);return Object.assign({},t,{list:t.list.filter((function(t){if(t.id===e.state.filterPost)return!0;var o=!1;return t.sub.forEach((function(t){t.id===e.state.filterPost&&(o=!0)})),o})),pagination:{page:1,pageTotal:1}})}var o=this.state,s=o.reverse,r=o.filterType,n=h.rakuenStore.comments(this.topicId),a=n._loaded?n:this.state.comments,d=a.list;if(s&&(d=a.list.slice().reverse()),h.systemStore.setting.filterDefault&&(d=d.filter((function(e){var t;return!(null!=(t=e.avatar)&&t.includes(b.URL_DEFAULT_AVATAR))})).map((function(e){return Object.assign({},e,{sub:e.sub.filter((function(e){var t;return!(null!=(t=e.avatar)&&t.includes(b.URL_DEFAULT_AVATAR))}))})}))),"likes"===r){var c=(0,i.default)(this.likesFloorIds||[]);return c.length?Object.assign({},a,{list:d.filter((function(e){if(c.includes(e.id))return!0;var t=!1;return e.sub.forEach((function(e){c.includes(e.id)&&(t=!0)})),t})),pagination:{page:1,pageTotal:1}}):Object.assign({},a,{list:d})}return"me"===r?Object.assign({},a,{list:d.filter((function(t){return-1!==t.sub.findIndex((function(t){return t.userId===e.myId}))||t.userId===e.myId})),pagination:{page:1,pageTotal:1}}):"friends"===r?Object.assign({},a,{list:d.filter((function(t){return-1!==t.sub.findIndex((function(t){return e.myFriendsMap[t.userId]}))||e.myFriendsMap[t.userId]})),pagination:{page:1,pageTotal:1}}):Object.assign({},a,{list:d})}},{key:"commentMeCount",get:function(){var e=this;return h.rakuenStore.comments(this.topicId).list.filter((function(t){return-1!==t.sub.findIndex((function(t){return t.userId===e.myId}))||t.userId===e.myId})).length}},{key:"commentFriendsCount",get:function(){var e=this;return h.rakuenStore.comments(this.topicId).list.filter((function(t){return-1!==t.sub.findIndex((function(t){return e.myFriendsMap[t.userId]}))||e.myFriendsMap[t.userId]})).length}},{key:"likesFloorIds",get:function(){return Object.keys(h.rakuenStore.likes(this.topicId))}},{key:"directItems",get:function(){var e="directItems|"+this.topicId+"|"+this.comments._loaded;if(_.default.get(e))return _.default.get(e);var t=[];return this.comments.list.forEach((function(e,o){t.push({id:Number(e.id),floor:e.floor,index:[o]});var s=[];e.sub.forEach((function(r,n){s.push(Number(r.id)),t.push({pid:Number(e.id),id:Number(r.id),floor:r.floor,index:[o,n],sibling:[].concat(s)})}))})),t.sort((function(e,t){return(0,y.asc)(e.id,t.id)})),_.default.set(e,t)}},{key:"isEp",get:function(){return 0===this.topicId.indexOf("ep/")}},{key:"isMono",get:function(){return 0===this.topicId.indexOf("prsn/")||0===this.topicId.indexOf("crt/")}},{key:"monoId",get:function(){return 0===this.topicId.indexOf("prsn/")?this.topicId.replace("prsn/","person/"):0===this.topicId.indexOf("crt/")?this.topicId.replace("crt/","character/"):this.topicId}},{key:"epFormHTML",get:function(){var e=this.topicId.replace("ep/","");return h.subjectStore.epFormHTML(e)}},{key:"isWebLogin",get:function(){return h.userStore.isWebLogin}},{key:"readed",get:function(){return h.rakuenStore.readed(this.topicId)}},{key:"myId",get:function(){return h.userStore.myId}},{key:"myFriendsMap",get:function(){return h.usersStore.myFriendsMap}},{key:"isUGCAgree",get:function(){return h.systemStore.isUGCAgree}},{key:"isFavor",get:function(){return h.rakuenStore.favorV2(this.topicId)}},{key:"favorCount",get:function(){return h.rakuenStore.favorCount(this.topicId)}},{key:"setting",get:function(){return h.rakuenStore.setting}},{key:"isLimit",get:function(){return h.userStore.isLimit}},{key:"filterDelete",get:function(){return h.rakuenStore.setting.filterDelete}},{key:"postUsersMap",get:function(){var e={};return h.rakuenStore.comments(this.topicId).list.forEach((function(t){e[t.userName]||(e[t.userName]={userId:t.userId,userName:t.userName,avatar:t.avatar}),t.sub.forEach((function(t){e[t.userName]||(e[t.userName]={userId:t.userId,userName:t.userName,avatar:t.avatar})}))})),e}},{key:"isBlockUser",value:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(0,j.computed)((function(){return-1!==h.rakuenStore.blockUserIds.findIndex((function(s){var r=s.split("@"),i=(0,n.default)(r,2),a=i[0],d=i[1];if("undefined"===d)return a===t;if(o){var c=o.split(",");if(7===c.length&&d==c[5])return!0}return d==e||a===t}))})).get()}},{key:"title",get:function(){return(0,y.HTMLDecode)(("undefined"===this.topic.title?"":this.topic.title)||this.params._title||this.topicFormCDN.title||"")}},{key:"subTitle",get:function(){if(!this.topicId.includes("ep/"))return"";var e=(0,y.HTMLDecode)(this.params._title||"");return e===this.title?"":e}},{key:"group",get:function(){return this.isMono?this.topic.title||this.params._title:this.topic.group||this.params._group||this.topicFormCDN.group||""}},{key:"groupThumb",get:function(){var e=this.params,t=e._group,o=e._groupThumb;return o||(t?h.rakuenStore.groupThumb(t):this.topic.groupThumb||this.topicFormCDN.groupThumb||"")}},{key:"groupHref",get:function(){return this.topic.groupHref||this.topicFormCDN.groupHref||""}},{key:"time",get:function(){return this.topic.time||this.topicFormCDN.time||""}},{key:"avatar",get:function(){return this.topic.avatar||this.params._avatar||this.topicFormCDN.avatar||""}},{key:"userId",get:function(){return this.topic.userId||this.params._userId||this.topicFormCDN.userId||""}},{key:"userName",get:function(){return(0,y.HTMLDecode)(this.topic.userName||this.params._userName||this.topicFormCDN.userName||"")}},{key:"userSign",get:function(){return this.topic.userSign||this.topicFormCDN.userSign||""}},{key:"html",get:function(){return this.isEp?this.epFormHTML||this.params._desc:(this.topic.message||this.topicFormCDN.message||"").replace(/(<br\s*\/?>){3,}/g,"<br><br>")}}]),o}(g.default),(0,f.default)(r.prototype,"topicId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicId"),r.prototype),(0,f.default)(r.prototype,"postId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"postId"),r.prototype),(0,f.default)(r.prototype,"namespace",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"namespace"),r.prototype),(0,f.default)(r.prototype,"topic",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topic"),r.prototype),(0,f.default)(r.prototype,"topicFormCDN",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicFormCDN"),r.prototype),(0,f.default)(r.prototype,"comments",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"comments"),r.prototype),(0,f.default)(r.prototype,"commentMeCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"commentMeCount"),r.prototype),(0,f.default)(r.prototype,"commentFriendsCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"commentFriendsCount"),r.prototype),(0,f.default)(r.prototype,"likesFloorIds",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"likesFloorIds"),r.prototype),(0,f.default)(r.prototype,"directItems",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"directItems"),r.prototype),(0,f.default)(r.prototype,"isEp",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isEp"),r.prototype),(0,f.default)(r.prototype,"isMono",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isMono"),r.prototype),(0,f.default)(r.prototype,"monoId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"monoId"),r.prototype),(0,f.default)(r.prototype,"epFormHTML",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"epFormHTML"),r.prototype),(0,f.default)(r.prototype,"isWebLogin",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isWebLogin"),r.prototype),(0,f.default)(r.prototype,"readed",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"readed"),r.prototype),(0,f.default)(r.prototype,"myId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"myId"),r.prototype),(0,f.default)(r.prototype,"myFriendsMap",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"myFriendsMap"),r.prototype),(0,f.default)(r.prototype,"isUGCAgree",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isUGCAgree"),r.prototype),(0,f.default)(r.prototype,"isFavor",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isFavor"),r.prototype),(0,f.default)(r.prototype,"favorCount",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"favorCount"),r.prototype),(0,f.default)(r.prototype,"setting",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"setting"),r.prototype),(0,f.default)(r.prototype,"isLimit",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"isLimit"),r.prototype),(0,f.default)(r.prototype,"filterDelete",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"filterDelete"),r.prototype),(0,f.default)(r.prototype,"postUsersMap",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"postUsersMap"),r.prototype),(0,f.default)(r.prototype,"title",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"title"),r.prototype),(0,f.default)(r.prototype,"subTitle",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"subTitle"),r.prototype),(0,f.default)(r.prototype,"group",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"group"),r.prototype),(0,f.default)(r.prototype,"groupThumb",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"groupThumb"),r.prototype),(0,f.default)(r.prototype,"groupHref",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"groupHref"),r.prototype),(0,f.default)(r.prototype,"time",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"time"),r.prototype),(0,f.default)(r.prototype,"avatar",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"avatar"),r.prototype),(0,f.default)(r.prototype,"userId",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userId"),r.prototype),(0,f.default)(r.prototype,"userName",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userName"),r.prototype),(0,f.default)(r.prototype,"userSign",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"userSign"),r.prototype),(0,f.default)(r.prototype,"html",[j.computed],Object.getOwnPropertyDescriptor(r.prototype,"html"),r.prototype),r)},"./src/screens/rakuen/topic/store/ds.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=void 0;var s=o("./src/stores/index.ts"),r=o("./src/constants/index.ts"),n=(t.NAMESPACE="ScreenTopic",t.EXCLUDE_STATE={fixed:!1,rendered:r.STORYBOOK,visibleBottom:s._.window.height,showHeaderTitle:!1,placeholder:"",value:"",replySub:"",editPostId:"",message:"",translateResult:[],translateResultFloor:{},topic:{_loaded:0},comments:{list:[],pagination:{page:0,pageTotal:0},_list:[],_loaded:0},filterPost:""});t.STATE=Object.assign({},n,{expands:[],filterType:"",reverse:!1,favor:{favored:!1,count:0,_loaded:0},directIndex:-1,directFloor:"",_loaded:!1})},"./src/screens/rakuen/topic/store/fetch.ts":(e,t,o)=>{var s=o("./node_modules/@babel/runtime/regenerator/index.js");o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.string.replace.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/web.timers.js"),o("./node_modules/core-js/modules/es.array.map.js"),o("./node_modules/core-js/modules/es.array.filter.js"),o("./node_modules/core-js/modules/es.string.sub.js");var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=r(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=o("./src/stores/index.ts"),f=o("./src/utils/index.ts"),j=o("./src/utils/kv/index.ts"),h=r(o("./src/utils/thirdParty/html-entities-decoder.ts")),y=r(o("./src/screens/rakuen/topic/store/computed.ts"));function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return(0,l.default)(this,o)}}t.default=function(e){(0,c.default)(o,e);var t=_(o);function o(){var e;(0,a.default)(this,o);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,p.default)((0,d.default)(e),"fetchTopic",(function(){return m.rakuenStore.fetchTopic({topicId:e.topicId})})),(0,p.default)((0,d.default)(e),"fetchEpFormHTML",(function(){var t=e.topicId.replace("ep/","");return m.subjectStore.fetchEpFormHTML(t)})),(0,p.default)((0,d.default)(e),"fetchTopicFromOSS",(0,n.default)(s.mark((function t(){var o,r,n,i,a,d,c,l;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.topic._loaded){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,(0,j.get)("topic_"+e.topicId.replace("/","_"));case 5:if(o=t.sent){t.next=9;break}return e.updateTopicThirdParty(),t.abrupt("return");case 9:r=o.ts,n=o.topic,i=o.comments,a=(0,f.getTimestamp)(),"object"==typeof n&&"object"==typeof i&&(l={topic:Object.assign({},n,{_loaded:a})},null!=i&&null!=(d=i.list)&&null!=(c=d[0])&&c.floor&&(i.list.length>=2&&1===i.list[0].floor.localeCompare(i.list[1].floor)||(l.comments=Object.assign({},i,{_loaded:a}))),e.setState(l)),a-r>=14400&&e.updateTopicThirdParty(),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(2);case 17:case"end":return t.stop()}}),t,null,[[2,15]])})))),(0,p.default)((0,d.default)(e),"updateTopicThirdParty",(function(){setTimeout((function(){var t=e.topic,o=t._loaded,s=t.formhash;if(o&&s)try{(0,j.update)("topic_"+e.topicId.replace("/","_"),{topic:(0,f.omit)(e.topic,["formhash","lastview","close","_loaded"]),comments:Object.assign({},e.comments,{list:e.comments.list.filter((function(e,t){return t<16})).map((function(e){return Object.assign({},(0,f.omit)(e,["replySub","erase","message","sub"]),{message:(0,h.default)(e.message),sub:e.sub.filter((function(e,t){return t<8})).map((function(e){return Object.assign({},(0,f.omit)(e,["replySub","erase","message"]),{message:(0,h.default)(e.message)})}))})}))})})}catch(e){}}),1e4)})),e}return(0,i.default)(o)}(y.default)},"./src/screens/rakuen/topic/store/index.ts":(e,t,o)=>{var s=o("./node_modules/@babel/runtime/regenerator/index.js");o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.number.constructor.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/es.array.reverse.js"),o("./node_modules/core-js/modules/web.timers.js");var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),a=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=r(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=o("./src/stores/index.ts"),f=o("./src/utils/index.ts"),j=r(o("./src/screens/rakuen/topic/store/action.ts")),h=o("./src/screens/rakuen/topic/store/ds.ts");function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return(0,l.default)(this,o)}}var _=!1,b=function(e){(0,c.default)(o,e);var t=y(o);function o(){var e;(0,a.default)(this,o);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),(0,p.default)((0,d.default)(e),"init",(0,n.default)(s.mark((function t(){var o,r,n,i,a;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.state._loaded,r=(0,f.getTimestamp)(),n=!o||r-Number(o)>60,t.next=5,e.getStorage(h.NAMESPACE);case 5:return i=t.sent,t.prev=6,t.t0=Object,t.t1={},t.next=11,e.getStorage(e.namespace);case 11:if(t.t2=t.sent,t.t3=h.EXCLUDE_STATE,t.t4={reverse:i.reverse,_loaded:n?r:o},a=t.t0.assign.call(t.t0,t.t1,t.t2,t.t3,t.t4),e.postId&&(a.filterType="",a.filterPost=e.postId),e.setState(a),e.fetchTopicFromOSS(),_||(m.rakuenStore.getFavor(),_=!0),!n){t.next=28;break}if(e.isEp?e.fetchEpFormHTML():m.rakuenStore.checkIsFavor(e.topicId),m.usersStore.updateFriendsMap(),e.params._noFetch){t.next=28;break}return t.next=26,e.fetchTopic();case 26:return setTimeout((function(){e.cacheAvatars()}),0),t.abrupt("return",!0);case 28:t.next=33;break;case 30:t.prev=30,t.t5=t.catch(6),e.setState(Object.assign({},h.EXCLUDE_STATE,{reverse:i.reverse,_loaded:n?r:o}));case 33:return t.abrupt("return",!0);case 34:case"end":return t.stop()}}),t,null,[[6,30]])})))),e}return(0,i.default)(o)}(j.default);t.default=b},"./src/screens/rakuen/topic/store/state.ts":(e,t,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js");var s=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(o("./node_modules/@babel/runtime/helpers/createClass.js")),n=s(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=s(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=s(o("./node_modules/@babel/runtime/helpers/inherits.js")),d=s(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),c=s(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),l=s(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),u=o("./node_modules/mobx/dist/mobx.esm.js"),p=s(o("./src/utils/store/index.ts")),m=o("./src/screens/rakuen/topic/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,s=(0,c.default)(e);if(t){var r=(0,c.default)(this).constructor;o=Reflect.construct(s,arguments,r)}else o=s.apply(this,arguments);return(0,d.default)(this,o)}}t.default=function(e){(0,a.default)(o,e);var t=f(o);function o(){var e;(0,n.default)(this,o);for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),(0,l.default)((0,i.default)(e),"params",void 0),(0,l.default)((0,i.default)(e),"state",(0,u.observable)(m.STATE)),e}return(0,r.default)(o)}(p.default)}}]);