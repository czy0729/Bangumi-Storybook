(self.webpackChunkweb=self.webpackChunkweb||[]).push([[3543],{"./src/screens/rakuen/search/component/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/rakuen/search/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"Component")},"./src/screens/rakuen/search/component/history/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"History")},"./src/screens/rakuen/search/component/history/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.map.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),a=r("./src/utils/decorators/index.ts"),c=r("./src/screens/rakuen/search/component/history/ds.ts"),d=r("./src/screens/rakuen/search/component/history/styles.ts"),l=r("./node_modules/react/jsx-runtime.js");s.default=(0,a.obc)((function(e,s){var r=e.style,t=s.$;if(""!==t.state.value)return null;var a=(0,d.memoStyles)();return(0,l.jsxs)(n.default,{style:r,children:[t.state.history.map((function(e){return(0,l.jsx)(n.default,{style:a.item,children:(0,l.jsxs)(o.Flex,{style:a.content,children:[(0,l.jsx)(o.Flex.Item,{children:(0,l.jsx)(o.Text,{size:15,bold:!0,onPress:function(){return t.selectHistory(e)},children:e})}),(0,l.jsx)(o.Touchable,{style:a.close,onPress:function(){return t.deleteHistory(e)},children:(0,l.jsx)(o.Iconfont,{name:"md-close"})})]})},e)})),(0,l.jsx)(o.Heatmap,{right:52,id:"帖子搜索.选择历史"}),(0,l.jsx)(o.Heatmap,{id:"帖子搜索.删除历史",transparent:!0})]})}),c.COMPONENT)},"./src/screens/rakuen/search/component/history/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{item:{paddingHorizontal:t._.wind},content:{paddingVertical:t._.sm},close:{padding:t._.sm,marginLeft:t._.md,marginRight:-t._.sm}}}))},"./src/screens/rakuen/search/component/item/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.LENGTH=s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"Item"),s.LENGTH=240},"./src/screens/rakuen/search/component/item/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.index-of.js"),r("./node_modules/core-js/modules/es.array.slice.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),a=r("./src/screens/_/index.ts"),c=r("./src/stores/index.ts"),d=r("./src/utils/index.ts"),l=r("./src/utils/decorators/index.ts"),i=r("./src/utils/fetch/index.ts"),u=r("./src/screens/rakuen/search/component/item/ds.ts"),m=r("./src/screens/rakuen/search/component/item/styles.ts"),p=r("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var r=e.index,t=e.id,l=e.title,h=e.message,f=e.avatar,j=e.userId,_=e.userName,y=e.time,b=e.group,x=s.$,v=s.navigation,g=(0,m.memoStyles)(),O=x.state.value,S=h.indexOf(O),k=S<u.LENGTH?h.slice(0,u.LENGTH):h.slice(48,u.LENGTH+S-48);return(0,p.jsxs)(n.default,{style:g.item,children:[!!r&&(0,p.jsx)(o.Divider,{}),(0,p.jsx)(o.Touchable,{style:g.touch,onPress:function(){(0,i.t)("帖子搜索.跳转",{to:"Topic",topicId:"group/"+t}),v.push("Topic",{topicId:"group/"+t})},children:(0,p.jsxs)(o.Flex,{align:"start",children:[(0,p.jsx)(a.Avatar,{src:f,userId:j}),(0,p.jsxs)(o.Flex.Item,{style:c._.ml.sm,children:[(0,p.jsx)(o.Highlight,{size:16,bold:!0,value:O,children:l}),(0,p.jsxs)(o.Text,{style:c._.mt.xs,type:"sub",size:12,children:[(0,d.lastDate)((0,d.getTimestamp)(y))," / ",_," / ",b]})]})]})}),(0,p.jsx)(o.Highlight,{lineHeight:16,value:O,children:k}),!r&&(0,p.jsx)(o.Heatmap,{id:"帖子搜索.跳转"})]})}),u.COMPONENT)},"./src/screens/rakuen/search/component/item/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{item:{paddingHorizontal:t._.wind,paddingBottom:t._.md,backgroundColor:t._.colorPlain},touch:{paddingVertical:t._.md}}}))},"./src/screens/rakuen/search/component/list/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"List")},"./src/screens/rakuen/search/component/list/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.string.search.js"),r("./node_modules/core-js/modules/es.regexp.exec.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=t(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),o=t(r("./node_modules/@babel/runtime/helpers/createClass.js")),a=t(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=t(r("./node_modules/@babel/runtime/helpers/inherits.js")),d=t(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=t(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=t(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),u=t(r("react")),m=r("./src/components/index.ts"),p=r("./src/stores/index.ts"),h=r("./src/utils/index.ts"),f=r("./src/utils/decorators/index.ts"),j=r("./src/utils/dev/index.ts"),_=t(r("./src/screens/rakuen/search/component/item/index.tsx")),y=r("./src/screens/rakuen/search/component/list/ds.ts"),b=r("./node_modules/react/jsx-runtime.js");function x(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=(0,l.default)(e);if(s){var n=(0,l.default)(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return(0,d.default)(this,r)}}var v=function(e){(0,c.default)(r,e);var s=x(r);function r(){var e;(0,n.default)(this,r);for(var t=arguments.length,o=new Array(t),c=0;c<t;c++)o[c]=arguments[c];return e=s.call.apply(s,[this].concat(o)),(0,i.default)((0,a.default)(e),"renderItem",(function(e){var s=e.item,r=e.index;return(0,b.jsx)(_.default,Object.assign({index:r},s))})),e}return(0,o.default)(r,[{key:"render",value:function(){(0,j.r)(y.COMPONENT);var e=this.context.$;if(e.state.searching)return(0,b.jsx)(m.Loading,{style:p._.container.flex});if(!e.search._loaded)return null;var s=e.search._filter,r=(void 0===s?0:s)>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.Text,{style:p._.mt.lg,type:"sub",align:"center",size:13,bold:!0,children:"非会员只显示 8 条结果"}),(0,b.jsx)(m.Text,{style:p._.mt.xs,type:"sub",align:"center",size:13,bold:!0,children:"高级会员显示 20 条结果"})]}):void 0;return(0,b.jsx)(m.ListView,{contentContainerStyle:p._.container.bottom,keyExtractor:h.keyExtractor,data:e.search,renderItem:this.renderItem,ListFooterComponent:r})}}]),r}(u.default.Component);s.default=(0,f.obc)(v);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/search/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/rakuen/search/component/list/index.tsx#list"})}catch(e){}},"./src/screens/rakuen/search/component/search-bar/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),n=r("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,t.rc)(n.COMPONENT,"SearchBar")},"./src/screens/rakuen/search/component/search-bar/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=r("./src/components/index.ts"),o=r("./src/utils/decorators/index.ts"),a=r("./src/screens/rakuen/search/component/search-bar/ds.ts"),c=r("./src/screens/rakuen/search/component/search-bar/styles.ts"),d=r("./node_modules/react/jsx-runtime.js");s.default=(0,o.obc)((function(e,s){var r=s.$,t=(0,c.memoStyles)();return(0,d.jsx)(n.Input,{style:t.searchIpt,value:r.state.value,returnKeyType:"search",returnKeyLabel:"搜索",placeholder:"输入关键字，多关键字空格隔开",autoFocus:!0,onChange:r.onChange,onSubmitEditing:r.doSearch})}),a.COMPONENT);try{searchbar.displayName="searchbar",searchbar.__docgenInfo={description:"",displayName:"searchbar",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/search/component/search-bar/index.tsx#searchbar"]={docgenInfo:searchbar.__docgenInfo,name:"searchbar",path:"src/screens/rakuen/search/component/search-bar/index.tsx#searchbar"})}catch(e){}},"./src/screens/rakuen/search/component/search-bar/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{searchIpt:Object.assign({height:40,paddingRight:20,paddingLeft:20},t._.fontSize12,{backgroundColor:t._.select(t._.colorBg,t._._colorDarkModeLevel1),borderRadius:34})}}))},"./src/screens/rakuen/search/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var t=s.COMPONENT="RakuenSearch",n=(s.NAMESPACE="Screen"+t,s.EXCLUDE_STATE={value:"",searching:!1,cache:{}});s.STATE=Object.assign({history:[]},n,{_loaded:!1})},"./src/screens/rakuen/search/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var n=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),a=r("./src/stores/index.ts"),c=r("./src/utils/decorators/index.ts"),d=r("./src/utils/hooks/index.ts"),l=t(r("./src/screens/rakuen/search/component/history/index.tsx")),i=t(r("./src/screens/rakuen/search/component/list/index.tsx")),u=t(r("./src/screens/rakuen/search/component/search-bar/index.tsx")),m=t(r("./src/screens/rakuen/search/store.ts")),p=r("./src/screens/rakuen/search/styles.ts"),h=r("./node_modules/react/jsx-runtime.js");s.default=(0,c.ic)(m.default,(function(e,s){var r=s.$;return(0,d.useRunAfter)((function(){r.init()})),(0,d.useObserver)((function(){var e=(0,p.memoStyles)();return(0,h.jsxs)(o.Component,{id:"screen-rakuen-search",children:[(0,h.jsx)(o.Header,{title:"小组搜索",hm:["rakuenSearch","RakuenSearch"]}),(0,h.jsxs)(o.Page,{children:[(0,h.jsxs)(o.Flex,{style:e.searchBar,children:[(0,h.jsx)(o.Flex.Item,{children:(0,h.jsx)(u.default,{})}),(0,h.jsxs)(n.default,{style:a._.ml.sm,children:[(0,h.jsx)(o.Button,{style:e.btn,type:"ghostPlain",size:"sm",onPress:r.doSearch,children:"查询"}),(0,h.jsx)(o.Heatmap,{id:"帖子搜索.搜索"})]})]}),(0,h.jsx)(l.default,{style:a._.mt.sm}),(0,h.jsx)(i.default,{})]})]})}))}));try{search.displayName="search",search.__docgenInfo={description:"",displayName:"search",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/rakuen/search/index.tsx#search"]={docgenInfo:search.__docgenInfo,name:"search",path:"src/screens/rakuen/search/index.tsx#search"})}catch(e){}},"./src/screens/rakuen/search/store.ts":(e,s,r)=>{var t=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,a=n(r("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),c=n(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=n(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=n(r("./node_modules/@babel/runtime/helpers/createClass.js")),i=n(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(r("./node_modules/@babel/runtime/helpers/inherits.js")),m=n(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=n(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),h=n(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=n(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=r("./node_modules/mobx/dist/mobx.esm.js"),_=r("./src/stores/index.ts"),y=r("./src/utils/index.ts"),b=r("./src/utils/fetch/index.ts"),x=n(r("./src/utils/store/index.ts")),v=r("./src/screens/rakuen/search/ds.ts");function g(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=(0,p.default)(e);if(s){var n=(0,p.default)(this).constructor;r=Reflect.construct(t,arguments,n)}else r=t.apply(this,arguments);return(0,m.default)(this,r)}}s.default=(o=function(e){(0,u.default)(r,e);var s=g(r);function r(){var e;(0,d.default)(this,r);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e=s.call.apply(s,[this].concat(o)),(0,h.default)((0,i.default)(e),"state",(0,j.observable)(v.STATE)),(0,h.default)((0,i.default)(e),"init",(0,c.default)(t.mark((function s(){var r;return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.getStorage(v.NAMESPACE);case 2:return r=s.sent,e.setState(Object.assign({},r,v.EXCLUDE_STATE,{_loaded:!0})),s.abrupt("return",r);case 5:case"end":return s.stop()}}),s)})))),(0,h.default)((0,i.default)(e),"onChange",(function(s){var r=s.nativeEvent.text;e.setState({value:r})})),(0,h.default)((0,i.default)(e),"selectHistory",(function(s){(0,b.t)("帖子搜索.选择历史",{value:s}),e.setState({value:s}),e.doSearch()})),(0,h.default)((0,i.default)(e),"deleteHistory",(function(s){(0,b.t)("帖子搜索.删除历史",{value:s});var r=e.state.history;e.setState({history:r.filter((function(e){return e!==s}))}),e.setStorage(void 0,void 0,v.NAMESPACE)})),(0,h.default)((0,i.default)(e),"doSearch",(0,c.default)(t.mark((function s(){var r,n,o,c;return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(r=e.state,n=r.history,""!==(o=r.value)){s.next=4;break}return(0,y.info)("请输入内容"),s.abrupt("return");case 4:return(0,b.t)("帖子搜索.搜索",{value:o}),c=(0,a.default)(n),n.includes(o)||c.unshift(o),c.length>10&&c.pop(),e.setState({history:c,searching:!0}),e.setStorage(v.NAMESPACE),s.prev=10,s.next=13,_.searchStore.fetchRakuenSearch(o,!0);case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(10),(0,y.info)("请稍候再查询");case 18:e.setState({searching:!1});case 19:case"end":return s.stop()}}),s,null,[[10,15]])})))),e}return(0,l.default)(r,[{key:"search",get:function(){var e=_.systemStore.advance,s=this.state.value,r=_.searchStore.rakuenSearch(s,!0);if(e)return r;var t=r.list.filter((function(e,s){return s<=8}));return Object.assign({},r,{list:t,pagination:{page:1,pageTotal:1},_pageTotal:r.pagination.pageTotal,_filter:r.list.length-8})}}]),r}(x.default),(0,f.default)(o.prototype,"search",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"search"),o.prototype),o)},"./src/screens/rakuen/search/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{searchBar:{paddingVertical:t._.md,paddingHorizontal:t._.wind},btn:{width:68,height:40,borderRadius:40}}}))}}]);