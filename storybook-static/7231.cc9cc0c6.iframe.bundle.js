(self.webpackChunkweb=self.webpackChunkweb||[]).push([[7231],{"./src/screens/tinygrail/relation/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.weak-map.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.function.name.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=o(r("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(r("./node_modules/@babel/runtime/helpers/inherits.js")),a=o(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=o(r("./node_modules/react/index.js")),d=r("./src/components/index.ts"),c=r("./src/stores/index.ts"),f=r("./src/utils/decorators/index.ts"),m=o(r("./src/screens/tinygrail/_/icon-go/index.tsx")),p=o(r("./src/screens/tinygrail/_/tool-bar/index.tsx")),j=o(r("./src/screens/tinygrail/relation/list/index.tsx")),y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=b(t);if(r&&r.has(e))return r.get(e);var o={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var l=s?Object.getOwnPropertyDescriptor(e,n):null;l&&(l.get||l.set)?Object.defineProperty(o,n,l):o[n]=e[n]}return o.default=e,r&&r.set(e,o),o}(r("./src/screens/tinygrail/relation/store.ts")),_=r("./node_modules/react/jsx-runtime.js");function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(b=function(e){return e?r:t})(e)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=(0,i.default)(e);if(t){var s=(0,i.default)(this).constructor;r=Reflect.construct(o,arguments,s)}else r=o.apply(this,arguments);return(0,a.default)(this,r)}}var h=function(e){(0,l.default)(r,e);var t=g(r);function r(){return(0,s.default)(this,r),t.apply(this,arguments)}return(0,n.default)(r,[{key:"componentDidMount",value:function(){this.context.$.init()}},{key:"renderContentHeaderComponent",value:function(){var e=this.context.$,t=e.state,r=t.level,o=t.sort,s=t.direction;return(0,_.jsx)(p.default,{style:c._.mt._sm,data:y.SORT_DS,level:r,sort:o,direction:s,onLevelSelect:e.onLevelSelect,onSortPress:e.onSortPress})}},{key:"render",value:function(){var e,t=this.context.$;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(d.Header,{title:(null==(e=t.params)?void 0:e.name)||"关联角色",alias:"关联角色",hm:["tinygrail/relation","TinygrailRelation"],statusBarEvents:!1,statusBarEventsType:"Tinygrail",headerRight:function(){return(0,_.jsx)(m.default,{$:t})}}),(0,_.jsxs)(d.Page,{style:c._.container.tinygrail,children:[this.renderContentHeaderComponent(),(0,_.jsx)(j.default,{})]})]})}}]),r}(u.default.Component);t.default=(0,f.inject)(y.default)((0,f.obc)(h));try{relation.displayName="relation",relation.__docgenInfo={description:"",displayName:"relation",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/tinygrail/relation/index.tsx#relation"]={docgenInfo:relation.__docgenInfo,name:"relation",path:"src/screens/tinygrail/relation/index.tsx#relation"})}catch(e){}},"./src/screens/tinygrail/relation/list/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.object.assign.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(r("./node_modules/react/index.js"));var s=r("./src/components/index.ts"),n=r("./src/stores/index.ts"),l=r("./src/utils/index.ts"),a=r("./src/utils/decorators/index.ts"),i=o(r("./src/screens/tinygrail/_/item/index.tsx")),u=r("./src/screens/tinygrail/_/utils.ts"),d=r("./node_modules/react/jsx-runtime.js"),c={id:"关联角色.跳转"};t.default=(0,a.obc)((function(e,t){var r=t.$;if(!r.list._loaded)return(0,d.jsx)(s.Loading,{style:n._.container.flex,color:n._.colorTinygrailText});var o=r.state,a=o.level,i=o.sort,c=o.direction,m=r.list;return a&&(m=Object.assign({},m,{list:(0,u.levelList)(a,m.list)})),i&&(m=Object.assign({},m,{list:(0,u.sortList)(i,c,m.list)})),(0,d.jsx)(s.ListView,{style:n._.container.flex,contentContainerStyle:n._.container.bottom,keyExtractor:l.keyExtractor,refreshControlProps:{color:n._.colorTinygrailText},footerTextType:"tinygrailText",data:m,windowSize:6,initialNumToRender:24,maxToRenderPerBatch:24,updateCellsBatchingPeriod:24,lazy:24,scrollToTop:!0,renderItem:f})}));function f(e){var t=e.item,r=e.index;return(0,d.jsx)(i.default,Object.assign({index:r,event:c},t))}try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/tinygrail/relation/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/tinygrail/relation/list/index.tsx#list"})}catch(e){}},"./src/screens/tinygrail/relation/store.ts":(e,t,r)=>{var o=r("./node_modules/@babel/runtime/regenerator/index.js");function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,s=function(){};return{s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw l}}}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.array.from.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.symbol.js"),r("./node_modules/core-js/modules/es.symbol.description.js"),r("./node_modules/core-js/modules/es.symbol.iterator.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.array.is-array.js");var l=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SORT_DS=void 0;var a,i=l(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=l(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=l(r("./node_modules/@babel/runtime/helpers/createClass.js")),c=l(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),f=l(r("./node_modules/@babel/runtime/helpers/inherits.js")),m=l(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=l(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),j=l(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),y=l(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),_=r("./node_modules/mobx/dist/mobx.esm.js"),b=r("./src/stores/index.ts"),g=r("./src/utils/index.ts"),h=l(r("./src/utils/store/index.ts")),v=r("./src/utils/fetch/index.ts"),x=r("./src/constants/index.ts"),S=r("./src/screens/tinygrail/_/utils.ts");function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=(0,p.default)(e);if(t){var s=(0,p.default)(this).constructor;r=Reflect.construct(o,arguments,s)}else r=o.apply(this,arguments);return(0,m.default)(this,r)}}t.SORT_DS=[S.SORT_SC,S.SORT_HYD,S.SORT_GX,S.SORT_SDGX,S.SORT_DQJ,S.SORT_DQZD,S.SORT_DJ,S.SORT_XFJL,S.SORT_GXB,S.SORT_SDGXB];var T="ScreenTinygrailRelation";t.default=(a=function(e){(0,f.default)(r,e);var t=O(r);function r(){var e;(0,u.default)(this,r);for(var n=arguments.length,l=new Array(n),a=0;a<n;a++)l[a]=arguments[a];return e=t.call.apply(t,[this].concat(l)),(0,j.default)((0,c.default)(e),"params",void 0),(0,j.default)((0,c.default)(e),"state",(0,_.observable)({level:"",sort:"",direction:"",go:"买入",_loaded:!1})),(0,j.default)((0,c.default)(e),"init",(0,i.default)(o.mark((function t(){var r,n,l,a,i;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(T);case 2:r=t.sent,e.setState(Object.assign({},r,{_loaded:!1})),n=e.params.ids,l=s(n),t.prev=6,l.s();case 8:if((a=l.n()).done){t.next=14;break}return i=a.value,t.next=12,b.tinygrailStore.fetchCharacters([i]);case 12:t.next=8;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(6),l.e(t.t0);case 19:return t.prev=19,l.f(),t.finish(19);case 22:return e.setState({_loaded:(0,g.getTimestamp)()}),t.abrupt("return",!0);case 24:case"end":return t.stop()}}),t,null,[[6,16,19,22]])})))),(0,j.default)((0,c.default)(e),"onSelectGo",(function(t){(0,v.t)("关联角色.设置前往",{title:t}),e.setState({go:t}),e.setStorage(T)})),(0,j.default)((0,c.default)(e),"onLevelSelect",(function(t){e.setState({level:t}),e.setStorage(T)})),(0,j.default)((0,c.default)(e),"onSortPress",(function(t){var r=e.state,o=r.sort,s=r.direction;if(t===o){var n=t,l="down";"down"===s?l="up":"up"===s&&(n="",l=""),(0,v.t)("关联角色.排序",{sort:n,direction:l}),e.setState({sort:n,direction:l})}else(0,v.t)("关联角色.排序",{sort:t,direction:"down"}),e.setState({sort:t,direction:"down"});e.setStorage(T)})),e}return(0,d.default)(r,[{key:"list",get:function(){if(!this.state._loaded)return x.LIST_EMPTY;var e=this.params.ids;return(0,S.relation)({list:e.map((function(e){return b.tinygrailStore.characters(e)})),pagination:{page:1,pageTotal:1},_loaded:(0,g.getTimestamp)()})}}]),r}(h.default),(0,y.default)(a.prototype,"list",[_.computed],Object.getOwnPropertyDescriptor(a.prototype,"list"),a.prototype),a)}}]);