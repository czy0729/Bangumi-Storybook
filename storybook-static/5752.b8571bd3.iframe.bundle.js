(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5752],{"./src/screens/home/typerank/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/typerank/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Component")},"./src/screens/home/typerank/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/typerank/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Item"),t.EVENT={id:"分类排行.跳转"}},"./src/screens/home/typerank/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("./node_modules/react/index.js"));var n=s("./src/screens/_/index.ts"),o=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/typerank/component/item/ds.ts"),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s=e.subjectId,r=e.index,o=t.$,c=t.navigation;return(0,a.jsx)(n.ItemSubject,{navigation:c,event:d.EVENT,index:r,subjectId:s,type:o.type,subject:o.subject(s),oss:o.subjectOSS(s),active:o.subjectId==s})}))},"./src/screens/home/typerank/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.SORT=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/typerank/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"List"),t.SORT=[{key:"top",title:"最受好评",desc:"分数超过 8分, 看过人数超过 10000 的作品"},{key:"pop",title:"近年流行",desc:"近年来的流行作品，收藏数的排名在前 20%"},{key:"tv",title:"TV",desc:"通常的 tv 动画"},{key:"old_tv",title:"老 TV",desc:"06 年及以前的老动画"},{key:"movie",title:"剧场版",desc:"动画电影 / 剧场版"},{key:"old_movie",title:"老剧场版",desc:"06 年及以前动画电影 / 剧场版"},{key:"nsfw",title:"NSFW",desc:"绝大多数是里番"}]},"./src/screens/home/typerank/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("./node_modules/react/index.js"));var n=s("./src/components/index.ts"),o=s("./src/screens/_/index.ts"),d=s("./src/stores/index.ts"),a=s("./src/utils/decorators/index.ts"),c=s("./src/screens/home/typerank/component/list/utils.tsx"),i=s("./src/screens/home/typerank/component/list/ds.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var s=t.$;return s.ids.length?s.state.searching?(0,u.jsx)(n.Loading,{style:d._.container.flex}):(0,u.jsx)(o.PaginationList2,{keyExtractor:c.keyExtractor,contentContainerStyle:d._.container.bottom,data:s.ids,limit:12,renderItem:c.renderItem,onScroll:s.onScroll,onPage:s.fetchSubjectsFromOSS}):(0,u.jsx)(n.Empty,{text:"此标签没有足够的列表数据"})}),i.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/typerank/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/home/typerank/component/list/index.tsx#list"})}catch(e){}},"./src/screens/home/typerank/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.keyExtractor=d,t.renderItem=a;r(s("./node_modules/react/index.js"));var n=r(s("./src/screens/home/typerank/component/item/index.tsx")),o=s("./node_modules/react/jsx-runtime.js");function d(e){return String(e)}function a(e){var t=e.item,s=e.index;return(0,o.jsx)(n.default,{subjectId:t,index:s})}try{d.displayName="keyExtractor",d.__docgenInfo={description:"",displayName:"keyExtractor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/typerank/component/list/utils.tsx#keyExtractor"]={docgenInfo:d.__docgenInfo,name:"keyExtractor",path:"src/screens/home/typerank/component/list/utils.tsx#keyExtractor"})}catch(e){}try{a.displayName="renderItem",a.__docgenInfo={description:"",displayName:"renderItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/typerank/component/list/utils.tsx#renderItem"]={docgenInfo:a.__docgenInfo,name:"renderItem",path:"src/screens/home/typerank/component/list/utils.tsx#renderItem"})}catch(e){}},"./src/screens/home/typerank/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=t.COMPONENT=void 0;var r=s("./src/stores/index.ts"),n=t.COMPONENT="Typerank",o=(t.NAMESPACE="Screen"+n,t.EXCLUDE_STATE={visibleBottom:r._.window.height,searching:!1});t.STATE=Object.assign({},o,{subjects:{},_loaded:!1})},"./src/screens/home/typerank/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/typerank/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Header")},"./src/screens/home/typerank/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("./node_modules/react/index.js"));var n=s("./src/components/index.ts"),o=s("./src/utils/decorators/index.ts"),d=s("./src/constants/index.ts"),a=s("./src/screens/home/typerank/header/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s=t.$;return(0,c.jsx)(n.Header,{title:"分类排行 · "+d.MODEL_SUBJECT_TYPE.getTitle(s.type)+" · "+s.tag+" ("+s.ids.length+")",hm:["typerank","Typerank"],headerTitleAlign:"left"})}),a.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/typerank/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/home/typerank/header/index.tsx#header"})}catch(e){}},"./src/screens/home/typerank/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("./node_modules/react/index.js"));var n=s("./src/components/index.ts"),o=s("./src/utils/decorators/index.ts"),d=s("./src/utils/hooks/index.ts"),a=r(s("./src/screens/home/typerank/component/list/index.tsx")),c=r(s("./src/screens/home/typerank/header/index.tsx")),i=r(s("./src/screens/home/typerank/store.ts")),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.ic)(i.default,(function(e,t){var s=t.$;return(0,d.useRunAfter)((function(){s.init()})),(0,d.useObserver)((function(){return(0,u.jsxs)(n.Component,{id:"screen-typerank",children:[(0,u.jsx)(c.default,{}),(0,u.jsx)(n.Page,{children:s.state._loaded&&(0,u.jsx)(a.default,{})})]})}))}));try{typerank.displayName="typerank",typerank.__docgenInfo={description:"",displayName:"typerank",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/typerank/index.tsx#typerank"]={docgenInfo:typerank.__docgenInfo,name:"typerank",path:"src/screens/home/typerank/index.tsx#typerank"})}catch(e){}},"./src/screens/home/typerank/store.ts":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.object.entries.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.is-array.js"),s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.function.bind.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,d=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),a=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),u=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),p=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),y=n(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=s("./node_modules/mobx/dist/mobx.esm.js"),_=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),h=s("./src/utils/kv/index.ts"),x=n(s("./src/utils/store/index.ts")),v=s("./src/screens/home/typerank/utils.ts"),O=s("./src/screens/home/typerank/ds.ts");function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;s=Reflect.construct(r,arguments,n)}else s=r.apply(this,arguments);return(0,p.default)(this,s)}}t.default=(o=function(e){(0,l.default)(s,e);var t=k(s);function s(){var e,n;(0,c.default)(this,s);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=t.call.apply(t,[this].concat(i)),(0,f.default)((0,u.default)(e),"params",void 0),(0,f.default)((0,u.default)(e),"state",(0,j.observable)(O.STATE)),(0,f.default)((0,u.default)(e),"init",(0,a.default)(r.mark((function t(){var s;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(O.NAMESPACE);case 2:s=t.sent,e.setState(Object.assign({},s,O.EXCLUDE_STATE,{_loaded:!0}));case 4:case"end":return t.stop()}}),t)})))),(0,f.default)((0,u.default)(e),"fetchSubjects",(0,a.default)(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})))),(0,f.default)((0,u.default)(e),"fetchSubjectsFromOSS",(n=(0,a.default)(r.mark((function t(s){var n,o,a,c,i;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.length){t.next=2;break}return t.abrupt("return",!0);case 2:if(n=e.state.subjects,o=(0,b.getTimestamp)(),a=[],s.forEach((function(t){if(!e.subject(t).id){var s=(n[t]||{})._loaded;if(!s||o-Number(s)>=86400){var r=e.subjectOSS(t)._loaded;(!r||o-Number(r)>=86400)&&a.push("subject_"+t)}}})),a.length){t.next=8;break}return t.abrupt("return",!0);case 8:return t.prev=8,console.info("fetchSubjectsFromOSS",a),c=["name","name_cn","image","rank","rating","totalEps","info","staff","tags"],t.next=13,(0,h.gets)(a,c);case 13:i=t.sent,Object.entries(i).forEach((function(e){var t=(0,d.default)(e,2),s=t[0],r=t[1];try{var n;if(i[s]=(0,b.pick)(r,c),i[s].info&&(i[s].date=(null==(n=i[s].info.match(/<li><span>(发售日|放送开始|上映年度|上映时间): <\/span>(.+?)<\/li>/))?void 0:n[2])||""),delete i[s].info,!i[s].date&&Array.isArray(i[s].tags)){var o=i[s].tags.find((function(e){return/^\d+年\d+月$/.test(e.name)}));o&&(i[s].date=o.name),o=i[s].tags.find((function(e){return/^\d{4}$/.test(e.name)})),o&&(i[s].date=o.name)}if(delete i[s].tags,Array.isArray(i[s].staff)){var a,u,l=i[s].staff.find((function(e){return"原作"===e.desc}));i[s].origin=(null==l?void 0:l.name)||(null==l?void 0:l.nameJP)||"";var p,m,f=i[s].staff.find((function(e){return"导演"===e.desc}));i[s].director=(null==(a=f)?void 0:a.name)||(null==(u=f)?void 0:u.nameJP)||"",i[s].director||(f=i[s].staff.find((function(e){return"作者"===e.desc||"开发"===e.desc||"音乐"===e.desc})),i[s].director=(null==(p=f)?void 0:p.name)||(null==(m=f)?void 0:m.nameJP)||"")}delete i[s].staff,i[s]._loaded=(0,b.getTimestamp)()}catch(e){}})),e.setState({subjects:i}),e.setStorage(O.NAMESPACE),t.next=21;break;case 19:t.prev=19,t.t0=t.catch(8);case 21:_.collectionStore.fetchCollectionStatusQueue(s);case 22:case"end":return t.stop()}}),t,null,[[8,19]])}))),function(e){return n.apply(this,arguments)})),(0,f.default)((0,u.default)(e),"onScroll",b.updateVisibleBottom.bind((0,u.default)(e))),e}return(0,i.default)(s,[{key:"tag",get:function(){return this.params.tag||""}},{key:"type",get:function(){return this.params.type||"anime"}},{key:"subjectId",get:function(){return this.params.subjectId||0}},{key:"ids",get:function(){return(0,v.getIds)(this.type,this.tag)}},{key:"subject",value:function(e){return(0,j.computed)((function(){return _.subjectStore.subjectV2(e)})).get()}},{key:"subjectOSS",value:function(e){var t=this;return(0,j.computed)((function(){return t.state.subjects["subject_"+e]||{}})).get()}}]),s}(x.default),(0,y.default)(o.prototype,"tag",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"tag"),o.prototype),(0,y.default)(o.prototype,"type",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"type"),o.prototype),(0,y.default)(o.prototype,"subjectId",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"subjectId"),o.prototype),(0,y.default)(o.prototype,"ids",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"ids"),o.prototype),o)},"./src/screens/home/typerank/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getIds=function(e,t){var s,r;if(!e||!t)return[];"anime"===e?r=n.default:"book"===e?r=o.default:"game"===e?r=d.default:"music"===e?r=a.default:"real"===e&&(r=c.default);return(null==(s=r)?void 0:s[t])||[]};var n=r(s("./src/assets/json/typerank/anime-ids.json")),o=r(s("./src/assets/json/typerank/book-ids.json")),d=r(s("./src/assets/json/typerank/game-ids.json")),a=r(s("./src/assets/json/typerank/music-ids.json")),c=r(s("./src/assets/json/typerank/real-ids.json"))}}]);