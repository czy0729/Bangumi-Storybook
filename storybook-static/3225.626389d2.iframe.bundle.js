(self.webpackChunkweb=self.webpackChunkweb||[]).push([[3225],{"./src/screens/discovery/word-cloud/component/bg/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Bg")},"./src/screens/discovery/word-cloud/component/bg/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),c=s("./src/screens/discovery/word-cloud/component/bg/ds.ts"),i=s("./src/screens/discovery/word-cloud/component/bg/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s,o,d=t.$,c="";if(d.subjectId)c=null==(s=d.subject)||null==(o=s.images)?void 0:o.medium;else if(d.topicId){var l,a;c=(null==(l=d.topic)?void 0:l.avatar)||(null==(a=d.topic)?void 0:a.groupThumb)}else if(d.monoId){var p;(c=null==(p=d.mono)?void 0:p.cover)&&(c=(0,n.getMonoCoverSmall)(c))}return c?(0,u.jsx)(r.BlurView,{style:i.styles.bg,tint:r.BLURVIEW_TINT_DARK,src:c,intensity:80,blurRadius:32}):null}),c.COMPONENT)},"./src/screens/discovery/word-cloud/component/bg/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({bg:{position:"absolute",top:0,right:0,bottom:0,left:0}})},"./src/screens/discovery/word-cloud/component/cavans/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Cavans")},"./src/screens/discovery/word-cloud/component/cavans/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),i=s("./src/screens/discovery/word-cloud/ds.ts"),u=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/index.tsx")),l=s("./src/screens/discovery/word-cloud/component/cavans/utils.ts"),a=s("./src/screens/discovery/word-cloud/component/cavans/ds.ts"),p=s("./src/screens/discovery/word-cloud/component/cavans/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$;if(!s.state._loaded)return null;var o=(0,p.memoStyles)(),c=s.state.data,a=c.list,f=c._loaded;if(f&&!a.length)return(0,m.jsx)(n.Text,{style:o.empty,type:"__plain__",bold:!0,align:"center",children:"没有足够的吐槽"});var h=s.state.fetching;return(0,m.jsxs)(r.default,{style:o.container,children:[!!h&&(0,m.jsxs)(n.Text,{style:o.fetching,type:"__plain__",align:"center",bold:!0,children:["获取数据中 ",h," / ",i.MAX_PAGE,"..."]}),!!a.length&&(0,m.jsx)(u.default,{style:d._.mt.md,options:Object.assign({words:(0,l.getWords)(a),verticalEnabled:!1,minFont:14,maxFont:68,fontOffset:4},o.container),onPress:s.onWordPress},String(f))]})}),a.COMPONENT)},"./src/screens/discovery/word-cloud/component/cavans/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{width:o._.window.width-2*o._._wind,height:o._.window.height-o._.web(200,280),paddingLeft:o._._wind},empty:{marginTop:o._.lg,opacity:.8},fetching:{position:"absolute",zIndex:1,top:o._.md,right:0,left:0,opacity:.64}}}))},"./src/screens/discovery/word-cloud/component/cavans/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.getWords=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60;return e.map((function(e,t){return{text:e[0],value:Number(e[1]),color:o[t%o.length]}})).filter((function(e,s){return s<=t}))};var o=["rgba(255, 255, 255, 0.9)","rgba(255, 255, 255, 0.75)","rgba(255, 255, 255, 0.6)","rgba(255, 255, 255, 0.45)","rgba(255, 255, 255, 0.3)"]},"./src/screens/discovery/word-cloud/component/comment/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Comment")},"./src/screens/discovery/word-cloud/component/comment/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),i=s("./src/utils/index.ts"),u=s("./src/utils/decorators/index.ts"),l=s("./src/screens/discovery/word-cloud/component/comment/ds.ts"),a=s("./src/screens/discovery/word-cloud/component/comment/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.obc)((function(e,t){var s=t.$,o=t.navigation,u=(0,a.memoStyles)(),l=s.state.title,m=s.selectedComment.length;return(0,p.jsx)(n.ActionSheet,{show:s.state.show,title:l+" ("+m+")",height:m<=2?480:m<=4?640:800,onClose:s.onClose,children:(0,p.jsx)(r.default,{style:u.container,children:s.selectedComment.map((function(e){var t=e.userId,s=e.userName,r=e.time,u=e.action;return(0,p.jsxs)(n.Flex,{style:c._.mb.md,align:"start",children:[(0,p.jsx)(n.UserStatus,{userId:t,children:(0,p.jsx)(n.Avatar,{navigation:o,userId:t,name:s,src:e.avatar,size:32})}),(0,p.jsxs)(n.Flex.Item,{style:c._.ml.sm,children:[(0,p.jsx)(d.Name,{size:14,bold:!0,userId:t,showFriend:!0,right:(0,p.jsxs)(n.Text,{type:"sub",size:11,lineHeight:14,children:["  ",u?u+" · ":"",String(r).includes("ago")?(0,i.correctAgo)(r):r]}),children:s}),(0,p.jsx)(n.Highlight,{style:c._.mt.xs,size:13,lineHeight:16,value:l,selectable:!0,children:e.comment})]})]},e.id)}))})})}),l.COMPONENT)},"./src/screens/discovery/word-cloud/component/comment/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{padding:o._.wind}}}))},"./src/screens/discovery/word-cloud/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Component")},"./src/screens/discovery/word-cloud/component/media/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Media")},"./src/screens/discovery/word-cloud/component/media/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),i=s("./src/constants/index.ts"),u=o(s("./src/screens/discovery/word-cloud/component/media/mono/index.tsx")),l=o(s("./src/screens/discovery/word-cloud/component/media/subject/index.tsx")),a=o(s("./src/screens/discovery/word-cloud/component/media/topic/index.tsx")),p=s("./src/screens/discovery/word-cloud/component/media/ds.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s,o=t.$,c=t.navigation;return o.subjectId?s=(0,m.jsx)(l.default,{}):o.topicId?s=(0,m.jsx)(a.default,{}):o.monoId&&(s=(0,m.jsx)(u.default,{})),s?(i.WEB&&(s=(0,m.jsx)(n.Touchable,{onPress:function(){o.subjectId?c.push("Subject",{subjectId:o.subjectId}):o.topicId?c.push("Topic",{topicId:o.topicId}):o.monoId&&c.push("Mono",{monoId:o.monoId})},children:s})),(0,m.jsx)(r.default,{style:d._.container.wind,children:s})):null}),p.COMPONENT)},"./src/screens/discovery/word-cloud/component/media/mono/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/media/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Mono")},"./src/screens/discovery/word-cloud/component/media/mono/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),i=s("./src/utils/index.ts"),u=s("./src/utils/decorators/index.ts"),l=s("./src/constants/index.ts"),a=s("./src/screens/discovery/word-cloud/component/media/mono/ds.ts"),p=s("./src/screens/discovery/word-cloud/component/media/mono/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.obc)((function(e,t){var s,o,u,a=t.$;if(null==(s=a.mono)||!s.name)return null;var f=(0,p.memoStyles)(),h=a.mono.nameCn||a.mono.name,j=[];if(null!=(o=a.mono)&&null!=(u=o.jobs)&&u.length){var y,b=(null==(y=a.mono.jobs)?void 0:y[0])||{};j.push(b.nameCn||b.name,b.staff)}else if(a.mono.detail){var _;j.push(null==(_=a.mono.detail.split("\n"))?void 0:_[0])}j=j.filter((function(e){return!!e})).join(" · ");var v=l.IOS?d.BlurView:r.default,x={style:f.container};return l.IOS&&(x.tint=n.BLURVIEW_TINT_DARK,x.intensity=64),(0,m.jsx)(v,Object.assign({},x,{children:(0,m.jsxs)(n.Flex,{align:"start",children:[(0,m.jsx)(n.Cover,{src:(0,i.getMonoCoverSmall)(a.mono.cover),size:f.body.height,radius:c._.radiusMd-2}),(0,m.jsx)(n.Flex.Item,{children:(0,m.jsxs)(n.Flex,{style:f.body,direction:"column",justify:"between",align:"start",children:[(0,m.jsxs)(n.Text,{type:"__plain__",bold:!0,numberOfLines:2,children:[h,(0,m.jsxs)(n.Text,{style:f.opacity,type:"__plain__",size:12,lineHeight:14,bold:!0,children:[" ","+",a.monoComments.list.length]})]}),!!j&&j!==h&&(0,m.jsx)(n.Text,{style:[c._.mt.xs,f.opacity],type:"__plain__",size:12,bold:!0,numberOfLines:2,children:j})]})})]})}))}),a.COMPONENT)},"./src/screens/discovery/word-cloud/component/media/mono/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{padding:o._.sm,marginTop:o._.headerHeight,marginBottom:o._.sm,backgroundColor:o._.ios("transparent","rgba(0, 0, 0, 0.32)"),borderRadius:o._.radiusMd,overflow:"hidden"},body:{height:60,paddingTop:3,paddingBottom:2,marginLeft:12},rank:{backgroundColor:"rgba(255, 255, 255, 0.2)"},opacity:{opacity:.64}}}))},"./src/screens/discovery/word-cloud/component/media/subject/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/media/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Subject")},"./src/screens/discovery/word-cloud/component/media/subject/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.slice.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),u=s("./src/constants/index.ts"),l=s("./src/screens/discovery/word-cloud/component/media/subject/ds.ts"),a=s("./src/screens/discovery/word-cloud/component/media/subject/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s,o,i=t.$;if(null==(s=i.subject)||!s.id)return null;var l=(0,a.memoStyles)(),m=i.subject.name_cn||i.subject.name,f=i.subject.name,h=u.IOS?d.BlurView:r.default,j={style:l.container};return u.IOS&&(j.tint=n.BLURVIEW_TINT_DARK,j.intensity=64),(0,p.jsx)(h,Object.assign({},j,{children:(0,p.jsxs)(n.Flex,{align:"start",children:[(0,p.jsx)(n.Cover,{src:null==(o=i.subject.images)?void 0:o.medium,size:"音乐"===i.params._type?u.IMG_HEIGHT_SM:u.IMG_WIDTH_SM,height:u.IMG_HEIGHT_SM,radius:c._.radiusMd-2}),(0,p.jsx)(n.Flex.Item,{children:(0,p.jsxs)(n.Flex,{style:l.body,direction:"column",justify:"between",align:"start",children:[(0,p.jsxs)(r.default,{children:[(0,p.jsxs)(n.Text,{type:"__plain__",size:15,bold:!0,numberOfLines:2,children:[m,(0,p.jsxs)(n.Text,{style:l.opacity,type:"__plain__",size:13,lineHeight:15,bold:!0,children:[" ","(",i.subject.air_date.slice(0,7),")"]})]}),!!f&&f!==m&&(0,p.jsx)(n.Text,{style:[l.opacity,c._.mt.xs],type:"__plain__",size:13,bold:!0,numberOfLines:2,children:f})]}),(0,p.jsxs)(n.Flex,{style:c._.mt.sm,children:[(0,p.jsx)(d.Rank,{style:l.rank,value:i.subject.rank}),(0,p.jsx)(d.Stars,{textStyle:l.opacity,type:"__plain__",value:i.subject.rating.score}),(0,p.jsxs)(n.Text,{style:[l.opacity,c._.ml.xs],type:"__plain__",size:11,bold:!0,children:["(",i.subject.rating.total,"人评分)"]})]})]})})]})}))}),l.COMPONENT)},"./src/screens/discovery/word-cloud/component/media/subject/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts"),r=s("./src/constants/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{padding:o._.sm,marginTop:o._.headerHeight,marginBottom:o._.sm,backgroundColor:o._.ios("transparent","rgba(0, 0, 0, 0.32)"),borderRadius:o._.radiusMd,overflow:"hidden"},body:{height:r.IMG_HEIGHT_SM,paddingTop:3,paddingBottom:4,marginLeft:12},rank:{backgroundColor:"rgba(255, 255, 255, 0.2)"},opacity:{opacity:.64}}}))},"./src/screens/discovery/word-cloud/component/media/topic/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/component/media/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Topic")},"./src/screens/discovery/word-cloud/component/media/topic/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.join.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.assign.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),n=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),u=s("./src/constants/index.ts"),l=s("./src/screens/discovery/word-cloud/component/media/topic/ds.ts"),a=s("./src/screens/discovery/word-cloud/component/media/topic/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s,o=t.$;if(null==(s=o.topic)||!s.title)return null;var i=(0,a.memoStyles)(),l=o.topic.title,m=[o.topic.time||o.topic.group,o.total+" 回复"].filter((function(e){return!!e})).join(" · "),f=u.IOS?d.BlurView:r.default,h={style:i.container};return u.IOS&&(h.tint=n.BLURVIEW_TINT_DARK,h.intensity=64),(0,p.jsx)(f,Object.assign({},h,{children:(0,p.jsxs)(n.Flex,{align:"start",children:[(0,p.jsx)(n.Cover,{src:o.topic.avatar||o.topic.groupThumb,size:i.body.height,radius:c._.radiusMd-2}),(0,p.jsx)(n.Flex.Item,{children:(0,p.jsxs)(n.Flex,{style:i.body,direction:"column",justify:"between",align:"start",children:[(0,p.jsxs)(n.Text,{type:"__plain__",bold:!0,numberOfLines:2,children:[l,!!o.topic.time&&(0,p.jsxs)(n.Text,{style:i.opacity,type:"__plain__",size:12,lineHeight:14,bold:!0,numberOfLines:2,children:["  ",o.topic.group]})]}),(0,p.jsx)(n.Text,{style:[c._.mt.xs,i.opacity],type:"__plain__",size:12,bold:!0,numberOfLines:2,children:m})]})})]})}))}),l.COMPONENT)},"./src/screens/discovery/word-cloud/component/media/topic/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{container:{padding:o._.sm,marginTop:o._.headerHeight,marginBottom:o._.sm,backgroundColor:o._.ios("transparent","rgba(0, 0, 0, 0.32)"),borderRadius:o._.radiusMd,overflow:"hidden"},body:{height:60,paddingTop:3,paddingBottom:2,marginLeft:12},rank:{backgroundColor:"rgba(255, 255, 255, 0.2)"},opacity:{opacity:.64}}}))},"./src/screens/discovery/word-cloud/component/react-native-wordcloud/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.function.bind.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.parse-float.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.splice.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),d=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),l=o(s("react")),a=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),p=o(s("./node_modules/prop-types/index.js")),m=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/space.ts")),f=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/text.tsx")),h=s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/util.ts"),j=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/word.tsx")),y=s("./node_modules/react/jsx-runtime.js");function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,i.default)(this,s)}}var _=function(e){(0,c.default)(s,e);var t=b(s);function s(e){var o;return(0,r.default)(this,s),(o=t.call(this,e)).state={words:[]},o.spaceDataObject=null,o.spaceIdArray=null,o.distanceCounter=1,o.target={width:e.options.width,height:e.options.height,xOffset:e.options.width/2,yOffset:e.options.height/2},o._placeFirstWord=o._placeFirstWord.bind((0,d.default)(o)),o._placeOtherWord=o._placeOtherWord.bind((0,d.default)(o)),o}return(0,n.default)(s,[{key:"componentDidMount",value:function(){this._init(this.props.options)}},{key:"_init",value:function(e){var t=this;this.spaceDataObject={},this.spaceIdArray=[];var s=e.words,o=e.fontOffset,r=e.minFont,n=e.maxFont,d=e.fontFamily;s.sort((function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}));var c=s[0].value,i=s[s.length-1].value,u=(n-r)/(c-i),l=s.map((function(e,s){return new j.default(Object.assign({},e,{minValue:i,maxValue:c,fontFactor:u,fontOffset:o+r,fontFamily:d,index:s,_placeFirstWord:t._placeFirstWord,_placeOtherWord:t._placeOtherWord}))}));this.setState({words:l})}},{key:"_draw",value:function(){var e=this.state.words;return 0===e.length?null:e.map((function(e){return e.view}))}},{key:"_updateSpaceIdArray",value:function(e,t){if(0!==this.spaceIdArray.length){for(var s=0;s<this.spaceIdArray.length;s++)if(t<parseFloat(this.spaceIdArray[s].split("_")[0]))return void this.spaceIdArray.splice(s,0,e);this.spaceIdArray.push(e)}else this.spaceIdArray.push(e)}},{key:"_pushSpaceData",value:function(e,t,s,o,r){var n=Math.sqrt((this.target.xOffset-o)*(this.target.xOffset-o)+(this.target.yOffset-r)*(this.target.yOffset-r)),d=n+"_"+this.distanceCounter++;this._updateSpaceIdArray(d,n),this.spaceDataObject[d]=new m.default(e,t,s,o,r)}},{key:"_updateTextPosition",value:function(e,t,s){var o=this,r={position:"absolute",left:Math.ceil(s),top:Math.ceil(t),fontSize:e.font,lineHeight:Math.ceil(1.1*e.font),color:e.color};this.setState((function(t){return{words:t.words.map((function(t){return t!==e?t:Object.assign({},t,{view:t.view&&(0,y.jsx)(f.default,{style:r,onPress:function(){return o.props.onPress(e.text)},children:e.text},e.text)||null})}))}}))}},{key:"_placeFirstWord",value:function(e){var t=e.width,s=e.height,o=this.target.xOffset-t/2,r=this.target.yOffset-s/2,n=this.target.width,d=this.target.height;this._updateTextPosition(e,r,o),this._pushSpaceData(h.spaceTypes.LB,n-o-t,s,o+t,r+s/2),this._pushSpaceData(h.spaceTypes.LT,t,d-r-s,o+t/2,r+s),this._pushSpaceData(h.spaceTypes.RT,o,s,o,r+s/2),this._pushSpaceData(h.spaceTypes.RB,t,r,o+t/2,r),this._pushSpaceData(h.spaceTypes.LT,t/2,s/2,o+t,r+s/2),this._pushSpaceData(h.spaceTypes.RT,t/2,s/2,o+t/2,r+s),this._pushSpaceData(h.spaceTypes.RB,t/2,s/2,o,r+s/2),this._pushSpaceData(h.spaceTypes.LB,t/2,s/2,o+t/2,r),this._pushSpaceData(h.spaceTypes.LT,n-o-t-t/2,d-r-s/2,o+t+t/2,r+s/2),this._pushSpaceData(h.spaceTypes.RT,o+t/2,d-r-s-s/2,o+t/2,r+s+s/2),this._pushSpaceData(h.spaceTypes.RB,o-t/2,r+s/2,o-t/2,r+s/2),this._pushSpaceData(h.spaceTypes.LB,o+t/2,r-s/2,o+t/2,r-s/2)}},{key:"_placeOtherWord",value:function(e){for(var t=0;t<this.spaceIdArray.length;t++){var s=this.spaceIdArray[t],o=this.spaceDataObject[s],r=0,n=0;if(e.width<=o.width&&e.height<=o.height&&(r=h.spaceTypes.HR,n++),this.props.options.verticalEnabled&&e.height<=o.width&&e.width<=o.height&&(r=h.spaceTypes.VR,n++),n>0){this.spaceDataObject[s]=null,this.spaceIdArray.splice(t,1);var d=1,c=1,i=1,u=1;switch(o.spaceType){case h.spaceTypes.LB:d=0,c=-1,i=1,u=-1;break;case h.spaceTypes.LT:d=0,c=0,i=1,u=1;break;case h.spaceTypes.RT:d=-1,c=0,i=-1,u=1;break;case h.spaceTypes.RB:d=-1,c=-1,i=-1,u=-1}n>1&&(r=5*Math.random()>3?h.spaceTypes.VR:h.spaceTypes.HR);var l=e.width,a=e.height;switch(r){case h.spaceTypes.HR:this._updateTextPosition(e,o.y+c*a,o.x+d*l),2*Math.random()>1?(this._pushSpaceData(o.spaceType,o.width-l,a,o.x+i*l,o.y),this._pushSpaceData(o.spaceType,o.width,o.height-a,o.x,o.y+u*a)):(this._pushSpaceData(o.spaceType,o.width-l,o.height,o.x+i*l,o.y),this._pushSpaceData(o.spaceType,l,o.height-a,o.x,o.y+u*a));break;case h.spaceTypes.VR:this._updateTextPosition(e,o.y+c*l+(l-a)/2,o.x+d*a-(l-a)/2,!0),2*Math.random()>1?(this._pushSpaceData(o.spaceType,o.width-a,l,o.x+i*a,o.y),this._pushSpaceData(o.spaceType,o.width,o.height-l,o.x,o.y+u*l)):(this._pushSpaceData(o.spaceType,o.width-a,o.height,o.x+i*a,o.y),this._pushSpaceData(o.spaceType,a,o.height-l,o.x,o.y+u*l))}return}}}},{key:"render",value:function(){return(0,y.jsx)(a.default,{style:Object.assign({position:"relative",width:this.props.options.width,height:this.props.options.height},this.props.style),children:this._draw()})}}]),s}(l.default.Component);_.propTypes={options:p.default.shape({words:p.default.arrayOf(p.default.shape({text:p.default.string.isRequired,value:p.default.number.isRequired,color:p.default.string})).isRequired,verticalEnabled:p.default.bool,minFont:p.default.number,maxFont:p.default.number,fontOffset:p.default.number,width:p.default.number.isRequired,height:p.default.number.isRequired,fontFamily:p.default.string}).isRequired},_.defaultProps={options:{words:[],verticalEnabled:!0,minFont:10,maxFont:50,fontOffset:1,width:300,height:200,fontFamily:""}};t.default=_},"./src/screens/discovery/word-cloud/component/react-native-wordcloud/space.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),n=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js"));t.default=(0,r.default)((function e(t,s,o,r,d){(0,n.default)(this,e),this.spaceType=t,this.width=s,this.height=o,this.x=r,this.y=d}))},"./src/screens/discovery/word-cloud/component/react-native-wordcloud/text.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./node_modules/react/jsx-runtime.js");t.default=function(e){var t=e.style,s=e.onPress,o=e.onLayout,d=e.children,c=(0,n.jsx)(r.Text,{style:t,onLayout:o,children:d});return s?(0,n.jsx)(r.Touchable,{onPress:s,children:c}):c}},"./src/screens/discovery/word-cloud/component/react-native-wordcloud/util.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.spaceTypes=t.default=void 0;var o={};t.spaceTypes={LB:1,LT:2,RT:3,RB:4,HR:1,VR:2};o.getRandomColor=function(){for(var e="0123456789ABCDEF".split(""),t="#",s=0;s<6;s++)t+=e[Math.round(15*Math.random())];return t};t.default=o},"./src/screens/discovery/word-cloud/component/react-native-wordcloud/word.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),n=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),d=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/text.tsx")),c=o(s("./src/screens/discovery/word-cloud/component/react-native-wordcloud/util.ts")),i=s("./node_modules/react/jsx-runtime.js");t.default=function(){function e(t){(0,r.default)(this,e),this.index=t.index,this._placeFirstWord=t._placeFirstWord,this._placeOtherWord=t._placeOtherWord,this.text=t.text,this.value=t.value,this.fontFactor=t.fontFactor,this.fontOffset=t.fontOffset,this.minValue=t.minValue,this.fontFamily=t.fontFamily,this.font=null,this.color=t.color,null!==this.color&&""!==this.color||(this.color=c.default.getRandomColor()),this.view=null,this.width=null,this.height=null,this._init()}return(0,n.default)(e,[{key:"_init",value:function(){this._setFont(),this._setViewSize()}},{key:"_setFont",value:function(){this.font=Math.floor((this.value-this.minValue)*this.fontFactor+this.fontOffset)}},{key:"_setViewSize",value:function(){var e=this,t={position:"absolute",left:0,top:0,fontSize:this.font,lineHeight:this.font,color:this.color,opacity:0,pointerEvents:"none"};this.view=(0,i.jsx)(d.default,{style:t,onLayout:function(t){return e._onLayout(t)},children:this.text},this.index+"|"+this.text)}},{key:"_onLayout",value:function(e){var t=e.nativeEvent.layout,s=t.width,o=t.height;this.width=s,this.height=o,0===this.index?this._placeFirstWord(this):this._placeOtherWord(this)}}]),e}()},"./src/screens/discovery/word-cloud/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.PAGE_LIMIT=t.MAX_PAGE=t.COMPONENT=void 0;t.COMPONENT="WordCloud",t.PAGE_LIMIT=10,t.MAX_PAGE=10},"./src/screens/discovery/word-cloud/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/discovery/word-cloud/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Header")},"./src/screens/discovery/word-cloud/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),d=s("./src/screens/discovery/word-cloud/header/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.obc)((function(e,t){var s=t.$;return(0,c.jsx)(r.Header,{mode:"float",statusBarEventsType:"Subject",title:s.title?s.title+"的词云":"词云",hm:[s.url,"WordCloud"]})}),d.COMPONENT)},"./src/screens/discovery/word-cloud/hooks.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/web.timers.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.useWordCloudPage=function(e){var t=e.$;(0,a.useRunAfter)((function(){t.init()})),(0,a.useFocusEffect)((function(){setTimeout((function(){i.StatusBar.setBarStyle("light-content")}),40)}));var s=(0,c.useState)(!1),r=(0,d.default)(s,2),p=r[0],m=r[1],f=(0,c.useCallback)((0,n.default)(o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),!u.systemStore.advance){e.next=17;break}if(!t.subjectId){e.next=7;break}return e.next=5,t.batchSubjectThenCut(!0);case 5:e.next=15;break;case 7:if(!t.topicId){e.next=12;break}return e.next=10,t.cutTopic();case 10:e.next=15;break;case 12:if(!t.monoId){e.next=15;break}return e.next=15,t.cutMono();case 15:e.next=18;break;case 17:(0,l.info)("由于此服务需要消耗大量服务器资源\n暂不对非付费用户提供主动刷新功能",5);case 18:m(!1);case 19:case"end":return e.stop()}}),e)}))),[m]);return{refreshing:p,handleRefresh:f}};var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),c=s("react"),i=s("./src/components/index.ts"),u=s("./src/stores/index.ts"),l=s("./src/utils/index.ts"),a=s("./src/utils/hooks/index.ts")},"./src/screens/discovery/word-cloud/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var r=o(s("./node_modules/react-native-web/dist/exports/RefreshControl/index.js")),n=s("./node_modules/mobx-react/dist/mobxreact.esm.js"),d=s("./src/components/index.ts"),c=s("./src/utils/decorators/index.ts"),i=o(s("./src/screens/discovery/word-cloud/component/bg/index.tsx")),u=o(s("./src/screens/discovery/word-cloud/component/cavans/index.tsx")),l=o(s("./src/screens/discovery/word-cloud/component/comment/index.tsx")),a=o(s("./src/screens/discovery/word-cloud/component/media/index.tsx")),p=o(s("./src/screens/discovery/word-cloud/header/index.tsx")),m=s("./src/screens/discovery/word-cloud/hooks.ts"),f=o(s("./src/screens/discovery/word-cloud/store/index.ts")),h=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.ic)(f.default,(function(e,t){var s=(0,m.useWordCloudPage)(t),o=s.refreshing,c=s.handleRefresh;return(0,n.useObserver)((function(){return(0,h.jsxs)(d.Component,{id:"screen-word-cloud",children:[(0,h.jsx)(p.default,{}),(0,h.jsxs)(d.Page,{children:[(0,h.jsx)(i.default,{}),(0,h.jsx)(a.default,{}),(0,h.jsx)(d.ScrollView,{style:{height:"100%"},refreshControl:(0,h.jsx)(r.default,{refreshing:o,onRefresh:c}),children:(0,h.jsx)(u.default,{})}),(0,h.jsx)(l.default,{})]})]})}))}))},"./src/screens/discovery/word-cloud/store/action.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/web.timers.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s("./src/utils/index.ts"),f=s("./src/utils/fetch/index.ts"),h=s("./src/utils/kv/index.ts"),j=s("./src/screens/discovery/word-cloud/ds.ts"),y=r(s("./src/screens/discovery/word-cloud/store/fetch.ts")),b=s("./src/screens/discovery/word-cloud/store/ds.ts");function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var r=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=_(s);function s(){var e;(0,c.default)(this,s);for(var r=arguments.length,d=new Array(r),u=0;u<r;u++)d[u]=arguments[u];return e=t.call.apply(t,[this].concat(d)),(0,p.default)((0,i.default)(e),"batchSubjectThenCut",(0,n.default)(o.mark((function t(){var s,r,n,d,c,i,u,l=arguments;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=l.length>0&&void 0!==l[0]&&l[0],!e.state.fetching){t.next=3;break}return t.abrupt("return");case 3:if(s&&(0,f.t)("词云.刷新",{id:e.id}),s){t.next=11;break}if(!e.state.data._loaded){t.next=7;break}return t.abrupt("return");case 7:if(!e.subjectComments._loaded){t.next=11;break}if(!((r=e.subjectComments.pagination).page>=j.MAX_PAGE||r.pageTotal&&r.page>=r.pageTotal)){t.next=11;break}return t.abrupt("return",e.cut());case 11:return e.setState({fetching:1}),t.prev=12,t.next=15,e.fetchSubjectComments(!0);case 15:c=t.sent,i=(null==c||null==(n=c[e.subjectId])||null==(d=n.pagination)?void 0:d.pageTotal)||0,u=2;case 18:if(!(u<=Math.min(j.MAX_PAGE,i))){t.next=25;break}return e.setState({fetching:u}),t.next=22,e.fetchSubjectComments();case 22:u+=1,t.next=18;break;case 25:t.next=29;break;case 27:t.prev=27,t.t0=t.catch(12);case 29:return e.setState({fetching:0}),t.abrupt("return",e.cut());case 31:case"end":return t.stop()}}),t,null,[[12,27]])})))),(0,p.default)((0,i.default)(e),"cutTopic",(0,n.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchTopic();case 2:return t.next=4,e.cut();case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))),(0,p.default)((0,i.default)(e),"cutMono",(0,n.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchMono();case 2:return t.next=4,e.cut();case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))),(0,p.default)((0,i.default)(e),"cut",(0,n.default)(o.mark((function t(){var s,r;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,h.extract)(e.plainText);case 2:return(s=t.sent)&&(r={list:s.filter((function(e){return!b.FILTER_WORD.includes(e[0])})),_loaded:(0,m.getTimestamp)()},e.setState({data:r}),e.save(),r.list.length>=40&&(0,h.update)(e.snapshotId,{data:r})),(0,f.t)("词云.分词",{id:e.id}),t.abrupt("return",!0);case 6:case"end":return t.stop()}}),t)})))),(0,p.default)((0,i.default)(e),"onWordPress",(function(t){e.setState({title:t}),setTimeout((function(){e.selectedComment.length?(e.setState({show:!0}),(0,f.t)("词云.点击",{id:e.id,title:t})):(0,m.info)("没有找到对应吐槽")}),0)})),(0,p.default)((0,i.default)(e),"onClose",(function(){e.setState({show:!1})})),e}return(0,d.default)(s)}(y.default)},"./src/screens/discovery/word-cloud/store/computed.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.sub.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,n=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),i=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),a=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=o(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),m=s("./node_modules/mobx/dist/mobx.esm.js"),f=s("./src/stores/index.ts"),h=s("./src/utils/index.ts"),j=s("./src/constants/index.ts"),y=s("./src/screens/discovery/word-cloud/ds.ts"),b=s("./src/screens/discovery/word-cloud/store/utils.ts"),_=o(s("./src/screens/discovery/word-cloud/store/state.ts")),v=s("./src/screens/discovery/word-cloud/store/ds.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,l.default)(e);if(t){var r=(0,l.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,u.default)(this,s)}}t.default=(r=function(e){(0,i.default)(s,e);var t=x(s);function s(){var e;(0,n.default)(this,s);for(var o=arguments.length,r=new Array(o),d=0;d<o;d++)r[d]=arguments[d];return e=t.call.apply(t,[this].concat(r)),(0,a.default)((0,c.default)(e),"save",(function(){return e.saveStorage(e.namespace,v.EXCLUDE_STATE)})),e}return(0,d.default)(s,[{key:"subjectId",get:function(){return this.params.subjectId}},{key:"topicId",get:function(){return this.params.topicId}},{key:"monoId",get:function(){return this.params.monoId}},{key:"id",get:function(){return this.subjectId||this.topicId||this.monoId||""}},{key:"snapshotId",get:function(){return"extract_"+String(this.id).replace(/\//g,"_")}},{key:"namespace",get:function(){return v.NAMESPACE+"|"+this.id}},{key:"subject",get:function(){return f.subjectStore.subject(this.subjectId)}},{key:"subjectComments",get:function(){return f.subjectStore.subjectComments(this.subjectId)}},{key:"topic",get:function(){return f.rakuenStore.topic(this.topicId)}},{key:"topicComments",get:function(){return f.rakuenStore.comments(this.topicId)}},{key:"mono",get:function(){return f.subjectStore.mono(this.monoId)}},{key:"monoComments",get:function(){return f.subjectStore.monoComments(this.monoId)}},{key:"plainText",get:function(){var e="";if(this.subjectId){var t=y.MAX_PAGE*y.PAGE_LIMIT;this.subjectComments.list.forEach((function(s,o){o>=t||(e+=(0,b.removeSlogan)((0,b.getPlainText)(s.comment)))}))}if(this.topicId){e+=(0,b.getPlainText)(this.topic.title),e+=(0,b.getPlainText)(this.topic.message,300);this.topicComments.list.forEach((function(t,s){s>=200||(e+=(0,b.removeSlogan)((0,b.getPlainText)(t.message),150))}))}if(this.monoId){var s=y.MAX_PAGE*y.PAGE_LIMIT;this.monoComments.list.forEach((function(t,o){o>=s||(e+=(0,b.removeSlogan)((0,b.getPlainText)(t.message),150))}))}return(0,b.removeSpec)(e)}},{key:"selectedComment",get:function(){var e=this.state.title;if(this.subjectId){var t=this.subjectComments.list;return t.length?t.filter((function(t){return t.comment.includes(e)})).map((function(e){return{id:e.id,avatar:e.avatar,userId:e.userId,userName:(0,h.HTMLDecode)(e.userName),comment:(0,b.removeSlogan)((0,b.getPlainText)(e.comment)),time:e.time,action:e.action}})):j.FROZEN_ARRAY}if(this.topicId){var s=this.topicComments.list;return s.length?s.filter((function(t){return(0,b.getPlainText)(t.message).includes(e)})).map((function(e){return{id:e.id,avatar:e.avatar,userId:e.userId,userName:(0,h.HTMLDecode)(e.userName),comment:(0,b.removeSlogan)((0,b.getPlainText)(e.message)),time:e.time,action:e.floor}})):j.FROZEN_ARRAY}if(this.monoId){var o=this.monoComments.list;return o.length?o.filter((function(t){return(0,b.getPlainText)(t.message).includes(e)})).map((function(e){return{id:e.id,avatar:e.avatar,userId:e.userId,userName:(0,h.HTMLDecode)(e.userName),comment:(0,b.removeSlogan)((0,b.getPlainText)(e.message)),time:e.time,action:e.floor}})):j.FROZEN_ARRAY}return j.FROZEN_ARRAY}},{key:"total",get:function(){var e=0;return this.topicComments.list.forEach((function(t){e+=1+t.sub.length})),e}},{key:"title",get:function(){var e,t,s,o,r;return(null==(e=this.subject)?void 0:e.name_cn)||(null==(t=this.subject)?void 0:t.name)||(null==(s=this.topic)?void 0:s.title)||(null==(o=this.mono)?void 0:o.nameCn)||(null==(r=this.mono)?void 0:r.name)||""}},{key:"url",get:function(){return"word_cloud/"+String(this.id).replace(/\//g,"_")}}]),s}(_.default),(0,p.default)(r.prototype,"subjectId",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"subjectId"),r.prototype),(0,p.default)(r.prototype,"topicId",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicId"),r.prototype),(0,p.default)(r.prototype,"monoId",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"monoId"),r.prototype),(0,p.default)(r.prototype,"id",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"id"),r.prototype),(0,p.default)(r.prototype,"snapshotId",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"snapshotId"),r.prototype),(0,p.default)(r.prototype,"namespace",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"namespace"),r.prototype),(0,p.default)(r.prototype,"subject",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"subject"),r.prototype),(0,p.default)(r.prototype,"subjectComments",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"subjectComments"),r.prototype),(0,p.default)(r.prototype,"topic",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"topic"),r.prototype),(0,p.default)(r.prototype,"topicComments",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"topicComments"),r.prototype),(0,p.default)(r.prototype,"mono",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"mono"),r.prototype),(0,p.default)(r.prototype,"monoComments",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"monoComments"),r.prototype),(0,p.default)(r.prototype,"plainText",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"plainText"),r.prototype),(0,p.default)(r.prototype,"selectedComment",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"selectedComment"),r.prototype),(0,p.default)(r.prototype,"total",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"total"),r.prototype),(0,p.default)(r.prototype,"title",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"title"),r.prototype),(0,p.default)(r.prototype,"url",[m.computed],Object.getOwnPropertyDescriptor(r.prototype,"url"),r.prototype),r)},"./src/screens/discovery/word-cloud/store/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.FILTER_WORD=t.EXCLUDE_STATE=void 0;var o=s("./src/screens/discovery/word-cloud/ds.ts"),r=(t.NAMESPACE="Screen"+o.COMPONENT,t.EXCLUDE_STATE={title:"",show:!1,fetching:0});t.STATE=Object.assign({},r,{data:{list:[],_loaded:0},_loaded:!1}),t.FILTER_WORD=["bgm","一部","实在","感觉","最后","有点","有种","比较","确实"]},"./src/screens/discovery/word-cloud/store/fetch.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.number.constructor.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s("./src/stores/index.ts"),f=s("./src/utils/index.ts"),h=s("./src/utils/kv/index.ts"),j=s("./src/constants/index.ts"),y=r(s("./src/screens/discovery/word-cloud/store/computed.ts"));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var r=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=b(s);function s(){var e,r;(0,c.default)(this,s);for(var d=arguments.length,u=new Array(d),l=0;l<d;l++)u[l]=arguments[l];return e=t.call.apply(t,[this].concat(u)),(0,p.default)((0,i.default)(e),"fetchSnapshot",(0,n.default)(o.mark((function t(){var s,r,n,d,c,i,u;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(0,f.getTimestamp)(),!(n=e.state.data)._loaded||null==(s=n.list)||!s.length){t.next=5;break}if(!(r-Number(n._loaded)<=j.D)){t.next=5;break}return t.abrupt("return",!0);case 5:return t.prev=5,t.next=8,(0,h.get)(e.snapshotId);case 8:if(null==(u=t.sent)||null==(d=u.data)||!d._loaded||null==u||null==(c=u.data)||null==(i=c.list)||!i.length){t.next=13;break}if(!(r-Number(u.data._loaded)<=j.D)){t.next=13;break}return e.setState({data:{list:u.data.list,_loaded:r}}),t.abrupt("return",!0);case 13:t.next=17;break;case 15:t.prev=15,t.t0=t.catch(5);case 17:return t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[5,15]])})))),(0,p.default)((0,i.default)(e),"fetchSubjectComments",(r=(0,n.default)(o.mark((function t(s){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",m.subjectStore.fetchSubjectComments({subjectId:e.subjectId,interest_type:"",version:!1},s));case 1:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)})),(0,p.default)((0,i.default)(e),"fetchTopic",(function(){return m.rakuenStore.fetchTopic({topicId:e.topicId})})),(0,p.default)((0,i.default)(e),"fetchMono",(function(){return m.subjectStore.fetchMono({monoId:e.monoId})})),e}return(0,d.default)(s)}(y.default)},"./src/screens/discovery/word-cloud/store/index.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),l=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s("./src/stores/index.ts"),f=r(s("./src/screens/discovery/word-cloud/store/action.ts")),h=s("./src/screens/discovery/word-cloud/store/ds.ts");function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var r=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,l.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=j(s);function s(){var e;(0,c.default)(this,s);for(var r=arguments.length,d=new Array(r),u=0;u<r;u++)d[u]=arguments[u];return e=t.call.apply(t,[this].concat(d)),(0,p.default)((0,i.default)(e),"init",(0,n.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.t1=Object,t.t2={},t.next=5,e.getStorage(e.namespace);case 5:if(t.t3=t.sent,t.t4=h.EXCLUDE_STATE,t.t5={_loaded:!0},t.t6=t.t1.assign.call(t.t1,t.t2,t.t3,t.t4,t.t5),t.t0.setState.call(t.t0,t.t6),!e.subjectId){t.next=14;break}if(e.subject._loaded){t.next=14;break}return t.next=14,m.subjectStore.fetchSubject(e.subjectId);case 14:return t.next=16,e.fetchSnapshot();case 16:if(t.sent){t.next=20;break}e.subjectId?e.batchSubjectThenCut():e.topicId?e.cutTopic():e.monoId&&e.cutMono(),t.next=21;break;case 20:e.monoId&&!e.monoComments._loaded&&e.fetchMono();case 21:return t.abrupt("return",!0);case 22:case"end":return t.stop()}}),t)})))),e}return(0,d.default)(s)}(f.default)},"./src/screens/discovery/word-cloud/store/state.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),n=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),l=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=s("./node_modules/mobx/dist/mobx.esm.js"),p=o(s("./src/utils/store/index.ts")),m=s("./src/screens/discovery/word-cloud/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var r=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,i.default)(this,s)}}t.default=function(e){(0,c.default)(s,e);var t=f(s);function s(){var e;(0,n.default)(this,s);for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];return e=t.call.apply(t,[this].concat(r)),(0,l.default)((0,d.default)(e),"params",void 0),(0,l.default)((0,d.default)(e),"state",(0,a.observable)(m.STATE)),e}return(0,r.default)(s)}(p.default)},"./src/screens/discovery/word-cloud/store/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.getPlainText=function(e,t){if(!e||"string"!=typeof e)return e;e=(0,o.HTMLDecode)((0,o.removeHTMLTag)(e,!1)),t&&(e=e.slice(0,t));return e},t.removeSlogan=function(e,t){var s;if(!e||"string"!=typeof e)return e;e=(null==(s=e.split("[来自Bangumi"))?void 0:s[0])||"",t&&(e=e.slice(0,t));return e},t.removeSpec=function(e){return e&&"string"==typeof e?e.replace(/https?:\/\/[^\s]+|www\.[^\s]+/g,"").replace(/x[a-zA-Z0-9]{5}/g,"").replace(/&#;/g,""):e};var o=s("./src/utils/index.ts")}}]);