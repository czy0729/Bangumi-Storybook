(self.webpackChunkweb=self.webpackChunkweb||[]).push([[561],{"./src/screens/web-view/bilibili-sync/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),l=s("./src/utils/decorators/index.ts"),i=s("./src/screens/web-view/bilibili-sync/btn/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.btnStyle,l=void 0===n?void 0:n,c=e.text,a=void 0===c?"同步":c,u=e.type,m=void 0===u?void 0:u,p=e.size,b=void 0===p?11:p,f=e.disabled,y=void 0===f?void 0:f,x=e.loading,_=void 0===x?void 0:x,j=e.onPress,h=void 0===j?void 0:j,v=(0,i.memoStyles)(),g="success"===m&&!y;return(0,d.jsx)(o.Touchable,{style:(0,r.stl)(v.touch,s),onPress:y||_?void 0:h,children:(0,d.jsx)(o.Flex,{style:(0,r.stl)(v.btn,g&&v.btnSuccess,l),justify:"center",children:_?(0,d.jsx)(o.Loading.Mini,{}):(0,d.jsx)(o.Text,{bold:!0,size:b,type:g?"__plain__":void 0,children:a})})})}));try{btn.displayName="btn",btn.__docgenInfo={description:"",displayName:"btn",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},btnStyle:{defaultValue:null,description:"",name:"btnStyle",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"number"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"any"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/btn/index.tsx#btn"]={docgenInfo:btn.__docgenInfo,name:"btn",path:"src/screens/web-view/bilibili-sync/btn/index.tsx#btn"})}catch(e){}},"./src/screens/web-view/bilibili-sync/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{touch:{width:56,borderRadius:n._.r(28),overflow:"hidden"},btn:{height:n._.r(28),backgroundColor:n._.select(n._.colorBg,n._._colorDarkModeLevel1),borderRadius:n._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/web-view/bilibili-sync/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.ob)((function(e){var t=e.select,s=e.text,n=e.next;return(0,i.jsxs)(o.Text,{style:r._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,i.jsxs)(o.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",n]})]})}));try{columnbgm.displayName="columnbgm",columnbgm.__docgenInfo={description:"",displayName:"columnbgm",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"any"}},next:{defaultValue:null,description:"",name:"next",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column-bgm/index.tsx#columnbgm"]={docgenInfo:columnbgm.__docgenInfo,name:"columnbgm",path:"src/screens/web-view/bilibili-sync/column-bgm/index.tsx#columnbgm"})}catch(e){}},"./src/screens/web-view/bilibili-sync/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),l=s("./src/utils/decorators/index.ts"),i=s("./src/screens/web-view/bilibili-sync/column-select/styles.ts"),d=s("./node_modules/react/jsx-runtime.js"),c={top:4,right:32,bottom:4,left:16};t.default=(0,l.ob)((function(e){var t=e.select,s=e.disabled,n=e.onPress;return s?(0,d.jsx)(o.default,{style:i.styles.columnSelect}):(0,d.jsx)(r.Touchable,{style:i.styles.columnSelect,hitSlop:c,onPress:function(){return n(!t)},children:(0,d.jsx)(r.Flex,{style:i.styles.radio,justify:"center",children:(0,d.jsx)(r.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?"rgb(1, 173, 145)":void 0,size:16})})})}));try{columnselect.displayName="columnselect",columnselect.__docgenInfo={description:"",displayName:"columnselect",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column-select/index.tsx#columnselect"]={docgenInfo:columnselect.__docgenInfo,name:"columnselect",path:"src/screens/web-view/bilibili-sync/column-select/index.tsx#columnselect"})}catch(e){}},"./src/screens/web-view/bilibili-sync/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/web-view/bilibili-sync/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.type,r=void 0===n?void 0:n,i=e.text,d=void 0===i?void 0:i,c=e.right,a=void 0===c?void 0:c,u=e.onPress,m=void 0===u?void 0:u;return(0,l.jsxs)(o.Flex,{style:s,children:[(0,l.jsx)(o.Text,{size:11,type:d&&"/"!==d?r:"sub",onPress:m,children:d||"__"}),a]})}));try{column.displayName="column",column.__docgenInfo={description:"",displayName:"column",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"any"}},right:{defaultValue:null,description:"",name:"right",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column/index.tsx#column"]={docgenInfo:column.__docgenInfo,name:"column",path:"src/screens/web-view/bilibili-sync/column/index.tsx#column"})}catch(e){}},"./src/screens/web-view/bilibili-sync/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectComment=a,t.getSelectEp=d,t.getSelectScore=c,t.getSelectStatus=i,t.useSelectComment=function(e,t){var s=(0,r.useState)(a(e,t).select),n=(0,o.default)(s,2),l=n[0],i=n[1];return(0,r.useEffect)((function(){i(a(e,t).select)}),[e,t]),[l,i]},t.useSelectEp=function(e,t){var s=(0,r.useState)(d(e,t).select),n=(0,o.default)(s,2),l=n[0],i=n[1];return(0,r.useEffect)((function(){i(d(e,t).select)}),[e,t]),[l,i]},t.useSelectScore=function(e,t){var s=(0,r.useState)(c(e,t).select),n=(0,o.default)(s,2),l=n[0],i=n[1];return(0,r.useEffect)((function(){i(c(e,t).select)}),[e,t]),[l,i]},t.useSelectStatus=function(e,t){var s=(0,r.useState)(i(e,t).select),n=(0,o.default)(s,2),l=n[0],d=n[1];return(0,r.useEffect)((function(){d(i(e,t).select)}),[e,t]),[l,d]};var o=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),r=s("react"),l=s("./src/constants/index.ts");function i(e,t){var s=Number(e||0),n=Number(l.MODEL_COLLECTION_STATUS.getTitle(t)||0);return 3===n?n=2:2===n&&(n=3),{select:!(n>=3)&&s>n,value:s}}function d(e,t){var s,n=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:n>Number(t||0),value:n}}function c(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function a(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}},"./src/screens/web-view/douban-sync/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.LOADED_TOTAL_EPS=t.LOADED=t.HOST_API=t.EXCLUDE_STATE=void 0;t.NAMESPACE="ScreenDouban";var n=t.EXCLUDE_STATE={progress:{fetching:!1,message:"",current:0,total:0}};t.STATE=Object.assign({doubanId:"",data:{list:[],_loaded:0},collections:{},totalEps:{},bottom:{current:0},hide:!1,hideWatched:!1,hideSame:!1,hideNotMatched:!1,noCommentUseCreateDate:!1,scoreMinuesOne:!1,privacy:!1},n,{_loaded:!1}),t.HOST_API="https://api.bgm.tv",t.LOADED={},t.LOADED_TOTAL_EPS={}},"./src/screens/web-view/douban-sync/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/screens/_/index.ts"),l=s("./src/stores/index.ts"),i=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=t.$,n=t.navigation,i=s.state.hide;return(0,c.jsx)(o.Header,{title:"豆瓣同步",hm:["douban-sync","DoubanSync"],headerRight:function(){return(0,c.jsxs)(o.Flex,{children:[(0,c.jsx)(r.IconTouchable,{style:l._.mr.xs,name:i?"md-refresh":"md-close",color:l._.colorDesc,onPress:s.onToggleHide}),(0,c.jsx)(r.IconTouchable,{name:"md-info-outline",color:l._.colorDesc,size:19,onPress:function(){(0,d.t)("豆瓣同步.关于"),n.push("Information",{title:"豆瓣同步",message:["此功能目前为实验性质。","请点击旁边的刷新按钮根据提示完成数据获取，然后开始同步数据。","因自动对比的数据存在较大的出错可能，目前不打算做一键提交功能，请手动核实后自行提交。","网页版不存在此功能，所以此为高级会员功能。此功能开发不易，目前暂时对所有用户开放，觉得有用可支持一下。"],advance:!0})}})]})}})}));try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/web-view/douban-sync/header/index.tsx#header"})}catch(e){}},"./src/screens/web-view/douban-sync/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),l=s("./src/utils/decorators/index.ts"),i=s("./src/utils/hooks/index.ts"),d=n(s("./src/screens/web-view/douban-sync/header/index.tsx")),c=n(s("./src/screens/web-view/douban-sync/list/index.tsx")),a=n(s("./src/screens/web-view/douban-sync/login/index.tsx")),u=n(s("./src/screens/web-view/douban-sync/store.ts")),m=n(s("./src/screens/web-view/douban-sync/tips/index.tsx")),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.ic)(u.default,(function(e,t){var s=t.$;return(0,i.useMount)((function(){(0,r.runAfter)((function(){s.init()}))})),(0,i.useObserver)((function(){return(0,p.jsxs)(o.Component,{id:"screen-douban-sync",children:[(0,p.jsx)(d.default,{}),(0,p.jsxs)(o.Page,{loaded:s.state._loaded,children:[(0,p.jsx)(a.default,{}),(0,p.jsx)(c.default,{}),(0,p.jsx)(m.default,{})]})]})}))}));try{doubansync.displayName="doubansync",doubansync.__docgenInfo={description:"",displayName:"doubansync",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/index.tsx#doubansync"]={docgenInfo:doubansync.__docgenInfo,name:"doubansync",path:"src/screens/web-view/douban-sync/index.tsx#doubansync"})}catch(e){}},"./src/screens/web-view/douban-sync/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.BILIBILI_STATUS=void 0;t.BILIBILI_STATUS={1:"想看",2:"在看",3:"看过"},t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},collection:{},totalEps:"",hideSame:!1,noCommentUseCreateDate:!1,scoreMinuesOne:!1,onRefreshCollection:function(){},onBottom:function(){},onSubmit:function(){}}},"./src/screens/web-view/douban-sync/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/utils/decorators/index.ts"),r=n(s("./src/screens/web-view/douban-sync/item/item.tsx")),l=s("./src/screens/web-view/douban-sync/item/styles.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.obc)((function(e,t){var s=e.item,n=t.$,o=t.navigation,d=n.state,c=d.hideWatched,a=d.hideSame,u=d.hideNotMatched,m=d.noCommentUseCreateDate,p=d.scoreMinuesOne,b=s.subjectId;if(u&&!b)return null;var f=n.collection(b);if(c&&"collect"===(null==f?void 0:f.status))return null;var y=n.totalEps(b);return(0,i.jsx)(r.default,{navigation:o,styles:(0,l.memoStyles)(),item:s,collection:f,totalEps:y?y+"话":"",hideSame:a,noCommentUseCreateDate:m,scoreMinuesOne:p,onRefreshCollection:n.onRefreshCollection,onBottom:n.onBottom,onSubmit:n.onSubmit})}))},"./src/screens/web-view/douban-sync/item/item.tsx":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.slice.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=w(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var l=o?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(n,r,l):n[r]=e[r]}return n.default=e,s&&s.set(e,n),n}(s("react")),d=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),c=s("./src/components/index.ts"),a=s("./src/components/cover/utils.ts"),u=s("./src/screens/_/index.ts"),m=s("./src/stores/index.ts"),p=s("./src/utils/index.ts"),b=s("./src/utils/decorators/index.ts"),f=s("./src/utils/fetch/index.ts"),y=s("./src/constants/index.ts"),x=o(s("./src/screens/web-view/bilibili-sync/btn/index.tsx")),_=o(s("./src/screens/web-view/bilibili-sync/column/index.tsx")),j=o(s("./src/screens/web-view/bilibili-sync/column-bgm/index.tsx")),h=o(s("./src/screens/web-view/bilibili-sync/column-select/index.tsx")),v=s("./src/screens/web-view/bilibili-sync/utils.ts"),g=s("./src/screens/web-view/douban-sync/item/ds.ts"),S=s("./node_modules/react/jsx-runtime.js");function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(w=function(e){return e?s:t})(e)}t.default=(0,b.memo)((function(e){var t=e.navigation,s=e.styles,o=e.item,b=e.collection,w=e.totalEps,T=e.hideSame,O=e.noCommentUseCreateDate,I=e.scoreMinuesOne,E=e.onRefreshCollection,C=e.onBottom,A=e.onSubmit,P=o.subjectId,D=!!P,R=!(null==b||!b.loaded),L=o.progress||"";"看过"===g.BILIBILI_STATUS[o.status]&&!L&&w&&(L=w);var M=o.score?2*Number(o.score)-(I?1:0):2*o.score,k=String(o.create_time).split(" ")[0],B=O?o.content||k:o.content,q=(0,i.useState)(!1),N=(0,l.default)(q,2),V=N[0],z=N[1],U=(0,v.useSelectStatus)(o.status,null==b?void 0:b.status),F=(0,l.default)(U,2),H=F[0],K=F[1],Y=(0,v.useSelectEp)(L,null==b?void 0:b.ep_status),W=(0,l.default)(Y,2),G=W[0],$=W[1],X=(0,v.useSelectScore)(M,null==b?void 0:b.rating),J=(0,l.default)(X,2),Q=J[0],Z=J[1],ee=(0,v.useSelectComment)(B,null==b?void 0:b.comment),te=(0,l.default)(ee,2),se=te[0],ne=te[1],oe={status:g.BILIBILI_STATUS[o.status]||"",ep:L||"",score:o.score||"",comment:B||""},re={status:y.MODEL_COLLECTION_STATUS.getLabel(null==b?void 0:b.status)||"",ep:(null==b?void 0:b.ep_status)&&b.ep_status+"话",score:(null==b?void 0:b.rating)||"",comment:(null==b?void 0:b.comment)||""};if(T&&oe.status==re.status&&oe.ep==re.ep&&oe.score==re.score&&oe.comment==re.comment)return null;var le={status:g.BILIBILI_STATUS[o.status],ep:(0,v.getSelectEp)(L,null==b?void 0:b.ep_status).value,score:(0,v.getSelectScore)(M,null==b?void 0:b.rating).value,comment:(0,v.getSelectComment)(B,null==b?void 0:b.comment).value},ie=function(){D&&t.push("Subject",{subjectId:P,_cn:o.title,_image:(0,a.getCoverSrc)(o.cover,y.IMG_WIDTH_SM)})};return(0,S.jsxs)(c.Flex,{style:s.item,align:"start",children:[(0,S.jsx)(u.Cover,{src:o.cover,width:y.IMG_WIDTH_SM,height:y.IMG_HEIGHT_SM,radius:!0,onPress:ie}),(0,S.jsx)(c.Flex.Item,{children:(0,S.jsxs)(c.Flex,{style:s.body,direction:"column",align:"start",children:[(0,S.jsx)(c.Text,{bold:!0,numberOfLines:2,onPress:ie,children:o.title}),!!o.create_time&&(0,S.jsx)(c.Text,{style:m._.mt.sm,size:11,type:"sub",bold:!0,children:o.create_time.slice(0,16)}),(0,S.jsxs)(c.Flex,{style:m._.mt.md,align:"start",children:[(0,S.jsxs)(d.default,{children:[(0,S.jsx)(_.default,{text:" ",type:"sub"}),(0,S.jsx)(_.default,{style:m._.mt.md,text:"状态",type:"sub"}),(0,S.jsx)(_.default,{style:m._.mt.md,text:"进度",type:"sub"}),(0,S.jsx)(_.default,{style:m._.mt.md,text:"评分",type:"sub"}),(0,S.jsx)(_.default,{style:m._.mt.md,text:"评论",type:"sub"})]}),(0,S.jsxs)(c.Flex.Item,{style:m._.ml.md,children:[(0,S.jsx)(_.default,{text:"douban",type:"sub"}),(0,S.jsx)(_.default,{style:m._.mt.md,text:oe.status}),(0,S.jsx)(_.default,{style:m._.mt.md,text:oe.ep}),(0,S.jsx)(_.default,{style:m._.mt.md,text:oe.score?oe.score+"★":oe.score}),(0,S.jsx)(_.default,{style:m._.mt.md,text:oe.comment,onPress:function(){o.content&&(0,p.copy)(o.content,"已复制")}})]}),(0,S.jsxs)(c.Flex.Item,{style:m._.ml.md,flex:1.5,children:[(0,S.jsx)(_.default,{text:"bgm",type:"sub",right:D&&(0,S.jsx)(c.Touchable,{style:m._.ml.xs,hitSlop:g.HIT_SLOP,onPress:function(){return E(P)},children:(0,S.jsx)(c.Iconfont,{name:"md-refresh",size:12})})}),D?R?(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(j.default,{select:H,text:re.status,next:le.status}),(0,S.jsx)(j.default,{select:G,text:re.ep,next:le.ep+"话"}),(0,S.jsx)(j.default,{select:Q,text:re.score,next:le.score}),(0,S.jsx)(j.default,{select:se,text:re.comment,next:le.comment})]}):(0,S.jsx)(c.Flex,{style:s.loading,children:(0,S.jsx)(c.Loading.Mini,{})}):(0,S.jsx)(_.default,{style:m._.mt.md,text:"未找到条目"})]}),D&&(0,S.jsxs)(d.default,{style:s.selectors,children:[(0,S.jsx)(_.default,{text:" ",type:"sub"}),R&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.default,{select:H,disabled:!le.status,onPress:K}),(0,S.jsx)(h.default,{select:G,disabled:""===le.ep,onPress:$}),(0,S.jsx)(h.default,{select:Q,disabled:!le.score,onPress:Z}),(0,S.jsx)(h.default,{select:se,disabled:!le.comment,onPress:ne})]})]})]}),(0,S.jsx)(d.default,{style:s.toolbar,children:(0,S.jsxs)(c.Flex,{style:m._.mt.md,children:[(0,S.jsx)(c.Flex.Item,{children:(0,S.jsxs)(c.Flex,{children:[(0,S.jsx)(x.default,{text:"详情",onPress:function(){(0,f.t)("豆瓣同步.详情"),(0,p.open)("https://m.douban.com/movie/subject/"+o.id)}}),(0,S.jsx)(x.default,{style:m._.ml.sm,text:"搜索",onPress:function(){(0,f.t)("豆瓣同步.搜索"),t.push("Search",{type:"动画",value:o.title})}}),(0,S.jsx)(x.default,{style:m._.ml.sm,text:"置底",onPress:function(){return C(o.id)}})]})}),D&&(0,S.jsx)(x.default,{style:m._.ml.md,type:"success",disabled:!R||!(H||G||Q||se),loading:V,onPress:(0,r.default)(n.mark((function e(){var t,s,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},s={},H?"想看"===le.status?(t.status=!0,s.status="wish"):"看过"===le.status?(t.status=!0,s.status="collect"):"在看"===le.status&&(t.status=!0,s.status="do"):re.status&&(t.status=!0,s.status=y.MODEL_COLLECTION_STATUS.getValue(re.status)),Q&&(t.score=!0,s.rating=Number(le.score)||0),se&&(t.comment=!0,s.comment=le.comment),o={},G&&(t.ep=!0,o.ep=le.ep),z(!0),e.next=10,A(P,s,o);case 10:z(!1),t.status&&K(!1),t.ep&&$(!1),t.score&&Z(!1),t.comment&&ne(!1);case 15:case"end":return e.stop()}}),e)})))})]})})]})})]})}),g.DEFAULT_PROPS);try{item.displayName="item",item.__docgenInfo={description:"",displayName:"item",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:"{ item: { paddingRight: number; paddingLeft: number; paddingVertical: number; marginBottom: number; }; body: { paddingLeft: number; }; selectors: { width: number; }; toolbar: { width: string; paddingRight: number; marginTop: number; }; loading: { ...; }; }"}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"{ id: Id; subjectId: SubjectId; title: string; cover: string; status: number; content: string; score: number; progress: any; create_time: string; }"}},collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:'{ comment?: string; ep_status?: number; rating?: number; status?: "dropped" | "collect" | "wish" | "do" | "on_hold"; private?: 0 | 1; loaded: number; }'}},totalEps:{defaultValue:null,description:"",name:"totalEps",required:!0,type:{name:"string"}},hideSame:{defaultValue:null,description:"",name:"hideSame",required:!0,type:{name:"boolean"}},noCommentUseCreateDate:{defaultValue:null,description:"",name:"noCommentUseCreateDate",required:!0,type:{name:"boolean"}},scoreMinuesOne:{defaultValue:null,description:"",name:"scoreMinuesOne",required:!0,type:{name:"boolean"}},onRefreshCollection:{defaultValue:null,description:"",name:"onRefreshCollection",required:!0,type:{name:"(subjectId: SubjectId) => void"}},onBottom:{defaultValue:null,description:"",name:"onBottom",required:!0,type:{name:"(mediaId: Id) => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(subjectId: SubjectId, collectionData: any, epData: any) => Promise<boolean>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/item/item.tsx#item"]={docgenInfo:item.__docgenInfo,name:"item",path:"src/screens/web-view/douban-sync/item/item.tsx#item"})}catch(e){}},"./src/screens/web-view/douban-sync/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{item:{paddingRight:n._.wind-n._._wind,paddingLeft:n._.wind,paddingVertical:n._.md,marginBottom:n._.sm},body:{paddingLeft:n._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:n._._wind,marginTop:n._.xs},loading:{marginTop:13}}}))},"./src/screens/web-view/douban-sync/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/screens/_/index.ts"),r=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),i=n(s("./src/screens/web-view/douban-sync/tool-bar/index.tsx")),d=n(s("./src/screens/web-view/douban-sync/item/index.tsx")),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$;return(0,c.jsx)(o.PaginationList2,{contentContainerStyle:r._.container.bottom,data:s.data,limit:12,keyboardDismissMode:"on-drag",ListHeaderComponent:(0,c.jsx)(i.default,{}),renderItem:function(e){var t=e.item;return(0,c.jsx)(d.default,{item:t})},onPage:s.onPage})}));try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/web-view/douban-sync/list/index.tsx#list"})}catch(e){}},"./src/screens/web-view/douban-sync/login/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.fixed.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),l=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),a=s("./src/utils/fetch/index.ts"),u=n(s("./src/screens/web-view/bilibili-sync/btn/index.tsx")),m=s("./src/screens/web-view/douban-sync/login/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$,n=(0,m.memoStyles)(),c=s.state,b=c.doubanId,f=c.hide,y=c.data,x=c.progress;return(0,p.jsxs)(p.Fragment,{children:[!f&&(0,p.jsx)(o.default,{style:n.mask}),(0,p.jsxs)(o.default,{style:(0,d.stl)(n.fixed,f&&n.hide),children:[(0,p.jsxs)(o.default,{style:n.user,children:[(0,p.jsx)(r.Input,{style:n.input,defaultValue:b,multiline:!0,numberOfLines:3,placeholder:"输入豆瓣用户空间地址或用户的豆瓣ID",onChangeText:s.onChange}),(0,p.jsxs)(r.Flex,{style:i._.mt.md,children:[(0,p.jsx)(r.Text,{size:15,bold:!0,children:s.doubanId?"匹配到豆瓣ID："+s.doubanId:"未匹配到豆瓣ID"}),!!s.doubanId&&(0,p.jsx)(l.IconTouchable,{name:"md-open-in-new",size:18,onPress:function(){(0,a.t)("豆瓣同步.检查"),(0,d.open)("https://m.douban.com/people/"+s.doubanId+"/")}})]}),!!y.list.length&&(0,p.jsxs)(r.Text,{style:i._.mt.md,bold:!0,children:["当前已获取 ",y.list.length," 个影视收藏，其中 ",s.matchCount," 个条目匹配 bgm.tv 数据成功。"]})]}),(0,p.jsxs)(o.default,{style:n.body,children:[(0,p.jsx)(r.Text,{style:i._.mt.sm,size:13,type:"sub",children:"请务必准确填写您的豆瓣用户空间地址或豆瓣 ID。(例如: https://www.douban.com/people/123456 或 123456)"}),(0,p.jsx)(r.Text,{style:i._.mt.sm,size:13,type:"sub",children:"网页版: 右上方 → 个人主页 → 复制网页地址。"}),(0,p.jsx)(r.Text,{style:i._.mt.sm,size:13,type:"sub",children:"豆瓣客户端: 底部菜单我 → 左上方菜单 → 点击头像 → 豆瓣ID。"}),(0,p.jsx)(r.Text,{style:i._.mt.md,size:13,type:"sub",children:"请知悉，因收录规则不同，绝大部分豆瓣条目不在 bgm.tv 收录范围内。"}),(0,p.jsx)(r.Text,{style:i._.mt.md,size:13,type:"sub",children:"此功能目前为实验性质，仅获取用户想看、在看、看过的影视条目，未来可能会逐步扩大到书籍和游戏。"}),(0,p.jsx)(r.Text,{style:i._.mt.sm,size:13,type:"sub",children:"自己主动隐藏的条目不能获取。请勿过度获取数据，可能会被豆瓣封 IP 几个小时。"}),(0,p.jsxs)(r.Flex,{style:i._.mt.lg,justify:"center",children:[(0,p.jsx)(u.default,{style:n.btn,btnStyle:n.btnStyle,text:"重新获取数据",size:13,loading:x.fetching,onPress:function(){x.fetching?(0,d.info)("已在获取中..."):(s.fetchDouban(),(0,a.t)("豆瓣同步.获取数据"))}}),(0,p.jsx)(u.default,{style:[n.btn,i._.ml.md],btnStyle:n.btnStyle,text:"收起窗口",size:13,onPress:s.onToggleHide})]})]})]})]})}));try{login.displayName="login",login.__docgenInfo={description:"",displayName:"login",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/login/index.tsx#login"]={docgenInfo:login.__docgenInfo,name:"login",path:"src/screens/web-view/douban-sync/login/index.tsx#login"})}catch(e){}},"./src/screens/web-view/douban-sync/login/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:n._.wind,width:n._.window.contentWidth,backgroundColor:n._.select(n._.colorPlain,n._._colorDarkModeLevel2),borderRadius:n._.radiusMd,shadowColor:n._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:n._.select(16,0)},hide:{top:n._.sm,right:n._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},body:{paddingHorizontal:n._.md,paddingBottom:28},btn:{width:128},btnStyle:{height:40},user:{paddingVertical:12,paddingHorizontal:n._._wind},input:{backgroundColor:n._.colorBg,borderRadius:n._.radiusMd}}}))},"./src/screens/web-view/douban-sync/store.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,l=o(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=o(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),f=s("./node_modules/mobx/dist/mobx.esm.js"),y=s("./src/stores/index.ts"),x=s("./src/utils/index.ts"),_=s("./src/utils/fetch/index.ts"),j=s("./src/utils/fetch.v0/index.ts"),h=o(s("./src/utils/store/index.ts")),v=o(s("./src/constants/i18n/index.ts")),g=s("./src/assets/json/index.web.ts"),S=s("./src/screens/web-view/douban-sync/ds.ts");function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,m.default)(e);if(t){var o=(0,m.default)(this).constructor;s=Reflect.construct(n,arguments,o)}else s=n.apply(this,arguments);return(0,u.default)(this,s)}}t.default=(r=function(e){(0,a.default)(s,e);var t=w(s);function s(){var e,o,r,d;(0,i.default)(this,s);for(var a=arguments.length,u=new Array(a),m=0;m<a;m++)u[m]=arguments[m];return e=t.call.apply(t,[this].concat(u)),(0,p.default)((0,c.default)(e),"state",(0,f.observable)(S.STATE)),(0,p.default)((0,c.default)(e),"collections",[]),(0,p.default)((0,c.default)(e),"init",(0,l.default)(n.mark((function t(){var s,o,r,l,i,d;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(S.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,e.setState(Object.assign({},r,{hide:!(null==r||null==(s=r.data)||null==(o=s.list)||!o.length)},S.EXCLUDE_STATE,{_loaded:!0})),l=e.state,i=l.data,d=l.progress,i.list.length||d.fetching||e.fetchDouban("done",1,!1);case 9:case"end":return t.stop()}}),t)})))),(0,p.default)((0,c.default)(e),"fetchDouban",(0,l.default)(n.mark((function t(){var s,o,r,l,i,d,c,a,u,m,p,b,f,y=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=y.length>0&&void 0!==y[0]?y[0]:"done",o=y.length>1&&void 0!==y[1]?y[1]:1,r=!(y.length>2&&void 0!==y[2])||y[2],e.doubanId){t.next=6;break}return r&&(0,x.info)("匹配豆瓣 ID 有误，请核实"),t.abrupt("return",!1);case 6:return i=(o-1)*(l=40),t.prev=8,e.setState({progress:{fetching:!0}}),t.next=12,(0,_.xhrCustom)({url:"https://m.douban.com/rexxar/api/v2/user/"+e.doubanId+"/interests?type=movie&status="+s+"&start="+i+"&count="+l+"&ck=PylB&for_mobile=1",headers:{Referer:"https://m.douban.com"}});case 12:return d=t.sent,c=d._response,a=JSON.parse(c),u=a.interests,m=void 0===u?[]:u,p=a.total,t.next=17,(0,g.loadJSON)("thirdParty/d.min");case 17:return b=t.sent,m.forEach((function(t){var s,n,o,r,l,i,d;e.collections.push({id:null==(s=t.subject)?void 0:s.id,subjectId:b[null==(n=t.subject)?void 0:n.id]||0,title:null==(o=t.subject)?void 0:o.title,cover:(null==(r=t.subject)||null==(l=r.pic)?void 0:l.normal)||"",status:"mark"===t.status?1:"doing"===t.status?2:3,progress:"done"===t.status&&"movie"===(null==(i=t.subject)?void 0:i.type)?"1话":0,content:t.comment||"",score:(null==t||null==(d=t.rating)?void 0:d.value)||0,create_time:t.create_time||"0"})})),t.next=21,(0,x.sleep)();case 21:f="mark"===s?"想看":"doing"===s?"在看":"看过",e.setState({progress:{fetching:!0,message:"正在获取"+f+"收藏",current:o,total:Math.floor(p/l)+1}}),o*l<p?e.fetchDouban(s,o+1):"done"===s?e.fetchDouban("doing",1):"doing"===s?e.fetchDouban("mark",1):(e.onToggleHide(),e.setState({data:{list:e.collections.slice().sort((function(e,t){return(0,x.desc)(e.create_time,t.create_time)})),_loaded:(0,x.getTimestamp)()},progress:S.EXCLUDE_STATE.progress}),(0,x.info)("已获取 "+e.collections.length+" 个收藏"),(0,x.feedback)(),(0,_.t)("豆瓣同步.获取成功",{length:e.collections.length,userId:e.userId}),e.collections=[],e.setStorage(S.NAMESPACE)),t.next=32;break;case 27:t.prev=27,t.t0=t.catch(8),(0,x.info)("获取数据出错，请检查"),(0,x.feedback)(),e.setState({progress:S.EXCLUDE_STATE.progress});case 32:case"end":return t.stop()}}),t,null,[[8,27]])})))),(0,p.default)((0,c.default)(e),"fetchCollection",(o=(0,l.default)(n.mark((function t(s){var o,r;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},t.next=3,(0,j.request)(S.HOST_API+"/collection/"+s);case 3:null!=(r=t.sent)&&r.status?o[s]={status:r.status.type,ep_status:r.ep_status,private:r.private,rating:r.rating,comment:r.comment,loaded:(0,x.getTimestamp)()}:o[s]={loaded:(0,x.getTimestamp)()},e.setState({collections:o}),e.setStorage(S.NAMESPACE);case 7:case"end":return t.stop()}}),t)}))),function(e){return o.apply(this,arguments)})),(0,p.default)((0,c.default)(e),"fetchCollections",(0,l.default)(n.mark((function t(){var s,o,r,i=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=i.length>0&&void 0!==i[0]?i[0]:[],e.userId){t.next=4;break}return(0,x.info)("此功能依赖收藏数据，请先"+v.default.login(),4),t.abrupt("return",!1);case 4:return o={},r=[],s.forEach((function(e){S.LOADED[e]||(S.LOADED[e]=!0,r.push((0,l.default)(n.mark((function t(){var s;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,j.request)(S.HOST_API+"/collection/"+e);case 2:return null!=(s=t.sent)&&s.status?o[e]={status:s.status.type,ep_status:s.ep_status,private:s.private,rating:s.rating,comment:s.comment,loaded:(0,x.getTimestamp)()}:o[e]={loaded:(0,x.getTimestamp)()},t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))))})),t.next=9,(0,_.queue)(r,2);case 9:e.setState({collections:o}),e.setStorage(S.NAMESPACE);case 11:case"end":return t.stop()}}),t)})))),(0,p.default)((0,c.default)(e),"fetchTotalEps",(0,l.default)(n.mark((function t(){var s,o,r=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={},o=[],(r.length>0&&void 0!==r[0]?r[0]:[]).forEach((function(e){S.LOADED_TOTAL_EPS[e]||(S.LOADED_TOTAL_EPS[e]=!0,o.push((0,l.default)(n.mark((function t(){var o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,j.request)(S.HOST_API+"/v0/subjects/"+e+"?responseGroup=small");case 3:(null!=(o=t.sent)&&o.total_episodes||null!=o&&o.eps)&&(s[e]=(null==o?void 0:o.total_episodes)||(null==o?void 0:o.eps)||0),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))))})),t.next=6,(0,_.queue)(o,2);case 6:e.setState({totalEps:s}),e.setStorage(S.NAMESPACE);case 8:case"end":return t.stop()}}),t)})))),(0,p.default)((0,c.default)(e),"onChange",(function(t){e.setState({doubanId:t.trim()})})),(0,p.default)((0,c.default)(e),"onToggleHide",(function(){var t=e.state.hide;e.setState({hide:!t}),e.setStorage(S.NAMESPACE)})),(0,p.default)((0,c.default)(e),"onPage",(function(t){e.fetchCollections(t.filter((function(e){return e.subjectId})).map((function(e){return e.subjectId}))),e.fetchTotalEps(t.filter((function(e){return e.subjectId&&!e.progress&&3===e.status})).map((function(e){return e.subjectId})))})),(0,p.default)((0,c.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,p.default)({current:s},t,s)}),e.setStorage(S.NAMESPACE),(0,_.t)("豆瓣同步.置底")})),(0,p.default)((0,c.default)(e),"onSubmit",(r=(0,l.default)(n.mark((function t(s,o,r){var l;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(o).length){t.next=6;break}return l=e.state.privacy,t.next=6,(0,j.request)(S.HOST_API+"/collection/"+s+"/update",Object.assign({},o,{privacy:l?1:0}));case 6:if(!Object.keys(r).length){t.next=9;break}return t.next=9,(0,j.request)(S.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:r.ep||0});case 9:return t.next=11,e.fetchCollection(s);case 11:(0,x.feedback)(),(0,_.t)("豆瓣同步.同步");case 13:case"end":return t.stop()}}),t)}))),function(e,t,s){return r.apply(this,arguments)})),(0,p.default)((0,c.default)(e),"onToggle",(d=(0,l.default)(n.mark((function t(s){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState((0,p.default)({},s,!e.state[s])),e.setStorage(S.NAMESPACE);case 2:case"end":return t.stop()}}),t)}))),function(e){return d.apply(this,arguments)})),(0,p.default)((0,c.default)(e),"onRefreshCollection",(function(t){e.setState({collections:(0,p.default)({},t,Object.assign({},e.collection(t)||{},{loaded:0}))}),setTimeout((function(){e.fetchCollection(t)}),0)})),e}return(0,d.default)(s,[{key:"doubanId",get:function(){var e,t=this.state.doubanId;return t?t.includes("://")?null==(e=t.split("/people/")[1])?void 0:e.split("/")[0]:t:""}},{key:"userId",get:function(){return y.userStore.usersInfo(y.userStore.myUserId).username||y.userStore.myUserId}},{key:"data",get:function(){var e=this.state,t=e.data,s=e.bottom;return t.list.slice().sort((function(e,t){return(0,x.asc)(s[e.id]||0,s[t.id]||0)})).sort((function(e,t){return(0,x.desc)(e.subjectId?1:0,t.subjectId?1:0)}))}},{key:"matchCount",get:function(){var e=this.state.data,t=0;return e.list.forEach((function(e){e.subjectId&&(t+=1)})),t}},{key:"collection",value:function(e){var t=this;return(0,f.computed)((function(){return t.state.collections[e]})).get()}},{key:"totalEps",value:function(e){var t=this;return(0,f.computed)((function(){return t.state.totalEps[e]||0})).get()}}]),s}(h.default),(0,b.default)(r.prototype,"doubanId",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"doubanId"),r.prototype),(0,b.default)(r.prototype,"userId",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"userId"),r.prototype),(0,b.default)(r.prototype,"data",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"data"),r.prototype),(0,b.default)(r.prototype,"matchCount",[f.computed],Object.getOwnPropertyDescriptor(r.prototype,"matchCount"),r.prototype),r)},"./src/screens/web-view/douban-sync/tips/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$.state.progress,n=s.fetching,r=s.message,i=s.current,d=s.total;return(0,l.jsx)(o.Progress,{show:n,message:r,current:i,total:d})}));try{tips.displayName="tips",tips.__docgenInfo={description:"",displayName:"tips",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/tips/index.tsx#tips"]={docgenInfo:tips.__docgenInfo,name:"tips",path:"src/screens/web-view/douban-sync/tips/index.tsx#tips"})}catch(e){}},"./src/screens/web-view/douban-sync/tool-bar/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("react"));var o=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$,n=s.state,l=n.hideWatched,d=n.hideSame,c=n.hideNotMatched,a=n.noCommentUseCreateDate,u=n.scoreMinuesOne,m=n.privacy;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.ToolBar,{children:[(0,i.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideNotMatched")},children:[(0,i.jsx)(o.Text,{size:11,bold:!0,children:"隐藏未匹配"}),c&&(0,i.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,i.jsx)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideWatched")},children:(0,i.jsxs)(o.Flex,{children:[(0,i.jsx)(o.Text,{size:11,bold:!0,children:"隐藏看过"}),l&&(0,i.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]})}),(0,i.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideSame")},children:[(0,i.jsx)(o.Text,{size:11,bold:!0,children:"隐藏相同状态"}),d&&(0,i.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]})]}),(0,i.jsxs)(o.ToolBar,{children:[(0,i.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("noCommentUseCreateDate")},children:[(0,i.jsx)(o.Text,{size:11,bold:!0,children:"创建时间作为评论"}),a&&(0,i.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,i.jsxs)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("scoreMinuesOne")},children:[(0,i.jsx)(o.Text,{size:11,bold:!0,children:"评分 -1"}),u&&(0,i.jsx)(o.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,i.jsx)(o.ToolBar.Touchable,{onSelect:function(){return s.onToggle("privacy")},children:(0,i.jsxs)(o.Text,{size:11,bold:!0,children:["同步时",m?"私密":"公开"]})})]})]})}));try{toolbar.displayName="toolbar",toolbar.__docgenInfo={description:"",displayName:"toolbar",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/douban-sync/tool-bar/index.tsx#toolbar"]={docgenInfo:toolbar.__docgenInfo,name:"toolbar",path:"src/screens/web-view/douban-sync/tool-bar/index.tsx#toolbar"})}catch(e){}}}]);