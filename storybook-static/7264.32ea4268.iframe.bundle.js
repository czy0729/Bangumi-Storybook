(self.webpackChunkweb=self.webpackChunkweb||[]).push([[7264],{"./src/screens/home/preview/component/ds.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.COMPONENT=void 0;var s=t("./src/utils/dev/index.ts"),o=t("./src/screens/home/preview/ds.ts");r.COMPONENT=(0,s.rc)(o.COMPONENT,"Component")},"./src/screens/home/preview/component/list/ds.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.COMPONENT=void 0;var s=t("./src/utils/dev/index.ts"),o=t("./src/screens/home/preview/component/ds.ts");r.COMPONENT=(0,s.rc)(o.COMPONENT,"List")},"./src/screens/home/preview/component/list/index.tsx":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),t("./node_modules/core-js/modules/es.array.for-each.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),t("./node_modules/core-js/modules/es.string.split.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.array.some.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.object.assign.js");var s=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=s(t("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(s(t("react")),s(t("./node_modules/react-native-web/dist/exports/View/index.js"))),u=t("./src/components/index.ts"),a=t("./src/stores/index.ts"),c=t("./src/utils/index.ts"),l=t("./src/utils/decorators/index.ts"),d=t("./src/constants/index.ts"),i=t("./src/screens/home/preview/component/list/ds.ts"),m=t("./src/screens/home/preview/component/list/styles.tsx"),p=t("./node_modules/react/jsx-runtime.js");r.default=(0,l.obc)((function(e,r){var t,s=r.$,l=r.navigation,i=(0,m.memoStyles)(),f=s.state,h=f.epsThumbs,j=void 0===h?[]:h,b=f.epsThumbsHeader,v=void 0===b?{}:b,y=s.data.length?s.data:j,_=null!=(t=s.headers)&&t.Referer?s.headers:v,x={};return null!=_&&_.Referer&&_.Referer.includes("douban")?(s.data.length&&s.data[0].includes("douban")&&(y=(0,o.default)(s.data)),j.forEach((function(e){var r,t=null==(r=e.split(/public/))?void 0:r[1];if(t){var s=y.some((function(e){return e.includes(t)}));s||y.push(e)}})),x.autoSize=i.item.width,x.fallback=!0):(x.width=i.item.width,x.height=.56*i.item.width,x.fallback=!0),(0,p.jsxs)(u.ScrollView,{contentContainerStyle:a._.container.bottom,scrollToTop:!0,children:[y.map((function(e,r){return(0,p.jsx)(n.default,{style:i.item,children:(0,p.jsx)(u.Touchable,{withoutFeedback:!0,onPress:function(){(0,c.showImageViewer)(y.map((function(e){return{url:e.split("@")[0],headers:_}})),r)},children:(0,p.jsx)(u.Image,Object.assign({},x,{src:e,headers:_,errorToHide:!0}))})},e)})),!(!d.WEB||!s.subjectId)&&(0,p.jsx)(u.Touchable,{style:a._.mt.lg,onPress:function(){l.push("Subject",{subjectId:s.subjectId})},children:(0,p.jsx)(u.Text,{align:"center",underline:!0,children:"返回条目"})})]})}),i.COMPONENT)},"./src/screens/home/preview/component/list/styles.tsx":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.memoStyles=void 0;var s=t("./src/stores/index.ts");r.memoStyles=s._.memoStyles((function(){return{item:{width:s._.window.width-(2*s._.wind-s._._wind),marginLeft:s._.sm,marginBottom:s._.md}}}))},"./src/screens/home/preview/ds.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.COMPONENT=void 0;r.COMPONENT="Preview-V2"},"./src/screens/home/preview/header/ds.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.COMPONENT=void 0;var s=t("./src/utils/dev/index.ts"),o=t("./src/screens/home/preview/ds.ts");r.COMPONENT=(0,s.rc)(o.COMPONENT,"Header")},"./src/screens/home/preview/header/index.tsx":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.function.name.js");var s=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;s(t("react"));var o=t("./src/components/index.ts"),n=t("./src/utils/decorators/index.ts"),u=t("./src/screens/home/preview/header/ds.ts"),a=t("./src/screens/home/preview/header/styles.ts"),c=t("./node_modules/react/jsx-runtime.js");r.default=(0,n.obc)((function(e,r){var t=r.$;return(0,c.jsx)(o.Header,{headerTitleStyle:a.styles.title,title:t.name?t.name+"的预览":"预览",alias:"预览",hm:[t.url,"Preview"]})}),u.COMPONENT)},"./src/screens/home/preview/header/styles.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.styles=void 0;var s=t("./src/stores/index.ts");r.styles=s._.create({title:{paddingLeft:s._.sm,paddingRight:s._.md}})},"./src/screens/home/preview/index.tsx":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var s=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;s(t("react"));var o=t("./src/components/index.ts"),n=t("./src/utils/decorators/index.ts"),u=t("./src/utils/hooks/index.ts"),a=s(t("./src/screens/home/preview/component/list/index.tsx")),c=s(t("./src/screens/home/preview/header/index.tsx")),l=s(t("./src/screens/home/preview/store/index.ts")),d=t("./node_modules/react/jsx-runtime.js");r.default=(0,n.ic)(l.default,(function(e,r){var t=r.$;return(0,u.useRunAfter)((function(){t.init()})),(0,u.useObserver)((function(){return(0,d.jsxs)(o.Component,{id:"screen-preview",children:[(0,d.jsx)(c.default,{}),(0,d.jsx)(o.Page,{loaded:t.state._loaded,children:(0,d.jsx)(a.default,{})})]})}))}))},"./src/screens/home/preview/store/computed.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var s=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o,n=s(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=s(t("./node_modules/@babel/runtime/helpers/createClass.js")),a=s(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=s(t("./node_modules/@babel/runtime/helpers/inherits.js")),l=s(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=s(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=s(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s(t("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),p=t("./node_modules/mobx/dist/mobx.esm.js"),f=t("./src/utils/index.ts"),h=t("./src/constants/index.ts"),j=s(t("./src/screens/home/preview/store/state.ts")),b=t("./src/screens/home/preview/store/ds.ts");function v(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,s=(0,d.default)(e);if(r){var o=(0,d.default)(this).constructor;t=Reflect.construct(s,arguments,o)}else t=s.apply(this,arguments);return(0,l.default)(this,t)}}r.default=(o=function(e){(0,c.default)(t,e);var r=v(t);function t(){var e;(0,n.default)(this,t);for(var s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];return e=r.call.apply(r,[this].concat(o)),(0,i.default)((0,a.default)(e),"save",(function(){return e.saveStorage(e.namespace)})),e}return(0,u.default)(t,[{key:"subjectId",get:function(){return this.params.subjectId}},{key:"namespace",get:function(){return b.NAMESPACE+"|"+this.subjectId}},{key:"name",get:function(){var e,r;return(0,f.cnjp)(null==(e=this.params)?void 0:e.cn,null==(r=this.params)?void 0:r.jp)||""}},{key:"data",get:function(){try{var e=this.params._images;if(e)return JSON.parse(e)}catch(e){}return[]}},{key:"headers",get:function(){try{var e=this.params._headers;if(e)return JSON.parse(e)}catch(e){}return{}}},{key:"url",get:function(){return h.HOST+"/preview/"+this.subjectId}}]),t}(j.default),(0,m.default)(o.prototype,"subjectId",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"subjectId"),o.prototype),(0,m.default)(o.prototype,"namespace",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"namespace"),o.prototype),(0,m.default)(o.prototype,"name",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"name"),o.prototype),(0,m.default)(o.prototype,"data",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"data"),o.prototype),(0,m.default)(o.prototype,"headers",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"headers"),o.prototype),(0,m.default)(o.prototype,"url",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"url"),o.prototype),o)},"./src/screens/home/preview/store/ds.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(r,"__esModule",{value:!0}),r.STATE=r.NAMESPACE=void 0;var s=t("./src/screens/home/preview/ds.ts");r.NAMESPACE="Screen"+s.COMPONENT,r.STATE={epsThumbs:[],epsThumbsHeader:{},_loaded:!1}},"./src/screens/home/preview/store/fetch.ts":(e,r,t)=>{var s=t("./node_modules/@babel/runtime/regenerator/index.js");t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.string.search.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.array.reverse.js"),t("./node_modules/core-js/modules/es.array.slice.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(t("./node_modules/@babel/runtime/helpers/createClass.js")),a=o(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(t("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=t("./src/utils/douban/index.ts"),f=t("./src/utils/kv/index.ts"),h=o(t("./src/screens/home/preview/store/computed.ts"));function j(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,s=(0,i.default)(e);if(r){var o=(0,i.default)(this).constructor;t=Reflect.construct(s,arguments,o)}else t=s.apply(this,arguments);return(0,d.default)(this,t)}}r.default=function(e){(0,l.default)(t,e);var r=j(t);function t(){var e;(0,a.default)(this,t);for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return e=r.call.apply(r,[this].concat(u)),(0,m.default)((0,c.default)(e),"fetchMovieFromDouban",(0,n.default)(s.mark((function r(){var t,o,n,u,a,c,l,d;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=e.params,o=t.cn,n=t.jp,u=t.year,!(a=o||n)){r.next=11;break}return r.next=5,(0,p.search)(a);case 5:return c=r.sent,l=(0,p.matchMovie)(a,c,n,u),r.next=9,(0,p.getPreview)(l,void 0,40);case 9:(d=r.sent).data.length&&(e.setState({epsThumbs:d.data.slice().reverse(),epsThumbsHeader:{Referer:d.referer}}),e.save());case 11:case"end":return r.stop()}}),r)})))),(0,m.default)((0,c.default)(e),"getThirdParty",(0,n.default)(s.mark((function r(){var t,o,n,u,a;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,f.get)("douban_"+e.subjectId);case 3:if(t=r.sent){r.next=6;break}return r.abrupt("return",!0);case 6:return o=t.epsThumbs,n=void 0===o?[]:o,u=t.epsThumbsHeader,a=void 0===u?{}:u,e.setState({epsThumbs:n,epsThumbsHeader:a}),e.save(),r.abrupt("return",!1);case 12:return r.prev=12,r.t0=r.catch(0),r.abrupt("return",!0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))),e}return(0,u.default)(t)}(h.default)},"./src/screens/home/preview/store/index.ts":(e,r,t)=>{var s=t("./node_modules/@babel/runtime/regenerator/index.js");t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.object.assign.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(t("./node_modules/@babel/runtime/helpers/createClass.js")),a=o(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(t("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=t("./src/constants/index.ts");function f(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,s=(0,i.default)(e);if(r){var o=(0,i.default)(this).constructor;t=Reflect.construct(s,arguments,o)}else t=s.apply(this,arguments);return(0,d.default)(this,t)}}var h=function(e){(0,l.default)(t,e);var r=f(t);function t(){var e;(0,a.default)(this,t);for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return e=r.call.apply(r,[this].concat(u)),(0,m.default)((0,c.default)(e),"init",(0,n.default)(s.mark((function r(){return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=e,r.t1=Object,r.t2={},r.next=5,e.getStorage(e.namespace);case 5:r.t3=r.sent,r.t4={_loaded:!0},r.t5=r.t1.assign.call(r.t1,r.t2,r.t3,r.t4),r.t0.setState.call(r.t0,r.t5),e.state.epsThumbs.length||(p.WEB?e.getThirdParty():e.fetchMovieFromDouban());case 10:case"end":return r.stop()}}),r)})))),e}return(0,u.default)(t)}(o(t("./src/screens/home/preview/store/fetch.ts")).default);r.default=h},"./src/screens/home/preview/store/state.ts":(e,r,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js");var s=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=s(t("./node_modules/@babel/runtime/helpers/createClass.js")),n=s(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=s(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=s(t("./node_modules/@babel/runtime/helpers/inherits.js")),c=s(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=s(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),d=s(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=t("./node_modules/mobx/dist/mobx.esm.js"),m=s(t("./src/utils/store/index.ts")),p=t("./src/screens/home/preview/store/ds.ts");function f(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,s=(0,l.default)(e);if(r){var o=(0,l.default)(this).constructor;t=Reflect.construct(s,arguments,o)}else t=s.apply(this,arguments);return(0,c.default)(this,t)}}r.default=function(e){(0,a.default)(t,e);var r=f(t);function t(){var e;(0,n.default)(this,t);for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e=r.call.apply(r,[this].concat(o)),(0,d.default)((0,u.default)(e),"params",void 0),(0,d.default)((0,u.default)(e),"state",(0,i.observable)(p.STATE)),e}return(0,o.default)(t)}(m.default)},"./src/utils/douban/index.ts":(e,r,t)=>{var s=t("./node_modules/@babel/runtime/regenerator/index.js");t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.string.search.js"),t("./node_modules/core-js/modules/es.regexp.exec.js"),t("./node_modules/core-js/modules/es.array.sort.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.array.map.js"),t("./node_modules/core-js/modules/es.array.find.js"),t("./node_modules/core-js/modules/es.string.trim.js"),t("./node_modules/core-js/modules/es.string.match.js"),t("./node_modules/core-js/modules/es.array.for-each.js"),t("./node_modules/core-js/modules/web.dom-collections.for-each.js"),t("./node_modules/core-js/modules/es.function.name.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),t("./node_modules/core-js/modules/es.string.replace.js"),t("./node_modules/core-js/modules/es.string.split.js"),t("./node_modules/core-js/modules/es.number.constructor.js");var o=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(r,"__esModule",{value:!0}),r.getPreview=function(e,r){return b.apply(this,arguments)},r.getTrailer=function(e){return v.apply(this,arguments)},r.getVideo=function(e,r){return y.apply(this,arguments)},r.matchGame=function(e,r){var t=_(e),s=!1;return r.forEach((function(e){s||(0,c.similar)(e.title,t)<.7&&!e.title.includes(t)||(s=e.id)})),r.forEach((function(e){s||e.desc.includes(t)&&(s=e.id)})),s},r.matchMovie=function(e,r,t,s){var o=_(e),n=!1;return r.forEach((function(e){n||s&&e.year&&s!=e.year||e.name&&e.name===t&&(n=e.id)})),r.forEach((function(e){n||s&&e.year&&e.year==s&&e.name&&t&&(0,c.similar)(_(e.name),_(t))>=.7&&(n=e.id)})),r.forEach((function(r){if(!n){if((0,c.similar)(r.title,o)<.7){if(!r.desc.includes("原名:"))return;if(s&&r.year&&s!=r.year)return;var u=r.desc.split(" / ")[0].replace("原名:","");if((0,c.similar)(u,t||e)<.7)return}n=r.id}})),n},r.search=function(e,r){return j.apply(this,arguments)};var n=o(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=t("./src/utils/fetch/index.ts"),a=t("./src/utils/html/index.ts"),c=t("./src/utils/utils/index.ts"),l="https://www.douban.com",d="https://movie.douban.com",i=function(e,r){return l+"/search?cat="+("game"===r?3114:1002)+"&q="+e},m=function(e){return d+"/subject/"+e},p=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"o",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"game"===r?"https://www.douban.com/game/"+e+"/photos/?type=1&start=0&sortby=hot":m(e)+"/photos?type=S&start="+s+"&sortby=time&size=a&subtype="+t},f=function(e){return l+"/"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"subject")+"/"+e+"/videos"},h=function(e){return d+"/subject/"+e+"/trailer"};function j(){return(j=(0,n.default)(s.mark((function e(r,t){var o,n,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,u.xhrCustom)({url:i(r,t)});case 2:return o=e.sent,n=o._response,l=(0,a.cheerio)(n),e.prev=5,e.abrupt("return",(l(".result .content").map((function(e,r){var t,s,o,n=(0,a.cheerio)(r),u=n.find("h3 a"),c=_(n.find(".subject-cast").text().trim())||"";return{id:null==(t=u.attr("onclick").match(/sid: (\d+)/))?void 0:t[1],title:_(u.text().trim()),name:(null==(s=c.match(/原名:(.*?)\//))?void 0:s[1])||"",desc:_(n.find("p").text().trim()),year:(null==(o=c.match(/(\d{4})$/))?void 0:o[1])||""}})).get()||[]).filter((function(e){return e.id})).sort((function(e,t){return(0,c.desc)((0,c.similar)(r,e.title),(0,c.similar)(r,t.title))})));case 9:return e.prev=9,e.t0=e.catch(5),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[5,9]])})))).apply(this,arguments)}function b(){return b=(0,n.default)(s.mark((function e(r,t){var o,n,c,l,d,i,f,h,j,b,v,y,_=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=_.length>2&&void 0!==_[2]?_[2]:12,r){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return n="game"===t,e.next=6,(0,u.xhrCustom)({url:p(r,t,n?void 0:"o")});case 6:if(l=e.sent,c=l._response,!n){e.next=11;break}e.next=26;break;case 11:if(d=(0,a.cheerio)(c)(".cover img"),!((i=d.length)>0&&i<12||0===i)){e.next=17;break}return e.next=15,(0,u.xhrCustom)({url:p(r,t,"a")});case 15:f=e.sent,c=f._response;case 17:if(0===i){e.next=26;break}if(h=c.match(/<span class="count">\(共(\d+)张\)<\/span>/),j=h?Number(h[1]):0,!(b=j>=100?j-50:j>=30?j-30:0)){e.next=26;break}return e.next=24,(0,u.xhrCustom)({url:p(r,t,"a",b)});case 24:v=e.sent,c=v._response;case 26:return y=(0,a.cheerio)(c),e.abrupt("return",{data:(y(n?".pholist img":".cover img").map((function(e,r){var t=(0,a.cheerio)(r).attr("src").replace("http://","https://");return n&&(t=t.replace("/photo/thumb/","/photo/photo/")),t})).get()||[]).filter((function(e,r){return r<o})),referer:m(r)});case 28:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function v(){return v=(0,n.default)(s.mark((function e(r){var t,o,n,c,l,d=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>1&&void 0!==d[1]?d[1]:2,r){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return o=h(r),e.next=6,(0,u.xhrCustom)({url:o});case 6:return n=e.sent,c=n._response,l=(0,a.cheerio)(c),e.abrupt("return",{data:(l(".pr-video").map((function(e,r){var t=(0,a.cheerio)(r);return{cover:t.find("img").attr("src").replace("http://","https://"),title:t.text().trim(),href:t.attr("href")||""}})).get()||[]).filter((function(e,r){return r<t})),referer:o});case 10:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function y(){return y=(0,n.default)(s.mark((function e(r,t){var o,n,d,i,m,p,h,j,b,v,y=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=y.length>2&&void 0!==y[2]?y[2]:3,r){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return n=f(r,t),e.next=6,(0,u.xhrCustom)({url:n});case 6:d=e.sent,i=d._response,m=(0,a.cheerio)(i),p=(m(".video-list li").map((function(e,r){var t,s=(0,a.cheerio)(r),o=s.find("p a");return{cover:s.find("img").attr("src").replace("http://","https://"),title:(null==(t=o.text().trim().split("_哔哩哔哩"))?void 0:t[0])||"",href:o.attr("href")||"",src:""}})).get()||[]).filter((function(e,r){return r<3})),h=0;case 11:if(!(h<p.length)){e.next=23;break}return e.next=14,(0,u.xhrCustom)({url:""+l+p[h].href});case 14:return j=e.sent,b=j._response,e.next=18,(0,c.sleep)(800);case 18:(v=(0,a.cheerio)(b)(".video-player-fallback").attr("href")||"").includes("www.bilibili.com")&&(p[h].src=v);case 20:h+=1,e.next=11;break;case 23:return e.abrupt("return",{data:p.filter((function(e){return e.src})).filter((function(e,r){return r<o})),referer:n});case 24:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function _(e){return String(e).replace(/ |(&amp;)|-|：|《|》|（|）|“|”|，|。|之/g,"").toLocaleLowerCase()}}}]);