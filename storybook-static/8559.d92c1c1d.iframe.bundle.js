(self.webpackChunkweb=self.webpackChunkweb||[]).push([[8559],{"./src/screens/web-view/bilibili-sync/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/utils/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/btn/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.btnStyle,r=void 0===n?void 0:n,a=e.text,c=void 0===a?"同步":a,u=e.type,m=void 0===u?void 0:u,b=e.size,f=void 0===b?11:b,p=e.disabled,y=void 0===p?void 0:p,_=e.loading,x=void 0===_?void 0:_,j=e.onPress,v=void 0===j?void 0:j,h=(0,l.memoStyles)(),g="success"===m&&!y;return(0,d.jsx)(i.Touchable,{style:(0,o.stl)(h.touch,s),onPress:y||x?void 0:v,children:(0,d.jsx)(i.Flex,{style:(0,o.stl)(h.btn,g&&h.btnSuccess,r),justify:"center",children:x?(0,d.jsx)(i.Loading.Mini,{}):(0,d.jsx)(i.Text,{bold:!0,size:f,type:g?"__plain__":void 0,children:c})})})}));try{btn.displayName="btn",btn.__docgenInfo={description:"",displayName:"btn",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},btnStyle:{defaultValue:null,description:"",name:"btnStyle",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},size:{defaultValue:null,description:"",name:"size",required:!1,type:{name:"number"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"any"}},loading:{defaultValue:null,description:"",name:"loading",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/btn/index.tsx#btn"]={docgenInfo:btn.__docgenInfo,name:"btn",path:"src/screens/web-view/bilibili-sync/btn/index.tsx#btn"})}catch(e){}},"./src/screens/web-view/bilibili-sync/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{touch:{width:56,borderRadius:n._.r(28),overflow:"hidden"},btn:{height:n._.r(28),backgroundColor:n._.select(n._.colorBg,n._._colorDarkModeLevel1),borderRadius:n._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/web-view/bilibili-sync/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/stores/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.select,s=e.text,n=e.next;return(0,l.jsxs)(i.Text,{style:o._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,l.jsxs)(i.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",n]})]})}));try{columnbgm.displayName="columnbgm",columnbgm.__docgenInfo={description:"",displayName:"columnbgm",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"any"}},next:{defaultValue:null,description:"",name:"next",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column-bgm/index.tsx#columnbgm"]={docgenInfo:columnbgm.__docgenInfo,name:"columnbgm",path:"src/screens/web-view/bilibili-sync/column-bgm/index.tsx#columnbgm"})}catch(e){}},"./src/screens/web-view/bilibili-sync/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),o=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/column-select/styles.ts"),d=s("./node_modules/react/jsx-runtime.js"),a={top:4,right:32,bottom:4,left:16};t.default=(0,r.ob)((function(e){var t=e.select,s=e.disabled,n=e.onPress;return s?(0,d.jsx)(i.default,{style:l.styles.columnSelect}):(0,d.jsx)(o.Touchable,{style:l.styles.columnSelect,hitSlop:a,onPress:function(){return n(!t)},children:(0,d.jsx)(o.Flex,{style:l.styles.radio,justify:"center",children:(0,d.jsx)(o.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?"rgb(1, 173, 145)":void 0,size:16})})})}));try{columnselect.displayName="columnselect",columnselect.__docgenInfo={description:"",displayName:"columnselect",props:{select:{defaultValue:null,description:"",name:"select",required:!0,type:{name:"any"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column-select/index.tsx#columnselect"]={docgenInfo:columnselect.__docgenInfo,name:"columnselect",path:"src/screens/web-view/bilibili-sync/column-select/index.tsx#columnselect"})}catch(e){}},"./src/screens/web-view/bilibili-sync/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var n=s("./src/stores/index.ts");t.styles=n._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/web-view/bilibili-sync/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/utils/decorators/index.ts"),r=s("./node_modules/react/jsx-runtime.js");t.default=(0,o.ob)((function(e){var t=e.style,s=void 0===t?void 0:t,n=e.type,o=void 0===n?void 0:n,l=e.text,d=void 0===l?void 0:l,a=e.right,c=void 0===a?void 0:a,u=e.onPress,m=void 0===u?void 0:u;return(0,r.jsxs)(i.Flex,{style:s,children:[(0,r.jsx)(i.Text,{size:11,type:d&&"/"!==d?o:"sub",onPress:m,children:d||"__"}),c]})}));try{column.displayName="column",column.__docgenInfo={description:"",displayName:"column",props:{style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"any"}},type:{defaultValue:null,description:"",name:"type",required:!1,type:{name:"any"}},text:{defaultValue:null,description:"",name:"text",required:!1,type:{name:"any"}},right:{defaultValue:null,description:"",name:"right",required:!1,type:{name:"any"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/column/index.tsx#column"]={docgenInfo:column.__docgenInfo,name:"column",path:"src/screens/web-view/bilibili-sync/column/index.tsx#column"})}catch(e){}},"./src/screens/web-view/bilibili-sync/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.MEDIA_SUBJECT=t.LOADED=t.HOST_API=t.EXCLUDE_STATE=void 0;t.NAMESPACE="ScreenBilibili";var n=t.EXCLUDE_STATE={loadedBangumiData:!1};t.STATE=Object.assign({data:{list:[],_loaded:0},reviews:{},collections:{},bottom:{current:0},hide:!1,hideWatched:!1,hideSame:!1,hideNotMatched:!1,privacy:!1},n,{_loaded:!1}),t.HOST_API="https://api.bgm.tv",t.LOADED={},t.MEDIA_SUBJECT={28220978:1424,28235244:330973,28235419:317042,28236365:326868,28236374:333158,28236378:323626,28236382:341077,28236394:344422,28236424:321825,28236579:348666,3846:35861}},"./src/screens/web-view/bilibili-sync/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/screens/_/index.ts"),r=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),a=n(s("./src/constants/i18n/index.ts")),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$,n=t.navigation,l=s.state.hide;return(0,c.jsx)(i.Header,{title:"bilibili 同步",hm:["bilibili-sync","BilibiliSync"],headerRight:function(){return(0,c.jsxs)(i.Flex,{children:[(0,c.jsx)(o.IconTouchable,{style:r._.mr.xs,name:l?"md-refresh":"md-close",color:r._.colorDesc,onPress:s.onToggleHide}),(0,c.jsx)(o.IconTouchable,{name:"md-info-outline",color:r._.colorDesc,size:19,onPress:function(){(0,d.t)("bili同步.关于"),n.push("Information",{title:"bilibili 同步",message:["此功能涉及到第三方平台"+a.default.login()+"，作者保证不会窃取任何个人数据，若有异议请勿使用。","因自动对比的数据存在较大的出错可能，目前不打算做一键提交功能，请手动核实后自行提交。","部分(僅限港澳台地區)的番剧做了最低限度的模糊匹配，若连翻译名称都不一样的基本没可能匹配成功。","网页版不存在此功能，所以此为高级会员功能。此功能开发不易，目前暂时对所有用户开放，觉得有用可支持一下。"],advance:!0})}})]})}})}));try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/web-view/bilibili-sync/header/index.tsx#header"})}catch(e){}},"./src/screens/web-view/bilibili-sync/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/utils/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./src/utils/hooks/index.ts"),d=n(s("./src/screens/web-view/bilibili-sync/header/index.tsx")),a=n(s("./src/screens/web-view/bilibili-sync/list/index.tsx")),c=n(s("./src/screens/web-view/bilibili-sync/login/index.tsx")),u=n(s("./src/screens/web-view/bilibili-sync/store.ts")),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ic)(u.default,(function(e,t){var s=t.$;return(0,l.useMount)((function(){(0,o.runAfter)((function(){s.init()}))})),(0,l.useObserver)((function(){return(0,m.jsxs)(i.Component,{id:"screen-bilibili-sync",children:[(0,m.jsx)(d.default,{}),(0,m.jsxs)(i.Page,{loaded:s.state._loaded,children:[(0,m.jsx)(c.default,{hide:s.state.hide,onToggleHide:s.onToggleHide,setData:s.setData,setReviews:s.setReviews}),(0,m.jsx)(a.default,{})]})]})}))}));try{bilibilisync.displayName="bilibilisync",bilibilisync.__docgenInfo={description:"",displayName:"bilibilisync",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/index.tsx#bilibilisync"]={docgenInfo:bilibilisync.__docgenInfo,name:"bilibilisync",path:"src/screens/web-view/bilibili-sync/index.tsx#bilibilisync"})}catch(e){}},"./src/screens/web-view/bilibili-sync/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.BILIBILI_STATUS=void 0;t.BILIBILI_STATUS={1:"想看",2:"在看",3:"看过"},t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},review:{},collection:{},hideSame:!1,onRefreshCollection:function(){},onBottom:function(){},onSubmit:function(){}}},"./src/screens/web-view/bilibili-sync/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/utils/decorators/index.ts"),o=n(s("./src/screens/web-view/bilibili-sync/item/item.tsx")),r=s("./src/screens/web-view/bilibili-sync/item/styles.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=e.item,n=t.$,i=t.navigation,d=n.state,a=d.hideWatched,c=d.hideSame,u=d.hideNotMatched,m=s.subjectId;if(u&&!m)return null;var b=n.collection(m);return a&&"collect"===(null==b?void 0:b.status)?null:(0,l.jsx)(o.default,{navigation:i,styles:(0,r.memoStyles)(),item:s,review:n.review(s.id),collection:b,hideSame:c,onRefreshCollection:n.onRefreshCollection,onBottom:n.onBottom,onSubmit:n.onSubmit})}))},"./src/screens/web-view/bilibili-sync/item/item.tsx":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.string.replace.js");var i=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),r=i(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=S(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,s&&s.set(e,n),n}(s("./node_modules/react/index.js")),d=i(s("./node_modules/react-native-web/dist/exports/View/index.js")),a=s("./src/components/index.ts"),c=s("./src/components/cover/utils.ts"),u=s("./src/screens/_/index.ts"),m=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),f=s("./src/utils/decorators/index.ts"),p=s("./src/utils/fetch/index.ts"),y=s("./src/constants/index.ts"),_=i(s("./src/screens/web-view/bilibili-sync/btn/index.tsx")),x=i(s("./src/screens/web-view/bilibili-sync/column/index.tsx")),j=i(s("./src/screens/web-view/bilibili-sync/column-bgm/index.tsx")),v=i(s("./src/screens/web-view/bilibili-sync/column-select/index.tsx")),h=s("./src/screens/web-view/bilibili-sync/utils.ts"),g=s("./src/screens/web-view/bilibili-sync/item/ds.ts"),w=s("./node_modules/react/jsx-runtime.js");function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(S=function(e){return e?s:t})(e)}t.default=(0,f.memo)((function(e){var t,s=e.navigation,i=e.styles,f=e.item,S=e.review,T=e.collection,O=e.hideSame,E=e.onRefreshCollection,I=e.onBottom,P=e.onSubmit,C=f.subjectId,R=!!C,A=!(null==T||!T.loaded),L=(null==(t=f.progress.replace("看到","").replace("第","").split(" "))?void 0:t[0])||"",M=(0,l.useState)(!1),D=(0,r.default)(M,2),q=D[0],B=D[1],k=(0,h.useSelectStatus)(f.status,null==T?void 0:T.status),N=(0,r.default)(k,2),V=N[0],H=N[1],Y=(0,h.useSelectEp)(L,null==T?void 0:T.ep_status),z=(0,r.default)(Y,2),F=z[0],K=z[1],W=(0,h.useSelectScore)(null==S?void 0:S.score,null==T?void 0:T.rating),G=(0,r.default)(W,2),U=G[0],J=G[1],$=(0,h.useSelectComment)(null==S?void 0:S.content,null==T?void 0:T.comment),X=(0,r.default)($,2),Q=X[0],Z=X[1],ee={status:g.BILIBILI_STATUS[f.status]||"",ep:L||"",score:(null==S?void 0:S.score)||"",comment:(null==S?void 0:S.content)||""},te={status:y.MODEL_COLLECTION_STATUS.getLabel(null==T?void 0:T.status)||"",ep:(null==T?void 0:T.ep_status)&&T.ep_status+"话",score:(null==T?void 0:T.rating)||"",comment:(null==T?void 0:T.comment)||""};if(O&&ee.status==te.status&&ee.ep==te.ep&&ee.score==te.score&&ee.comment==te.comment)return null;var se={status:g.BILIBILI_STATUS[f.status],ep:(0,h.getSelectEp)(L,null==T?void 0:T.ep_status).value,score:(0,h.getSelectScore)(null==S?void 0:S.score,null==T?void 0:T.rating).value,comment:(0,h.getSelectComment)(null==S?void 0:S.content,null==T?void 0:T.comment).value},ne=function(){R&&s.push("Subject",{subjectId:C,_cn:f.title.replace("（僅限港澳台地區）",""),_image:(0,c.getCoverSrc)(f.cover,y.IMG_WIDTH_SM)})};return(0,w.jsxs)(a.Flex,{style:i.item,align:"start",children:[(0,w.jsx)(u.Cover,{src:f.cover,width:y.IMG_WIDTH_SM,height:y.IMG_HEIGHT_SM,radius:!0,onPress:ne}),(0,w.jsx)(a.Flex.Item,{children:(0,w.jsxs)(a.Flex,{style:i.body,direction:"column",align:"start",children:[(0,w.jsx)(a.Text,{bold:!0,numberOfLines:2,onPress:ne,children:f.title}),(0,w.jsxs)(a.Flex,{style:m._.mt.md,align:"start",children:[(0,w.jsxs)(d.default,{children:[(0,w.jsx)(x.default,{text:" ",type:"sub"}),(0,w.jsx)(x.default,{style:m._.mt.md,text:"状态",type:"sub"}),(0,w.jsx)(x.default,{style:m._.mt.md,text:"进度",type:"sub"}),(0,w.jsx)(x.default,{style:m._.mt.md,text:"评分",type:"sub"}),(0,w.jsx)(x.default,{style:m._.mt.md,text:"点评",type:"sub"})]}),(0,w.jsxs)(a.Flex.Item,{style:m._.ml.md,children:[(0,w.jsx)(x.default,{text:"bilibili",type:"sub"}),(0,w.jsx)(x.default,{style:m._.mt.md,text:ee.status}),(0,w.jsx)(x.default,{style:m._.mt.md,text:ee.ep}),(0,w.jsx)(x.default,{style:m._.mt.md,text:ee.score}),(0,w.jsx)(x.default,{style:m._.mt.md,text:ee.comment,onPress:function(){null!=S&&S.content&&(0,b.copy)(null==S?void 0:S.content,"已复制")}})]}),(0,w.jsxs)(a.Flex.Item,{style:m._.ml.md,flex:1.5,children:[(0,w.jsx)(x.default,{text:"bgm",type:"sub",right:R&&(0,w.jsx)(a.Touchable,{style:m._.ml.xs,hitSlop:g.HIT_SLOP,onPress:function(){return E(C)},children:(0,w.jsx)(a.Iconfont,{name:"md-refresh",size:12})})}),R?A?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.default,{select:V,text:te.status,next:se.status}),(0,w.jsx)(j.default,{select:F,text:te.ep,next:se.ep+"话"}),(0,w.jsx)(j.default,{select:U,text:te.score,next:se.score}),(0,w.jsx)(j.default,{select:Q,text:te.comment,next:se.comment})]}):(0,w.jsx)(a.Flex,{style:i.loading,children:(0,w.jsx)(a.Loading.Mini,{})}):(0,w.jsx)(x.default,{style:m._.mt.md,text:"未找到条目"})]}),R&&(0,w.jsxs)(d.default,{style:i.selectors,children:[(0,w.jsx)(x.default,{text:" ",type:"sub"}),A&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(v.default,{select:V,disabled:!se.status,onPress:H}),(0,w.jsx)(v.default,{select:F,disabled:""===se.ep,onPress:K}),(0,w.jsx)(v.default,{select:U,disabled:!se.score,onPress:J}),(0,w.jsx)(v.default,{select:Q,disabled:!se.comment,onPress:Z})]})]})]}),(0,w.jsx)(d.default,{style:i.toolbar,children:(0,w.jsxs)(a.Flex,{style:m._.mt.md,children:[(0,w.jsx)(a.Flex.Item,{children:(0,w.jsxs)(a.Flex,{children:[(0,w.jsx)(_.default,{text:"详情",onPress:function(){(0,p.t)("bili同步.详情"),(0,b.open)("https://www.bilibili.com/bangumi/media/md"+f.id)}}),(0,w.jsx)(_.default,{style:m._.ml.sm,text:"搜索",onPress:function(){(0,p.t)("bili同步.搜索"),s.push("Search",{type:"动画",value:f.title.replace("（僅限港澳台地區）","")})}}),(0,w.jsx)(_.default,{style:m._.ml.sm,text:"置底",onPress:function(){return I(f.id)}})]})}),R&&(0,w.jsx)(_.default,{style:m._.ml.md,type:"success",disabled:!A||!(V||F||U||Q),loading:q,onPress:(0,o.default)(n.mark((function e(){var t,s,i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},s={},V?"想看"===se.status?(t.status=!0,s.status="wish"):"看过"===se.status?(t.status=!0,s.status="collect"):"在看"===se.status&&(t.status=!0,s.status="do"):te.status&&(t.status=!0,s.status=y.MODEL_COLLECTION_STATUS.getValue(te.status)),U&&(t.score=!0,s.rating=se.score),Q&&(t.comment=!0,s.comment=se.comment),i={},F&&(t.ep=!0,i.ep=se.ep),B(!0),e.next=10,P(C,s,i);case 10:B(!1),t.status&&H(!1),t.ep&&K(!1),t.score&&J(!1),t.comment&&Z(!1);case 15:case"end":return e.stop()}}),e)})))})]})})]})})]})}),g.DEFAULT_PROPS);try{item.displayName="item",item.__docgenInfo={description:"",displayName:"item",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},styles:{defaultValue:null,description:"",name:"styles",required:!0,type:{name:"{ item: { paddingRight: number; paddingLeft: number; paddingVertical: number; marginBottom: number; }; body: { paddingLeft: number; }; selectors: { width: number; }; toolbar: { width: string; paddingRight: number; marginTop: number; }; loading: { ...; }; }"}},item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},review:{defaultValue:null,description:"",name:"review",required:!0,type:{name:"any"}},collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"any"}},hideSame:{defaultValue:null,description:"",name:"hideSame",required:!0,type:{name:"boolean"}},onRefreshCollection:{defaultValue:null,description:"",name:"onRefreshCollection",required:!0,type:{name:"(subjectId: any) => void"}},onBottom:{defaultValue:null,description:"",name:"onBottom",required:!0,type:{name:"(mediaId: any) => void"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!0,type:{name:"(subjectId: any, collectionData: any, epData: any) => Promise<boolean>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/item/item.tsx#item"]={docgenInfo:item.__docgenInfo,name:"item",path:"src/screens/web-view/bilibili-sync/item/item.tsx#item"})}catch(e){}},"./src/screens/web-view/bilibili-sync/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{item:{paddingRight:n._.wind-n._._wind,paddingLeft:n._.wind,paddingVertical:n._.md,marginBottom:n._.sm},body:{paddingLeft:n._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:n._._wind,marginTop:n._.xs},loading:{marginTop:13}}}))},"./src/screens/web-view/bilibili-sync/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/screens/_/index.ts"),o=s("./src/stores/index.ts"),r=s("./src/utils/decorators/index.ts"),l=n(s("./src/screens/web-view/bilibili-sync/tool-bar/index.tsx")),d=n(s("./src/screens/web-view/bilibili-sync/item/index.tsx")),a=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$;return(0,a.jsx)(i.PaginationList2,{contentContainerStyle:o._.container.bottom,data:s.data,limit:12,ListHeaderComponent:(0,a.jsx)(l.default,{}),renderItem:function(e){var t=e.item;return(0,a.jsx)(d.default,{item:t})},onPage:s.onPage})}));try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/web-view/bilibili-sync/list/index.tsx#list"})}catch(e){}},"./src/screens/web-view/bilibili-sync/login/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.string.fixed.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=x(t);if(s&&s.has(e))return s.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,s&&s.set(e,n),n}(s("./node_modules/react/index.js")),r=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),l=s("./node_modules/react-native-webview/index.js"),d=s("./src/components/index.ts"),a=s("./src/stores/index.ts"),c=s("./src/utils/index.ts"),u=s("./src/utils/hooks/index.ts"),m=s("./src/utils/fetch/index.ts"),b=n(s("./src/constants/i18n/index.ts")),f=n(s("./src/screens/web-view/bilibili-sync/btn/index.tsx")),p=s("./src/screens/web-view/bilibili-sync/login/utils.ts"),y=s("./src/screens/web-view/bilibili-sync/login/styles.ts"),_=s("./node_modules/react/jsx-runtime.js");function x(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(x=function(e){return e?s:t})(e)}var j;function v(e){var t=e.hide,s=e.onToggleHide,n=e.setData,x=e.setReviews,v=(0,o.useState)(0),h=(0,i.default)(v,2),g=h[0],w=h[1],S=(0,o.useState)("检查状态中..."),T=(0,i.default)(S,2),O=T[0],E=T[1],I=(0,o.useCallback)((function(e){var t,s=JSON.parse(e.nativeEvent.data),i=s.type,o=s.data;switch(i){case p.TYPE_CHECK_LOGIN:E(null!=o&&null!=(t=o.data)&&t.isLogin?"已"+b.default.login():"检查"+b.default.login()+"状态失败，请先"+b.default.login());break;case p.TYPE_GET_LIST:E("已获取番剧列表"),n(o),j=o.length;break;case p.TYPE_GET_REVIEW:E("已获取"+j+"个番剧信息，请收起"+b.default.login()+"框进行操作"),x(o)}}),[n,x]),P=(0,o.useCallback)((function(){E("检查状态中..."),w(g+1),(0,m.t)("bili同步.获取数据")}),[g]);return(0,u.useObserver)((function(){var e=(0,y.memoStyles)();return(0,_.jsxs)(_.Fragment,{children:[!t&&(0,_.jsx)(r.default,{style:e.mask}),(0,_.jsxs)(r.default,{style:(0,c.stl)(e.fixed,t&&e.hide),children:[(0,_.jsx)(r.default,{style:e.container,children:(0,_.jsx)(l.WebView,{source:{uri:"https://m.bilibili.com/space?from=headline"},containerStyle:[e.webview,t&&e.webviewHide],androidHardwareAccelerationDisabled:!0,androidLayerType:"software",javaScriptEnabled:!0,injectedJavaScript:(0,p.injectedJavaScript)(),onMessage:I},g)}),(0,_.jsxs)(r.default,{style:e.body,children:[(0,_.jsx)(d.Text,{bold:!0,size:15,children:O}),(0,_.jsx)(d.Text,{style:a._.mt.md,size:11,type:"sub",children:"若上方网页白屏请多刷新几次。"}),(0,_.jsx)(d.Text,{style:a._.mt.sm,size:11,type:"sub",children:"因 bilibili 对鉴权信息做了保护加密，目前同步番剧需要通过在WebView内部发起带鉴权的请求，获得数据后通知APP。"}),(0,_.jsxs)(d.Text,{style:a._.mt.sm,size:11,type:"sub",children:["完成同步前需要一直保持bilibil",b.default.login(),"状态，完成后你可以手动登出账号。"]}),(0,_.jsxs)(d.Flex,{style:a._.mt.md,justify:"center",children:[(0,_.jsx)(f.default,{style:e.btn,btnStyle:e.btnStyle,text:"重新获取数据",size:13,onPress:P}),(0,_.jsx)(f.default,{style:[e.btn,a._.ml.lg],btnStyle:e.btnStyle,text:"收起"+b.default.login()+"框",size:13,onPress:s})]})]})]})]})}))}t.default=v;try{v.displayName="Login",v.__docgenInfo={description:"",displayName:"Login",props:{hide:{defaultValue:null,description:"",name:"hide",required:!0,type:{name:"any"}},onToggleHide:{defaultValue:null,description:"",name:"onToggleHide",required:!0,type:{name:"any"}},setData:{defaultValue:null,description:"",name:"setData",required:!0,type:{name:"any"}},setReviews:{defaultValue:null,description:"",name:"setReviews",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/login/index.tsx#Login"]={docgenInfo:v.__docgenInfo,name:"Login",path:"src/screens/web-view/bilibili-sync/login/index.tsx#Login"})}catch(e){}},"./src/screens/web-view/bilibili-sync/login/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var n=s("./src/stores/index.ts");t.memoStyles=n._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:n._.wind,width:n._.window.contentWidth,backgroundColor:n._.select(n._.colorPlain,n._._colorDarkModeLevel2),borderRadius:n._.radiusMd,shadowColor:n._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:n._.select(16,0)},hide:{top:n._.sm,right:n._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},container:{minHeight:400,borderRadius:n._.radiusMd,overflow:"hidden"},webview:{borderRadius:n._.radiusMd,overflow:"hidden"},webviewHide:{opacity:.01},body:{paddingTop:20,paddingHorizontal:n._.md,paddingBottom:28},iconToggle:{position:"absolute",zIndex:2,top:1,right:0},btn:{width:128},btnStyle:{height:40}}}))},"./src/screens/web-view/bilibili-sync/login/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE_GET_REVIEW=t.TYPE_GET_LIST=t.TYPE_CHECK_LOGIN=void 0,t.injectedJavaScript=function(){return"(function() {\n    setTimeout(() => {\n      /* webview的postMessage不是马上生效的 */\n      let __timeoutId = null;\n      let __isBridgeOk = false;\n\n      function waitForBridge() {\n        if (!__isBridgeOk && !window.ReactNativeWebView.postMessage) {\n          __timeoutId = setTimeout(waitForBridge, 400);\n        } else {\n          clearTimeout(__timeoutId);\n          __timeoutId = null;\n          __isBridgeOk = true;\n\n          setTimeout(() => {\n            function xhr({ method = 'get', url } = {}) {\n    return new Promise(resolve => {\n      const request = new XMLHttpRequest()\n      request.onreadystatechange = function () {\n        if (this.readyState === 4) {\n          if (this.status === 200 || this.status === 201) {\n            resolve(JSON.parse(this.responseText))\n          }\n\n          if (this.status === 404 || this.status === 500) {\n            resolve(null)\n          }\n        }\n      }\n      request.onerror = function () {\n        resolve(null)\n      }\n      request.ontimeout = function () {\n        resolve(null)\n      }\n      request.onabort = function () {\n        resolve(null)\n      }\n      request.open(method, url, true)\n      request.withCredentials = true\n      request.send(null)\n    })\n  }\n\n  function postMessage(type, data) {\n    window.ReactNativeWebView.postMessage(JSON.stringify({ type, data }))\n  }\n\n  function ts() {\n    return String(new Date()/1);\n  }\n\n  function queue(fetchs) {\n    return new Promise(resolve => {\n      function cb() {\n        if (!fetchs.length) {\n          resolve(true);\n          return;\n        }\n\n        const fetch = fetchs.shift();\n        fetch().then(() => cb(fetchs));\n      }\n      cb();\n    });\n  };\n            function checkLogin() {\n    xhr({\n      url: 'https://api.bilibili.com/x/web-interface/nav'\n    }).then(data => {\n      if (data) postMessage('"+n+"', data);\n      if (data && data.data && data.data.isLogin) {\n        getList(data.data.wallet.mid);\n      }\n    });\n  };\n            const list = [];\n    const limit = 15;\n    let page = 1;\n    function getList(mid) {\n      xhr({\n        url: 'https://api.bilibili.com/x/space/bangumi/follow/list?type=1&follow_status=0&pn='+page+'&ps='+limit+'&vmid='+String(mid)+'&ts='+ts()\n      }).then(data => {\n        if (data && data.data && data.data.list) {\n          data.data.list.forEach(item => {\n            list.push({\n              id: item.media_id,\n              title: item.title,\n              cover: item.cover,\n              status: item.follow_status,\n              progress: item.progress,\n              total: item.total_count\n            });\n          });\n\n          if (data.data.list.length >= limit) {\n            page += 1;\n            getList(mid);\n          } else {\n            postMessage('"+i+"', list);\n\n            const mediaIds = list.map(item => item.id);\n            getReviews(mediaIds);\n          }\n        }\n      });\n    };\n            function getReviews(mediaIds) {\n    const reviews = {};\n    const fetchs = [];\n    mediaIds.forEach(mediaId => {\n      fetchs.push(() => {\n        return new Promise(resolve => {\n          xhr({\n            url: 'https://api.bilibili.com/pgc/review/user?media_id='+String(mediaId)+'&ts='+ts()\n          }).then(data => {\n            if (data && data.result && data.result.review && data.result.review.short_review) {\n              const { short_review } = data.result.review;\n              reviews[mediaId] = {\n                score: short_review.score || 0,\n                content: short_review.content || ''\n              };\n            }\n            resolve(true);\n          });\n        });\n      });\n    });\n\n    queue(fetchs).then(() => {\n      postMessage('"+o+"', reviews);\n    });\n  };\n            checkLogin();\n          }, 4000);\n        }\n      }\n\n      waitForBridge();\n    }, 1000);\n  }());"};var n=t.TYPE_CHECK_LOGIN="CHECK_LOGIN",i=t.TYPE_GET_LIST="GET_LIST",o=t.TYPE_GET_REVIEW="GET_REVIEW"},"./src/screens/web-view/bilibili-sync/store.ts":(e,t,s)=>{var n=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.find.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var i=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=i(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=i(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=i(s("./node_modules/@babel/runtime/helpers/createClass.js")),a=i(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=i(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=i(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=i(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),b=i(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=i(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),p=s("./node_modules/mobx/dist/mobx.esm.js"),y=s("./src/stores/index.ts"),_=s("./src/utils/index.ts"),x=i(s("./src/utils/store/index.ts")),j=s("./src/utils/fetch/index.ts"),v=s("./src/utils/fetch.v0/index.ts"),h=s("./src/utils/protobuf/index.web.ts"),g=s("./src/utils/thirdParty/cn-char/index.ts"),w=i(s("./src/constants/i18n/index.ts")),S=s("./src/screens/web-view/bilibili-sync/ds.ts");function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,n=(0,m.default)(e);if(t){var i=(0,m.default)(this).constructor;s=Reflect.construct(n,arguments,i)}else s=n.apply(this,arguments);return(0,u.default)(this,s)}}t.default=(o=function(e){(0,c.default)(s,e);var t=T(s);function s(){var e,i,o,d;(0,l.default)(this,s);for(var c=arguments.length,u=new Array(c),m=0;m<c;m++)u[m]=arguments[m];return e=t.call.apply(t,[this].concat(u)),(0,b.default)((0,a.default)(e),"state",(0,p.observable)(S.STATE)),(0,b.default)((0,a.default)(e),"init",(0,r.default)(n.mark((function t(){var s,i,o,r;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(S.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,e.setState(Object.assign({},r,{hide:!(null==r||null==(s=r.data)||null==(i=s.list)||!i.length),loadedBangumiData:!(null==(o=(0,h.get)("bangumi-data"))||!o.length),_loaded:!0})),e.fetchBangumiData();case 8:case"end":return t.stop()}}),t)})))),(0,b.default)((0,a.default)(e),"fetchBangumiData",(0,r.default)(n.mark((function t(){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.loadedBangumiData){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,h.decode)("bangumi-data");case 4:e.setState({loadedBangumiData:!0});case 5:case"end":return t.stop()}}),t)})))),(0,b.default)((0,a.default)(e),"fetchCollection",(i=(0,r.default)(n.mark((function t(s){var i,o;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={},t.next=3,(0,v.request)(S.HOST_API+"/collection/"+s);case 3:null!=(o=t.sent)&&o.status?i[s]={status:o.status.type,ep_status:o.ep_status,private:o.private,rating:o.rating,comment:o.comment,loaded:(0,_.getTimestamp)()}:i[s]={loaded:(0,_.getTimestamp)()},e.setState({collections:i}),e.setStorage(S.NAMESPACE);case 7:case"end":return t.stop()}}),t)}))),function(e){return i.apply(this,arguments)})),(0,b.default)((0,a.default)(e),"fetchCollections",(0,r.default)(n.mark((function t(){var s,i,o,l=arguments;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=l.length>0&&void 0!==l[0]?l[0]:[],e.userId){t.next=4;break}return(0,_.info)("此功能依赖收藏数据，请先"+w.default.login(),4),t.abrupt("return",!1);case 4:return i={},o=[],s.forEach((function(e){S.LOADED[e]||(S.LOADED[e]=!0,o.push((0,r.default)(n.mark((function t(){var s;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,v.request)(S.HOST_API+"/collection/"+e);case 2:return null!=(s=t.sent)&&s.status?i[e]={status:s.status.type,ep_status:s.ep_status,private:s.private,rating:s.rating,comment:s.comment,loaded:(0,_.getTimestamp)()}:i[e]={loaded:(0,_.getTimestamp)()},t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))))})),t.next=9,(0,j.queue)(o,2);case 9:e.setState({collections:i}),e.setStorage(S.NAMESPACE);case 11:case"end":return t.stop()}}),t)})))),(0,b.default)((0,a.default)(e),"onToggleHide",(function(){var t=e.state.hide;e.setState({hide:!t})})),(0,b.default)((0,a.default)(e),"onPage",(function(t){var s=t.filter((function(e){return e.subjectId})).map((function(e){return e.subjectId}));e.fetchCollections(s)})),(0,b.default)((0,a.default)(e),"setData",(function(t){e.setState({data:{list:t.map((function(e){var t;return Object.assign({subjectId:S.MEDIA_SUBJECT[e.id]||(null==(t=((0,h.get)("bangumi-data")||[]).find((function(t){var s,n,i=(null==t||null==(s=t.s)?void 0:s.b)===e.id;return i||(i=(null==t||null==(n=t.s)?void 0:n.bhmt)===e.id),i||(i=e.title.includes("（僅限港澳台地區）")?(null==t?void 0:t.c)===(0,g.t2s)(e.title.replace("（僅限港澳台地區）","")):(null==t?void 0:t.c)===e.title),i})))?void 0:t.id)||""},e)})),_loaded:(0,_.getTimestamp)()}}),e.setStorage(S.NAMESPACE),(0,j.t)("bili同步.获取成功",{length:t.length,userId:e.userId})})),(0,b.default)((0,a.default)(e),"setReviews",(function(t){e.setState({reviews:t}),e.setStorage(S.NAMESPACE)})),(0,b.default)((0,a.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,b.default)({current:s},t,s)}),e.setStorage(S.NAMESPACE),(0,j.t)("bili同步.置底")})),(0,b.default)((0,a.default)(e),"onSubmit",(o=(0,r.default)(n.mark((function t(s,i,o){var r;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(i).length){t.next=6;break}return r=e.state.privacy,t.next=6,(0,v.request)(S.HOST_API+"/collection/"+s+"/update",Object.assign({},i,{privacy:r?1:0}));case 6:if(!Object.keys(o).length){t.next=9;break}return t.next=9,(0,v.request)(S.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:o.ep||0});case 9:return t.next=11,e.fetchCollection(s);case 11:(0,_.feedback)(),(0,j.t)("bili同步.同步");case 13:case"end":return t.stop()}}),t)}))),function(e,t,s){return o.apply(this,arguments)})),(0,b.default)((0,a.default)(e),"onToggle",(d=(0,r.default)(n.mark((function t(s){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState((0,b.default)({},s,!e.state[s])),e.setStorage(S.NAMESPACE);case 2:case"end":return t.stop()}}),t)}))),function(e){return d.apply(this,arguments)})),(0,b.default)((0,a.default)(e),"onRefreshCollection",(function(t){e.setState({collections:(0,b.default)({},t,Object.assign({},e.collection(t)||{},{loaded:0}))}),setTimeout((function(){e.fetchCollection(t)}),0)})),e}return(0,d.default)(s,[{key:"userId",get:function(){return y.userStore.usersInfo(y.userStore.myUserId).username||y.userStore.myUserId}},{key:"data",get:function(){var e=this.state,t=e.data,s=e.bottom;return t.list.slice().sort((function(e,t){return(0,_.asc)(s[e.id]||0,s[t.id]||0)})).sort((function(e,t){return(0,_.desc)(e.subjectId?1:0,t.subjectId?1:0)}))}},{key:"review",value:function(e){var t=this;return(0,p.computed)((function(){return t.state.reviews[e]})).get()}},{key:"collection",value:function(e){var t=this;return(0,p.computed)((function(){return t.state.collections[e]})).get()}}]),s}(x.default),(0,f.default)(o.prototype,"userId",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"userId"),o.prototype),(0,f.default)(o.prototype,"data",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"data"),o.prototype),o)},"./src/screens/web-view/bilibili-sync/tool-bar/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(s("./node_modules/react/index.js"));var i=s("./src/components/index.ts"),o=s("./src/stores/index.ts"),r=s("./src/utils/decorators/index.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$,n=s.state,r=n.hideWatched,d=n.hideSame,a=n.hideNotMatched,c=n.privacy;return(0,l.jsxs)(i.ToolBar,{children:[(0,l.jsxs)(i.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideNotMatched")},children:[(0,l.jsx)(i.Text,{size:11,bold:!0,children:"隐藏未匹配"}),a&&(0,l.jsx)(i.Iconfont,{style:[o._.ml.xs,o._.mr._xs],name:"md-check",size:11,color:o._.colorDesc})]}),(0,l.jsx)(i.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideWatched")},children:(0,l.jsxs)(i.Flex,{children:[(0,l.jsx)(i.Text,{size:11,bold:!0,children:"隐藏看过"}),r&&(0,l.jsx)(i.Iconfont,{style:[o._.ml.xs,o._.mr._xs],name:"md-check",size:11,color:o._.colorDesc})]})}),(0,l.jsxs)(i.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideSame")},children:[(0,l.jsx)(i.Text,{size:11,bold:!0,children:"隐藏相同"}),d&&(0,l.jsx)(i.Iconfont,{style:[o._.ml.xs,o._.mr._xs],name:"md-check",size:11,color:o._.colorDesc})]}),(0,l.jsx)(i.ToolBar.Touchable,{onSelect:function(){return s.onToggle("privacy")},children:(0,l.jsx)(i.Text,{size:11,bold:!0,children:c?"私密":"公开"})})]})}));try{toolbar.displayName="toolbar",toolbar.__docgenInfo={description:"",displayName:"toolbar",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/web-view/bilibili-sync/tool-bar/index.tsx#toolbar"]={docgenInfo:toolbar.__docgenInfo,name:"toolbar",path:"src/screens/web-view/bilibili-sync/tool-bar/index.tsx#toolbar"})}catch(e){}},"./src/screens/web-view/bilibili-sync/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectComment=c,t.getSelectEp=d,t.getSelectScore=a,t.getSelectStatus=l,t.useSelectComment=function(e,t){var s=(0,o.useState)(c(e,t).select),n=(0,i.default)(s,2),r=n[0],l=n[1];return(0,o.useEffect)((function(){l(c(e,t).select)}),[e,t]),[r,l]},t.useSelectEp=function(e,t){var s=(0,o.useState)(d(e,t).select),n=(0,i.default)(s,2),r=n[0],l=n[1];return(0,o.useEffect)((function(){l(d(e,t).select)}),[e,t]),[r,l]},t.useSelectScore=function(e,t){var s=(0,o.useState)(a(e,t).select),n=(0,i.default)(s,2),r=n[0],l=n[1];return(0,o.useEffect)((function(){l(a(e,t).select)}),[e,t]),[r,l]},t.useSelectStatus=function(e,t){var s=(0,o.useState)(l(e,t).select),n=(0,i.default)(s,2),r=n[0],d=n[1];return(0,o.useEffect)((function(){d(l(e,t).select)}),[e,t]),[r,d]};var i=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),o=s("./node_modules/react/index.js"),r=s("./src/constants/index.ts");function l(e,t){var s=Number(e||0),n=Number(r.MODEL_COLLECTION_STATUS.getTitle(t)||0);return 3===n?n=2:2===n&&(n=3),{select:!(n>=3)&&s>n,value:s}}function d(e,t){var s,n=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:n>Number(t||0),value:n}}function a(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function c(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}}}]);