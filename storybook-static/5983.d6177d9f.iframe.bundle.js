(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5983],{"./src/screens/rakuen/search/component/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/rakuen/search/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"Component")},"./src/screens/rakuen/search/component/history/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"History")},"./src/screens/rakuen/search/component/history/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.array.map.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),o=t("./src/components/index.ts"),c=t("./src/utils/decorators/index.ts"),a=t("./src/screens/rakuen/search/component/history/ds.ts"),d=t("./src/screens/rakuen/search/component/history/styles.ts"),l=t("./node_modules/react/jsx-runtime.js");s.default=(0,c.obc)((function(e,s){var t=e.style,r=s.$;if(""!==r.state.value)return null;var c=(0,d.memoStyles)();return(0,l.jsxs)(n.default,{style:t,children:[r.state.history.map((function(e){return(0,l.jsx)(n.default,{style:c.item,children:(0,l.jsxs)(o.Flex,{style:c.content,children:[(0,l.jsx)(o.Flex.Item,{children:(0,l.jsx)(o.Text,{size:15,bold:!0,onPress:function(){return r.selectHistory(e)},children:e})}),(0,l.jsx)(o.Touchable,{style:c.close,onPress:function(){return r.deleteHistory(e)},children:(0,l.jsx)(o.Iconfont,{name:"md-close"})})]})},e)})),(0,l.jsx)(o.Heatmap,{right:52,id:"帖子搜索.选择历史"}),(0,l.jsx)(o.Heatmap,{id:"帖子搜索.删除历史",transparent:!0})]})}),a.COMPONENT)},"./src/screens/rakuen/search/component/history/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{item:{paddingHorizontal:r._.wind},content:{paddingVertical:r._.sm},close:{padding:r._.sm,marginLeft:r._.md,marginRight:-r._.sm}}}))},"./src/screens/rakuen/search/component/item/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.LENGTH=s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"Item"),s.LENGTH=240},"./src/screens/rakuen/search/component/item/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.array.index-of.js"),t("./node_modules/core-js/modules/es.array.slice.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),o=t("./src/components/index.ts"),c=t("./src/screens/_/index.ts"),a=t("./src/stores/index.ts"),d=t("./src/utils/index.ts"),l=t("./src/utils/decorators/index.ts"),u=t("./src/utils/fetch/index.ts"),i=t("./src/screens/rakuen/search/component/item/ds.ts"),m=t("./src/screens/rakuen/search/component/item/styles.ts"),p=t("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var t=e.index,r=e.id,l=e.title,f=e.message,h=e.avatar,j=e.userId,b=e.userName,y=e.time,_=e.group,x=s.$,v=s.navigation,g=(0,m.memoStyles)(),O=x.state.value,k=f.indexOf(O),P=k<i.LENGTH?f.slice(0,i.LENGTH):f.slice(48,i.LENGTH+k-48);return(0,p.jsxs)(n.default,{style:g.item,children:[!!t&&(0,p.jsx)(o.Divider,{}),(0,p.jsx)(o.Touchable,{style:g.touch,onPress:function(){(0,u.t)("帖子搜索.跳转",{to:"Topic",topicId:"group/"+r}),v.push("Topic",{topicId:"group/"+r})},children:(0,p.jsxs)(o.Flex,{align:"start",children:[(0,p.jsx)(c.Avatar,{src:h,userId:j}),(0,p.jsxs)(o.Flex.Item,{style:a._.ml.sm,children:[(0,p.jsx)(o.Highlight,{size:16,bold:!0,value:O,children:l}),(0,p.jsxs)(o.Text,{style:a._.mt.xs,type:"sub",size:12,children:[(0,d.lastDate)((0,d.getTimestamp)(y))," / ",b," / ",_]})]})]})}),(0,p.jsx)(o.Highlight,{lineHeight:16,value:O,children:P}),!t&&(0,p.jsx)(o.Heatmap,{id:"帖子搜索.跳转"})]})}),i.COMPONENT)},"./src/screens/rakuen/search/component/item/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{item:{paddingHorizontal:r._.wind,paddingBottom:r._.md,backgroundColor:r._.colorPlain},touch:{paddingVertical:r._.md}}}))},"./src/screens/rakuen/search/component/list/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"List")},"./src/screens/rakuen/search/component/list/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.object.assign.js"),t("./node_modules/core-js/modules/es.string.search.js"),t("./node_modules/core-js/modules/es.regexp.exec.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n=r(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),o=r(t("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=r(t("./node_modules/@babel/runtime/helpers/inherits.js")),d=r(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=r(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),u=r(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=r(t("react")),m=t("./src/components/index.ts"),p=t("./src/stores/index.ts"),f=t("./src/utils/index.ts"),h=t("./src/utils/decorators/index.ts"),j=t("./src/utils/dev/index.ts"),b=r(t("./src/screens/rakuen/search/component/item/index.tsx")),y=t("./src/screens/rakuen/search/component/list/ds.ts"),_=t("./node_modules/react/jsx-runtime.js");function x(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,l.default)(e);if(s){var n=(0,l.default)(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return(0,d.default)(this,t)}}var v=function(e){(0,a.default)(t,e);var s=x(t);function t(){var e;(0,n.default)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return e=s.call.apply(s,[this].concat(o)),(0,u.default)((0,c.default)(e),"renderItem",(function(e){var s=e.item,t=e.index;return(0,_.jsx)(b.default,Object.assign({index:t},s))})),e}return(0,o.default)(t,[{key:"render",value:function(){(0,j.r)(y.COMPONENT);var e=this.context.$;if(e.state.searching)return(0,_.jsx)(m.Loading,{style:p._.container.flex});if(!e.search._loaded)return null;var s=e.search._filter,t=(void 0===s?0:s)>0?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(m.Text,{style:p._.mt.lg,type:"sub",align:"center",size:13,bold:!0,children:"非会员只显示 8 条结果"}),(0,_.jsx)(m.Text,{style:p._.mt.xs,type:"sub",align:"center",size:13,bold:!0,children:"高级会员显示 20 条结果"})]}):void 0;return(0,_.jsx)(m.ListView,{contentContainerStyle:p._.container.bottom,keyExtractor:f.keyExtractor,data:e.search,renderItem:this.renderItem,ListFooterComponent:t})}}]),t}(i.default.Component);s.default=(0,h.obc)(v)},"./src/screens/rakuen/search/component/search-bar/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var r=t("./src/utils/dev/index.ts"),n=t("./src/screens/rakuen/search/component/ds.ts");s.COMPONENT=(0,r.rc)(n.COMPONENT,"SearchBar")},"./src/screens/rakuen/search/component/search-bar/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=t("./src/components/index.ts"),o=t("./src/utils/decorators/index.ts"),c=t("./src/screens/rakuen/search/component/search-bar/ds.ts"),a=t("./src/screens/rakuen/search/component/search-bar/styles.ts"),d=t("./node_modules/react/jsx-runtime.js");s.default=(0,o.obc)((function(e,s){var t=s.$,r=(0,a.memoStyles)();return(0,d.jsx)(n.Input,{style:r.searchIpt,value:t.state.value,returnKeyType:"search",returnKeyLabel:"搜索",placeholder:"输入关键字，多关键字空格隔开",autoFocus:!0,onChange:t.onChange,onSubmitEditing:t.doSearch})}),c.COMPONENT)},"./src/screens/rakuen/search/component/search-bar/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{searchIpt:Object.assign({height:40,paddingRight:20,paddingLeft:20},r._.fontSize12,{backgroundColor:r._.select(r._.colorBg,r._._colorDarkModeLevel1),borderRadius:34})}}))},"./src/screens/rakuen/search/ds.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var r=s.COMPONENT="RakuenSearch",n=(s.NAMESPACE="Screen"+r,s.EXCLUDE_STATE={value:"",searching:!1,cache:{}});s.STATE=Object.assign({history:[]},n,{_loaded:!1})},"./src/screens/rakuen/search/index.tsx":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js");var r=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;r(t("react"));var n=r(t("./node_modules/react-native-web/dist/exports/View/index.js")),o=t("./src/components/index.ts"),c=t("./src/stores/index.ts"),a=t("./src/utils/decorators/index.ts"),d=t("./src/utils/hooks/index.ts"),l=r(t("./src/screens/rakuen/search/component/history/index.tsx")),u=r(t("./src/screens/rakuen/search/component/list/index.tsx")),i=r(t("./src/screens/rakuen/search/component/search-bar/index.tsx")),m=r(t("./src/screens/rakuen/search/store.ts")),p=t("./src/screens/rakuen/search/styles.ts"),f=t("./node_modules/react/jsx-runtime.js");s.default=(0,a.ic)(m.default,(function(e,s){var t=s.$;return(0,d.useRunAfter)((function(){t.init()})),(0,d.useObserver)((function(){var e=(0,p.memoStyles)();return(0,f.jsxs)(o.Component,{id:"screen-rakuen-search",children:[(0,f.jsx)(o.Header,{title:"小组搜索",hm:["rakuenSearch","RakuenSearch"]}),(0,f.jsxs)(o.Page,{children:[(0,f.jsxs)(o.Flex,{style:e.searchBar,children:[(0,f.jsx)(o.Flex.Item,{children:(0,f.jsx)(i.default,{})}),(0,f.jsxs)(n.default,{style:c._.ml.sm,children:[(0,f.jsx)(o.Button,{style:e.btn,type:"ghostPlain",size:"sm",onPress:t.doSearch,children:"查询"}),(0,f.jsx)(o.Heatmap,{id:"帖子搜索.搜索"})]})]}),(0,f.jsx)(l.default,{style:c._.mt.sm}),(0,f.jsx)(u.default,{})]})]})}))}))},"./src/screens/rakuen/search/store.ts":(e,s,t)=>{var r=t("./node_modules/@babel/runtime/regenerator/index.js");t("./node_modules/core-js/modules/es.object.define-property.js"),t("./node_modules/core-js/modules/es.reflect.construct.js"),t("./node_modules/core-js/modules/es.array.concat.js"),t("./node_modules/core-js/modules/es.object.assign.js"),t("./node_modules/core-js/modules/es.array.filter.js"),t("./node_modules/core-js/modules/es.array.includes.js"),t("./node_modules/core-js/modules/es.string.includes.js"),t("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=t("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o,c=n(t("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),a=n(t("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=n(t("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=n(t("./node_modules/@babel/runtime/helpers/createClass.js")),u=n(t("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),i=n(t("./node_modules/@babel/runtime/helpers/inherits.js")),m=n(t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),p=n(t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=n(t("./node_modules/@babel/runtime/helpers/defineProperty.js")),h=n(t("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=t("./node_modules/mobx/dist/mobx.esm.js"),b=t("./src/stores/index.ts"),y=t("./src/utils/index.ts"),_=t("./src/utils/fetch/index.ts"),x=n(t("./src/utils/store/index.ts")),v=t("./src/screens/rakuen/search/ds.ts");function g(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=(0,p.default)(e);if(s){var n=(0,p.default)(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return(0,m.default)(this,t)}}s.default=(o=function(e){(0,i.default)(t,e);var s=g(t);function t(){var e;(0,d.default)(this,t);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e=s.call.apply(s,[this].concat(o)),(0,f.default)((0,u.default)(e),"state",(0,j.observable)(v.STATE)),(0,f.default)((0,u.default)(e),"init",(0,a.default)(r.mark((function s(){var t;return r.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,e.getStorage(v.NAMESPACE);case 2:return t=s.sent,e.setState(Object.assign({},t,v.EXCLUDE_STATE,{_loaded:!0})),s.abrupt("return",t);case 5:case"end":return s.stop()}}),s)})))),(0,f.default)((0,u.default)(e),"onChange",(function(s){var t=s.nativeEvent.text;e.setState({value:t})})),(0,f.default)((0,u.default)(e),"selectHistory",(function(s){(0,_.t)("帖子搜索.选择历史",{value:s}),e.setState({value:s}),e.doSearch()})),(0,f.default)((0,u.default)(e),"deleteHistory",(function(s){(0,_.t)("帖子搜索.删除历史",{value:s});var t=e.state.history;e.setState({history:t.filter((function(e){return e!==s}))}),e.setStorage(void 0,void 0,v.NAMESPACE)})),(0,f.default)((0,u.default)(e),"doSearch",(0,a.default)(r.mark((function s(){var t,n,o,a;return r.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t=e.state,n=t.history,""!==(o=t.value)){s.next=4;break}return(0,y.info)("请输入内容"),s.abrupt("return");case 4:return(0,_.t)("帖子搜索.搜索",{value:o}),a=(0,c.default)(n),n.includes(o)||a.unshift(o),a.length>10&&a.pop(),e.setState({history:a,searching:!0}),e.setStorage(v.NAMESPACE),s.prev=10,s.next=13,b.searchStore.fetchRakuenSearch(o,!0);case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(10),(0,y.info)("请稍候再查询");case 18:e.setState({searching:!1});case 19:case"end":return s.stop()}}),s,null,[[10,15]])})))),e}return(0,l.default)(t,[{key:"search",get:function(){var e=b.systemStore.advance,s=this.state.value,t=b.searchStore.rakuenSearch(s,!0);if(e)return t;var r=t.list.filter((function(e,s){return s<=8}));return Object.assign({},t,{list:r,pagination:{page:1,pageTotal:1},_pageTotal:t.pagination.pageTotal,_filter:t.list.length-8})}}]),t}(x.default),(0,h.default)(o.prototype,"search",[j.computed],Object.getOwnPropertyDescriptor(o.prototype,"search"),o.prototype),o)},"./src/screens/rakuen/search/styles.ts":(e,s,t)=>{t("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var r=t("./src/stores/index.ts");s.memoStyles=r._.memoStyles((function(){return{searchBar:{paddingVertical:r._.md,paddingHorizontal:r._.wind},btn:{width:68,height:40,borderRadius:40}}}))}}]);