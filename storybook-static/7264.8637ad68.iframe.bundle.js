(self.webpackChunkweb=self.webpackChunkweb||[]).push([[7264],{"./src/screens/home/preview/component/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/home/preview/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"Component")},"./src/screens/home/preview/component/list/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/home/preview/component/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"List")},"./src/screens/home/preview/component/list/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.object.assign.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(r("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),n=(s(r("react")),s(r("./node_modules/react-native-web/dist/exports/View/index.js"))),u=r("./src/components/index.ts"),a=r("./src/stores/index.ts"),c=r("./src/utils/index.ts"),l=r("./src/utils/decorators/index.ts"),d=r("./src/constants/index.ts"),i=r("./src/screens/home/preview/component/list/ds.ts"),m=r("./src/screens/home/preview/component/list/styles.tsx"),p=r("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var r,s=t.$,l=t.navigation,i=(0,m.memoStyles)(),f=s.state,h=f.epsThumbs,j=void 0===h?[]:h,b=f.epsThumbsHeader,v=void 0===b?{}:b,_=s.data.length?s.data:j,y=null!=(r=s.headers)&&r.Referer?s.headers:v,x={};return null!=y&&y.Referer&&y.Referer.includes("douban")?(s.data.length&&s.data[0].includes("douban")&&(_=(0,o.default)(s.data)),j.forEach((function(e){_.includes(e)||_.push(e)})),x.autoSize=i.item.width,x.fallback=!0):(x.width=i.item.width,x.height=.56*i.item.width,x.fallback=!0),(0,p.jsxs)(u.ScrollView,{contentContainerStyle:a._.container.bottom,scrollToTop:!0,children:[_.map((function(e,t){return(0,p.jsx)(n.default,{style:i.item,children:(0,p.jsx)(u.Touchable,{withoutFeedback:!0,onPress:function(){(0,c.showImageViewer)(_.map((function(e){return{url:e.split("@")[0],headers:y}})),t)},children:(0,p.jsx)(u.Image,Object.assign({},x,{src:e,headers:y,errorToHide:!0}))})},e)})),!(!d.WEB||!s.subjectId)&&(0,p.jsx)(u.Touchable,{style:a._.mt.lg,onPress:function(){l.push("Subject",{subjectId:s.subjectId})},children:(0,p.jsx)(u.Text,{align:"center",underline:!0,children:"返回条目"})})]})}),i.COMPONENT)},"./src/screens/home/preview/component/list/styles.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=r("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{item:{width:s._.window.width-(2*s._.wind-s._._wind),marginLeft:s._.sm,marginBottom:s._.md}}}))},"./src/screens/home/preview/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;t.COMPONENT="Preview"},"./src/screens/home/preview/header/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var s=r("./src/utils/dev/index.ts"),o=r("./src/screens/home/preview/ds.ts");t.COMPONENT=(0,s.rc)(o.COMPONENT,"Header")},"./src/screens/home/preview/header/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.function.name.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("react"));var o=r("./src/components/index.ts"),n=r("./src/utils/decorators/index.ts"),u=r("./src/screens/home/preview/header/ds.ts"),a=r("./src/screens/home/preview/header/styles.ts"),c=r("./node_modules/react/jsx-runtime.js");t.default=(0,n.obc)((function(e,t){var r=t.$;return(0,c.jsx)(o.Header,{headerTitleStyle:a.styles.title,title:r.name?r.name+"的预览":"预览",alias:"预览",hm:[r.url,"Preview"]})}),u.COMPONENT)},"./src/screens/home/preview/header/styles.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var s=r("./src/stores/index.ts");t.styles=s._.create({title:{paddingLeft:s._.sm,paddingRight:s._.md}})},"./src/screens/home/preview/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("react"));var o=r("./src/components/index.ts"),n=r("./src/utils/decorators/index.ts"),u=r("./src/utils/hooks/index.ts"),a=s(r("./src/screens/home/preview/component/list/index.tsx")),c=s(r("./src/screens/home/preview/header/index.tsx")),l=s(r("./src/screens/home/preview/store/index.ts")),d=r("./node_modules/react/jsx-runtime.js");t.default=(0,n.ic)(l.default,(function(e,t){var r=t.$;return(0,u.useRunAfter)((function(){r.init()})),(0,u.useObserver)((function(){return(0,d.jsxs)(o.Component,{id:"screen-preview",children:[(0,d.jsx)(c.default,{}),(0,d.jsx)(o.Page,{loaded:r.state._loaded,children:(0,d.jsx)(a.default,{})})]})}))}))},"./src/screens/home/preview/store/computed.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,n=s(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=s(r("./node_modules/@babel/runtime/helpers/createClass.js")),a=s(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),c=s(r("./node_modules/@babel/runtime/helpers/inherits.js")),l=s(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=s(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=s(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),p=r("./node_modules/mobx/dist/mobx.esm.js"),f=r("./src/utils/index.ts"),h=r("./src/constants/index.ts"),j=s(r("./src/screens/home/preview/store/state.ts")),b=r("./src/screens/home/preview/store/ds.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,d.default)(e);if(t){var o=(0,d.default)(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return(0,l.default)(this,r)}}t.default=(o=function(e){(0,c.default)(r,e);var t=v(r);function r(){var e;(0,n.default)(this,r);for(var s=arguments.length,o=new Array(s),u=0;u<s;u++)o[u]=arguments[u];return e=t.call.apply(t,[this].concat(o)),(0,i.default)((0,a.default)(e),"save",(function(){return e.saveStorage(e.namespace)})),e}return(0,u.default)(r,[{key:"subjectId",get:function(){return this.params.subjectId}},{key:"namespace",get:function(){return b.NAMESPACE+"|"+this.subjectId}},{key:"name",get:function(){var e,t;return(0,f.cnjp)(null==(e=this.params)?void 0:e.cn,null==(t=this.params)?void 0:t.jp)||""}},{key:"data",get:function(){try{var e=this.params._images;if(e)return JSON.parse(e)}catch(e){}return[]}},{key:"headers",get:function(){try{var e=this.params._headers;if(e)return JSON.parse(e)}catch(e){}return{}}},{key:"url",get:function(){return h.HOST+"/preview/"+this.subjectId}}]),r}(j.default),(0,m.default)(o.prototype,"subjectId",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"subjectId"),o.prototype),(0,m.default)(o.prototype,"namespace",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"namespace"),o.prototype),(0,m.default)(o.prototype,"name",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"name"),o.prototype),(0,m.default)(o.prototype,"data",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"data"),o.prototype),(0,m.default)(o.prototype,"headers",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"headers"),o.prototype),(0,m.default)(o.prototype,"url",[p.computed],Object.getOwnPropertyDescriptor(o.prototype,"url"),o.prototype),o)},"./src/screens/home/preview/store/ds.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=void 0;var s=r("./src/screens/home/preview/ds.ts");t.NAMESPACE="Screen"+s.COMPONENT,t.STATE={epsThumbs:[],epsThumbsHeader:{},_loaded:!1}},"./src/screens/home/preview/store/fetch.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.string.search.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.array.reverse.js"),r("./node_modules/core-js/modules/es.array.slice.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(r("./node_modules/@babel/runtime/helpers/createClass.js")),a=o(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(r("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=r("./src/utils/douban/index.ts"),f=r("./src/utils/kv/index.ts"),h=o(r("./src/screens/home/preview/store/computed.ts"));function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return(0,d.default)(this,r)}}t.default=function(e){(0,l.default)(r,e);var t=j(r);function r(){var e;(0,a.default)(this,r);for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return e=t.call.apply(t,[this].concat(u)),(0,m.default)((0,c.default)(e),"fetchMovieFromDouban",(0,n.default)(s.mark((function t(){var r,o,n,u,a,c,l;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.params,o=r.cn,n=r.jp,!(u=o||n)){t.next=11;break}return t.next=5,(0,p.search)(u);case 5:return a=t.sent,c=(0,p.matchMovie)(u,a,n),t.next=9,(0,p.getPreview)(c,void 0,40);case 9:(l=t.sent).data.length&&(e.setState({epsThumbs:l.data.slice().reverse(),epsThumbsHeader:{Referer:l.referer}}),e.save());case 11:case"end":return t.stop()}}),t)})))),(0,m.default)((0,c.default)(e),"getThirdParty",(0,n.default)(s.mark((function t(){var r,o,n,u,a;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,f.get)("douban_"+e.subjectId);case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return",!0);case 6:return o=r.epsThumbs,n=void 0===o?[]:o,u=r.epsThumbsHeader,a=void 0===u?{}:u,e.setState({epsThumbs:n,epsThumbsHeader:a}),e.save(),t.abrupt("return",!1);case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",!0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))),e}return(0,u.default)(r)}(h.default)},"./src/screens/home/preview/store/index.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=o(r("./node_modules/@babel/runtime/helpers/createClass.js")),a=o(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(r("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=o(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=r("./src/constants/index.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,i.default)(e);if(t){var o=(0,i.default)(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return(0,d.default)(this,r)}}var h=function(e){(0,l.default)(r,e);var t=f(r);function r(){var e;(0,a.default)(this,r);for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return e=t.call.apply(t,[this].concat(u)),(0,m.default)((0,c.default)(e),"init",(0,n.default)(s.mark((function t(){return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.t1=Object,t.t2={},t.next=5,e.getStorage(e.namespace);case 5:t.t3=t.sent,t.t4={_loaded:!0},t.t5=t.t1.assign.call(t.t1,t.t2,t.t3,t.t4),t.t0.setState.call(t.t0,t.t5),e.state.epsThumbs.length||(p.WEB?e.getThirdParty():e.fetchMovieFromDouban());case 10:case"end":return t.stop()}}),t)})))),e}return(0,u.default)(r)}(o(r("./src/screens/home/preview/store/fetch.ts")).default);t.default=h},"./src/screens/home/preview/store/state.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(r("./node_modules/@babel/runtime/helpers/createClass.js")),n=s(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=s(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=s(r("./node_modules/@babel/runtime/helpers/inherits.js")),c=s(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),l=s(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),d=s(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),i=r("./node_modules/mobx/dist/mobx.esm.js"),m=s(r("./src/utils/store/index.ts")),p=r("./src/screens/home/preview/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,l.default)(e);if(t){var o=(0,l.default)(this).constructor;r=Reflect.construct(s,arguments,o)}else r=s.apply(this,arguments);return(0,c.default)(this,r)}}t.default=function(e){(0,a.default)(r,e);var t=f(r);function r(){var e;(0,n.default)(this,r);for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),(0,d.default)((0,u.default)(e),"params",void 0),(0,d.default)((0,u.default)(e),"state",(0,i.observable)(p.STATE)),e}return(0,o.default)(r)}(m.default)},"./src/utils/douban/index.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.string.search.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.find.js"),r("./node_modules/core-js/modules/es.string.trim.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.string.replace.js"),r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.number.constructor.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getPreview=function(e,t){return b.apply(this,arguments)},t.getTrailer=function(e){return v.apply(this,arguments)},t.getVideo=function(e,t){return _.apply(this,arguments)},t.matchGame=function(e,t){var r=y(e),s=!1;return t.forEach((function(e){s||(0,u.similar)(e.title,r)<.7&&!e.title.includes(r)||(s=e.id)})),t.forEach((function(e){s||e.desc.includes(r)&&(s=e.id)})),s},t.matchMovie=function(e,t,r,s){var o=y(e),n=!1;return t.forEach((function(e){e.name&&e.name===r&&(n=e.id)})),t.forEach((function(t){if(!n){if((0,u.similar)(t.title,o)<.7){if(!t.desc.includes("原名:"))return;if(s&&t.year&&s!=t.year)return;var a=t.desc.split(" / ")[0].replace("原名:","");if((0,u.similar)(a,r||e)<.7)return}n=t.id}})),n},t.search=function(e,t){return j.apply(this,arguments)};var n=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),u=r("./src/utils/utils/index.ts"),a=r("./src/utils/fetch/index.ts"),c=r("./src/utils/html/index.ts"),l="https://www.douban.com",d="https://movie.douban.com",i=function(e,t){return l+"/search?cat="+("game"===t?3114:1002)+"&q="+e},m=function(e){return d+"/subject/"+e},p=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"o",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return"game"===t?"https://www.douban.com/game/"+e+"/photos/?type=1&start=0&sortby=hot":m(e)+"/photos?type=S&start="+s+"&sortby=time&size=a&subtype="+r},f=function(e){return l+"/"+(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"subject")+"/"+e+"/videos"},h=function(e){return d+"/subject/"+e+"/trailer"};function j(){return(j=(0,n.default)(s.mark((function e(t,r){var o,n,l;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.xhrCustom)({url:i(t,r)});case 2:return o=e.sent,n=o._response,l=(0,c.cheerio)(n),e.prev=5,e.abrupt("return",(l(".result .content").map((function(e,t){var r,s,o,n=(0,c.cheerio)(t),u=n.find("h3 a"),a=y(n.find(".subject-cast").text().trim())||"";return{id:null==(r=u.attr("onclick").match(/sid: (\d+)/))?void 0:r[1],title:y(u.text().trim()),name:(null==(s=a.match(/原名:(.*?)\//))?void 0:s[1])||"",desc:y(n.find("p").text().trim()),year:(null==(o=a.match(/(\d{4})$/))?void 0:o[1])||""}})).get()||[]).filter((function(e){return e.id})).sort((function(e,r){return(0,u.desc)((0,u.similar)(t,e.title),(0,u.similar)(t,r.title))})));case 9:return e.prev=9,e.t0=e.catch(5),e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[5,9]])})))).apply(this,arguments)}function b(){return b=(0,n.default)(s.mark((function e(t,r){var o,n,u,l,d,i,f,h,j,b,v,_,y=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=y.length>2&&void 0!==y[2]?y[2]:12,t){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return n="game"===r,e.next=6,(0,a.xhrCustom)({url:p(t,r,n?void 0:"o")});case 6:if(l=e.sent,u=l._response,!n){e.next=11;break}e.next=26;break;case 11:if(d=(0,c.cheerio)(u)(".cover img"),!((i=d.length)>0&&i<12||0===i)){e.next=17;break}return e.next=15,(0,a.xhrCustom)({url:p(t,r,"a")});case 15:f=e.sent,u=f._response;case 17:if(0===i){e.next=26;break}if(h=u.match(/<span class="count">\(共(\d+)张\)<\/span>/),j=h?Number(h[1]):0,!(b=j>=100?j-50:j>=30?j-30:0)){e.next=26;break}return e.next=24,(0,a.xhrCustom)({url:p(t,r,"a",b)});case 24:v=e.sent,u=v._response;case 26:return _=(0,c.cheerio)(u),e.abrupt("return",{data:(_(n?".pholist img":".cover img").map((function(e,t){var r=(0,c.cheerio)(t).attr("src").replace("http://","https://");return n&&(r=r.replace("/photo/thumb/","/photo/photo/")),r})).get()||[]).filter((function(e,t){return t<o})),referer:m(t)});case 28:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function v(){return v=(0,n.default)(s.mark((function e(t){var r,o,n,u,l,d=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:2,t){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return o=h(t),e.next=6,(0,a.xhrCustom)({url:o});case 6:return n=e.sent,u=n._response,l=(0,c.cheerio)(u),e.abrupt("return",{data:(l(".pr-video").map((function(e,t){var r=(0,c.cheerio)(t);return{cover:r.find("img").attr("src").replace("http://","https://"),title:r.text().trim(),href:r.attr("href")||""}})).get()||[]).filter((function(e,t){return t<r})),referer:o});case 10:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function _(){return _=(0,n.default)(s.mark((function e(t,r){var o,n,d,i,m,p,h,j,b,v,_=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=_.length>2&&void 0!==_[2]?_[2]:3,t){e.next=3;break}return e.abrupt("return",{data:[],referer:""});case 3:return n=f(t,r),e.next=6,(0,a.xhrCustom)({url:n});case 6:d=e.sent,i=d._response,m=(0,c.cheerio)(i),p=(m(".video-list li").map((function(e,t){var r,s=(0,c.cheerio)(t),o=s.find("p a");return{cover:s.find("img").attr("src").replace("http://","https://"),title:(null==(r=o.text().trim().split("_哔哩哔哩"))?void 0:r[0])||"",href:o.attr("href")||"",src:""}})).get()||[]).filter((function(e,t){return t<3})),h=0;case 11:if(!(h<p.length)){e.next=23;break}return e.next=14,(0,a.xhrCustom)({url:""+l+p[h].href});case 14:return j=e.sent,b=j._response,e.next=18,(0,u.sleep)(800);case 18:(v=(0,c.cheerio)(b)(".video-player-fallback").attr("href")||"").includes("www.bilibili.com")&&(p[h].src=v);case 20:h+=1,e.next=11;break;case 23:return e.abrupt("return",{data:p.filter((function(e){return e.src})).filter((function(e,t){return t<o})),referer:n});case 24:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function y(e){return String(e).replace(/ |(&amp;)|-|：|《|》|（|）|“|”|，|。|之/g,"")}}}]);