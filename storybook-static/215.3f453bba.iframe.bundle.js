(self.webpackChunkweb=self.webpackChunkweb||[]).push([[215],{"./src/screens/home/rating/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Component")},"./src/screens/home/rating/component/filter/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Filter")},"./src/screens/home/rating/component/filter/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var n=r(s("./node_modules/react-native-web/dist/exports/View/index.js")),o=s("./src/components/index.ts"),d=s("./src/utils/decorators/index.ts"),i=s("./src/screens/home/rating/component/filter/ds.ts"),a=s("./src/screens/home/rating/component/filter/styles.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ob)((function(e){var t=e.$,s=t.state.isFriend;return(0,c.jsxs)(n.default,{children:[(0,c.jsx)(o.SegmentedControl,{style:a.styles.segment,size:11,values:["所有","好友"],selectedIndex:s?1:0,onValueChange:t.onToggleFilter},String(s)),(0,c.jsx)(o.Heatmap,{id:"用户评分.切换类型"})]})}),i.COMPONENT);try{filter.displayName="filter",filter.__docgenInfo={description:"",displayName:"filter",props:{$:{defaultValue:null,description:"",name:"$",required:!0,type:{name:"ScreenRating"}},navigation:{defaultValue:null,description:"",name:"navigation",required:!1,type:{name:"Navigation"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/rating/component/filter/index.tsx#filter"]={docgenInfo:filter.__docgenInfo,name:"filter",path:"src/screens/home/rating/component/filter/index.tsx#filter"})}catch(e){}},"./src/screens/home/rating/component/filter/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var r=s("./src/stores/index.ts");t.styles=r._.create({segment:{width:r._.r(88),height:r._.r(28),marginRight:r._.xs}})},"./src/screens/home/rating/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Item"),t.EVENT={id:"用户评分.跳转"}},"./src/screens/home/rating/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var n=r(s("./node_modules/react-native-web/dist/exports/View/index.js")),o=s("./src/components/index.ts"),d=s("./src/screens/_/index.ts"),i=s("./src/stores/index.ts"),a=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/home/rating/component/item/ds.ts"),u=s("./src/screens/home/rating/component/item/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=e.id,r=e.avatar,c=e.name,p=e.time,f=e.star,_=e.comment,j=t.navigation,g=(0,u.memoStyles)();return(0,m.jsxs)(n.default,{style:g.container,children:[(0,m.jsxs)(o.Flex,{children:[(0,m.jsx)(o.UserStatus,{userId:s,children:(0,m.jsx)(d.Avatar,{navigation:j,size:36,event:l.EVENT,userId:s,src:r,radius:!0})}),(0,m.jsxs)(o.Flex.Item,{style:i._.ml.sm,children:[(0,m.jsxs)(o.Text,{size:12,bold:!0,children:[c,(0,m.jsxs)(o.Text,{size:10,lineHeight:12,type:"sub",children:["  ",(0,a.simpleTime)(p).split(" ")[0]]})]}),!!f&&(0,m.jsx)(d.Stars,{style:i._.mt.xxs,value:f,size:11})]})]}),!!_&&(0,m.jsx)(o.Flex,{style:i._.mt.xs,children:(0,m.jsx)(o.Text,{style:g.comment,size:i._.device(13,14),lineHeight:15,children:_})})]})}),l.COMPONENT)},"./src/screens/home/rating/component/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts");t.memoStyles=r._.memoStyles((function(){return{container:{width:r._.portrait("50%","33%"),paddingVertical:r._.sm+2},comment:{paddingVertical:r._.xs,paddingHorizontal:r._.sm,marginTop:r._.sm,marginRight:r._.sm,backgroundColor:r._.select(r._.colorBg,r._._colorDarkModeLevel1),borderRadius:r._.radiusXs,overflow:"hidden"}}}))},"./src/screens/home/rating/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"List")},"./src/screens/home/rating/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var n=s("./src/components/index.ts"),o=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),a=s("./src/constants/index.ts"),c=s("./src/screens/home/rating/ds.ts"),l=r(s("./src/screens/home/rating/component/item/index.tsx")),u=s("./src/screens/home/rating/component/list/ds.ts"),m=s("./src/screens/home/rating/component/list/styles.ts"),p=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s=e.title,r=t.$,i=a.MODEL_RATING_STATUS.getValue(s),l=r.rating(i);if(!l._loaded)return(0,p.jsx)(n.Loading,{});var u=(0,m.memoStyles)(),_=r.state,j=_.isFriend,g=_.page,h=o._.portrait(2,3);return(0,p.jsx)(n.ListView,{style:o._.container.flex,contentContainerStyle:u.contentContainerStyle,keyExtractor:d.keyExtractor,data:l,numColumns:h,scrollToTop:c.TABS[g].title===s,renderItem:f,onEndReachedThreshold:.2,onHeaderRefresh:function(){return r.fetchRating(!0)},onFooterRefresh:r.fetchRating},(j?"1":"0")+h)}),u.COMPONENT);function f(e){var t=e.item;return(0,p.jsx)(l.default,Object.assign({},t))}},"./src/screens/home/rating/component/list/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts"),n=s("./src/constants/index.ts");t.memoStyles=r._.memoStyles((function(){if(n.STORYBOOK){var e=r._.window.height-(n.STORYBOOK?r._.headerHeight:0);return{contentContainerStyle:{paddingHorizontal:r._.wind,paddingTop:r._.md,paddingBottom:r._.bottom,minHeight:e,maxHeight:e}}}return{contentContainerStyle:{paddingHorizontal:r._.wind,paddingTop:r._.md,paddingBottom:r._.bottom}}}))},"./src/screens/home/rating/component/tab/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_MAP=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/component/ds.ts");t.COMPONENT=(0,r.rc)(n.COMPONENT,"Tab"),t.STATUS_MAP={wishes:"wish",collections:"collect",doings:"doing",on_hold:"onHold",dropped:"dropped"}},"./src/screens/home/rating/component/tab/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.string.replace.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=r(s("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=j(t);if(s&&s.has(e))return s.get(e);var r={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var d=n?Object.getOwnPropertyDescriptor(e,o):null;d&&(d.get||d.set)?Object.defineProperty(r,o,d):r[o]=e[o]}return r.default=e,s&&s.set(e,r),r}(s("react")),i=s("./node_modules/react-native-tab-view/lib/module/index.js"),a=s("./src/components/index.ts"),c=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),u=s("./src/screens/home/rating/ds.ts"),m=r(s("./src/screens/home/rating/component/list/index.tsx")),p=s("./src/screens/home/rating/component/tab/ds.ts"),f=s("./src/screens/home/rating/component/tab/styles.ts"),_=s("./node_modules/react/jsx-runtime.js");function j(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(j=function(e){return e?s:t})(e)}t.default=(0,l.obc)((function(e,t){var s=t.$,r=(0,f.memoStyles)(),l=s.state.page,j=(0,i.SceneMap)(Object.assign.apply(Object,[{}].concat((0,o.default)(u.TABS.map((function(e){return(0,n.default)({},e.key,(function(){return(0,_.jsx)(m.default,{title:e.title})}))}))))));return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(a.TabView,{style:c._.mt._sm,lazyPreloadDistance:0,navigationState:{index:l,routes:u.TABS},renderTabBar:function(e){return(0,d.createElement)(a.TabBar,Object.assign({},e,{key:Object.keys(s.counts)?"1":"0",style:r.tabBar,tabStyle:r.tab,labelStyle:r.label,indicatorStyle:r.indicator,pressOpacity:1,pressColor:"transparent",renderLabel:function(e){var t=e.route,r=e.focused,n=s.counts[t.key]||s.params[p.STATUS_MAP[t.key]],o=s.params.type,d=t.title||"";return"书籍"===o?d=d.replace("看","读"):"游戏"===o?d=d.replace("看","玩"):"音乐"===o&&(d=d.replace("看","听")),(0,_.jsxs)(a.Flex,{style:c._.container.block,justify:"center",children:[(0,_.jsx)(a.Text,{type:"title",size:13,bold:r,noWrap:!0,children:d}),!!n&&(0,_.jsxs)(a.Text,{type:"sub",size:11,bold:!0,lineHeight:13,noWrap:!0,children:[" ",n," "]})]})}}))},renderScene:j,onIndexChange:s.onChange},c._.orientation),(0,_.jsx)(a.Heatmap,{right:c._.wind+62,bottom:c._.window.height-c._.tabsHeaderHeight-12,id:"用户评分.标签页切换",transparent:!0})]})}),p.COMPONENT);try{tab.displayName="tab",tab.__docgenInfo={description:"",displayName:"tab",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/rating/component/tab/index.tsx#tab"]={docgenInfo:tab.__docgenInfo,name:"tab",path:"src/screens/home/rating/component/tab/index.tsx#tab"})}catch(e){}},"./src/screens/home/rating/component/tab/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var r=s("./src/stores/index.ts"),n=s("./src/screens/home/rating/ds.ts");t.memoStyles=r._.memoStyles((function(){var e=r._.window.width/n.TABS.length;return{tabBar:{backgroundColor:r._.ios("transparent",r._.select("transparent",r._.deepDark?r._._colorPlain:r._._colorDarkModeLevel1)),borderBottomWidth:r._.select(r._.ios(0,r._.hairlineWidth),r._.deepDark?0:r._.hairlineWidth),borderBottomColor:r._.colorBorder,elevation:0},tab:{width:e,height:48},label:{padding:0},indicator:{width:16,height:4,marginLeft:(e-16)/2,backgroundColor:r._.colorMain,borderRadius:4}}}))},"./src/screens/home/rating/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.array.map.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TABS=t.STATUS_MAP=t.STATE=t.NAMESPACE=t.COMPONENT=void 0;var r=s("./src/constants/index.ts"),n=t.COMPONENT="Rating";t.NAMESPACE="Screen"+n,t.STATE={page:2,isFriend:!1,_fetching:!1,_loaded:!1},t.STATUS_MAP={wish:0,collect:1,doing:2,doings:2,onHold:3,on_hold:3,dropped:4},t.TABS=r.RATING_STATUS.map((function(e){return{key:e.value,title:e.label}}))},"./src/screens/home/rating/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BROWSER=t.DATA=t.COMPONENT=void 0;var r=s("./src/utils/dev/index.ts"),n=s("./src/screens/home/rating/ds.ts"),o=(t.COMPONENT=(0,r.rc)(n.COMPONENT,"Header"),t.TEXT_BROWSER="浏览器查看");t.DATA=[o]},"./src/screens/home/rating/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var n=s("./src/components/index.ts"),o=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),i=s("./src/utils/decorators/index.ts"),a=s("./src/utils/fetch/index.ts"),c=r(s("./src/screens/home/rating/component/filter/index.tsx")),l=s("./src/screens/home/rating/header/ds.ts"),u=s("./src/screens/home/rating/header/styles.ts"),m=s("./node_modules/react/jsx-runtime.js");t.default=(0,i.obc)((function(e,t){var s,r=t.$;return(0,m.jsx)(n.Header,{title:(null==(s=r.params)?void 0:s.name)||"用户评分",headerTitleAlign:"left",headerTitleStyle:u.styles.title,alias:"用户评分",hm:[r.url,"Rating"],headerRight:function(){return(0,m.jsxs)(n.Flex,{children:[o.userStore.isLogin&&(0,m.jsx)(c.default,{$:r}),(0,m.jsx)(n.Header.Popover,{data:l.DATA,onSelect:function(e){e===l.TEXT_BROWSER&&((0,a.t)("用户评分.右上角菜单",{key:e}),(0,d.open)(r.url))},children:(0,m.jsx)(n.Heatmap,{id:"用户评分.右上角菜单"})})]})}})}),l.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/rating/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/home/rating/header/index.tsx#header"})}catch(e){}},"./src/screens/home/rating/header/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var r=s("./src/stores/index.ts");t.styles=r._.create({title:{paddingLeft:0,paddingRight:72,marginLeft:-24}})},"./src/screens/home/rating/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(s("react"));var n=s("./src/components/index.ts"),o=s("./src/stores/index.ts"),d=s("./src/utils/decorators/index.ts"),i=s("./src/utils/hooks/index.ts"),a=r(s("./src/screens/home/rating/component/tab/index.tsx")),c=r(s("./src/screens/home/rating/header/index.tsx")),l=r(s("./src/screens/home/rating/store.ts")),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.ic)(l.default,(function(e,t){var s=t.$;return(0,i.useRunAfter)((function(){s.init()})),(0,i.useObserver)((function(){return(0,u.jsxs)(n.Component,{id:"screen-rating",children:[(0,u.jsx)(c.default,{}),(0,u.jsxs)(n.Page,{loaded:s.state._loaded,children:[(0,u.jsx)(a.default,{}),(0,u.jsx)(n.Heatmap,{bottom:o._.bottom,id:"用户评分",screen:"Rating"})]})]})}))}));try{rating.displayName="rating",rating.__docgenInfo={description:"",displayName:"rating",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/rating/index.tsx#rating"]={docgenInfo:rating.__docgenInfo,name:"rating",path:"src/screens/home/rating/index.tsx#rating"})}catch(e){}},"./src/screens/home/rating/store.ts":(e,t,s)=>{var r=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,d=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),i=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),a=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),c=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=n(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),_=s("./node_modules/mobx/dist/mobx.esm.js"),j=s("./src/stores/index.ts"),g=s("./src/utils/fetch/index.ts"),h=n(s("./src/utils/store/index.ts")),b=s("./src/constants/index.ts"),y=s("./src/screens/home/rating/ds.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,r=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;s=Reflect.construct(r,arguments,n)}else s=r.apply(this,arguments);return(0,u.default)(this,s)}}t.default=(o=function(e){(0,l.default)(s,e);var t=x(s);function s(){var e;(0,i.default)(this,s);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o)),(0,p.default)((0,c.default)(e),"params",void 0),(0,p.default)((0,c.default)(e),"state",(0,_.observable)(y.STATE)),(0,p.default)((0,c.default)(e),"init",(0,d.default)(r.mark((function t(){var s,n,o,d;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(y.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:if(s=t.t0,(n=e.params.status)&&(s.page=y.STATUS_MAP[n]||2),e.setState(Object.assign({},s,{_fetching:!1,_loaded:!0})),o=e.state.page,d=e.rating(y.TABS[o].key),d._loaded){t.next=13;break}return t.abrupt("return",e.fetchRating(!0));case 13:return t.abrupt("return",!0);case 14:case"end":return t.stop()}}),t)})))),(0,p.default)((0,c.default)(e),"_counts",null),(0,p.default)((0,c.default)(e),"fetchRating",(0,d.default)(r.mark((function t(){var s,n,o,d,i,a=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=a.length>0&&void 0!==a[0]&&a[0],!e.state._fetching){t.next=4;break}return t.abrupt("return",!0);case 4:return n=e.state,o=n.page,d=n.isFriend,i=y.TABS[o].key,e.setState({_fetching:!0}),t.next=9,j.subjectStore.fetchRating({subjectId:e.subjectId,status:i,isFriend:d},s);case 9:return e.setState({_fetching:!1}),t.abrupt("return",!0);case 11:case"end":return t.stop()}}),t)})))),(0,p.default)((0,c.default)(e),"onChange",(function(t){(0,g.t)("用户评分.标签页切换",{page:t}),e.setState({page:t}),e.setStorage(y.NAMESPACE);var s=y.TABS[t].key;e.rating(s)._loaded||e.fetchRating(!0)})),(0,p.default)((0,c.default)(e),"onToggleFilter",(function(t){var s=e.state,r=s.page,n=s.isFriend;if(t){if("所有"===t&&!n)return;if("好友"===t&&n)return}(0,g.t)("用户评分.切换类型",{isFriend:!n}),e.setState({isFriend:!n}),e.setStorage(y.NAMESPACE);var o=y.TABS[r].key;e.rating(o)._loaded||e.fetchRating(!0)})),e}return(0,a.default)(s,[{key:"subjectId",get:function(){return this.params.subjectId}},{key:"rating",value:function(e){var t=this;return(0,_.computed)((function(){var s=t.state.isFriend,r=j.systemStore.setting.filterDefault,n=j.subjectStore.rating(t.subjectId,e,s);return r?Object.assign({},n,{list:n.list.filter((function(e){return!(e.avatar.includes(b.URL_DEFAULT_AVATAR)&&!e.comment)}))}):n})).get()}},{key:"counts",get:function(){if(this._counts)return this._counts;var e=this.state.page,t=y.TABS[e].key,s=this.rating(t),r=s.counts;return s._loaded&&(this._counts=r),r}},{key:"url",get:function(){var e=this.state,t=e.page,s=e.isFriend,r=y.TABS[t].key;return(0,b.HTML_SUBJECT_RATING)(this.subjectId,r,s)}}]),s}(h.default),(0,f.default)(o.prototype,"subjectId",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"subjectId"),o.prototype),(0,f.default)(o.prototype,"counts",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"counts"),o.prototype),(0,f.default)(o.prototype,"url",[_.computed],Object.getOwnPropertyDescriptor(o.prototype,"url"),o.prototype),o)}}]);