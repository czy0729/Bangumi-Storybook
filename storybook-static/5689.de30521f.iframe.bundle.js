(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5689],{"./src/screens/discovery/dollars/component/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=o("./src/utils/dev/index.ts"),r=o("./src/screens/discovery/dollars/ds.ts");s.COMPONENT=(0,t.rc)(r.COMPONENT,"Component")},"./src/screens/discovery/dollars/component/item/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.ITEM_HEIGHT=s.COMPONENT=void 0;var t=o("./src/utils/dev/index.ts"),r=o("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(r.COMPONENT,"Item"),s.ITEM_HEIGHT=64},"./src/screens/discovery/dollars/component/item/index.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.string.match.js"),o("./node_modules/core-js/modules/es.regexp.exec.js"),o("./node_modules/core-js/modules/es.string.replace.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(o("react"));var r=t(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./src/components/index.ts"),d=o("./src/screens/_/index.ts"),l=o("./src/stores/index.ts"),c=o("./src/utils/index.ts"),i=o("./src/utils/decorators/index.ts"),a=o("./src/utils/fetch/index.ts"),u=o("./src/constants/index.ts"),m=o("./src/screens/discovery/dollars/component/item/ds.ts"),f=o("./src/screens/discovery/dollars/component/item/styles.ts"),p=o("./node_modules/react/jsx-runtime.js");s.default=(0,i.obc)((function(e,s){var o,t=e.index,i=e.avatar,j=e.nickname,b=e.msg,_=e.color,v=s.$,y=s.navigation,x=(0,f.memoStyles)(),h=null==(o=String(i).match(/\/(\d+)\.jpg/))?void 0:o[1];return(0,p.jsxs)(n.Flex,{style:x.item,align:"start",children:[(0,p.jsxs)(n.Flex,{style:x.avatar,direction:"column",children:[(0,p.jsx)(n.UserStatus,{userId:h,children:(0,p.jsx)(d.InView,{style:x.inView,y:m.ITEM_HEIGHT*t+1,children:(0,p.jsx)(d.Avatar,{src:u.HOST+"/pic/user/l/"+i,size:52,borderWidth:2,borderColor:l._.select(l._.colorBorder,"rgba(255, 255, 255, 0.88)"),radius:l._.radiusSm,onPress:function(){return v.onToggleShow(j)},onLongPress:function(){h&&(y.push("Zone",{userId:h}),(0,a.t)("Dollars.跳转",{to:"Zone",userId:h}))}})})}),(0,p.jsx)(n.Text,{style:l._.mt.sm,size:12,bold:!0,align:"center",children:j})]}),(0,p.jsx)(n.Flex.Item,{children:(0,p.jsx)(r.default,{style:[x.content,{backgroundColor:_||"transparent"}],children:(0,p.jsx)(n.Text,{type:"__plain__",lineHeight:17,bold:!0,shadow:!0,selectable:!0,children:(0,c.HTMLDecode)(b).replace(/<br \/>/g,"")})})})]})}),m.COMPONENT)},"./src/screens/discovery/dollars/component/item/styles.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=o("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{item:{paddingVertical:12},inView:{minWidth:52,minHeight:52},avatar:{width:80,paddingRight:12},content:{padding:15,paddingTop:12,marginTop:-1,borderWidth:5,borderRadius:t._.radiusMd,borderColor:t._.select("rgba(255, 255, 255, 0.5)","rgba(255, 255, 255, 0.88)")},moreStyle:{}}}))},"./src/screens/discovery/dollars/component/list/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=o("./src/utils/dev/index.ts"),r=o("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(r.COMPONENT,"List")},"./src/screens/discovery/dollars/component/list/index.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(o("react"));var r=o("./src/screens/_/index.ts"),n=o("./src/stores/index.ts"),d=o("./src/utils/index.ts"),l=o("./src/utils/decorators/index.ts"),c=o("./src/constants/index.ts"),i=o("./src/screens/discovery/dollars/component/list/utils.tsx"),a=o("./src/screens/discovery/dollars/component/list/ds.ts"),u=o("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var o=s.$;return(0,u.jsx)(r.PaginationList2,Object.assign({forwardRef:o.forwardRef,keyExtractor:d.keyExtractor,style:n._.container.wind,contentContainerStyle:n._.container.bottom},c.SCROLL_VIEW_RESET_PROPS,{scrollEventThrottle:16,data:o.dollars.list,renderItem:i.renderItem,onScroll:o.onScroll}))}),a.COMPONENT)},"./src/screens/discovery/dollars/component/list/utils.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.renderItem=function(e){var s=e.item,o=e.index;return(0,n.jsx)(r.default,Object.assign({index:o},s),s.id)};t(o("react"));var r=t(o("./src/screens/discovery/dollars/component/item/index.tsx")),n=o("./node_modules/react/jsx-runtime.js")},"./src/screens/discovery/dollars/component/textarea/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=o("./src/utils/dev/index.ts"),r=o("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(r.COMPONENT,"Textarea")},"./src/screens/discovery/dollars/component/textarea/index.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(o("react"));var r=t(o("./node_modules/react-native-web/dist/exports/View/index.js")),n=o("./src/components/index.ts"),d=o("./src/stores/index.ts"),l=o("./src/utils/decorators/index.ts"),c=o("./src/screens/discovery/dollars/component/textarea/ds.ts"),i=o("./src/screens/discovery/dollars/component/textarea/styles.ts"),a=o("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var o=s.$;if(!o.state.show)return null;var t=(0,i.memoStyles)();return(0,a.jsxs)(r.default,{style:t.container,children:[(0,a.jsx)(n.Input,{ref:o.forwardInputRef,style:t.textarea,inputStyle:t.input,multiline:!0,numberOfLines:3,value:o.state.text,placeholder:"单击头像可以@某人，长按则前往空间",autoFocus:!0,returnKeyType:"done",returnKeyLabel:"发送",onChangeText:o.onChangeText,onSubmitEditing:o.onSubmit}),(0,a.jsx)(n.Touchable,{style:d._.mt.md,onPress:o.onSubmit,children:(0,a.jsx)(r.default,{style:t.btn,children:(0,a.jsx)(n.Text,{size:16,bold:!0,align:"center",children:"POST"})})})]})}),c.COMPONENT)},"./src/screens/discovery/dollars/component/textarea/styles.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=o("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{container:{paddingTop:t._.sm,paddingHorizontal:t._.wind,paddingBottom:t._.md,backgroundColor:t._.colorPlain},textarea:{borderWidth:3,borderRadius:t._.radiusMd,borderColor:t._.select("#000","rgba(255, 255, 255, 0.88)"),backgroundColor:t._.select(t._.colorBg,"rgba(255, 255, 255, 0.24)")},input:Object.assign({},t._.fontSize15,{color:t._.colorDesc}),btn:{paddingVertical:t._.sm,borderWidth:3,borderRadius:t._.radiusMd,borderColor:t._.select("#000","rgba(255, 255, 255, 0.88)")}}}))},"./src/screens/discovery/dollars/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var t=o("./src/stores/index.ts"),r=s.COMPONENT="Dollars",n=(s.NAMESPACE="Screen"+r,s.EXCLUDE_STATE={visibleBottom:t._.window.height,fetching:!1,show:!1,text:""});s.STATE=Object.assign({},n,{_loaded:!1})},"./src/screens/discovery/dollars/header/ds.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=o("./src/utils/dev/index.ts"),r=o("./src/screens/discovery/dollars/ds.ts");s.COMPONENT=(0,t.rc)(r.COMPONENT,"Header")},"./src/screens/discovery/dollars/header/index.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(o("react"));var r=o("./src/components/index.ts"),n=o("./src/screens/_/index.ts"),d=o("./src/stores/index.ts"),l=o("./src/utils/decorators/index.ts"),c=o("./src/screens/discovery/dollars/header/ds.ts"),i=o("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var o=s.$,t=o.state.show;return(0,i.jsx)(r.Header,{title:"DOLLARS",hm:["dollars","Dollars"],headerRight:function(){return(0,i.jsxs)(r.Flex,{children:[!t&&o.state.visibleBottom>=2*d._.window.height&&(0,i.jsx)(n.IconTouchable,{style:d._.mr.xs,name:"md-keyboard-arrow-up",size:28,color:d._.colorTitle,onPress:function(){o.scrollToTop(!0)}}),(0,i.jsx)(n.IconTouchable,{style:d._.mr.xs,name:t?"md-close":"md-edit",size:t?20:16,color:d._.colorTitle,onPress:function(){o.onToggleShow()}})]})}})}),c.COMPONENT)},"./src/screens/discovery/dollars/hooks.ts":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/web.timers.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.useDollarsPage=function(e){var s=e.$;(0,r.useRunAfter)((function(){s.init()}));var o=(0,t.useRef)(null);(0,r.useMount)((function(){return o.current=setInterval((function(){s.updateDollars()}),8e3),function(){s.scrollViewRef=null,s.inputRef=null,clearInterval(o.current)}}))};var t=o("react"),r=o("./src/utils/hooks/index.ts")},"./src/screens/discovery/dollars/index.tsx":(e,s,o)=>{o("./node_modules/core-js/modules/es.object.define-property.js");var t=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(o("react"));var r=o("./src/components/index.ts"),n=o("./src/utils/decorators/index.ts"),d=o("./src/utils/hooks/index.ts"),l=t(o("./src/screens/discovery/dollars/component/list/index.tsx")),c=t(o("./src/screens/discovery/dollars/component/textarea/index.tsx")),i=t(o("./src/screens/discovery/dollars/header/index.tsx")),a=o("./src/screens/discovery/dollars/hooks.ts"),u=t(o("./src/screens/discovery/dollars/store.ts")),m=o("./node_modules/react/jsx-runtime.js");s.default=(0,n.ic)(u.default,(function(e,s){(0,a.useDollarsPage)(s);var o=s.$;return(0,d.useObserver)((function(){return(0,m.jsxs)(r.Component,{id:"screen-dollars",children:[(0,m.jsx)(i.default,{}),(0,m.jsxs)(r.Page,{loaded:o.dollars._loaded,children:[(0,m.jsx)(c.default,{}),(0,m.jsx)(l.default,{})]})]})}))}))},"./src/screens/discovery/dollars/store.ts":(e,s,o)=>{var t=o("./node_modules/@babel/runtime/regenerator/index.js");o("./node_modules/core-js/modules/es.object.define-property.js"),o("./node_modules/core-js/modules/es.reflect.construct.js"),o("./node_modules/core-js/modules/es.array.concat.js"),o("./node_modules/core-js/modules/es.object.assign.js"),o("./node_modules/core-js/modules/web.timers.js"),o("./node_modules/core-js/modules/es.array.includes.js"),o("./node_modules/core-js/modules/es.string.includes.js"),o("./node_modules/core-js/modules/es.string.trim.js"),o("./node_modules/core-js/modules/es.function.bind.js"),o("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=o("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n,d=r(o("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=r(o("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=r(o("./node_modules/@babel/runtime/helpers/createClass.js")),i=r(o("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=r(o("./node_modules/@babel/runtime/helpers/inherits.js")),u=r(o("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=r(o("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=r(o("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=r(o("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=o("./node_modules/mobx/dist/mobx.esm.js"),b=o("./src/stores/index.ts"),_=o("./src/utils/index.ts"),v=o("./src/utils/fetch/index.ts"),y=r(o("./src/utils/store/index.ts")),x=o("./src/screens/discovery/dollars/ds.ts");function h(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,t=(0,m.default)(e);if(s){var r=(0,m.default)(this).constructor;o=Reflect.construct(t,arguments,r)}else o=t.apply(this,arguments);return(0,u.default)(this,o)}}s.default=(n=function(e){(0,a.default)(o,e);var s=h(o);function o(){var e;(0,l.default)(this,o);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return e=s.call.apply(s,[this].concat(n)),(0,f.default)((0,i.default)(e),"state",(0,j.observable)(x.STATE)),(0,f.default)((0,i.default)(e),"scrollViewRef",null),(0,f.default)((0,i.default)(e),"inputRef",null),(0,f.default)((0,i.default)(e),"init",(0,d.default)(t.mark((function s(){return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e.setState(Object.assign({},x.EXCLUDE_STATE,{_loaded:!0})),s.abrupt("return",e.fetchDollars());case 2:case"end":return s.stop()}}),s)})))),(0,f.default)((0,i.default)(e),"forwardRef",(function(s){e.scrollViewRef=s})),(0,f.default)((0,i.default)(e),"forwardInputRef",(function(s){try{e.inputRef=s.inputRef}catch(e){}})),(0,f.default)((0,i.default)(e),"fetchDollars",(function(){return b.discoveryStore.fetchDollars()})),(0,f.default)((0,i.default)(e),"updateDollars",(function(){return b.discoveryStore.updateDollars()})),(0,f.default)((0,i.default)(e),"scrollToTop",(function(){var s;null!=(s=e.scrollViewRef)&&s.scrollToIndex&&setTimeout((function(){try{e.scrollViewRef.scrollToIndex({animated:!0,index:0,viewOffset:0})}catch(e){}}),160)})),(0,f.default)((0,i.default)(e),"scrollToBottom",(function(){var s,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!=(s=e.scrollViewRef)&&s.scrollToEnd&&setTimeout((function(){try{e.scrollViewRef.scrollToEnd({animated:o,duration:640})}catch(e){}}),160)})),(0,f.default)((0,i.default)(e),"onToggleShow",(function(s){if(e.isWebLogin){var o=e.state,t=o.show,r=o.text;if(s){var n="@"+s;return e.setState({show:!0,text:r.includes(n)?r:"@"+s+" "+r}),void setTimeout((function(){try{e.inputRef.focus()}catch(e){}}),0)}e.setState({show:!t})}else(0,_.info)("未登录")})),(0,f.default)((0,i.default)(e),"onChangeText",(function(s){e.setState({text:s.trim()})})),(0,f.default)((0,i.default)(e),"onSubmit",(function(){var s=e.state,o=s.fetching,t=s.text;o||(t?(e.setState({fetching:!0,show:!1}),setTimeout((function(){e.updateDollars(),b.discoveryStore.doDollars({message:t},(function(){e.setState({fetching:!1,text:""}),e.updateDollars(),(0,v.t)("Dollars.发送",{userId:b.userStore.myId})}),(function(){(0,_.info)("发送失败, 可能需要重新登录"),e.setState({fetching:!1,show:!0})}))}),80)):(0,_.info)("请输入内容"))})),(0,f.default)((0,i.default)(e),"onScroll",_.updateVisibleBottom.bind((0,i.default)(e))),e}return(0,c.default)(o,[{key:"isWebLogin",get:function(){return b.userStore.isWebLogin}},{key:"dollars",get:function(){return b.discoveryStore.dollars}}]),o}(y.default),(0,p.default)(n.prototype,"isWebLogin",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"isWebLogin"),n.prototype),(0,p.default)(n.prototype,"dollars",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"dollars"),n.prototype),n)}}]);