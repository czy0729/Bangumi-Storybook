(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5292],{"./src/screens/web-view/bilibili-sync/component/btn/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Btn")},"./src/screens/web-view/bilibili-sync/component/btn/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/btn/ds.ts"),d=s("./src/screens/web-view/bilibili-sync/component/btn/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.ob)((function(e){var t=e.style,s=e.btnStyle,o=e.text,c=void 0===o?"同步":o,l=e.type,i=e.size,a=void 0===i?11:i,m=e.disabled,b=e.loading,f=e.onPress,p=(0,d.memoStyles)(),j="success"===l&&!m;return(0,u.jsx)(n.Touchable,{style:(0,r.stl)(p.touch,t),onPress:m||b?void 0:f,children:(0,u.jsx)(n.Flex,{style:(0,r.stl)(p.btn,j&&p.btnSuccess,s),justify:"center",children:b?(0,u.jsx)(n.Loading.Mini,{}):(0,u.jsx)(n.Text,{bold:!0,size:a,type:j?"__plain__":void 0,children:c})})})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/btn/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{touch:{width:56,borderRadius:o._.r(28),overflow:"hidden"},btn:{height:o._.r(28),backgroundColor:o._.select(o._.colorBg,o._._colorDarkModeLevel1),borderRadius:o._.r(28)},btnSuccess:{backgroundColor:"rgb(1, 173, 145)"}}}))},"./src/screens/web-view/bilibili-sync/component/column-bgm/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"ColumnBgm")},"./src/screens/web-view/bilibili-sync/component/column-bgm/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/column-bgm/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.ob)((function(e){var t=e.select,s=e.text,o=e.next;return(0,d.jsxs)(n.Text,{style:r._.mt.md,type:s?t?"sub":"desc":"sub",size:11,bold:!0,children:[s||"__",t&&(0,d.jsxs)(n.Text,{size:11,bold:!0,type:"desc",children:[" ","→ ",o]})]})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/column-select/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.COMPONENT=t.COLOR_SUCCESS=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"ColumnSelect"),t.COLOR_SUCCESS="rgb(1, 173, 145)",t.HIT_SLOP={top:4,right:32,bottom:4,left:16}},"./src/screens/web-view/bilibili-sync/component/column-select/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/bilibili-sync/component/column-select/ds.ts"),d=s("./src/screens/web-view/bilibili-sync/component/column-select/styles.ts"),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.ob)((function(e){var t=e.select,s=e.disabled,o=e.onPress;return s?(0,u.jsx)(n.default,{style:d.styles.columnSelect}):(0,u.jsx)(r.Touchable,{style:d.styles.columnSelect,hitSlop:l.HIT_SLOP,onPress:function(){return o(!t)},children:(0,u.jsx)(r.Flex,{style:d.styles.radio,justify:"center",children:(0,u.jsx)(r.Iconfont,{name:t?"md-check-circle":"md-radio-button-off",color:t?l.COLOR_SUCCESS:void 0,size:16})})})}),l.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/column-select/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({columnSelect:{width:26,height:28,paddingTop:5,marginTop:3,marginLeft:-2,borderRadius:20,overflow:"hidden"},radio:{width:26,height:26}})},"./src/screens/web-view/bilibili-sync/component/column/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/bilibili-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Column")},"./src/screens/web-view/bilibili-sync/component/column/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),c=s("./src/screens/web-view/bilibili-sync/component/column/ds.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.ob)((function(e){var t=e.style,s=e.type,o=e.text,r=e.right,c=e.onPress;return(0,l.jsxs)(n.Flex,{style:t,children:[(0,l.jsx)(n.Text,{size:11,type:o&&"/"!==o?s:"sub",onPress:c,children:o||"__"}),r]})}),c.COMPONENT)},"./src/screens/web-view/bilibili-sync/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/bilibili-sync/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Component")},"./src/screens/web-view/bilibili-sync/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.MEDIA_SUBJECT=t.LOADED=t.HOST_API=t.COMPONENT=void 0;t.COMPONENT="BilibiliSync",t.HOST_API="https://api.bgm.tv",t.LOADED={},t.MEDIA_SUBJECT={28220978:1424,28235244:330973,28235419:317042,28236365:326868,28236374:333158,28236378:323626,28236382:341077,28236394:344422,28236424:321825,28236579:348666,3846:35861}},"./src/screens/web-view/bilibili-sync/utils.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.match.js"),s("./node_modules/core-js/modules/es.regexp.exec.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectComment=i,t.getSelectEp=d,t.getSelectScore=u,t.getSelectStatus=l,t.useSelectComment=function(e,t){var s=(0,r.useState)(i(e,t).select),o=(0,n.default)(s,2),c=o[0],l=o[1];return(0,r.useEffect)((function(){l(i(e,t).select)}),[e,t]),[c,l]},t.useSelectEp=function(e,t){var s=(0,r.useState)(d(e,t).select),o=(0,n.default)(s,2),c=o[0],l=o[1];return(0,r.useEffect)((function(){l(d(e,t).select)}),[e,t]),[c,l]},t.useSelectScore=function(e,t){var s=(0,r.useState)(u(e,t).select),o=(0,n.default)(s,2),c=o[0],l=o[1];return(0,r.useEffect)((function(){l(u(e,t).select)}),[e,t]),[c,l]},t.useSelectStatus=function(e,t){var s=(0,r.useState)(l(e,t).select),o=(0,n.default)(s,2),c=o[0],d=o[1];return(0,r.useEffect)((function(){d(l(e,t).select)}),[e,t]),[c,d]};var n=o(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),r=s("react"),c=s("./src/constants/index.ts");function l(e,t){var s=Number(e||0),o=Number(c.MODEL_COLLECTION_STATUS.getTitle(t)||0);return 3===o?o=2:2===o&&(o=3),{select:!(o>=3)&&s>o,value:s}}function d(e,t){var s,o=Number((null==(s=String(e).match(/(\d+)话/))?void 0:s[1])||0);return{select:o>Number(t||0),value:o}}function u(e,t){var s=Number(e||0);return{select:0===Number(t||0)&&0!==s,value:s}}function i(e,t){var s=String(e||"");return{select:!String(t||"")&&!!s,value:s}}},"./src/screens/web-view/douban-sync/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Component")},"./src/screens/web-view/douban-sync/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.HIT_SLOP=t.DEFAULT_PROPS=t.COMPONENT=t.BILIBILI_STATUS=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/constants/index.ts"),r=s("./src/screens/web-view/douban-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Item"),t.BILIBILI_STATUS={1:"想看",2:"在看",3:"看过"},t.HIT_SLOP={top:4,right:20,bottom:4,left:20},t.DEFAULT_PROPS={navigation:{},styles:{},item:{},collection:{},totalEps:"",hideSame:!1,noCommentUseCreateDate:!1,scoreMinuesOne:!1,onRefreshCollection:n.FROZEN_FN,onBottom:n.FROZEN_FN,onSubmit:n.FROZEN_FN}},"./src/screens/web-view/douban-sync/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/utils/decorators/index.ts"),r=o(s("./src/screens/web-view/douban-sync/component/item/item.tsx")),c=s("./src/screens/web-view/douban-sync/component/item/ds.ts"),l=s("./src/screens/web-view/douban-sync/component/item/styles.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.obc)((function(e,t){var s=e.item,o=t.$,n=t.navigation,c=s.subjectId;if(o.state.hideNotMatched&&!c)return null;var u=o.collection(c);if(o.state.hideWatched&&"collect"===(null==u?void 0:u.status))return null;var i=o.totalEps(c);return(0,d.jsx)(r.default,{navigation:n,styles:(0,l.memoStyles)(),item:s,collection:u,totalEps:i?i+"话":"",hideSame:o.state.hideSame,noCommentUseCreateDate:o.state.noCommentUseCreateDate,scoreMinuesOne:o.state.scoreMinuesOne,onRefreshCollection:o.onRefreshCollection,onBottom:o.onBottom,onSubmit:o.onSubmit})}),c.COMPONENT)},"./src/screens/web-view/douban-sync/component/item/item.tsx":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.weak-map.js"),s("./node_modules/core-js/modules/es.object.to-string.js"),s("./node_modules/core-js/modules/es.string.iterator.js"),s("./node_modules/core-js/modules/es.array.iterator.js"),s("./node_modules/core-js/modules/web.dom-collections.iterator.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),s("./node_modules/core-js/modules/es.number.constructor.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.slice.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=n(s("./node_modules/@babel/runtime/helpers/slicedToArray.js")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var s=O(t);if(s&&s.has(e))return s.get(e);var o={__proto__:null},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var c=n?Object.getOwnPropertyDescriptor(e,r):null;c&&(c.get||c.set)?Object.defineProperty(o,r,c):o[r]=e[r]}return o.default=e,s&&s.set(e,o),o}(s("react")),d=n(s("./node_modules/react-native-web/dist/exports/View/index.js")),u=s("./src/components/index.ts"),i=s("./src/components/cover/utils.ts"),a=s("./src/screens/_/index.ts"),m=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),f=s("./src/utils/decorators/index.ts"),p=s("./src/utils/fetch/index.ts"),j=s("./src/constants/index.ts"),_=n(s("./src/screens/web-view/bilibili-sync/component/btn/index.tsx")),v=n(s("./src/screens/web-view/bilibili-sync/component/column/index.tsx")),y=n(s("./src/screens/web-view/bilibili-sync/component/column-bgm/index.tsx")),h=n(s("./src/screens/web-view/bilibili-sync/component/column-select/index.tsx")),x=s("./src/screens/web-view/bilibili-sync/utils.ts"),w=s("./src/screens/web-view/douban-sync/component/item/ds.ts"),g=s("./node_modules/react/jsx-runtime.js");function O(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,s=new WeakMap;return(O=function(e){return e?s:t})(e)}t.default=(0,f.memo)((function(e){var t=e.navigation,s=e.styles,n=e.item,f=e.collection,O=e.totalEps,T=e.hideSame,P=e.noCommentUseCreateDate,S=e.scoreMinuesOne,C=e.onRefreshCollection,E=e.onBottom,N=e.onSubmit,M=n.subjectId,I=!!M,D=!(null==f||!f.loaded),R=n.progress||"";"看过"===w.BILIBILI_STATUS[n.status]&&!R&&O&&(R=O);var L=n.score?2*Number(n.score)-(S?1:0):2*n.score,k=String(n.create_time).split(" ")[0],A=P?n.content||k:n.content,B=(0,l.useState)(!1),z=(0,c.default)(B,2),F=z[0],U=z[1],H=(0,x.useSelectStatus)(n.status,null==f?void 0:f.status),q=(0,c.default)(H,2),W=q[0],G=q[1],V=(0,x.useSelectEp)(R,null==f?void 0:f.ep_status),$=(0,c.default)(V,2),X=$[0],J=$[1],Z=(0,x.useSelectScore)(L,null==f?void 0:f.rating),K=(0,c.default)(Z,2),Q=K[0],Y=K[1],ee=(0,x.useSelectComment)(A,null==f?void 0:f.comment),te=(0,c.default)(ee,2),se=te[0],oe=te[1],ne={status:w.BILIBILI_STATUS[n.status]||"",ep:R||"",score:n.score||"",comment:A||""},re={status:j.MODEL_COLLECTION_STATUS.getLabel(null==f?void 0:f.status)||"",ep:(null==f?void 0:f.ep_status)&&f.ep_status+"话",score:(null==f?void 0:f.rating)||"",comment:(null==f?void 0:f.comment)||""};if(T&&ne.status==re.status&&ne.ep==re.ep&&ne.score==re.score&&ne.comment==re.comment)return null;var ce={status:w.BILIBILI_STATUS[n.status],ep:(0,x.getSelectEp)(R,null==f?void 0:f.ep_status).value,score:(0,x.getSelectScore)(L,null==f?void 0:f.rating).value,comment:(0,x.getSelectComment)(A,null==f?void 0:f.comment).value},le=function(){I&&t.push("Subject",{subjectId:M,_cn:n.title,_image:(0,i.getCoverSrc)(n.cover,j.IMG_WIDTH_SM)})};return(0,g.jsxs)(u.Flex,{style:s.item,align:"start",children:[(0,g.jsx)(a.Cover,{src:n.cover,width:j.IMG_WIDTH_SM,height:j.IMG_HEIGHT_SM,radius:!0,onPress:le}),(0,g.jsx)(u.Flex.Item,{children:(0,g.jsxs)(u.Flex,{style:s.body,direction:"column",align:"start",children:[(0,g.jsx)(u.Text,{bold:!0,numberOfLines:2,onPress:le,children:n.title}),!!n.create_time&&(0,g.jsx)(u.Text,{style:m._.mt.sm,size:11,type:"sub",bold:!0,children:n.create_time.slice(0,16)}),(0,g.jsxs)(u.Flex,{style:m._.mt.md,align:"start",children:[(0,g.jsxs)(d.default,{children:[(0,g.jsx)(v.default,{text:" ",type:"sub"}),(0,g.jsx)(v.default,{style:m._.mt.md,text:"状态",type:"sub"}),(0,g.jsx)(v.default,{style:m._.mt.md,text:"进度",type:"sub"}),(0,g.jsx)(v.default,{style:m._.mt.md,text:"评分",type:"sub"}),(0,g.jsx)(v.default,{style:m._.mt.md,text:"评论",type:"sub"})]}),(0,g.jsxs)(u.Flex.Item,{style:m._.ml.md,children:[(0,g.jsx)(v.default,{text:"douban",type:"sub"}),(0,g.jsx)(v.default,{style:m._.mt.md,text:ne.status}),(0,g.jsx)(v.default,{style:m._.mt.md,text:ne.ep}),(0,g.jsx)(v.default,{style:m._.mt.md,text:ne.score?ne.score+"★":ne.score}),(0,g.jsx)(v.default,{style:m._.mt.md,text:ne.comment,onPress:function(){n.content&&(0,b.copy)(n.content,"已复制")}})]}),(0,g.jsxs)(u.Flex.Item,{style:m._.ml.md,flex:1.5,children:[(0,g.jsx)(v.default,{text:"bgm",type:"sub",right:I&&(0,g.jsx)(u.Touchable,{style:m._.ml.xs,hitSlop:w.HIT_SLOP,onPress:function(){return C(M)},children:(0,g.jsx)(u.Iconfont,{name:"md-refresh",size:12})})}),I?D?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(y.default,{select:W,text:re.status,next:ce.status}),(0,g.jsx)(y.default,{select:X,text:re.ep,next:ce.ep+"话"}),(0,g.jsx)(y.default,{select:Q,text:re.score,next:ce.score}),(0,g.jsx)(y.default,{select:se,text:re.comment,next:ce.comment})]}):(0,g.jsx)(u.Flex,{style:s.loading,children:(0,g.jsx)(u.Loading.Mini,{})}):(0,g.jsx)(v.default,{style:m._.mt.md,text:"未找到条目"})]}),I&&(0,g.jsxs)(d.default,{style:s.selectors,children:[(0,g.jsx)(v.default,{text:" ",type:"sub"}),D&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(h.default,{select:W,disabled:!ce.status,onPress:G}),(0,g.jsx)(h.default,{select:X,disabled:""===ce.ep,onPress:J}),(0,g.jsx)(h.default,{select:Q,disabled:!ce.score,onPress:Y}),(0,g.jsx)(h.default,{select:se,disabled:!ce.comment,onPress:oe})]})]})]}),(0,g.jsx)(d.default,{style:s.toolbar,children:(0,g.jsxs)(u.Flex,{style:m._.mt.md,children:[(0,g.jsx)(u.Flex.Item,{children:(0,g.jsxs)(u.Flex,{children:[(0,g.jsx)(_.default,{text:"详情",onPress:function(){(0,p.t)("豆瓣同步.详情"),(0,b.open)("https://m.douban.com/movie/subject/"+n.id)}}),(0,g.jsx)(_.default,{style:m._.ml.sm,text:"搜索",onPress:function(){(0,p.t)("豆瓣同步.搜索"),t.push("Search",{type:"动画",value:n.title})}}),(0,g.jsx)(_.default,{style:m._.ml.sm,text:"置底",onPress:function(){return E(n.id)}})]})}),I&&(0,g.jsx)(_.default,{style:m._.ml.md,type:"success",disabled:!D||!(W||X||Q||se),loading:F,onPress:(0,r.default)(o.mark((function e(){var t,s,n;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},s={},W?"想看"===ce.status?(t.status=!0,s.status="wish"):"看过"===ce.status?(t.status=!0,s.status="collect"):"在看"===ce.status&&(t.status=!0,s.status="do"):re.status&&(t.status=!0,s.status=j.MODEL_COLLECTION_STATUS.getValue(re.status)),Q&&(t.score=!0,s.rating=Number(ce.score)||0),se&&(t.comment=!0,s.comment=ce.comment),n={},X&&(t.ep=!0,n.ep=ce.ep),U(!0),e.next=10,N(M,s,n);case 10:U(!1),t.status&&G(!1),t.ep&&J(!1),t.score&&Y(!1),t.comment&&oe(!1);case 15:case"end":return e.stop()}}),e)})))})]})})]})})]})}),w.DEFAULT_PROPS)},"./src/screens/web-view/douban-sync/component/item/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{item:{paddingRight:o._.wind-o._._wind,paddingLeft:o._.wind,paddingVertical:o._.md,marginBottom:o._.sm},body:{paddingLeft:o._.md},selectors:{width:48},toolbar:{width:"100%",paddingRight:o._._wind,marginTop:o._.xs},loading:{marginTop:13}}}))},"./src/screens/web-view/douban-sync/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"List")},"./src/screens/web-view/douban-sync/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/screens/_/index.ts"),r=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),l=o(s("./src/screens/web-view/douban-sync/component/tool-bar/index.tsx")),d=s("./src/screens/web-view/douban-sync/component/list/utils.tsx"),u=s("./src/screens/web-view/douban-sync/component/list/ds.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.default,{}),(0,i.jsx)(n.PaginationList2,{contentContainerStyle:r._.container.bottom,data:s.data,limit:12,keyboardDismissMode:"on-drag",ListHeaderComponent:s.data.length?(0,i.jsxs)(n.Notice,{children:["共查找到 ",s.data.length," 项结果，其中 ",s.matchCount," 项匹配成功"]}):null,renderItem:d.renderItem,onPage:s.onPage})]})}),u.COMPONENT)},"./src/screens/web-view/douban-sync/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=function(e){var t=e.item;return(0,r.jsx)(n.default,{item:t})};o(s("react"));var n=o(s("./src/screens/web-view/douban-sync/component/item/index.tsx")),r=s("./node_modules/react/jsx-runtime.js")},"./src/screens/web-view/douban-sync/component/login/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Login")},"./src/screens/web-view/douban-sync/component/login/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.string.fixed.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=o(s("./node_modules/react-native-web/dist/exports/View/index.js")),r=s("./src/components/index.ts"),c=s("./src/screens/_/index.ts"),l=s("./src/stores/index.ts"),d=s("./src/utils/index.ts"),u=s("./src/utils/decorators/index.ts"),i=s("./src/utils/fetch/index.ts"),a=o(s("./src/screens/web-view/bilibili-sync/component/btn/index.tsx")),m=s("./src/screens/web-view/douban-sync/component/login/ds.ts"),b=s("./src/screens/web-view/douban-sync/component/login/styles.ts"),f=s("./node_modules/react/jsx-runtime.js");t.default=(0,u.obc)((function(e,t){var s=t.$,o=(0,b.memoStyles)(),u=s.state,m=u.doubanId,p=u.hide,j=u.data,_=u.progress;return(0,f.jsxs)(f.Fragment,{children:[!p&&(0,f.jsx)(n.default,{style:o.mask}),(0,f.jsxs)(n.default,{style:(0,d.stl)(o.fixed,p&&o.hide),children:[(0,f.jsxs)(n.default,{style:o.user,children:[(0,f.jsx)(r.Input,{style:o.input,defaultValue:m,multiline:!0,numberOfLines:3,placeholder:"输入豆瓣用户空间地址或用户的豆瓣 ID",onChangeText:s.onChange}),(0,f.jsxs)(r.Flex,{style:l._.mt.md,children:[(0,f.jsx)(r.Text,{size:15,bold:!0,children:s.doubanId?"匹配到豆瓣ID："+s.doubanId:"未匹配到豆瓣ID"}),!!s.doubanId&&(0,f.jsx)(c.IconTouchable,{name:"md-open-in-new",size:18,onPress:function(){(0,i.t)("豆瓣同步.检查"),(0,d.open)("https://m.douban.com/people/"+s.doubanId+"/")}})]}),!!j.list.length&&(0,f.jsxs)(r.Text,{style:l._.mt.md,bold:!0,children:["当前已获取 ",j.list.length," 个影视收藏，其中 ",s.matchCount," 个条目匹配 bgm.tv 数据成功。"]})]}),(0,f.jsxs)(n.default,{style:o.body,children:[(0,f.jsx)(r.Text,{style:l._.mt.sm,size:13,type:"sub",children:"请务必准确填写您的豆瓣用户空间地址或豆瓣 ID。例如: https://www.douban.com/people/123456 或 123456。"}),(0,f.jsx)(r.Text,{style:l._.mt.sm,size:13,type:"sub",children:"网页版: 右上方 → 个人主页 → 复制网页地址。"}),(0,f.jsx)(r.Text,{style:l._.mt.sm,size:13,type:"sub",children:"豆瓣客户端: 底部菜单我 → 左上方菜单 → 点击头像 → 豆瓣ID。"}),(0,f.jsx)(r.Text,{style:l._.mt.md,size:13,type:"sub",children:"请知悉，因收录规则不同，绝大部分豆瓣条目不在 bgm.tv 收录范围内。"}),(0,f.jsx)(r.Text,{style:l._.mt.md,size:13,type:"sub",children:"此功能目前为实验性质，仅获取用户想看、在看、看过的影视条目，未来可能会逐步扩大到书籍和游戏。"}),(0,f.jsx)(r.Text,{style:l._.mt.sm,size:13,type:"sub",children:"自己主动隐藏的条目不能获取。请勿过度获取数据，可能会被豆瓣封 IP 几个小时。"}),(0,f.jsxs)(r.Flex,{style:l._.mt.lg,justify:"center",children:[(0,f.jsx)(a.default,{style:o.btn,btnStyle:o.btnStyle,text:"重新获取数据",size:13,loading:_.fetching,onPress:function(){_.fetching?(0,d.info)("已在获取中..."):(s.fetchDouban(),(0,i.t)("豆瓣同步.获取数据"))}}),(0,f.jsx)(a.default,{style:[o.btn,l._.ml.md],btnStyle:o.btnStyle,text:"收起窗口",size:13,onPress:s.onToggleHide})]})]})]})]})}),m.COMPONENT)},"./src/screens/web-view/douban-sync/component/login/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var o=s("./src/stores/index.ts");t.memoStyles=o._.memoStyles((function(){return{mask:{position:"absolute",zIndex:1,top:0,right:0,bottom:0,left:0},fixed:{position:"absolute",zIndex:2,top:8,right:o._.wind,width:o._.window.contentWidth,backgroundColor:o._.select(o._.colorPlain,o._._colorDarkModeLevel2),borderRadius:o._.radiusMd,shadowColor:o._.colorShadow,shadowOffset:{width:1,height:2},shadowOpacity:.16,shadowRadius:6,elevation:o._.select(16,0)},hide:{top:o._.sm,right:o._.sm,width:1,height:1,backgroundColor:"transparent",overflow:"hidden"},body:{paddingHorizontal:o._.md,paddingBottom:28},btn:{width:128},btnStyle:{height:40},user:{paddingVertical:12,paddingHorizontal:o._._wind},input:{backgroundColor:o._.colorBg,borderRadius:o._.radiusMd}}}))},"./src/screens/web-view/douban-sync/component/tips/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Tips")},"./src/screens/web-view/douban-sync/component/tips/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/utils/decorators/index.ts"),c=s("./src/screens/web-view/douban-sync/component/tips/ds.ts"),l=s("./node_modules/react/jsx-runtime.js");t.default=(0,r.obc)((function(e,t){var s=t.$.state.progress,o=s.fetching,r=s.message,c=s.current,d=s.total;return(0,l.jsx)(n.Progress,{show:o,message:r,current:c,total:d})}),c.COMPONENT)},"./src/screens/web-view/douban-sync/component/tool-bar/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/component/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"ToolBar")},"./src/screens/web-view/douban-sync/component/tool-bar/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/stores/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/screens/web-view/douban-sync/component/tool-bar/ds.ts"),d=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.obc)((function(e,t){var s=t.$;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.ToolBar,{children:[(0,d.jsxs)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideNotMatched")},children:[(0,d.jsx)(n.Text,{size:11,bold:!0,children:"隐藏未匹配"}),s.state.hideNotMatched&&(0,d.jsx)(n.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,d.jsx)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideWatched")},children:(0,d.jsxs)(n.Flex,{children:[(0,d.jsx)(n.Text,{size:11,bold:!0,children:"隐藏看过"}),s.state.hideWatched&&(0,d.jsx)(n.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]})}),(0,d.jsxs)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("hideSame")},children:[(0,d.jsx)(n.Text,{size:11,bold:!0,children:"隐藏相同状态"}),s.state.hideSame&&(0,d.jsx)(n.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]})]}),(0,d.jsxs)(n.ToolBar,{children:[(0,d.jsxs)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("noCommentUseCreateDate")},children:[(0,d.jsx)(n.Text,{size:11,bold:!0,children:"创建时间作为评论"}),s.state.noCommentUseCreateDate&&(0,d.jsx)(n.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,d.jsxs)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("scoreMinuesOne")},children:[(0,d.jsx)(n.Text,{size:11,bold:!0,children:"评分 -1"}),s.state.scoreMinuesOne&&(0,d.jsx)(n.Iconfont,{style:[r._.ml.xs,r._.mr._xs],name:"md-check",size:11,color:r._.colorDesc})]}),(0,d.jsx)(n.ToolBar.Touchable,{onSelect:function(){return s.onToggle("privacy")},children:(0,d.jsxs)(n.Text,{size:11,bold:!0,children:["同步时",s.state.privacy?"私密":"公开"]})})]})]})}),l.COMPONENT)},"./src/screens/web-view/douban-sync/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.LOADED_TOTAL_EPS=t.LOADED=t.HOST_API=t.COMPONENT=void 0;t.COMPONENT="DoubanSync",t.HOST_API="https://api.bgm.tv",t.LOADED={},t.LOADED_TOTAL_EPS={}},"./src/screens/web-view/douban-sync/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),n=s("./src/screens/web-view/douban-sync/ds.ts");t.COMPONENT=(0,o.rc)(n.COMPONENT,"Header")},"./src/screens/web-view/douban-sync/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/screens/_/index.ts"),c=s("./src/stores/index.ts"),l=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),u=s("./src/screens/web-view/douban-sync/header/ds.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,l.obc)((function(e,t){var s=t.$,o=t.navigation,l=s.state.hide;return(0,i.jsx)(n.Header,{title:"豆瓣同步",hm:["douban-sync","DoubanSync"],headerRight:function(){return(0,i.jsxs)(n.Flex,{children:[(0,i.jsx)(r.IconTouchable,{style:c._.mr.xs,name:l?"md-refresh":"md-close",color:c._.colorDesc,onPress:s.onToggleHide}),(0,i.jsx)(r.IconTouchable,{name:"md-info-outline",color:c._.colorDesc,size:19,onPress:function(){(0,d.t)("豆瓣同步.关于"),o.push("Information",{title:"豆瓣同步",message:["此功能目前为实验性质。","请点击旁边的刷新按钮根据提示完成数据获取，然后开始同步数据。","因自动对比的数据存在较大的出错可能，目前不打算做一键提交功能，请手动核实后自行提交。","网页版不存在此功能，所以此为高级会员功能。此功能开发不易，目前暂时对所有用户开放，觉得有用可支持一下。"],advance:!0})}})]})}})}),u.COMPONENT)},"./src/screens/web-view/douban-sync/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("react"));var n=s("./src/components/index.ts"),r=s("./src/utils/index.ts"),c=s("./src/utils/decorators/index.ts"),l=s("./src/utils/hooks/index.ts"),d=o(s("./src/screens/web-view/douban-sync/component/list/index.tsx")),u=o(s("./src/screens/web-view/douban-sync/component/login/index.tsx")),i=o(s("./src/screens/web-view/douban-sync/component/tips/index.tsx")),a=o(s("./src/screens/web-view/douban-sync/header/index.tsx")),m=o(s("./src/screens/web-view/douban-sync/store/index.ts")),b=s("./node_modules/react/jsx-runtime.js");t.default=(0,c.ic)(m.default,(function(e,t){var s=t.$;return(0,l.useMount)((function(){(0,r.runAfter)((function(){s.init()}))})),(0,l.useObserver)((function(){return(0,b.jsxs)(n.Component,{id:"screen-douban-sync",children:[(0,b.jsx)(a.default,{}),(0,b.jsxs)(n.Page,{loaded:s.state._loaded,children:[(0,b.jsx)(u.default,{}),(0,b.jsx)(d.default,{}),(0,b.jsx)(i.default,{})]})]})}))}))},"./src/screens/web-view/douban-sync/store/action.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.string.trim.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.keys.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/web.timers.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s("./src/utils/index.ts"),f=s("./src/utils/fetch/index.ts"),p=s("./src/utils/fetch.v0/index.ts"),j=s("./src/screens/web-view/douban-sync/ds.ts"),_=n(s("./src/screens/web-view/douban-sync/store/fetch.ts"));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var n=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,n)}else s=o.apply(this,arguments);return(0,i.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=v(s);function s(){var e,n,c;(0,l.default)(this,s);for(var u=arguments.length,i=new Array(u),a=0;a<u;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),(0,m.default)((0,d.default)(e),"onChange",(function(t){e.setState({doubanId:t.trim()})})),(0,m.default)((0,d.default)(e),"onPage",(function(t){e.fetchCollections(t.filter((function(e){return e.subjectId})).map((function(e){return e.subjectId}))),e.fetchTotalEps(t.filter((function(e){return e.subjectId&&!e.progress&&3===e.status})).map((function(e){return e.subjectId})))})),(0,m.default)((0,d.default)(e),"onBottom",(function(t){var s=e.state.bottom.current+1;e.setState({bottom:(0,m.default)({current:s},t,s)}),e.save(),(0,f.t)("豆瓣同步.置底")})),(0,m.default)((0,d.default)(e),"onSubmit",(n=(0,r.default)(o.mark((function t(s,n,r){var c;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}return t.abrupt("return",!1);case 2:if(!Object.keys(n).length){t.next=6;break}return c=e.state.privacy,t.next=6,(0,p.request)(j.HOST_API+"/collection/"+s+"/update",Object.assign({},n,{privacy:c?1:0}));case 6:if(!Object.keys(r).length){t.next=9;break}return t.next=9,(0,p.request)(j.HOST_API+"/subject/"+s+"/update/watched_eps",{watched_eps:r.ep||0});case 9:return t.next=11,e.fetchCollection(s);case 11:(0,b.feedback)(),(0,f.t)("豆瓣同步.同步");case 13:case"end":return t.stop()}}),t)}))),function(e,t,s){return n.apply(this,arguments)})),(0,m.default)((0,d.default)(e),"onToggle",(c=(0,r.default)(o.mark((function t(s){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState((0,m.default)({},s,!e.state[s])),e.save();case 2:case"end":return t.stop()}}),t)}))),function(e){return c.apply(this,arguments)})),(0,m.default)((0,d.default)(e),"onRefreshCollection",(function(t){e.setState({collections:(0,m.default)({},t,Object.assign({},e.collection(t)||{},{loaded:0}))}),setTimeout((function(){e.fetchCollection(t)}),0)})),e}return(0,c.default)(s)}(_.default)},"./src/screens/web-view/douban-sync/store/computed.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/es.string.includes.js"),s("./node_modules/core-js/modules/es.string.split.js"),s("./node_modules/core-js/modules/es.regexp.exec.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=o(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),a=s("./node_modules/mobx/dist/mobx.esm.js"),m=s("./src/stores/index.ts"),b=s("./src/utils/index.ts"),f=o(s("./src/screens/web-view/douban-sync/store/state.ts"));function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,n)}else s=o.apply(this,arguments);return(0,d.default)(this,s)}}t.default=(n=function(e){(0,l.default)(s,e);var t=p(s);function s(){return(0,r.default)(this,s),t.apply(this,arguments)}return(0,c.default)(s,[{key:"doubanId",get:function(){var e,t,s,o=this.state.doubanId;return o?o.includes("://")?null==(e=o.split("/people/"))||null==(t=e[1])||null==(s=t.split("/"))?void 0:s[0]:o:""}},{key:"userId",get:function(){return m.userStore.usersInfo(m.userStore.myUserId).username||m.userStore.myUserId}},{key:"data",get:function(){var e=this.state,t=e.data,s=e.bottom;return t.list.slice().sort((function(e,t){return(0,b.asc)(s[e.id]||0,s[t.id]||0)})).sort((function(e,t){return(0,b.desc)(e.subjectId?1:0,t.subjectId?1:0)}))}},{key:"matchCount",get:function(){var e=0;return this.state.data.list.forEach((function(t){t.subjectId&&(e+=1)})),e}},{key:"collection",value:function(e){var t=this;return(0,a.computed)((function(){return t.state.collections[e]})).get()}},{key:"totalEps",value:function(e){var t=this;return(0,a.computed)((function(){return t.state.totalEps[e]||0})).get()}}]),s}(f.default),(0,i.default)(n.prototype,"doubanId",[a.computed],Object.getOwnPropertyDescriptor(n.prototype,"doubanId"),n.prototype),(0,i.default)(n.prototype,"userId",[a.computed],Object.getOwnPropertyDescriptor(n.prototype,"userId"),n.prototype),(0,i.default)(n.prototype,"data",[a.computed],Object.getOwnPropertyDescriptor(n.prototype,"data"),n.prototype),(0,i.default)(n.prototype,"matchCount",[a.computed],Object.getOwnPropertyDescriptor(n.prototype,"matchCount"),n.prototype),n)},"./src/screens/web-view/douban-sync/store/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.NAMESPACE=t.EXCLUDE_STATE=void 0;var o=s("./src/screens/web-view/douban-sync/ds.ts"),n=(t.NAMESPACE="Screen"+o.COMPONENT,t.EXCLUDE_STATE={progress:{fetching:!1,message:"",current:0,total:0}});t.STATE=Object.assign({doubanId:"",data:{list:[],_loaded:0},collections:{},totalEps:{},bottom:{current:0},hide:!1,hideWatched:!1,hideSame:!1,hideNotMatched:!1,noCommentUseCreateDate:!1,scoreMinuesOne:!1,privacy:!1},n,{_loaded:!1})},"./src/screens/web-view/douban-sync/store/fetch.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.for-each.js"),s("./node_modules/core-js/modules/web.dom-collections.for-each.js"),s("./node_modules/core-js/modules/es.array.sort.js"),s("./node_modules/core-js/modules/es.array.slice.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s("./src/utils/index.ts"),f=s("./src/utils/fetch/index.ts"),p=s("./src/utils/fetch.v0/index.ts"),j=n(s("./src/constants/i18n/index.ts")),_=s("./src/assets/json/index.web.ts"),v=s("./src/screens/web-view/douban-sync/ds.ts"),y=n(s("./src/screens/web-view/douban-sync/store/computed.ts")),h=s("./src/screens/web-view/douban-sync/store/ds.ts");function x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var n=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,n)}else s=o.apply(this,arguments);return(0,i.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=x(s);function s(){var e,n;(0,l.default)(this,s);for(var c=arguments.length,u=new Array(c),i=0;i<c;i++)u[i]=arguments[i];return e=t.call.apply(t,[this].concat(u)),(0,m.default)((0,d.default)(e),"fetchDouban",(0,r.default)(o.mark((function t(){var s,n,r,c,l,d,u,i,a,m,p,j,v,y=arguments;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=y.length>0&&void 0!==y[0]?y[0]:"done",n=y.length>1&&void 0!==y[1]?y[1]:1,r=!(y.length>2&&void 0!==y[2])||y[2],e.doubanId){t.next=6;break}return r&&(0,b.info)("匹配豆瓣 ID 有误，请核实"),t.abrupt("return",!1);case 6:return l=(n-1)*(c=40),t.prev=8,e.setState({progress:{fetching:!0}}),t.next=12,(0,f.xhrCustom)({url:"https://m.douban.com/rexxar/api/v2/user/"+e.doubanId+"/interests?type=movie&status="+s+"&start="+l+"&count="+c+"&ck=PylB&for_mobile=1",headers:{Referer:"https://m.douban.com"}});case 12:return d=t.sent,u=d._response,i=JSON.parse(u),a=i.interests,m=void 0===a?[]:a,p=i.total,t.next=17,(0,_.loadJSON)("thirdParty/d.min");case 17:return j=t.sent,m.forEach((function(t){var s,o,n,r,c,l,d;e.collections.push({id:null==(s=t.subject)?void 0:s.id,subjectId:j[null==(o=t.subject)?void 0:o.id]||0,title:null==(n=t.subject)?void 0:n.title,cover:(null==(r=t.subject)||null==(c=r.pic)?void 0:c.normal)||"",status:"mark"===t.status?1:"doing"===t.status?2:3,progress:"done"===t.status&&"movie"===(null==(l=t.subject)?void 0:l.type)?"1话":0,content:t.comment||"",score:(null==t||null==(d=t.rating)?void 0:d.value)||0,create_time:t.create_time||"0"})})),t.next=21,(0,b.sleep)();case 21:v="mark"===s?"想看":"doing"===s?"在看":"看过",e.setState({progress:{fetching:!0,message:"正在获取"+v+"收藏",current:n,total:Math.floor(p/c)+1}}),n*c<p?e.fetchDouban(s,n+1):"done"===s?e.fetchDouban("doing",1):"doing"===s?e.fetchDouban("mark",1):(e.onToggleHide(),e.setState({data:{list:e.collections.slice().sort((function(e,t){return(0,b.desc)(e.create_time,t.create_time)})),_loaded:(0,b.getTimestamp)()},progress:h.EXCLUDE_STATE.progress}),(0,b.info)("已获取 "+e.collections.length+" 个收藏"),(0,b.feedback)(),(0,f.t)("豆瓣同步.获取成功",{length:e.collections.length,userId:e.userId}),e.collections=[],e.save()),t.next=32;break;case 27:t.prev=27,t.t0=t.catch(8),(0,b.info)("获取数据出错，请检查"),(0,b.feedback)(),e.setState({progress:h.EXCLUDE_STATE.progress});case 32:case"end":return t.stop()}}),t,null,[[8,27]])})))),(0,m.default)((0,d.default)(e),"fetchCollection",(n=(0,r.default)(o.mark((function t(s){var n,r;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},t.next=3,(0,p.request)(v.HOST_API+"/collection/"+s);case 3:null!=(r=t.sent)&&r.status?n[s]={status:r.status.type,ep_status:r.ep_status,private:r.private,rating:r.rating,comment:r.comment,loaded:(0,b.getTimestamp)()}:n[s]={loaded:(0,b.getTimestamp)()},e.setState({collections:n}),e.save();case 7:case"end":return t.stop()}}),t)}))),function(e){return n.apply(this,arguments)})),(0,m.default)((0,d.default)(e),"fetchCollections",(0,r.default)(o.mark((function t(){var s,n,c,l=arguments;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=l.length>0&&void 0!==l[0]?l[0]:[],e.userId){t.next=4;break}return(0,b.info)("此功能依赖收藏数据，请先"+j.default.login(),4),t.abrupt("return",!1);case 4:return n={},c=[],s.forEach((function(e){v.LOADED[e]||(v.LOADED[e]=!0,c.push((0,r.default)(o.mark((function t(){var s;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,p.request)(v.HOST_API+"/collection/"+e);case 2:return null!=(s=t.sent)&&s.status?n[e]={status:s.status.type,ep_status:s.ep_status,private:s.private,rating:s.rating,comment:s.comment,loaded:(0,b.getTimestamp)()}:n[e]={loaded:(0,b.getTimestamp)()},t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))))})),t.next=9,(0,f.queue)(c,2);case 9:e.setState({collections:n}),e.save();case 11:case"end":return t.stop()}}),t)})))),(0,m.default)((0,d.default)(e),"fetchTotalEps",(0,r.default)(o.mark((function t(){var s,n,c=arguments;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={},n=[],(c.length>0&&void 0!==c[0]?c[0]:[]).forEach((function(e){v.LOADED_TOTAL_EPS[e]||(v.LOADED_TOTAL_EPS[e]=!0,n.push((0,r.default)(o.mark((function t(){var n;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,p.request)(v.HOST_API+"/v0/subjects/"+e+"?responseGroup=small");case 3:(null!=(n=t.sent)&&n.total_episodes||null!=n&&n.eps)&&(s[e]=(null==n?void 0:n.total_episodes)||(null==n?void 0:n.eps)||0),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))))})),t.next=6,(0,f.queue)(n,2);case 6:e.setState({totalEps:s}),e.save();case 8:case"end":return t.stop()}}),t)})))),(0,m.default)((0,d.default)(e),"onToggleHide",(function(){e.setState({hide:!e.state.hide}),e.save()})),e}return(0,c.default)(s)}(y.default)},"./src/screens/web-view/douban-sync/store/index.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.object.assign.js");var n=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),c=n(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),d=n(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(s("./node_modules/@babel/runtime/helpers/inherits.js")),i=n(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),a=n(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=n(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=n(s("./src/screens/web-view/douban-sync/store/action.ts")),f=s("./src/screens/web-view/douban-sync/store/ds.ts");function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,a.default)(e);if(t){var n=(0,a.default)(this).constructor;s=Reflect.construct(o,arguments,n)}else s=o.apply(this,arguments);return(0,i.default)(this,s)}}t.default=function(e){(0,u.default)(s,e);var t=p(s);function s(){var e;(0,l.default)(this,s);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return e=t.call.apply(t,[this].concat(c)),(0,m.default)((0,d.default)(e),"init",(0,r.default)(o.mark((function t(){var s,n,r,c,l,d;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(f.NAMESPACE);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,e.setState(Object.assign({},r,{hide:!(null==r||null==(s=r.data)||null==(n=s.list)||!n.length)},f.EXCLUDE_STATE,{_loaded:!0})),c=e.state,l=c.data,d=c.progress,l.list.length||d.fetching||e.fetchDouban("done",1,!1);case 9:case"end":return t.stop()}}),t)})))),e}return(0,c.default)(s)}(b.default)},"./src/screens/web-view/douban-sync/store/state.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(s("./node_modules/@babel/runtime/helpers/createClass.js")),r=o(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),l=o(s("./node_modules/@babel/runtime/helpers/inherits.js")),d=o(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),u=o(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),i=o(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=s("./node_modules/mobx/dist/mobx.esm.js"),m=o(s("./src/utils/store/index.ts")),b=s("./src/screens/web-view/douban-sync/store/ds.ts");function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,u.default)(e);if(t){var n=(0,u.default)(this).constructor;s=Reflect.construct(o,arguments,n)}else s=o.apply(this,arguments);return(0,d.default)(this,s)}}t.default=function(e){(0,l.default)(s,e);var t=f(s);function s(){var e;(0,r.default)(this,s);for(var o=arguments.length,n=new Array(o),l=0;l<o;l++)n[l]=arguments[l];return e=t.call.apply(t,[this].concat(n)),(0,i.default)((0,c.default)(e),"state",(0,a.observable)(b.STATE)),(0,i.default)((0,c.default)(e),"collections",[]),(0,i.default)((0,c.default)(e),"save",(function(){return e.saveStorage(b.NAMESPACE,b.EXCLUDE_STATE)})),e}return(0,n.default)(s)}(m.default)}}]);