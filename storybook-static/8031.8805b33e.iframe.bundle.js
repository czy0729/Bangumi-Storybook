(self.webpackChunkweb=self.webpackChunkweb||[]).push([[8031],{"./src/screens/discovery/dollars/component/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),o=r("./src/screens/discovery/dollars/ds.ts");s.COMPONENT=(0,t.rc)(o.COMPONENT,"Component")},"./src/screens/discovery/dollars/component/item/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.ITEM_HEIGHT=s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),o=r("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(o.COMPONENT,"Item"),s.ITEM_HEIGHT=64},"./src/screens/discovery/dollars/component/item/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.string.match.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.string.replace.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var o=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),n=r("./src/components/index.ts"),d=r("./src/screens/_/index.ts"),l=r("./src/stores/index.ts"),c=r("./src/utils/index.ts"),i=r("./src/utils/decorators/index.ts"),a=r("./src/utils/fetch/index.ts"),u=r("./src/constants/index.ts"),m=r("./src/screens/discovery/dollars/component/item/ds.ts"),f=r("./src/screens/discovery/dollars/component/item/styles.ts"),p=r("./node_modules/react/jsx-runtime.js");s.default=(0,i.obc)((function(e,s){var r,t=e.index,i=e.avatar,_=e.nickname,y=e.msg,j=e.color,x=s.$,v=s.navigation,b=(0,f.memoStyles)(),h=null==(r=String(i).match(/\/(\d+)\.jpg/))?void 0:r[1];return(0,p.jsxs)(n.Flex,{style:b.item,align:"start",children:[(0,p.jsxs)(n.Flex,{style:b.avatar,direction:"column",children:[(0,p.jsx)(n.UserStatus,{userId:h,children:(0,p.jsx)(d.InView,{style:b.inView,y:m.ITEM_HEIGHT*t+1,children:(0,p.jsx)(d.Avatar,{src:u.HOST+"/pic/user/l/"+i,size:52,borderWidth:2,borderColor:l._.select(l._.colorBorder,"rgba(255, 255, 255, 0.88)"),radius:l._.radiusSm,onPress:function(){return x.onToggleShow(_)},onLongPress:function(){h&&(v.push("Zone",{userId:h}),(0,a.t)("Dollars.跳转",{to:"Zone",userId:h}))}})})}),(0,p.jsx)(n.Text,{style:l._.mt.sm,size:12,bold:!0,align:"center",children:_})]}),(0,p.jsx)(n.Flex.Item,{children:(0,p.jsx)(o.default,{style:[b.content,{backgroundColor:j||"transparent"}],children:(0,p.jsx)(n.Text,{type:"__plain__",lineHeight:17,bold:!0,shadow:!0,selectable:!0,children:(0,c.HTMLDecode)(y).replace(/<br \/>/g,"")})})})]})}),m.COMPONENT)},"./src/screens/discovery/dollars/component/item/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{item:{paddingVertical:12},inView:{minWidth:52,minHeight:52},avatar:{width:80,paddingRight:12},content:{padding:15,paddingTop:12,marginTop:-1,borderWidth:5,borderRadius:t._.radiusMd,borderColor:t._.select("rgba(255, 255, 255, 0.5)","rgba(255, 255, 255, 0.88)")},moreStyle:{}}}))},"./src/screens/discovery/dollars/component/list/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),o=r("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(o.COMPONENT,"List")},"./src/screens/discovery/dollars/component/list/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var o=r("./src/screens/_/index.ts"),n=r("./src/stores/index.ts"),d=r("./src/utils/index.ts"),l=r("./src/utils/decorators/index.ts"),c=r("./src/constants/index.ts"),i=r("./src/screens/discovery/dollars/component/list/utils.tsx"),a=r("./src/screens/discovery/dollars/component/list/ds.ts"),u=r("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var r=s.$;return(0,u.jsx)(o.PaginationList2,Object.assign({forwardRef:r.forwardRef,keyExtractor:d.keyExtractor,style:n._.container.wind,contentContainerStyle:n._.container.bottom},c.SCROLL_VIEW_RESET_PROPS,{scrollEventThrottle:16,data:r.dollars.list,renderItem:i.renderItem,onScroll:r.onScroll}))}),a.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/discovery/dollars/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/discovery/dollars/component/list/index.tsx#list"})}catch(e){}},"./src/screens/discovery/dollars/component/list/utils.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.renderItem=d;t(r("react"));var o=t(r("./src/screens/discovery/dollars/component/item/index.tsx")),n=r("./node_modules/react/jsx-runtime.js");function d(e){var s=e.item,r=e.index;return(0,n.jsx)(o.default,Object.assign({index:r},s),s.id)}try{d.displayName="renderItem",d.__docgenInfo={description:"",displayName:"renderItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/discovery/dollars/component/list/utils.tsx#renderItem"]={docgenInfo:d.__docgenInfo,name:"renderItem",path:"src/screens/discovery/dollars/component/list/utils.tsx#renderItem"})}catch(e){}},"./src/screens/discovery/dollars/component/textarea/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),o=r("./src/screens/discovery/dollars/component/ds.ts");s.COMPONENT=(0,t.rc)(o.COMPONENT,"Textarea")},"./src/screens/discovery/dollars/component/textarea/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var o=t(r("./node_modules/react-native-web/dist/exports/View/index.js")),n=r("./src/components/index.ts"),d=r("./src/stores/index.ts"),l=r("./src/utils/decorators/index.ts"),c=r("./src/screens/discovery/dollars/component/textarea/ds.ts"),i=r("./src/screens/discovery/dollars/component/textarea/styles.ts"),a=r("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var r=s.$;if(!r.state.show)return null;var t=(0,i.memoStyles)();return(0,a.jsxs)(o.default,{style:t.container,children:[(0,a.jsx)(n.Input,{ref:r.forwardInputRef,style:t.textarea,inputStyle:t.input,multiline:!0,numberOfLines:3,value:r.state.text,placeholder:"单击头像可以@某人，长按则前往空间",autoFocus:!0,returnKeyType:"done",returnKeyLabel:"发送",onChangeText:r.onChangeText,onSubmitEditing:r.onSubmit}),(0,a.jsx)(n.Touchable,{style:d._.mt.md,onPress:r.onSubmit,children:(0,a.jsx)(o.default,{style:t.btn,children:(0,a.jsx)(n.Text,{size:16,bold:!0,align:"center",children:"POST"})})})]})}),c.COMPONENT);try{textarea.displayName="textarea",textarea.__docgenInfo={description:"",displayName:"textarea",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/discovery/dollars/component/textarea/index.tsx#textarea"]={docgenInfo:textarea.__docgenInfo,name:"textarea",path:"src/screens/discovery/dollars/component/textarea/index.tsx#textarea"})}catch(e){}},"./src/screens/discovery/dollars/component/textarea/styles.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.memoStyles=void 0;var t=r("./src/stores/index.ts");s.memoStyles=t._.memoStyles((function(){return{container:{paddingTop:t._.sm,paddingHorizontal:t._.wind,paddingBottom:t._.md,backgroundColor:t._.colorPlain},textarea:{borderWidth:3,borderRadius:t._.radiusMd,borderColor:t._.select("#000","rgba(255, 255, 255, 0.88)"),backgroundColor:t._.select(t._.colorBg,"rgba(255, 255, 255, 0.24)")},input:Object.assign({},t._.fontSize15,{color:t._.colorDesc}),btn:{paddingVertical:t._.sm,borderWidth:3,borderRadius:t._.radiusMd,borderColor:t._.select("#000","rgba(255, 255, 255, 0.88)")}}}))},"./src/screens/discovery/dollars/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.object.assign.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.STATE=s.NAMESPACE=s.EXCLUDE_STATE=s.COMPONENT=void 0;var t=r("./src/stores/index.ts"),o=s.COMPONENT="Dollars",n=(s.NAMESPACE="Screen"+o,s.EXCLUDE_STATE={visibleBottom:t._.window.height,fetching:!1,show:!1,text:""});s.STATE=Object.assign({},n,{_loaded:!1})},"./src/screens/discovery/dollars/header/ds.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.COMPONENT=void 0;var t=r("./src/utils/dev/index.ts"),o=r("./src/screens/discovery/dollars/ds.ts");s.COMPONENT=(0,t.rc)(o.COMPONENT,"Header")},"./src/screens/discovery/dollars/header/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var o=r("./src/components/index.ts"),n=r("./src/screens/_/index.ts"),d=r("./src/stores/index.ts"),l=r("./src/utils/decorators/index.ts"),c=r("./src/screens/discovery/dollars/header/ds.ts"),i=r("./node_modules/react/jsx-runtime.js");s.default=(0,l.obc)((function(e,s){var r=s.$,t=r.state.show;return(0,i.jsx)(o.Header,{title:"DOLLARS",hm:["dollars","Dollars"],headerRight:function(){return(0,i.jsxs)(o.Flex,{children:[!t&&r.state.visibleBottom>=2*d._.window.height&&(0,i.jsx)(n.IconTouchable,{style:d._.mr.xs,name:"md-keyboard-arrow-up",size:28,color:d._.colorTitle,onPress:function(){r.scrollToTop(!0)}}),(0,i.jsx)(n.IconTouchable,{style:d._.mr.xs,name:t?"md-close":"md-edit",size:t?20:16,color:d._.colorTitle,onPress:function(){r.onToggleShow()}})]})}})}),c.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/discovery/dollars/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/discovery/dollars/header/index.tsx#header"})}catch(e){}},"./src/screens/discovery/dollars/hooks.ts":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/web.timers.js"),Object.defineProperty(s,"__esModule",{value:!0}),s.useDollarsPage=function(e){var s=e.$;(0,o.useRunAfter)((function(){s.init()}));var r=(0,t.useRef)(null);(0,o.useMount)((function(){return r.current=setInterval((function(){s.updateDollars()}),8e3),function(){s.scrollViewRef=null,s.inputRef=null,clearInterval(r.current)}}))};var t=r("react"),o=r("./src/utils/hooks/index.ts")},"./src/screens/discovery/dollars/index.tsx":(e,s,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js");var t=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;t(r("react"));var o=r("./src/components/index.ts"),n=r("./src/utils/decorators/index.ts"),d=r("./src/utils/hooks/index.ts"),l=t(r("./src/screens/discovery/dollars/component/list/index.tsx")),c=t(r("./src/screens/discovery/dollars/component/textarea/index.tsx")),i=t(r("./src/screens/discovery/dollars/header/index.tsx")),a=r("./src/screens/discovery/dollars/hooks.ts"),u=t(r("./src/screens/discovery/dollars/store.ts")),m=r("./node_modules/react/jsx-runtime.js");s.default=(0,n.ic)(u.default,(function(e,s){(0,a.useDollarsPage)(s);var r=s.$;return(0,d.useObserver)((function(){return(0,m.jsxs)(o.Component,{id:"screen-dollars",children:[(0,m.jsx)(i.default,{}),(0,m.jsxs)(o.Page,{loaded:r.dollars._loaded,children:[(0,m.jsx)(c.default,{}),(0,m.jsx)(l.default,{})]})]})}))}));try{dollars.displayName="dollars",dollars.__docgenInfo={description:"",displayName:"dollars",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/discovery/dollars/index.tsx#dollars"]={docgenInfo:dollars.__docgenInfo,name:"dollars",path:"src/screens/discovery/dollars/index.tsx#dollars"})}catch(e){}},"./src/screens/discovery/dollars/store.ts":(e,s,r)=>{var t=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/web.timers.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.string.trim.js"),r("./node_modules/core-js/modules/es.function.bind.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var o=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var n,d=o(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=o(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=o(r("./node_modules/@babel/runtime/helpers/createClass.js")),i=o(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),a=o(r("./node_modules/@babel/runtime/helpers/inherits.js")),u=o(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=o(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=o(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=o(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),_=r("./node_modules/mobx/dist/mobx.esm.js"),y=r("./src/stores/index.ts"),j=r("./src/utils/index.ts"),x=r("./src/utils/fetch/index.ts"),v=o(r("./src/utils/store/index.ts")),b=r("./src/screens/discovery/dollars/ds.ts");function h(e){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,t=(0,m.default)(e);if(s){var o=(0,m.default)(this).constructor;r=Reflect.construct(t,arguments,o)}else r=t.apply(this,arguments);return(0,u.default)(this,r)}}s.default=(n=function(e){(0,a.default)(r,e);var s=h(r);function r(){var e;(0,l.default)(this,r);for(var o=arguments.length,n=new Array(o),c=0;c<o;c++)n[c]=arguments[c];return e=s.call.apply(s,[this].concat(n)),(0,f.default)((0,i.default)(e),"state",(0,_.observable)(b.STATE)),(0,f.default)((0,i.default)(e),"scrollViewRef",null),(0,f.default)((0,i.default)(e),"inputRef",null),(0,f.default)((0,i.default)(e),"init",(0,d.default)(t.mark((function s(){return t.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e.setState(Object.assign({},b.EXCLUDE_STATE,{_loaded:!0})),s.abrupt("return",e.fetchDollars());case 2:case"end":return s.stop()}}),s)})))),(0,f.default)((0,i.default)(e),"forwardRef",(function(s){e.scrollViewRef=s})),(0,f.default)((0,i.default)(e),"forwardInputRef",(function(s){try{e.inputRef=s.inputRef}catch(e){}})),(0,f.default)((0,i.default)(e),"fetchDollars",(function(){return y.discoveryStore.fetchDollars()})),(0,f.default)((0,i.default)(e),"updateDollars",(function(){return y.discoveryStore.updateDollars()})),(0,f.default)((0,i.default)(e),"scrollToTop",(function(){var s;null!=(s=e.scrollViewRef)&&s.scrollToIndex&&setTimeout((function(){try{e.scrollViewRef.scrollToIndex({animated:!0,index:0,viewOffset:0})}catch(e){}}),160)})),(0,f.default)((0,i.default)(e),"scrollToBottom",(function(){var s,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!=(s=e.scrollViewRef)&&s.scrollToEnd&&setTimeout((function(){try{e.scrollViewRef.scrollToEnd({animated:r,duration:640})}catch(e){}}),160)})),(0,f.default)((0,i.default)(e),"onToggleShow",(function(s){if(e.isWebLogin){var r=e.state,t=r.show,o=r.text;if(s){var n="@"+s;return e.setState({show:!0,text:o.includes(n)?o:"@"+s+" "+o}),void setTimeout((function(){try{e.inputRef.focus()}catch(e){}}),0)}e.setState({show:!t})}else(0,j.info)("未登录")})),(0,f.default)((0,i.default)(e),"onChangeText",(function(s){e.setState({text:s.trim()})})),(0,f.default)((0,i.default)(e),"onSubmit",(function(){var s=e.state,r=s.fetching,t=s.text;r||(t?(e.setState({fetching:!0,show:!1}),setTimeout((function(){e.updateDollars(),y.discoveryStore.doDollars({message:t},(function(){e.setState({fetching:!1,text:""}),e.updateDollars(),(0,x.t)("Dollars.发送",{userId:y.userStore.myId})}),(function(){(0,j.info)("发送失败, 可能需要重新登录"),e.setState({fetching:!1,show:!0})}))}),80)):(0,j.info)("请输入内容"))})),(0,f.default)((0,i.default)(e),"onScroll",j.updateVisibleBottom.bind((0,i.default)(e))),e}return(0,c.default)(r,[{key:"isWebLogin",get:function(){return y.userStore.isWebLogin}},{key:"dollars",get:function(){return y.discoveryStore.dollars}}]),r}(v.default),(0,p.default)(n.prototype,"isWebLogin",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"isWebLogin"),n.prototype),(0,p.default)(n.prototype,"dollars",[_.computed],Object.getOwnPropertyDescriptor(n.prototype,"dollars"),n.prototype),n)}}]);