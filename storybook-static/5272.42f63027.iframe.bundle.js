(self.webpackChunkweb=self.webpackChunkweb||[]).push([[5272],{"./src/screens/home/catalogs/component/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/catalogs/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Component")},"./src/screens/home/catalogs/component/extra/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/catalogs/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Extra")},"./src/screens/home/catalogs/component/extra/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("./node_modules/react/index.js"));var r=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/catalogs/component/extra/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,a.ob)((function(){return(0,c.jsx)(r.Heatmap,{bottom:n._.bottom,id:"条目目录",screen:"SubjectCatalogs"})}),d.COMPONENT)},"./src/screens/home/catalogs/component/item/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT=t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/catalogs/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Item"),t.EVENT={id:"条目目录.跳转"}},"./src/screens/home/catalogs/component/item/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("./node_modules/react/index.js"));var r=s("./src/components/index.ts"),n=s("./src/screens/_/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/screens/home/catalogs/component/item/ds.ts"),c=s("./node_modules/react/jsx-runtime.js");t.default=(0,a.ob)((function(e){var t=e.item,s=e.index;return(0,c.jsx)(n.ItemCatalog,{event:d.EVENT,isUser:!0,id:t.id,name:t.userName,title:t.title,children:!s&&(0,c.jsx)(r.Heatmap,{id:"条目目录.跳转"})})}),d.COMPONENT);try{item.displayName="item",item.__docgenInfo={description:"",displayName:"item",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/catalogs/component/item/index.tsx#item"]={docgenInfo:item.__docgenInfo,name:"item",path:"src/screens/home/catalogs/component/item/index.tsx#item"})}catch(e){}},"./src/screens/home/catalogs/component/list/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/catalogs/component/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"List")},"./src/screens/home/catalogs/component/list/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("./node_modules/react/index.js"));var r=s("./src/components/index.ts"),n=s("./src/stores/index.ts"),a=s("./src/utils/index.ts"),d=s("./src/utils/decorators/index.ts"),c=s("./src/screens/home/catalogs/component/list/utils.tsx"),l=s("./src/screens/home/catalogs/component/list/ds.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,d.obc)((function(e,t){var s=t.$;return(0,i.jsx)(r.ListView,{contentContainerStyle:n._.container.bottom,keyExtractor:a.keyExtractor,data:s.list,lazy:4,scrollToTop:!0,renderItem:c.renderItem,onHeaderRefresh:s.onHeaderRefresh,onFooterRefresh:s.fetchSubjectCatalogs})}),l.COMPONENT);try{list.displayName="list",list.__docgenInfo={description:"",displayName:"list",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/catalogs/component/list/index.tsx#list"]={docgenInfo:list.__docgenInfo,name:"list",path:"src/screens/home/catalogs/component/list/index.tsx#list"})}catch(e){}},"./src/screens/home/catalogs/component/list/utils.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.renderItem=a;o(s("./node_modules/react/index.js"));var r=o(s("./src/screens/home/catalogs/component/item/index.tsx")),n=s("./node_modules/react/jsx-runtime.js");function a(e){var t=e.item,s=e.index;return(0,n.jsx)(r.default,{item:t,index:s})}try{a.displayName="renderItem",a.__docgenInfo={description:"",displayName:"renderItem",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"any"}},index:{defaultValue:null,description:"",name:"index",required:!0,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/catalogs/component/list/utils.tsx#renderItem"]={docgenInfo:a.__docgenInfo,name:"renderItem",path:"src/screens/home/catalogs/component/list/utils.tsx#renderItem"})}catch(e){}},"./src/screens/home/catalogs/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.STATE=t.COMPONENT=void 0;t.COMPONENT="Catalogs",t.STATE={ota:{},_loaded:!1}},"./src/screens/home/catalogs/header/ds.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.COMPONENT=void 0;var o=s("./src/utils/dev/index.ts"),r=s("./src/screens/home/catalogs/ds.ts");t.COMPONENT=(0,o.rc)(r.COMPONENT,"Header")},"./src/screens/home/catalogs/header/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.function.name.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("./node_modules/react/index.js"));var r=s("./src/components/index.ts"),n=s("./src/utils/index.ts"),a=s("./src/utils/decorators/index.ts"),d=s("./src/utils/fetch/index.ts"),c=s("./src/screens/home/catalogs/header/ds.ts"),l=s("./src/screens/home/catalogs/header/styles.ts"),i=s("./node_modules/react/jsx-runtime.js");t.default=(0,a.obc)((function(e,t){var s,o=t.$;return(0,i.jsx)(r.Header,{title:null!=(s=o.params)&&s.name?"包含"+o.params.name+"的目录":"条目目录",alias:"条目目录",hm:[o.url,"SubjectCatalogs"],headerTitleStyle:l.styles.title,headerRight:function(){return(0,i.jsx)(r.Header.Popover,{data:["浏览器查看"],onSelect:function(e){"浏览器查看"===e&&((0,d.t)("条目目录.右上角菜单",{key:e}),(0,n.open)(o.url))},children:(0,i.jsx)(r.Heatmap,{id:"条目目录.右上角菜单"})})}})}),c.COMPONENT);try{header.displayName="header",header.__docgenInfo={description:"",displayName:"header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/catalogs/header/index.tsx#header"]={docgenInfo:header.__docgenInfo,name:"header",path:"src/screens/home/catalogs/header/index.tsx#header"})}catch(e){}},"./src/screens/home/catalogs/header/styles.ts":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.styles=void 0;var o=s("./src/stores/index.ts");t.styles=o._.create({title:{paddingLeft:o._.sm,paddingRight:o._.md}})},"./src/screens/home/catalogs/index.tsx":(e,t,s)=>{s("./node_modules/core-js/modules/es.object.define-property.js");var o=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(s("./node_modules/react/index.js"));var r=s("./src/components/index.ts"),n=s("./src/utils/decorators/index.ts"),a=s("./src/utils/hooks/index.ts"),d=o(s("./src/screens/home/catalogs/component/extra/index.tsx")),c=o(s("./src/screens/home/catalogs/component/list/index.tsx")),l=o(s("./src/screens/home/catalogs/header/index.tsx")),i=o(s("./src/screens/home/catalogs/store.ts")),u=s("./node_modules/react/jsx-runtime.js");t.default=(0,n.ic)(i.default,(function(e,t){var s=t.$;return(0,a.useRunAfter)((function(){s.init()})),(0,a.useObserver)((function(){return(0,u.jsxs)(r.Component,{id:"screen-subject-catalogs",children:[(0,u.jsx)(l.default,{}),(0,u.jsx)(r.Page,{loaded:s.list._loaded,children:(0,u.jsx)(c.default,{})}),(0,u.jsx)(d.default,{})]})}))}));try{catalogs.displayName="catalogs",catalogs.__docgenInfo={description:"",displayName:"catalogs",props:{navigation:{defaultValue:null,description:"",name:"navigation",required:!0,type:{name:"Navigation"}},route:{defaultValue:null,description:"",name:"route",required:!1,type:{name:"{ params?: any; name?: any; }"}},onMounted:{defaultValue:null,description:"Storybook",name:"onMounted",required:!1,type:{name:"Fn"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/screens/home/catalogs/index.tsx#catalogs"]={docgenInfo:catalogs.__docgenInfo,name:"catalogs",path:"src/screens/home/catalogs/index.tsx#catalogs"})}catch(e){}},"./src/screens/home/catalogs/store.ts":(e,t,s)=>{var o=s("./node_modules/@babel/runtime/regenerator/index.js");s("./node_modules/core-js/modules/es.object.define-property.js"),s("./node_modules/core-js/modules/es.reflect.construct.js"),s("./node_modules/core-js/modules/es.array.concat.js"),s("./node_modules/core-js/modules/es.array.map.js"),s("./node_modules/core-js/modules/es.object.assign.js"),s("./node_modules/core-js/modules/es.array.includes.js"),s("./node_modules/core-js/modules/web.timers.js"),s("./node_modules/core-js/modules/es.array.slice.js"),s("./node_modules/core-js/modules/es.array.filter.js"),s("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js");var r=s("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=r(s("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),d=r(s("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=r(s("./node_modules/@babel/runtime/helpers/createClass.js")),l=r(s("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),i=r(s("./node_modules/@babel/runtime/helpers/inherits.js")),u=r(s("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=r(s("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(s("./node_modules/@babel/runtime/helpers/defineProperty.js")),f=r(s("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),j=s("./node_modules/mobx/dist/mobx.esm.js"),h=s("./src/stores/index.ts"),y=s("./src/utils/index.ts"),_=s("./src/utils/fetch/index.ts"),g=s("./src/utils/kv/index.ts"),b=r(s("./src/utils/store/index.ts")),x=s("./src/constants/index.ts"),O=s("./src/screens/home/catalogs/ds.ts");function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var s,o=(0,m.default)(e);if(t){var r=(0,m.default)(this).constructor;s=Reflect.construct(o,arguments,r)}else s=o.apply(this,arguments);return(0,u.default)(this,s)}}var C=[];t.default=(n=function(e){(0,i.default)(s,e);var t=v(s);function s(){var e,r;(0,d.default)(this,s);for(var n=arguments.length,c=new Array(n),i=0;i<n;i++)c[i]=arguments[i];return e=t.call.apply(t,[this].concat(c)),(0,p.default)((0,l.default)(e),"params",void 0),(0,p.default)((0,l.default)(e),"state",(0,j.observable)(O.STATE)),(0,p.default)((0,l.default)(e),"init",(function(){return e.setState({_loaded:!0}),e.fetchSubjectCatalogs(!0)})),(0,p.default)((0,l.default)(e),"onHeaderRefresh",(function(){return e.fetchSubjectCatalogs(!0)})),(0,p.default)((0,l.default)(e),"fetchSubjectCatalogs",(0,a.default)(o.mark((function t(){var s,r,n,a,d=arguments;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(s=d.length>0&&void 0!==d[0]&&d[0])&&e.fetchThirdParty(),t.next=4,h.subjectStore.fetchSubjectCatalogs({subjectId:e.subjectId},s);case 4:return(r=t.sent).list.length&&e.thirdPartyKey in e.state.ota&&(a=(null==(n=e.ota)?void 0:n.ts)||0,(0,y.getTimestamp)()-a>=604800&&e.updateThirdParty()),(0,_.queue)(r.list.map((function(t){return function(){return e.fetchCatalogDetail(t.id)}}))),t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t)})))),(0,p.default)((0,l.default)(e),"fetchCatalogDetail",(r=(0,a.default)(o.mark((function t(s){var r;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h.discoveryStore.catalogDetail(s)._loaded&&!h.discoveryStore.catalogDetailFromOSS(s)._loaded){t.next=2;break}return t.abrupt("return",!0);case 2:return t.next=4,h.discoveryStore.fetchCatalogDetailFromOSS({id:s});case 4:if(!t.sent){t.next=7;break}return t.abrupt("return",!0);case 7:return t.next=9,h.discoveryStore.fetchCatalogDetail({id:s});case 9:return r=t.sent,e.updateCatalogDetail(Object.assign({},r,{id:s})),t.abrupt("return",!0);case 12:case"end":return t.stop()}}),t)}))),function(e){return r.apply(this,arguments)})),(0,p.default)((0,l.default)(e),"fetchThirdParty",(0,a.default)(o.mark((function t(){var s;return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ota||e.list._loaded){t.next=8;break}return t.next=3,(0,g.get)(e.thirdPartyKey);case 3:if(s=t.sent){t.next=7;break}return e.setState({ota:(0,p.default)({},e.thirdPartyKey,{list:[],_loaded:0})}),t.abrupt("return");case 7:e.setState({ota:(0,p.default)({},e.thirdPartyKey,Object.assign({},s,{_loaded:(0,y.getTimestamp)()}))});case 8:case"end":return t.stop()}}),t)})))),(0,p.default)((0,l.default)(e),"updateThirdParty",(0,a.default)(o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!C.includes(e.thirdPartyKey)){t.next=2;break}return t.abrupt("return");case 2:setTimeout((function(){(0,g.update)(e.thirdPartyKey,{list:e.list.list}),C.push(e.thirdPartyKey)}),0);case 3:case"end":return t.stop()}}),t)})))),(0,p.default)((0,l.default)(e),"updateCatalogDetail",(function(e){setTimeout((function(){var t=e.id,s=e.title,o=e.info,r=e.content,n=e.avatar,a=e.nickname,d=e.userId,c=e.time,l=e.collect,i=e.list,u=(0,y.HTMLDecode)((0,y.removeHTMLTag)(o||r));(0,g.update)("catalog_"+t,{id:t,title:s,info:u?u.slice(0,40):"",avatar:n,nickname:a,userId:d,time:c,collect:l,list:i.filter((function(e,t){return t<3})).map((function(e){return{id:e.id,image:e.image,title:e.title,type:e.type,info:e.info,comment:e.comment}})),total:i.length})}),2e3)})),e}return(0,c.default)(s,[{key:"subjectId",get:function(){return this.params.subjectId}},{key:"url",get:function(){return(0,x.HTML_SUBJECT_CATALOGS)(this.subjectId)}},{key:"subjectCatalogs",get:function(){return h.subjectStore.subjectCatalogs(this.subjectId)}},{key:"list",get:function(){return this.subjectCatalogs._loaded?this.subjectCatalogs:this.ota?Object.assign({},this.ota,{pagination:{page:1,pageTotal:10}}):x.LIST_EMPTY}},{key:"catalogDetail",value:function(e){return(0,j.computed)((function(){return h.discoveryStore.catalogDetail(e)})).get()}},{key:"ota",get:function(){return this.state.ota[this.thirdPartyKey]}},{key:"thirdPartyKey",get:function(){return"subject-catalogs_"+this.subjectId}}]),s}(b.default),(0,f.default)(n.prototype,"subjectId",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"subjectId"),n.prototype),(0,f.default)(n.prototype,"url",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"url"),n.prototype),(0,f.default)(n.prototype,"subjectCatalogs",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"subjectCatalogs"),n.prototype),(0,f.default)(n.prototype,"list",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"list"),n.prototype),(0,f.default)(n.prototype,"ota",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"ota"),n.prototype),(0,f.default)(n.prototype,"thirdPartyKey",[j.computed],Object.getOwnPropertyDescriptor(n.prototype,"thirdPartyKey"),n.prototype),n)}}]);