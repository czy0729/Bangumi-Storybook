(self.webpackChunkweb=self.webpackChunkweb||[]).push([[9254],{"./src/screens/tinygrail/tree/chart/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.object.assign.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("react"));var n=s(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/stores/index.ts"),a=r("./src/utils/decorators/index.ts"),i=r("./src/constants/index.ts"),l=s(r("./src/screens/tinygrail/tree/item/index.tsx")),u=r("./node_modules/react/jsx-runtime.js");t.default=(0,a.ob)((function(e){var t,r=e.data,s=void 0===r?[]:r,a=e.caculateType,c=e.isTemple,d=e.onPress,f=e.onLongPress,m=i.MODEL_TINYGRAIL_CACULATE_TYPE.getLabel(a);return"股息"===m&&(t="+"),(0,u.jsx)(n.default,{style:o._.container.tinygrail,children:s.map((function(e){return(0,u.jsx)(l.default,Object.assign({},e,{label:m,extra:t,isTemple:c,onPress:d,onLongPress:f}),e.id)}))})}))},"./src/screens/tinygrail/tree/index.tsx":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.function.name.js");var n=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),a=n(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=n(r("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),u=n(r("./node_modules/@babel/runtime/helpers/inherits.js")),c=n(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=n(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),f=n(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=n(r("react")),h=r("./src/components/index.ts"),p=r("./src/screens/_/index.ts"),y=r("./src/stores/index.ts"),g=r("./src/utils/index.ts"),j=r("./src/utils/decorators/index.ts"),x=r("./src/utils/fetch/index.ts"),_=n(r("./src/constants/i18n/index.ts")),b=n(r("./src/screens/tinygrail/tree/chart/index.tsx")),v=n(r("./src/screens/tinygrail/tree/store.ts")),T=n(r("./src/screens/tinygrail/tree/tool-bar/index.tsx")),w=r("./node_modules/react/jsx-runtime.js");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,d.default)(e);if(t){var n=(0,d.default)(this).constructor;r=Reflect.construct(s,arguments,n)}else r=s.apply(this,arguments);return(0,c.default)(this,r)}}var A=function(e){(0,u.default)(r,e);var t=S(r);function r(){var e;(0,a.default)(this,r);for(var n=arguments.length,i=new Array(n),u=0;u<n;u++)i[u]=arguments[u];return e=t.call.apply(t,[this].concat(i)),(0,f.default)((0,l.default)(e),"state",{refreshing:!1}),(0,f.default)((0,l.default)(e),"onAlert",(function(){(0,g.alert)("1. 单击方格展开功能菜单, 长按隐藏方格\n2. 本功能处于实验性阶段, 不保证能正常渲染, 不正常请尝试刷新或者在讨论组等"+_.default.contact()+"作者\n3. 计算的数据只供参考, 不排除会出现不准确丢失的情况\n4. 因角色数量可能导致流量变大, 页面当有缓存数据不会自动刷新, 请点击旁边的按钮刷新\n5. 部分数据可能毫无意义, 只是顺便调出来, 还请自己把握(bgm38)","小圣杯助手")})),(0,f.default)((0,l.default)(e),"onRefresh",(0,o.default)(s.mark((function t(){var r,n;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.context,n=r.$,e.setState({refreshing:!0}),t.next=4,n.refresh();case 4:n.generateTreeMap(),(0,g.info)("已刷新"),e.setState({refreshing:!1});case 7:case"end":return t.stop()}}),t)})))),(0,f.default)((0,l.default)(e),"onShowMenu",(function(t){var r=t.id,s=t.name,n=t.title;if(r){(0,x.t)("资产分析.人物菜单",{key:n,id:r});var o=e.context,a=o.$,i=o.navigation;switch(n){case"K线":return void i.push("TinygrailTrade",{monoId:"character/"+r});case"买入":return void i.push("TinygrailDeal",{monoId:"character/"+r,type:"bid"});case"卖出":return void i.push("TinygrailDeal",{monoId:"character/"+r,type:"ask"});case"资产重组":return void i.push("TinygrailSacrifice",{monoId:"character/"+r});case"隐藏":return void a.onToggleItem({id:r,name:s});default:i.push("Mono",{monoId:"character/"+r,_name:s})}}})),e}return(0,i.default)(r,[{key:"componentDidMount",value:function(){this.context.$.init()}},{key:"render",value:function(){var e,t=this,r=this.context.$,s=r.state,n=s.loading,o=s.caculateType,a=s.data,i=this.state.refreshing;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(h.Header,{title:(null==(e=r.params)?void 0:e.name)||"资产分析",alias:"资产分析",hm:["tinygrail/tree","TinygrailTree"],statusBarEvents:!1,statusBarEventsType:"Tinygrail",headerRight:function(){return(0,w.jsxs)(h.Flex,{children:[i?(0,w.jsx)(h.Text,{style:y._.mr.sm,type:"tinygrailPlain",size:12,children:"请求中..."}):(0,w.jsx)(p.IconHeader,{style:y._.mr.sm,name:"md-refresh",color:y._.colorTinygrailPlain,size:22,onPress:function(){(0,x.t)("资产分析.刷新"),t.onRefresh()}}),(0,w.jsx)(p.IconHeader,{name:"md-info-outline",color:y._.colorTinygrailPlain,onPress:function(){(0,x.t)("资产分析.提醒"),t.onAlert()}})]})}}),(0,w.jsxs)(h.Page,{style:y._.container.tinygrail,children:[(0,w.jsx)(T.default,{style:y._.mt._sm}),n?(0,w.jsx)(h.Loading,{style:y._.container.tinygrail,color:y._.colorTinygrailText}):(0,w.jsx)(b.default,{data:a,caculateType:o,isTemple:r.isTemple,onPress:this.onShowMenu,onLongPress:function(e){(0,x.t)("资产分析.长按隐藏",{id:e.id}),r.onToggleItem(e)}})]})]})}}]),r}(m.default.Component);t.default=(0,j.inject)(v.default)((0,j.obc)(A))},"./src/screens/tinygrail/tree/item/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.number.to-fixed.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;s(r("react"));var n=s(r("./node_modules/react-native-web/dist/exports/View/index.js")),o=r("./src/components/index.ts"),a=r("./src/screens/_/index.ts"),i=r("./src/stores/index.ts"),l=r("./src/utils/index.ts"),u=r("./src/utils/decorators/index.ts"),c=r("./src/constants/index.ts"),d=r("./src/screens/tinygrail/tree/item/styles.ts"),f=r("./node_modules/react/jsx-runtime.js"),m=i._.window.width*i._.window.height;t.default=(0,u.ob)((function(e){var t,r=e.w,s=e.h,u=e.x,h=e.y,p=e.id,y=e.icon,g=e.name,j=e.price,x=e.percent,_=e.fluctuation,b=e.label,v=e.extra,T=e.isTemple,w=e.onPress,S=e.onLongPress,A=(0,d.memoStyles)(),I=Math.pow(x+1,2),M=s/i._.window.height*1.2,P=!!y&&r*s/m>.016,L=100*x,C=Math.floor(9*I);t=j>c.B?(0,l.toFixed)(j/c.B,1)+"亿":j>c.M?(0,l.toFixed)(j/c.M,1)+"万":(0,l.toFixed)(j,1);var E,R,O=i._.colorTinygrailContainer;y||(O=i._.colorTinygrailBorder);var k="tinygrailText";return"当前涨跌"===b&&(R="%",_>0?(E="+",k="bid"):_<0&&(E="-",k="ask")),(0,f.jsx)(n.default,{style:[A.item,{top:h,left:u}],children:(0,f.jsx)(a.Popover,{data:p?[g,"K线","买入","卖出","资产重组","隐藏"]:[],placement:"auto",onSelect:function(e){if("function"==typeof w)return w({id:p,name:g,title:e})},onLongPress:function(){if("function"==typeof S)return S({id:p,name:g})},children:(0,f.jsxs)(o.Flex,{style:[i._.container.flex,{width:r,height:s,backgroundColor:O}],direction:"column",justify:"center",children:[P&&(0,f.jsx)(o.Image,{style:{marginBottom:Math.floor(5.6*I)},src:y,size:Math.floor(240*M),height:T?Math.floor(320*M):Math.floor(240*M),radius:T?4:Math.floor(120*M),placeholder:!1,skeletonType:"tinygrail"}),(0,f.jsx)(o.Text,{type:"tinygrailPlain",size:Math.min(Math.floor(11*I),15),numberOfLines:1,bold:!0,selectable:!1,children:g}),(0,f.jsxs)(o.Text,{style:{marginTop:Math.floor(3*I)},type:"tinygrailText",size:Math.min(C,14),numberOfLines:1,selectable:!1,children:[(0,f.jsxs)(o.Text,{type:k,size:Math.min(C,14),selectable:!1,children:[v,E,t,R]})," ","/ ",(0,l.toFixed)(L,L<.1?2:1),"%"]})]})})})}))},"./src/screens/tinygrail/tree/item/styles.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=r("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{item:{position:"absolute",borderWidth:s._.tSelect(1,s._.hairlineWidth),borderColor:s._.colorTinygrailBorder,overflow:"hidden"}}}))},"./src/screens/tinygrail/tree/store.ts":(e,t,r)=>{var s=r("./node_modules/@babel/runtime/regenerator/index.js");r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.reflect.construct.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.object.assign.js"),r("./node_modules/core-js/modules/es.promise.js"),r("./node_modules/core-js/modules/es.object.to-string.js"),r("./node_modules/core-js/modules/es.string.iterator.js"),r("./node_modules/core-js/modules/es.array.iterator.js"),r("./node_modules/core-js/modules/web.dom-collections.iterator.js"),r("./node_modules/core-js/modules/es.array.filter.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.array.includes.js"),r("./node_modules/core-js/modules/es.string.includes.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.array.find-index.js"),r("./node_modules/core-js/modules/es.array.splice.js"),r("./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),r("./node_modules/core-js/modules/es.array.for-each.js"),r("./node_modules/core-js/modules/web.dom-collections.for-each.js"),r("./node_modules/core-js/modules/es.parse-float.js"),r("./node_modules/core-js/modules/es.number.to-fixed.js");var n=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,a=n(r("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),i=n(r("./node_modules/@babel/runtime/helpers/asyncToGenerator.js")),l=n(r("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=n(r("./node_modules/@babel/runtime/helpers/createClass.js")),c=n(r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),d=n(r("./node_modules/@babel/runtime/helpers/inherits.js")),f=n(r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),m=n(r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),h=n(r("./node_modules/@babel/runtime/helpers/defineProperty.js")),p=n(r("./node_modules/@babel/runtime/helpers/applyDecoratedDescriptor.js")),y=r("./node_modules/mobx/dist/mobx.esm.js"),g=r("./src/stores/index.ts"),j=r("./src/utils/index.ts"),x=n(r("./src/utils/store/index.ts")),_=r("./src/utils/fetch/index.ts"),b=n(r("./src/utils/thirdParty/treemap.ts")),v=r("./src/constants/index.ts"),T=n(r("./src/styles/index.ts")),w=r("./src/screens/tinygrail/_/ds.ts");function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,s=(0,m.default)(e);if(t){var n=(0,m.default)(this).constructor;r=Reflect.construct(s,arguments,n)}else r=s.apply(this,arguments);return(0,f.default)(this,r)}}var A="valhalla@tinygrail.com",I="ScreenTinygrailTree",M=v.MODEL_TINYGRAIL_ASSETS_TYPE.getValue("所有"),P=v.MODEL_TINYGRAIL_CACULATE_TYPE.getValue("周股息");t.default=(o=function(e){(0,d.default)(r,e);var t=S(r);function r(){var e;(0,l.default)(this,r);for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];return e=t.call.apply(t,[this].concat(o)),(0,h.default)((0,c.default)(e),"params",void 0),(0,h.default)((0,c.default)(e),"state",(0,y.observable)({type:M,caculateType:P,loading:!1,data:[],total:0,filterItems:[]})),(0,h.default)((0,c.default)(e),"init",(0,i.default)(s.mark((function t(){var r;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getStorage(I);case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:if(r=t.t0,e.setState(Object.assign({},r,{loading:!1,data:[],total:0,filterItems:[]})),!e.charaAssets.length){t.next=10;break}return e.generateTreeMap(),t.abrupt("return");case 10:return e.setState({loading:!0}),t.next=13,e.refresh();case 13:e.generateTreeMap(),e.setState({loading:!1});case 15:case"end":return t.stop()}}),t)})))),(0,h.default)((0,c.default)(e),"refresh",(function(){return Promise.all([e.fetchCharaAssets(),e.fetchTemple()])})),(0,h.default)((0,c.default)(e),"fetchCharaAssets",(function(){var t=e.params.userName;return t===A?g.tinygrailStore.fetchValhallList():g.tinygrailStore.fetchCharaAll(t)})),(0,h.default)((0,c.default)(e),"fetchTemple",(function(){var t=e.params.userName;return t!==A&&g.tinygrailStore.fetchTemple(t)})),(0,h.default)((0,c.default)(e),"generateTreeMap",(function(){try{if(!e.charaAssets.length)return;var t=e.caculate(),r=t.total,s=void 0===r?0:r,n=t.currentTotal,o=t.filterCount,a=t.filterTotal,i=t.nodes;o&&i.push({id:0,icon:"",data:"其他"+o+"个角色",weight:a/n>.05?.05*n:a,price:a,percent:a/s});var l=function(e){var t=[];try{b.default.squarify({frame:{x:0,y:0,width:T.default.window.width,height:T.default.window.height-T.default.headerHeight-44},nodes:e},(function(e,r,s,n,o){return t.push({id:o.id,icon:(0,j.tinygrailOSS)(o.icon),name:o.data,price:o.price,percent:o.percent,fluctuation:o.fluctuation,x:parseFloat((0,j.toFixed)(e,3)),y:parseFloat((0,j.toFixed)(r,3)),w:parseFloat((0,j.toFixed)(s,3)),h:parseFloat((0,j.toFixed)(n,3))})}))}catch(e){}return t}(i).filter((function(e){return!!e.percent}));e.setState({data:l,total:s})}catch(e){(0,j.info)("渲染失败, 请刷新")}})),(0,h.default)((0,c.default)(e),"caculate",(function(){var t=e.state,r=t.caculateType,s=t.filterItems,n=e.charaAssets,o=v.MODEL_TINYGRAIL_CACULATE_TYPE.getLabel(r),a=L(n,o,e.isTemple),i=s.map((function(e){return e.id})),l=n.filter((function(e){return!i.includes(e.id)})),u=L(l,o,e.isTemple),c=Math.max(.0072-2e-4*i.length,.005),d=0,f=0,m=l.filter((function(t){if(!u)return!0;var r=C(t,o,e.isTemple);return!(r/u<c)||(d+=1,f+=r,!1)})).map((function(t){var r=C(t,o,e.isTemple);return{id:t.id,icon:t.icon||t.cover,data:t.name,weight:r,price:r,percent:r/a,fluctuation:t.fluctuation||0}}));return{total:a,currentTotal:u,filterCount:d,filterTotal:f,filterRate:c,nodes:m}})),(0,h.default)((0,c.default)(e),"reset",(function(){e.setState({filterItems:[]}),e.generateTreeMap()})),(0,h.default)((0,c.default)(e),"onToggleItem",(function(t){var r=t.id,s=t.name;if(0!==r){var n=e.state.filterItems,o=n.findIndex((function(e){return e.id===r}));e.setState({filterItems:-1===o?[].concat((0,a.default)(n),[{id:r,name:s}]):n.filter((function(e,t){return t!==o}))}),e.generateTreeMap()}})),(0,h.default)((0,c.default)(e),"onTypeSelect",(function(t){(0,_.t)("资产分析.选择范围",{type:t}),e.setState({type:v.MODEL_TINYGRAIL_ASSETS_TYPE.getValue(t),filterItems:[]}),e.generateTreeMap(),e.setStorage(I)})),(0,h.default)((0,c.default)(e),"onCaculateTypeSelect",(function(t){(0,_.t)("资产分析.选择计算类型",{type:t}),e.setState({caculateType:v.MODEL_TINYGRAIL_CACULATE_TYPE.getValue(t),filterItems:[]}),e.generateTreeMap(),e.setStorage(I)})),(0,h.default)((0,c.default)(e),"onHideLow",(function(){e.setState({filterItems:e.charaAssets.filter((function(e){return C(e,"持仓价值")<100}))}),e.generateTreeMap()})),e}return(0,u.default)(r,[{key:"label",get:function(){var e=this.state.type;return v.MODEL_TINYGRAIL_ASSETS_TYPE.getLabel(e)}},{key:"isTemple",get:function(){return"圣殿股"===this.label}},{key:"charaAssets",get:function(){var e=this.params.userName;if(e===A)return this.isTemple?[]:g.tinygrailStore.valhallList.list;if("流动股"===this.label)return g.tinygrailStore.charaAll(e).list;if(this.isTemple)return g.tinygrailStore.temple(e).list;var t=(0,y.toJS)(g.tinygrailStore.temple(e).list),r=(0,y.toJS)(g.tinygrailStore.charaAll(e).list).map((function(e){var r=t.findIndex((function(t){return t.id===e.id}));if(-1!==r){var s=Object.assign({},t[r],e);return t.splice(r,1),s}return e}));return[].concat((0,a.default)(r),(0,a.default)(t))}}]),r}(x.default),(0,p.default)(o.prototype,"label",[y.computed],Object.getOwnPropertyDescriptor(o.prototype,"label"),o.prototype),(0,p.default)(o.prototype,"isTemple",[y.computed],Object.getOwnPropertyDescriptor(o.prototype,"isTemple"),o.prototype),(0,p.default)(o.prototype,"charaAssets",[y.computed],Object.getOwnPropertyDescriptor(o.prototype,"charaAssets"),o.prototype),o);function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=0;try{e.forEach((function(e){s+=C(e,t,r)}))}catch(e){}return s}function C(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=0;try{switch(t){case"持仓价值":r?s+=e.sacrifices*(w.VALHALL_PRICE[e.id]||10)*.5:e.sacrifices?s+=(e.state||0)*(e.current||w.VALHALL_PRICE[e.id]||10)+e.sacrifices*(e.current||w.VALHALL_PRICE[e.id]||10)*.5:s+=e.state*e.current;break;case"周股息":r?s+=(e.sacrifices||0)*e.rate*(e.level+1)*.3:e.sacrifices?s+=(e.state||0)*e.rate+e.sacrifices*e.rate*(e.level+1)*.3:s+=(e.state||0)*e.rate;break;case"股息":s+=e.rate;break;case"持股数":r?s+=.5*e.sacrifices:e.sacrifices?s+=(e.state||0)+.5*e.sacrifices:s+=e.state;break;case"市场价":s+=e.marketValue||0;break;case"发行量":s+=e.total||0;break;case"当前价":s+=e.current||0;break;case"交易量":s+=e.change||0;break;case"当前涨跌":s+=Math.abs(100*e.fluctuation||0);break;case"新番奖励":s+=e.bonus||0}}catch(e){}return s}},"./src/screens/tinygrail/tree/tool-bar/index.tsx":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.map.js"),r("./node_modules/core-js/modules/es.number.to-fixed.js"),r("./node_modules/core-js/modules/es.array.concat.js"),r("./node_modules/core-js/modules/es.function.name.js"),r("./node_modules/core-js/modules/es.string.split.js"),r("./node_modules/core-js/modules/es.regexp.exec.js"),r("./node_modules/core-js/modules/es.parse-int.js");var s=r("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r("./node_modules/@babel/runtime/helpers/slicedToArray.js")),o=s(r("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),a=(s(r("react")),r("./src/components/index.ts")),i=r("./src/screens/_/index.ts"),l=r("./src/stores/index.ts"),u=r("./src/utils/index.ts"),c=r("./src/utils/decorators/index.ts"),d=r("./src/utils/fetch/index.ts"),f=r("./src/constants/index.ts"),m=r("./src/screens/tinygrail/tree/tool-bar/styles.ts"),h=r("./node_modules/react/jsx-runtime.js"),p=f.TINYGRAIL_ASSETS_TYPE.map((function(e){return e.label})),y=f.TINYGRAIL_CACULATE_TYPE.map((function(e){return e.label})),g=f.TINYGRAIL_CACULATE_TEMPLE_TYPE.map((function(e){return e.label}));t.default=(0,c.obc)((function(e,t){var r,s=e.style,c=t.$,j=(0,m.memoStyles)(),x=c.state,_=x.type,b=x.caculateType,v=x.total,T=void 0===v?0:v,w=x.filterItems,S=f.MODEL_TINYGRAIL_ASSETS_TYPE.getLabel(_),A=f.MODEL_TINYGRAIL_CACULATE_TYPE.getLabel(b);return r=T>f.B?(0,u.toFixed)(T/f.B,1)+"亿":T>f.M?(0,u.toFixed)(T/f.M,1)+"万":(0,u.toFixed)(T||0,1),(0,h.jsxs)(a.Flex,{style:(0,u.stl)(j.container,s),children:[(0,h.jsx)(a.Flex.Item,{flex:.8,children:(0,h.jsx)(i.Popover,{data:p,onSelect:function(e){return c.onTypeSelect(e)},children:(0,h.jsxs)(a.Flex,{style:j.item,justify:"center",children:[(0,h.jsx)(a.Text,{type:"warning",children:S||"范围"}),(0,h.jsx)(a.Text,{style:l._.ml.xs,type:"warning",size:12,children:c.charaAssets.length})]})})}),(0,h.jsx)(a.Flex.Item,{children:(0,h.jsx)(i.Popover,{data:c.isTemple?g:y,onSelect:function(e){return c.onCaculateTypeSelect(e)},children:(0,h.jsxs)(a.Flex,{style:j.item,justify:"center",children:[(0,h.jsx)(a.Text,{type:"warning",children:A||"计算类型"}),(0,h.jsx)(a.Text,{style:l._.ml.xs,type:"warning",size:12,children:r})]})})}),(0,h.jsx)(a.Flex.Item,{flex:.8,children:(0,h.jsx)(i.Popover,{data:["重置","隐藏低持仓"].concat((0,o.default)(w.map((function(e){return e.name+" #"+e.id})))),onSelect:function(e){if((0,d.t)("资产分析.选择筛选",{title:e}),"重置"!==e)if("隐藏低持仓"!==e){var t=e.split(" #"),r=(0,n.default)(t,2),s=r[0],o=r[1];c.onToggleItem({id:parseInt(o),name:s})}else c.onHideLow();else c.reset()},children:(0,h.jsxs)(a.Flex,{style:j.item,justify:"center",children:[(0,h.jsx)(a.Iconfont,{style:{color:w.length?l._.colorWarning:l._.colorTinygrailText},name:"md-filter-list",size:16}),(0,h.jsx)(a.Text,{style:l._.ml.sm,type:w.length?"warning":"tinygrailText",children:w.length||"-"})]})})})]})}))},"./src/screens/tinygrail/tree/tool-bar/styles.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.memoStyles=void 0;var s=r("./src/stores/index.ts");t.memoStyles=s._.memoStyles((function(){return{container:{height:s._.r(44),backgroundColor:s._.colorTinygrailContainer},item:{paddingVertical:s._.md-4,paddingHorizontal:s._.md},touchable:{paddingHorizontal:s._.lg}}}))},"./src/utils/thirdParty/treemap.ts":(e,t,r)=>{r("./node_modules/core-js/modules/es.object.define-property.js"),r("./node_modules/core-js/modules/es.array.slice.js"),r("./node_modules/core-js/modules/es.array.sort.js"),r("./node_modules/core-js/modules/es.array.map.js"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={},n=function(){function e(e,t){this.weight=0,this.frame={x:0,y:0,width:0,height:0},this.weight=e,this.data=t}return e.weigh=function(e){var t=new Array,r=new Array;for(e.level=0,r.push(e);r.length>0;){var s=r.pop();if(t[s.level]||(t[s.level]=new Array),t[s.level].push(s),s.nodes)for(var n=0;n<s.nodes.length;++n){var o=s.nodes[n];o.level=s.level+1,o.parent=s,r.push(o)}}for(n=t.length-2;n>=0;--n)for(var a=0;a<t[n].length;++a){for(var i=0,l=0;l<t[n][a].nodes.length;++l)i+=t[n][a].nodes[l].weight;t[n][a].weight=i}},e}();s.InternalNode=n;var o=function(){};function a(){return.05}s.Size=o,s.maxFontSize=function(e){return.1*(e.width+e.height)},s.minFontSize=function(e){return 8},s.fontSize=function(e,t){var r=this.minFontSize(e),s=this.maxFontSize(e);return Math.max(r,(t.width+t.height)/(e.width+e.height)*s)},s.tileMarginPercentage=a,s.xMargin=function(e){return.05*e.width},s.yMargin=function(e){return.05*e.height};var i=function(){function e(){}return e.squarify=function(e,t,r,n){var o=e.slice(0);this.scaleWeights(e,t,r),o.sort((function(e,t){return t.weight-e.weight})),o.push(new s.InternalNode(0,null));for(var a=r<t,i=a?r:t,l=0,u=0,c=t,d=r,f=[];o.length>0;){var m=o[0],h=m.weight,p=this.sum(f),y=this.min(f),g=this.max(f),j=this.worst(p+h,Math.min(y,h),Math.max(g,h),i),x=this.worst(p,y,g,i);if(0==f.length||j<x)f.push(m),o.shift();else{var _,b=l,v=u,T=p/i;for(_=0;_<f.length;++_){var w=f[_].weight/T;a?(n(b,v,T,w,f[_]),v+=w):(n(b,v,w,T,f[_]),b+=w)}a?(l+=T,c-=T):(u+=T,d-=T),i=(a=d<c)?d:c,f=[]}}},e.worst=function(e,t,r,s){return Math.max(s*s*r/(e*e),e*e/(s*s*t))},e.scaleWeights=function(e,t,r){for(var s=t*r/this.sum(e),n=0;n<e.length;n++)e[n].weight=s*e[n].weight},e.max=function(e){return Math.max.apply(Math,this.weights(e))},e.min=function(e){return Math.min.apply(Math,this.weights(e))},e.sum=function(e){for(var t=0,r=0;r<e.length;++r)t+=e[r].weight;return t},e.weights=function(e){return e.map((function(e){return e.weight}),e)},e}();s.squarify=function(e,t){s.InternalNode.weigh(e);var r=new Array;for(r.push(e);r.length>0;){if((a=r.shift()).nodes&&a.nodes.length>0){i.squarify(a.nodes,a.frame.width,a.frame.height,(function(e,t,r,s,n){n.frame={x:a.frame.x+e,y:a.frame.y+t,width:r,height:s}}));for(var n=0;n<a.nodes.length;++n){var o=a.nodes[n];o.nodes&&o.nodes.length>0&&r.push(o)}}}for(r.push(e);r.length>0;){var a;if(t((a=r.pop()).frame.x,a.frame.y,a.frame.width,a.frame.height,a),a.nodes)for(n=0;n<a.nodes.length;++n)r.push(a.nodes[n])}};t.default=s}}]);